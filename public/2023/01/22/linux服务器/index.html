



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="杜明清的个人博客" href="https://dmqweb.cn/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="杜明清的个人博客" href="https://dmqweb.cn/atom.xml" />
<link rel="alternate" type="application/json" title="杜明清的个人博客" href="https://dmqweb.cn/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="Linux" />


<link rel="canonical" href="https://dmqweb.cn/2023/01/22/linux%E6%9C%8D%E5%8A%A1%E5%99%A8/">



  <title>
Linux - Linux |
Web blog = 杜明清的个人博客 = 👻欢迎一起交流学习👻</title>
  <meta name="keywords" content="前端开发, HTML, CSS, JavaScript, 博客">
  <meta name="description" content="探索前端开发的无限可能。本博客提供最新的前端知识库，以及实用的开发技巧和最佳实践。加入我们的社区，共同成长。">
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">Linux
  </h1>
  
<div class="meta">
  <span class="item" title="创建时间：2023-01-22 12:24:04">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">发表于</span>
    <time itemprop="dateCreated datePublished" datetime="2023-01-22T12:24:04+08:00">2023-01-22</time>
  </span>
  <span class="item" title="本文字数">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">本文字数</span>
    <span>28k</span>
    <span class="text">字</span>
  </span>
  <span class="item" title="阅读时长">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">阅读时长</span>
    <span>26 分钟</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="切换导航栏">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Web blog</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/15/66e62db68b7b65eb.webp"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/28/f7a6eb62965e0dec.webp"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/07/5a293b82670a4885.webp"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/12/3368de466b008234.webp"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/03/29/4e134f025ae53f2b.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/25/3fe84aea28b256c7.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">首页</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Linux/" itemprop="item" rel="index" title="分类于 Linux"><span itemprop="name">Linux</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://dmqweb.cn/2023/01/22/linux%E6%9C%8D%E5%8A%A1%E5%99%A8/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="dmq">
    <meta itemprop="description" content="👻欢迎一起交流学习👻, ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="杜明清的个人博客">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="linux-服务器"><a class="anchor" href="#linux-服务器">#</a> Linux 服务器</h1>
<p><strong>Linux 是操作系统：</strong></p>
<p>Linux 作为<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvJUU4JTg3JUFBJUU3JTk0JUIxJUU4JUJEJUFGJUU0JUJCJUI2">自由软件</span>和<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvJUU1JUJDJTgwJUU2JTk0JUJFJUU2JUJBJTkwJUU0JUJCJUEzJUU3JUEwJTgxJUU4JUJEJUFGJUU0JUJCJUI2">开放源代码软件</span>发展中最著名的例子，背靠社区与商业化的使用，使其得到了广泛的应用与发展。</p>
<p><strong>Linux 无处不在：</strong></p>
<p>世界上 500 个最快的超级计算机 90％以上运行 Linux 发行版或变种，包括最快的前 10 名超级计算机运行的都是基于 Linux 内核的操作系统。Linux 也广泛应用在嵌入式系统上，如手机（Mobile Phone）、平板电脑（Tablet）、路由器（Router）、电视（TV）和电子游戏机等。在移动设备上广泛使用的 Android 操作系统就是创建在 Linux 内核之上。</p>
<p><strong>学习 Linux 迫在眉睫：</strong></p>
<ul>
<li>公司都在用</li>
<li>小伙伴们都会用</li>
<li>关键免费啊….</li>
</ul>
<p><strong>本课程的主要目标：</strong></p>
<ul>
<li>了解 Linux 操作系统 (版本、目录、安装等)</li>
<li>学会使用 Linux 常见的命令</li>
<li>搭建 Nginx 服务，给你的 Web 小站一个运行环境吧～～</li>
<li>介绍 HTTP (s) 及免费申请 SSL 证书</li>
<li>云服务器阿里云、华为云（介绍）、云数据库 RDS 介绍</li>
<li>什么是负载均衡？负载均衡有什么用？阿里云 SLB 介绍</li>
</ul>
<p><strong>前置准备【下面的方式任选其一】：</strong></p>
<ul>
<li>使用虚拟化软件 (本地安装)</li>
<li>购买云服务器</li>
</ul>
<p>版本准备：linux 操作系统 (Centos 7.6)</p>
<p>可选：准备一个域名</p>
<h2 id="linux简介"><a class="anchor" href="#linux简介">#</a> Linux 简介</h2>
<h3 id="版本介绍"><a class="anchor" href="#版本介绍">#</a> 版本介绍</h3>
<p><img data-src="./assets/123-3.png" alt="Linux简版介绍" /></p>
<p>Fedora 是基于 RHEL，CentOS，Scientific Linux, 和 Oracle Linux 的社区版本。相比 RHEL，Fedora 打包了显著的更多的软件包。其中一个原因是，多样化的社区参与 Fedora 的建设，它不只是一家公司。在这个过程中，CentOS 用于活动，演示和实验，因为它是对最终用户免费提供的，并具有比 Fedora 的一个更长的发布周期 (通常每隔半年左右发布一个新版本)。</p>
<p>Debian 是包括 Ubuntu 在内许多发行版的上游，而 Ubuntu 又是 Linux Mint 及其他发行版的上游。Debian 在服务器和桌面电脑领域都有着广泛的应用。Debian 是一个纯开源计划并着重在一个关键点上，稳定性。它同时也提供了最大的和完整的软件仓库给用户。</p>
<p>Linux 的发行版本可以大体分为两类，一类是商业公司维护的发行版本，如：著名的 Redhat (RHEL)，一类是社区组织维护的发行版本，如：Debian。下面介绍一下各个发行版本的特点：</p>
<h4 id="centosredhat"><a class="anchor" href="#centosredhat">#</a> Centos(Redhat)</h4>
<p>Redhat，应该称为 Redhat 系列，包括 RHEL (Redhat Enterprise Linux，也就是所谓的 Redhat Advance Server，收费版本)、Fedora Core (由原来的 Redhat 桌面版本发展而来，免费版本)、CentOS (RHEL 的社区克隆版本，免费)。</p>
<p>包管理方式：采用的是基于 <code>rpm</code>  包的 <code>yum</code>  包管理方式。</p>
<h4 id="debian"><a class="anchor" href="#debian">#</a> Debian</h4>
<p>Debian 是社区类 Linux 的典范，是迄今为止最遵循 GNU 规范 的 Linux 系统。Debian 最早由 Ian Murdock 于 1993 年创建，分为三个版本分支 (branch)：  <code>stable</code> ,  <code>testing</code>  和  <code>unstable</code> 。其中， <code>unstable</code>  为最新的测试版本，其中包括最新的软件包，但是也有相对较多的 bug，适合桌面用户。 <code>testing</code>  的版本都经 过 <code>unstable</code>  中的测试，相对较为稳定，也支持了不少新技术 (比如 SMP 等)。而 <code>stable</code>  一般只用于服务器，上面的软件包大部分都比较过时，但是稳定和安全性都非常的高。</p>
<p>包管理方式：采用的是基于是 <code>apt-get</code> 、 <code>dpkg</code>  包管理方式。</p>
<h4 id="ubuntu"><a class="anchor" href="#ubuntu">#</a> Ubuntu</h4>
<p>Ubuntu 严格来说不能算一个独立的发行版本，Ubuntu 是基于 Debian 的 <code>unstable</code>  版本加强而来，可以这么说，Ubuntu 就是 一个拥有 Debian 所有的优点，以及自己所加强的优点的近乎完美的 Linux 桌面系统。根据选择的桌面系统不同，有三个版本可供选择，基于 <code>Gnome</code>  的 Ubuntu，基于 <code>KDE</code>  的 Kubuntu 以及基于 <code>Xfc</code>  的 Xubuntu。特点是界面非常友好，容易上手，对硬件的支持非常全面，是最适合做桌面系统的 Linux 发行版本。</p>
<p>包管理方式：采用的是基于是 <code>apt-get</code> 、 <code>dpkg</code>  包管理方式。</p>
<p>总结对比一下：</p>
<table>
<thead>
<tr>
<th>分类</th>
<th>Centos</th>
<th>Debian</th>
<th>Ubuntu</th>
</tr>
</thead>
<tbody>
<tr>
<td>包管理</td>
<td>yum</td>
<td>apt-get</td>
<td>apt-get</td>
</tr>
<tr>
<td>桌面应用</td>
<td>支持</td>
<td>需要另装</td>
<td>支持</td>
</tr>
<tr>
<td>系统资源占用</td>
<td>小</td>
<td>非常小</td>
<td>大</td>
</tr>
<tr>
<td>资料</td>
<td>最多</td>
<td>依赖社区</td>
<td>多</td>
</tr>
<tr>
<td>更新频次</td>
<td>长达 10 年</td>
<td>1-2 年</td>
<td>3-5 年</td>
</tr>
<tr>
<td>软件资源</td>
<td>较新</td>
<td>最新</td>
<td>新</td>
</tr>
<tr>
<td>漏洞更新</td>
<td>慢</td>
<td>依赖社区</td>
<td>依赖社区</td>
</tr>
<tr>
<td>默认安装</td>
<td>非常全</td>
<td>无</td>
<td>非常全</td>
</tr>
<tr>
<td>稳定性</td>
<td>较稳定</td>
<td>稳定</td>
<td>相对稳定</td>
</tr>
<tr>
<td>系统操作要求</td>
<td>较高</td>
<td>高</td>
<td>低</td>
</tr>
<tr>
<td>维护要求</td>
<td>低</td>
<td>高</td>
<td>较高</td>
</tr>
<tr>
<td>易用性</td>
<td>一般</td>
<td>差</td>
<td>较好</td>
</tr>
<tr>
<td>定制化</td>
<td>一般</td>
<td>高</td>
<td>差</td>
</tr>
</tbody>
</table>
<p>CentOS 是 RHEL 发行版对应的开源版本，通常在 RedHat 的发布后就会很快发行。它既稳定，占用资源又少，在网络上能方便搜索到安装配置的文档，自身的帮助文档也非常强大。所以，新人学习推荐：<strong>Centos</strong></p>
<blockquote>
<p>本课程，后续的操作与演示，将会使用 Centos 7.6 64-bit 版本进行演示</p>
</blockquote>
<p>参考资料：<span class="exturl" data-url="aHR0cHM6Ly91cGxvYWQud2lraW1lZGlhLm9yZy93aWtpcGVkaWEvY29tbW9ucy8xLzFiL0xpbnV4X0Rpc3RyaWJ1dGlvbl9UaW1lbGluZS5zdmc=">Linux 发行版及年份</span></p>
<h3 id="应用场景"><a class="anchor" href="#应用场景">#</a> 应用场景</h3>
<h4 id="linux-vs-windows"><a class="anchor" href="#linux-vs-windows">#</a> Linux vs Windows</h4>
<p>下面我们 Linux 与 Windows 作一个对比：</p>
<p>这里 Linux 是免费的版本，如 Centos, Ubuntu，而 Windows 则是 Windows10/8/7</p>
<table>
<thead>
<tr>
<th>分类</th>
<th>Linux</th>
<th>Windows</th>
</tr>
</thead>
<tbody>
<tr>
<td>费用</td>
<td>免费</td>
<td>付费</td>
</tr>
<tr>
<td>软件支持</td>
<td>社区，免费</td>
<td>官方支持，收费</td>
</tr>
<tr>
<td>安全性</td>
<td>很安全</td>
<td>各种漏洞</td>
</tr>
<tr>
<td>使用习惯</td>
<td>命令行与界面操作，需要学习</td>
<td>图形界面操作，简单</td>
</tr>
<tr>
<td>可定制性</td>
<td>高</td>
<td>低</td>
</tr>
<tr>
<td>应用范畴</td>
<td>服务器</td>
<td>工作、娱乐</td>
</tr>
<tr>
<td>更新</td>
<td>依赖社区</td>
<td>官方更新</td>
</tr>
<tr>
<td>系统内核</td>
<td>透明</td>
<td>封闭</td>
</tr>
</tbody>
</table>
<p>Linux 的优势：</p>
<ul>
<li><strong>稳定的系统</strong></li>
<li>安全性和漏洞的快速修补</li>
<li>多用户</li>
<li>用户和用户组的规划</li>
<li><strong>相对较少的系统资源占用</strong></li>
<li>可定制裁剪，移植到嵌入式平台（如安卓设备）</li>
<li>可选择的多种图形用户界面（如 GNOME，KDE）</li>
</ul>
<p>Windows 的优势：</p>
<ul>
<li>特定的支持厂商</li>
<li><strong>足够的游戏娱乐支持度</strong></li>
<li>足够的专业软件支持度</li>
</ul>
<h4 id="linux的gui界面"><a class="anchor" href="#linux的gui界面">#</a> Linux 的 GUI 界面</h4>
<p>这里我们选择几款比较有代表性的桌面进行简单的介绍：</p>
<ol>
<li>
<p>GNOME<span class="exturl" data-url="aHR0cHM6Ly93d3cuZ25vbWUub3JnLw=="> [官方地址]</span></p>
<p><img data-src="./assets/image-20190602081017634.png" alt="/images/image-20190602081017634" /></p>
<blockquote>
<p>centos6.x 上默认是 gnome2，7.x 默认 gnome3</p>
</blockquote>
<p><img data-src="./assets/activities-overview.jpg" alt="img" /></p>
<p>上图为：GNOME3</p>
</li>
<li>
<p>KDE <span class="exturl" data-url="aHR0cHM6Ly9rZGUub3JnLw==">[官方地址]</span></p>
<p><img data-src="./assets/plasma-5.12.png" alt="Plasma 5.12" /></p>
<p>上图为：Plasma 5.12 LTS</p>
</li>
<li>
<p>Unity</p>
<p><img data-src="./assets/v2-c495dceef151f7685d5964a99c970f2b_r.jpg" alt="preview" /></p>
<p><strong>Unity</strong> 是<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvQ2Fub25pY2FsJUU1JTg1JUFDJUU1JThGJUI4"> Canonical 公司</span>为<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvR05PTUU="> GNOME</span><span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvJUU2JUExJThDJUU5JTlEJUEyJUU3JThFJUFGJUU1JUEyJTgz"> 桌面环境</span>所开发的<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvJUU1JTlCJUJFJUU1JUJEJUEyJUU3JTk0JUE4JUU2JTg4JUI3JUU3JTk1JThDJUU5JTlEJUEy">图形用户界面</span>，用于<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvVWJ1bnR1"> Ubuntu</span><span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvJUU2JTkzJThEJUU0JUJEJTlDJUU3JUIzJUJCJUU3JUJCJTlG"> 操作系统</span>。</p>
<blockquote>
<p>直到 Ubuntu16.04LTS，使用的都是 Unity，从 Ubuntu 18.04 LTS 开始，默认的 Ubuntu 桌面将重归 GNOME。人事调整，与钱的问题…. 有兴趣的同学可以看<span class="exturl" data-url="aHR0cHM6Ly9pbnNpZ2h0cy51YnVudHUuY29tLzIwMTcvMDQvMDUvZ3Jvd2luZy11YnVudHUtZm9yLWNsb3VkLWFuZC1pb3QtcmF0aGVyLXRoYW4tcGhvbmUtYW5kLWNvbnZlcmdlbmNlLw==">这里</span></p>
</blockquote>
</li>
</ol>
<p>我们来看看<span class="exturl" data-url="aHR0cHM6Ly90cmVuZHMuZ29vZ2xlLmNvbS90cmVuZHMvZXhwbG9yZT9kYXRlPXRvZGF5JTIwNS15JmFtcDtxPUdOT01FLEtERSwlMkZtJTJGMGRzYmswbg=="> Google Trends</span></p>
<p>参考资料：</p>
<p><span class="exturl" data-url="aHR0cDovL3d3dy51YnVudHUub3JnLmNuL2Rvd25sb2Fk">Ubuntu 官方下载地址：获取 Ubuntu</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p5cWJsb2cvYXJ0aWNsZS9kZXRhaWxzLzgwMTUyMDE2">Ubuntu18.04（Gnome 桌面）主题美化</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ljZV9fc25vdy9hcnRpY2xlL2RldGFpbHMvODAxNTIwNjg=">Ubuntu 18.04 配置及美化</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9oZWxpdS5pby8yMDE4LzEyLzIyL1VidW50dTE4LjA0JUU1JUFFJThDJUU3JUJFJThFJUU5JTg1JThEJUU3JUJEJUFFLyMlRTYlOTUlODglRTYlOUUlOUMlRTklQTIlODQlRTglQTclODg=">Ubuntu18.04 完美配置优化美化</span></p>
<h4 id="常见软件应用"><a class="anchor" href="#常见软件应用">#</a> 常见软件应用</h4>
<ul>
<li>数据库：MySQL、Oracle、 MongoDB、Redis</li>
<li>web 服务器： <code>Nginx</code> 、Apache</li>
<li>浏览器：Chromium (Chrome)、Firefox</li>
<li>编辑器：Emacs， <code>Vim</code> ，Nano，Atom，VScode，IntelliJ IDEA&amp;Webstorm</li>
<li>文档：WPS Office、LibreOffice、Calligra (Ubuntu/Debian)</li>
<li>下载工具： <code>Aria2</code> 、uGet(Ubuntu/Debian)、XDM、qBittorrent</li>
<li>虚拟化：VirtualBox、VMWare、</li>
<li>系统工具： <code>git</code> 、rsync、sudo、unzip、tar</li>
<li>其他：音乐 Netease Music、图片 GIMP、聊天 Wine QQ、播放器 VLC</li>
</ul>
<h3 id="安装方法"><a class="anchor" href="#安装方法">#</a> 安装方法</h3>
<h4 id="centos安装方法"><a class="anchor" href="#centos安装方法">#</a> Centos 安装方法：</h4>
<ol>
<li>
<p>下载镜像</p>
<p><img data-src="./assets/image-20190602095157756.png" alt="/images/image-20190602095157756" /></p>
<p>按需选择下载：</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>DVD</th>
<th>Minimal</th>
</tr>
</thead>
<tbody>
<tr>
<td>图形安装</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td>自带软件包</td>
<td>全家桶，可选择</td>
<td>无</td>
</tr>
<tr>
<td>镜像大小</td>
<td>4G+</td>
<td>800-900M</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>制作 U 盘启动盘</p>
<p>Windows 参考：<a href="#Windows%E4%B8%AD%E5%88%B6%E4%BD%9CUSB%E5%90%AF%E5%8A%A8%E7%9B%98">Windows 中制作 USB 启动盘</a></p>
<p>Mac/Linux 参考：<a href="#MacOS%E4%B8%AD%E5%88%B6%E4%BD%9CUSB%E5%90%AF%E5%8A%A8%E7%9B%98">MacOS 中制作 USB 启动盘</a></p>
</li>
<li>
<p>修改 BIOS 启动顺序，重启</p>
</li>
<li>
<p>安装配置。€</p>
</li>
</ol>
<p>参考资料</p>
<ol>
<li><span class="exturl" data-url="aHR0cHM6Ly93aWtpLmNlbnRvcy5vcmcvemgvSG93VG9zL0luc3RhbGxGcm9tVVNCa2V5">官方 U 盘安装说明</span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY2VudG9zLm9yZy9kb3dubG9hZC8=">镜像下载</span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9saW51eC5jbi9hcnRpY2xlLTgwNDgtMS5odG1s">Centos7 安装教程</span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly90dXRvcmlhbHMudWJ1bnR1LmNvbS90dXRvcmlhbC90dXRvcmlhbC1pbnN0YWxsLXVidW50dS1kZXNrdG9wIzA=">Ubuntu 官方安装教程</span></li>
</ol>
<p>常见问题：</p>
<ol>
<li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmppbmNodWFuZy5vcmcvMjA2Mi5odG1s">centos7 U 盘安装卡在 starting dracut initqueue hook </span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3pncmprZmxta3ljL2FydGljbGUvZGV0YWlscy83ODI5MzUwNA==">U 盘安装 CentOS7 遇到：Warning: dracut-initqueue timeout - starting timeout scripts</span></li>
</ol>
<h4 id="windows中制作usb启动盘"><a class="anchor" href="#windows中制作usb启动盘">#</a> Windows 中制作 USB 启动盘</h4>
<p>操作步骤：</p>
<ol>
<li>
<p>格式化 U 盘 (FAT32 格式)</p>
</li>
<li>
<p>下载 ISO 镜像</p>
</li>
<li>
<p>下载资源文件中的写入程序</p>
</li>
<li>
<p>写入镜像 (工具见后文)</p>
</li>
</ol>
<p><img data-src="./assets/1559440057311.jpg" alt="1559440057311" /></p>
<p>资源下载：</p>
<p>Centos 官网推荐：</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9zb3VyY2Vmb3JnZS5uZXQvcHJvamVjdHMvdXNid3JpdGVyLw==">USBwriter</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9zb3VyY2Vmb3JnZS5uZXQvcHJvamVjdHMvd2luMzJkaXNraW1hZ2VyLw==">Win32 Disk Imager</span></p>
<p>Ubuntu 官网推荐：</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ydWZ1cy5pZS8=">rufus</span></p>
<p><img data-src="./assets/SouthEast.png" alt="rufus" /></p>
<h4 id="macos中制作usb启动盘"><a class="anchor" href="#macos中制作usb启动盘">#</a> MacOS 中制作 USB 启动盘</h4>
<ol>
<li>
<p>格式化 U 盘</p>
<p><img data-src="./assets/image-20190602094231784.png" alt="/images/image-20190602094231784" /></p>
</li>
<li>
<p>使用  <code>diskutil list</code>  查看 U 的设备名</p>
<pre><code>$ diskutil list
/dev/disk0 (internal):
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:      GUID_partition_scheme                         500.3 GB   disk0
   1:                        EFI EFI                     314.6 MB   disk0s1
   2:                 Apple_APFS Container disk1         500.0 GB   disk0s2

/dev/disk1 (synthesized):
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:      APFS Container Scheme -                      +500.0 GB   disk1
                                 Physical Store disk0s2
   1:                APFS Volume APPLE SSD               342.6 GB   disk1s1
   2:                APFS Volume Preboot                 47.6 MB    disk1s2
   3:                APFS Volume Recovery                509.7 MB   disk1s3
   4:                APFS Volume VM                      4.3 GB     disk1s4

/dev/disk2 (external, physical):
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:     FDisk_partition_scheme                        *123.0 GB   disk2
   1:               Windows_NTFS LIWEI                   123.0 GB   disk2s1

</code></pre>
<p>上图中，/dev/disk2 就是 U 盘</p>
</li>
<li>
<p>卸载 U 盘 (不是推出) :  <code>diskutil umountDisk /dev/disk2</code>  (假如 U 盘是 /dev/disk2)</p>
<pre><code>$ diskutil umountDisk /dev/disk2
Unmount of all volumes on disk1 was successful
</code></pre>
</li>
<li>
<p>镜像 DMG 写入到 U 盘:  <code>sudo dd if=~/Downloads/ubuntu-16.04-desktop-amd64.iso of=/dev/disk2 bs=1m</code>  (假如 U 盘是 /dev/disk1, 千万别搞错了)</p>
<pre><code>$ sudo dd if=~/Downloads/ubuntu-17.04-desktop-amd64.iso of=/dev/disk2 bs=1m
Password:
2151+1 records in
2151+1 records out
2256076800 bytes transferred in 90.277905 secs (24990354 bytes/sec)
</code></pre>
</li>
<li>
<p>写入完成后会提示:“此电脑不能读取能插入的磁盘”, 这里选择直接推出即可</p>
</li>
</ol>
<h3 id="linux目录结构"><a class="anchor" href="#linux目录结构">#</a> Linux 目录结构</h3>
<p><img data-src="./assets/linux-operation-system.jpeg" alt="Linux目录结构" /></p>
<table>
<thead>
<tr>
<th>目录</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>/bin</td>
<td>常用二进制命令</td>
<td>ls, cp, rm, mkdir</td>
</tr>
<tr>
<td>/usr</td>
<td>系统程序目录</td>
<td>命令、帮助文件、系统配置</td>
</tr>
<tr>
<td>/var</td>
<td>这个目录中存放着在不断扩充着的东西</td>
<td>日志</td>
</tr>
<tr>
<td>/lib</td>
<td>系统最基本的动态连接共享库</td>
<td>类似于 Windows 中的 DLL</td>
</tr>
<tr>
<td>/srv</td>
<td>存放一些服务启动之后需要提取的数据</td>
<td>通常是空的</td>
</tr>
<tr>
<td>/home</td>
<td>用户主目录</td>
<td>通常是空的</td>
</tr>
<tr>
<td>/boot</td>
<td>Linux 内核及系统引导文件目录</td>
<td></td>
</tr>
<tr>
<td>/dev</td>
<td>设备文件的目录</td>
<td>声卡，磁盘，光驱等</td>
</tr>
<tr>
<td>/etc</td>
<td>二进制软件包配置文件的默认路径</td>
<td>系统信息，网络配置</td>
</tr>
<tr>
<td>/lost+found</td>
<td>系统崩溃时，产生的一些碎片文件</td>
<td></td>
</tr>
<tr>
<td>/mnt</td>
<td>临时挂载存储设备</td>
<td>U 盘</td>
</tr>
<tr>
<td>/opt</td>
<td>软件可选的安装目录</td>
<td>通常是空的</td>
</tr>
<tr>
<td>/proc</td>
<td>操作系统进程信息目录</td>
<td></td>
</tr>
<tr>
<td>/sbin</td>
<td>管理员命令，系统级命令</td>
<td>sudo 用户</td>
</tr>
<tr>
<td>/tmp</td>
<td>临时文件目录</td>
<td>重启后，被清空</td>
</tr>
<tr>
<td>/run</td>
<td>临时文件系统，存储系统启动以来的信息</td>
<td>重启后，被清空</td>
</tr>
<tr>
<td>/sys</td>
<td>系统中的设备组织成层次结构</td>
<td>通过文件查看硬件信息</td>
</tr>
</tbody>
</table>
<p>需要掌握的目录路径知识：</p>
<ol>
<li>
<p>查看系统内核信息</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># Centos</span></pre></td></tr><tr><td data-num="2"></td><td><pre>$ <span class="token function">cat</span> /proc/version</pre></td></tr><tr><td data-num="3"></td><td><pre>Linux version <span class="token number">3.10</span>.0-957.10.1.el7.x86_64 <span class="token punctuation">(</span>mockbuild@kbuilder.bsys.centos.org<span class="token punctuation">)</span> <span class="token punctuation">(</span>gcc version <span class="token number">4.8</span>.5 <span class="token number">20150623</span> <span class="token punctuation">(</span>Red Hat <span class="token number">4.8</span>.5-36<span class="token punctuation">)</span> <span class="token punctuation">(</span>GCC<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment">#1 SMP Mon Mar 18 15:06:45 UTC 2019</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># Ubuntu</span></pre></td></tr><tr><td data-num="6"></td><td><pre>$ <span class="token function">cat</span> /proc/version</pre></td></tr><tr><td data-num="7"></td><td><pre>Linux version <span class="token number">4.15</span>.7-041507-generic <span class="token punctuation">(</span>kernel@gloin<span class="token punctuation">)</span> <span class="token punctuation">(</span>gcc version <span class="token number">7.2</span>.0 <span class="token punctuation">(</span>Ubuntu <span class="token number">7.2</span>.0-8ubuntu3.2<span class="token punctuation">))</span> <span class="token comment">#201802280530 SMP Wed Feb 28 10:31:47 UTC 2018</span></pre></td></tr></table></figure></li>
<li>
<p>查看网络信息</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># Centos DHCP</span></pre></td></tr><tr><td data-num="2"></td><td><pre>$ <span class="token function">cat</span> /etc/sysconfig/network-scripts/ifcfg-eth0</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token assign-left variable">DEVICE</span><span class="token operator">=</span>eth0</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span>dhcp</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span>yes</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 或者指定 IP</span></pre></td></tr><tr><td data-num="8"></td><td><pre>$ <span class="token function">cat</span> /etc/sysconfig/network-scripts/ifcfg-em1</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token assign-left variable">TYPE</span><span class="token operator">=</span>Ethernet</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token assign-left variable">PROXY_METHOD</span><span class="token operator">=</span>none</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token assign-left variable">BROWSER_ONLY</span><span class="token operator">=</span>no</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span>none</pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token assign-left variable">DEFROUTE</span><span class="token operator">=</span>yes</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token assign-left variable">IPV4_FAILURE_FATAL</span><span class="token operator">=</span>no</pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token assign-left variable">IPV6INIT</span><span class="token operator">=</span>yes</pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token assign-left variable">IPV6_AUTOCONF</span><span class="token operator">=</span>yes</pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token assign-left variable">IPV6_DEFROUTE</span><span class="token operator">=</span>yes</pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token assign-left variable">IPV6_FAILURE_FATAL</span><span class="token operator">=</span>no</pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token assign-left variable">IPV6_ADDR_GEN_MODE</span><span class="token operator">=</span>stable-privacy</pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token assign-left variable">NAME</span><span class="token operator">=</span>em1</pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token assign-left variable">UUID</span><span class="token operator">=</span>fa335568-27db-47fd-a055-424173c42430</pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token assign-left variable">DEVICE</span><span class="token operator">=</span>em1</pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span>yes</pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token number">192.168</span>.4.252</pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token assign-left variable">PREFIX</span><span class="token operator">=</span><span class="token number">24</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token assign-left variable">GATEWAY</span><span class="token operator">=</span><span class="token number">192.168</span>.4.50</pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token assign-left variable">DNS1</span><span class="token operator">=</span><span class="token number">192.168</span>.4.50</pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token assign-left variable">IPV6_PRIVACY</span><span class="token operator">=</span>no</pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token assign-left variable">ZONE</span><span class="token operator">=</span>public</pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token comment"># Ubuntu</span></pre></td></tr><tr><td data-num="32"></td><td><pre>$ <span class="token function">vi</span> /etc/network/interfaces</pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token comment"># This file describes the network interfaces available on your system</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment"># and how to activate them. For more information, see interfaces(5).</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token builtin class-name">source</span> /etc/network/interfaces.d/*</pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token comment"># The loopback network interface</span></pre></td></tr><tr><td data-num="39"></td><td><pre>auto lo</pre></td></tr><tr><td data-num="40"></td><td><pre>iface lo inet loopback</pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token comment"># The primary network interface</span></pre></td></tr><tr><td data-num="43"></td><td><pre>auto ens3</pre></td></tr><tr><td data-num="44"></td><td><pre>iface ens3 inet static</pre></td></tr><tr><td data-num="45"></td><td><pre>        address <span class="token number">192.168</span>.4.60</pre></td></tr><tr><td data-num="46"></td><td><pre>        netmask <span class="token number">255.255</span>.255.0</pre></td></tr><tr><td data-num="47"></td><td><pre>        network <span class="token number">192.168</span>.4.0</pre></td></tr><tr><td data-num="48"></td><td><pre>        broadcast <span class="token number">192.168</span>.4.255</pre></td></tr><tr><td data-num="49"></td><td><pre>        gateway <span class="token number">192.168</span>.4.50</pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token comment"># dns-* options are implemented by the resolvconf package, if installed</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        dns-nameservers <span class="token number">192.168</span>.4.50</pre></td></tr><tr><td data-num="52"></td><td><pre>        dns-search itheima</pre></td></tr></table></figure><p>通常使用 <code>ifconfig</code>  来查看网卡的信息</p>
</li>
<li>
<p>DNS 配置</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>$ <span class="token function">cat</span> /etc/resolv.conf</pre></td></tr><tr><td data-num="2"></td><td><pre>options timeout:2 attempts:3 rotate single-request-reopen</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">;</span> generated by /usr/sbin/dhclient-script</pre></td></tr><tr><td data-num="4"></td><td><pre>nameserver <span class="token number">100.100</span>.2.136</pre></td></tr><tr><td data-num="5"></td><td><pre>nameserver <span class="token number">100.100</span>.2.138</pre></td></tr></table></figure></li>
<li>
<p>host 文件</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>$ <span class="token function">cat</span> /etc/hosts</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">127.0</span>.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</pre></td></tr><tr><td data-num="3"></td><td><pre>::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</pre></td></tr></table></figure></li>
<li>
<p>用户 / 组</p>
<p>查看用户：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>$ <span class="token function">cat</span> /etc/passwd</pre></td></tr><tr><td data-num="2"></td><td><pre>root:x:0:0:root:/root:/bin/bash</pre></td></tr><tr><td data-num="3"></td><td><pre>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</pre></td></tr><tr><td data-num="4"></td><td><pre>bin:x:2:2:bin:/bin:/usr/sbin/nologin</pre></td></tr><tr><td data-num="5"></td><td><pre>sys:x:3:3:sys:/dev:/usr/sbin/nologin</pre></td></tr><tr><td data-num="6"></td><td><pre>sync:x:4:65534:sync:/bin:/bin/sync</pre></td></tr><tr><td data-num="7"></td><td><pre>games:x:5:60:games:/usr/games:/usr/sbin/nologin</pre></td></tr><tr><td data-num="8"></td><td><pre>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</pre></td></tr><tr><td data-num="9"></td><td><pre>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">..</span><span class="token punctuation">..</span></pre></td></tr></table></figure><p>查看组：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>$ <span class="token function">cat</span> /etc/group</pre></td></tr><tr><td data-num="2"></td><td><pre>root:x:0:</pre></td></tr><tr><td data-num="3"></td><td><pre>daemon:x:1:</pre></td></tr><tr><td data-num="4"></td><td><pre>bin:x:2:</pre></td></tr><tr><td data-num="5"></td><td><pre>sys:x:3:</pre></td></tr><tr><td data-num="6"></td><td><pre>adm:x:4:syslog,bttech</pre></td></tr><tr><td data-num="7"></td><td><pre>tty:x:5:</pre></td></tr><tr><td data-num="8"></td><td><pre>disk:x:6:</pre></td></tr><tr><td data-num="9"></td><td><pre>lp:x:7:</pre></td></tr><tr><td data-num="10"></td><td><pre>mail:x:8:</pre></td></tr><tr><td data-num="11"></td><td><pre>news:x:9:</pre></td></tr><tr><td data-num="12"></td><td><pre>uucp:x:10:</pre></td></tr><tr><td data-num="13"></td><td><pre>man:x:12:</pre></td></tr><tr><td data-num="14"></td><td><pre>proxy:x:13:</pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">..</span><span class="token punctuation">..</span></pre></td></tr></table></figure></li>
<li>
<p>查看内存 / CPU</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 查看 CPU</span></pre></td></tr><tr><td data-num="2"></td><td><pre>$ <span class="token function">cat</span> /proc/cpuinfo</pre></td></tr><tr><td data-num="3"></td><td><pre>processor	<span class="token builtin class-name">:</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="4"></td><td><pre>vendor_id	<span class="token builtin class-name">:</span> GenuineIntel</pre></td></tr><tr><td data-num="5"></td><td><pre>cpu family	<span class="token builtin class-name">:</span> <span class="token number">6</span></pre></td></tr><tr><td data-num="6"></td><td><pre>model		<span class="token builtin class-name">:</span> <span class="token number">45</span></pre></td></tr><tr><td data-num="7"></td><td><pre>model name	<span class="token builtin class-name">:</span> Intel<span class="token punctuation">(</span>R<span class="token punctuation">)</span> Xeon<span class="token punctuation">(</span>R<span class="token punctuation">)</span> CPU E5-2670 <span class="token number">0</span> @ <span class="token number">2</span>.60GHz</pre></td></tr><tr><td data-num="8"></td><td><pre>stepping	<span class="token builtin class-name">:</span> <span class="token number">7</span></pre></td></tr><tr><td data-num="9"></td><td><pre>microcode	<span class="token builtin class-name">:</span> 0x714</pre></td></tr><tr><td data-num="10"></td><td><pre>cpu MHz		<span class="token builtin class-name">:</span> <span class="token number">2117.419</span></pre></td></tr><tr><td data-num="11"></td><td><pre>cache size	<span class="token builtin class-name">:</span> <span class="token number">20480</span> KB</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment"># 查看内存</span></pre></td></tr><tr><td data-num="15"></td><td><pre>$ <span class="token function">cat</span> /proc/meminfo</pre></td></tr><tr><td data-num="16"></td><td><pre>MemTotal:       <span class="token number">131812048</span> kB</pre></td></tr><tr><td data-num="17"></td><td><pre>MemFree:          <span class="token number">460820</span> kB</pre></td></tr><tr><td data-num="18"></td><td><pre>MemAvailable:   <span class="token number">36657836</span> kB</pre></td></tr><tr><td data-num="19"></td><td><pre>Buffers:               <span class="token number">0</span> kB</pre></td></tr><tr><td data-num="20"></td><td><pre>Cached:         <span class="token number">34910784</span> kB</pre></td></tr><tr><td data-num="21"></td><td><pre>SwapCached:      <span class="token number">1051944</span> kB</pre></td></tr><tr><td data-num="22"></td><td><pre>Active:         <span class="token number">95183532</span> kB</pre></td></tr><tr><td data-num="23"></td><td><pre>Inactive:       <span class="token number">32382012</span> kB</pre></td></tr><tr><td data-num="24"></td><td><pre>Active<span class="token punctuation">(</span>anon<span class="token punctuation">)</span>:   <span class="token number">77764844</span> kB</pre></td></tr><tr><td data-num="25"></td><td><pre>Inactive<span class="token punctuation">(</span>anon<span class="token punctuation">)</span>: <span class="token number">15015220</span> kB</pre></td></tr><tr><td data-num="26"></td><td><pre>Active<span class="token punctuation">(</span>file<span class="token punctuation">)</span>:   <span class="token number">17418688</span> kB</pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">..</span>.</pre></td></tr></table></figure></li>
<li>
<p>其他</p>
<ul>
<li>/etc/fstab（开机自动挂载列表）</li>
<li>/etc/rc.local（开机自启动文件，自启动命令，脚本）</li>
<li>/etc/init.d (服务启动命令脚本目录)</li>
<li>/etc/profile (全局环境变量)</li>
<li>/usr/local (编译安装软件默认安装目录)</li>
<li>/var/log/message（系统日志）</li>
<li>/var/log/secure（系统安全日志）</li>
<li><em>/proc/mounts</em>（系统挂载信息）</li>
</ul>
</li>
</ol>
<h3 id="linux启动过程"><a class="anchor" href="#linux启动过程">#</a> Linux 启动过程</h3>
<p>Linux 启动过程：</p>
<ul>
<li>
<p>内核的引导</p>
<p>首先是 BIOS 开机自检，按照 BIOS 中设置的启动设备（通常是硬盘）来启动。</p>
<p>主要是一些驱动、基本的操作指令，用来接管所有的硬件</p>
</li>
<li>
<p>运行 init</p>
<p>就跟 main 函数一样，有一个起点，初始一个服务进程 daemon，跟 windows 中的服务一样。</p>
</li>
<li>
<p>系统初始化</p>
<p>用户及软件服务自启动</p>
</li>
<li>
<p>建立终端</p>
<p>Linux 的多用户管理。</p>
<p>针对对用户，登录方式有三种：</p>
<ul>
<li>命令行登录</li>
<li>ssh 登录</li>
<li>图形界面登录</li>
</ul>
</li>
<li>
<p>用户登录系统</p>
</li>
</ul>
<p><img data-src="./assets/bg2013081707.png" alt="img" /></p>
<h3 id="常用命令介绍重点"><a class="anchor" href="#常用命令介绍重点">#</a> 常用命令介绍 (重点)</h3>
<h4 id="文件相关"><a class="anchor" href="#文件相关">#</a> 文件相关</h4>
<ol>
<li>目录相关
<ul>
<li>
<p><code>ls</code> : 列出目录</p>
<p>-la 可以查看隐藏文件，文件一些基础属性</p>
</li>
<li>
<p><code>cd</code> ：切换目录</p>
<p>使用绝对路径 <code>/</code> ，也可以使用 <code>./</code>  相对路径，回到上级目录 <code>cd ..</code></p>
</li>
<li>
<p><code>pwd</code> ：显示目前的目录</p>
</li>
<li>
<p><code>mkdir</code> ：创建一个新的目录</p>
</li>
<li>
<p><code>rmdir</code> ：删除一个空的目录</p>
</li>
<li>
<p><code>cp</code> : 复制文件或目录</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">cp</span> <span class="token builtin class-name">source</span> target</pre></td></tr></table></figure></li>
<li>
<p><code>rm</code> : 移除文件或目录</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 删除目录</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">rm</span> <span class="token parameter variable">-r</span> dirpath</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 强制删除，要特别注意</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">rm</span> <span class="token parameter variable">-rf</span> dirpath€</pre></td></tr></table></figure></li>
<li>
<p><code>mv</code> : 移动文件与目录，或修改文件与目录的名称</p>
<pre><code>mv source target
</code></pre>
</li>
<li>
<p><code>cat</code>  用来查看文件内的内容， <code>touch</code>  命令来创建文件， <code>echo</code>  命令往文件里面写入内容， <code>more</code>  命令来查看显示长文件内容</p>
</li>
</ul>
</li>
<li>基本属性：
<ul>
<li>
<p>权限管理 <code>chmod</code></p>
<p>文件基本属性分为 10 个字符  <code>drwxrwxrwx</code></p>
<p><code>r</code>  代表着 read 读权限</p>
<p><code>w</code>  代表着 write 写权限</p>
<p><code>x</code>  代表着 execute 执行权限</p>
<p><code>d</code>  代表着目录</p>
<p><code>chmod -R</code>  递归执行，相当于是把目录下所有的文件都修改对应的权限</p>
<p><code>chmod +x</code>  给文件一个执行 / 读 / 写权限</p>
<p>修改权限的两种方式：</p>
<p><strong>方式 1： 数字方式</strong></p>
<p><code>7</code> - <code>rwx</code></p>
<p><code>6</code> - <code>-rw-</code></p>
<p><code>4</code> - <code>r--</code></p>
<p><code>0</code> - <code>---</code>  什么权限都没有，</p>
<p>前面的 3 个是所有者用户的权限，</p>
<p>中间的 3 个是组用户的权限，</p>
<p>后面的 3 个是其他用户的权限。</p>
<p>举例说明：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 对所属用户有读写权限</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">chmod</span> <span class="token number">600</span> <span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 对应 -rwxrw-rw-，相当于是取消了组与其他用户的执行权限</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">chmod</span> <span class="token number">755</span> <span class="token punctuation">..</span>.</pre></td></tr></table></figure><p><strong>方式 2：</strong></p>
<p><code>a</code>  代表 all 所有， <code>u</code>  代表 user， <code>g</code>  代表 group， <code>o</code>  代表 other。</p>
<p><code>+</code>  代表增加， <code>-</code>  代表减少</p>
<p>举例说明：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 增加所有用户的读的权限</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">chmod</span> a+r <span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 增加用户与组的写的权限</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">chmod</span> ug+w <span class="token punctuation">..</span></pre></td></tr></table></figure><blockquote>
<p>个人比较推荐数字的方式，比较好记！！</p>
</blockquote>
</li>
<li>
<p>用户 / 组权限管理 <code>chown</code></p>
<p>修改文件 / 文档所属 / 所属组</p>
<pre><code>chown &lt;所属用户&gt;:&lt;所属组&gt; &lt;文件&gt;
</code></pre>
<p>目录：</p>
<pre><code>chown -R &lt;所属用户&gt;:&lt;所属组&gt; &lt;文件&gt;
</code></pre>
<p><code>-R</code>  代表着递归</p>
</li>
</ul>
</li>
</ol>
<h4 id="用户管理登录"><a class="anchor" href="#用户管理登录">#</a> 用户管理 / 登录</h4>
<ol>
<li>添加用户 <code>useradd</code></li>
<li>删除用户 <code>userdel</code></li>
<li>用户口令修改  <code>passwd</code></li>
<li>（扩展）用户组 <code>groupadd</code> / <code>groupdel</code> / <code>groupmod</code></li>
</ol>
<h4 id="网络"><a class="anchor" href="#网络">#</a> 网络</h4>
<ol>
<li>
<p>远程连接 <code>ssh</code></p>
<p>配置文件的路径是在 <code>/etc/ssh/sshd_config</code>  目录下</p>
<p>如果需要修改 port：</p>
<ul>
<li>修改 <code>sshd_config</code>  中的 <code>Port</code>  参数</li>
<li>(Centos) 还需要使用 <code>semanage port -a -t ssh_port_t -p tcp &lt;Port&gt;</code></li>
<li><code>service sshd restart</code>  (Centos) /  <code>service ssh restart</code>  (Debian、Ubuntu)</li>
</ul>
<blockquote>
<p>在测试的时候，可以关闭服务器的防火墙，但是生产系统中不推荐这么去做。</p>
<p>如果提示没有 semanage 这个命令，则可以使用如下方式来安装：</p>
<p><code>sudo yum install -y policecoreutils-python</code></p>
<p>或者使用 <code>yum whatprovides semange</code>  来反查</p>
</blockquote>
<p>ssh 登录命令的格式： <code>ssh -p Port &lt;用户名&gt;@&lt;服务器的地址&gt;</code></p>
<p>如：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>$ <span class="token function">ssh</span> <span class="token parameter variable">-p</span> <span class="token number">10022</span> root@192.168.0.1</pre></td></tr></table></figure><blockquote>
<p>window 推荐使用<span class="exturl" data-url="aHR0cHM6Ly93d3cubmV0c2FyYW5nLmNvbS96aC94ZnRwLw=="> xftp</span> 终端</p>
<p>mac 推荐使用<span class="exturl" data-url="aHR0cHM6Ly93d3cuaXRlcm0yLmNvbS8="> iterm</span></p>
</blockquote>
</li>
<li>
<p>查看网卡配置 <code>ifconfig</code></p>
<p>如果说没有这个命令，可以使用 <code>yum install net-tools</code>  进行安装</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">ifconfig</span> eth0 <span class="token operator">&lt;</span>ip<span class="token operator">></span> netmask <span class="token number">255.255</span>.255.0</pre></td></tr></table></figure><p>对网口进行禁用 / 启用</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">ifconfig</span> eth0 down/up</pre></td></tr></table></figure></li>
<li>
<p>查看网络 <code>netstat</code></p>
<ul>
<li><code>-t</code> ：列出 TCP 协议端口</li>
<li><code>-u</code> ：列出 UDP 协议端口</li>
<li><code>-n</code> : 不使用域名与服务名，而使用 IP 地址和端口号</li>
<li><code>-l</code> ：仅列出在监听状态网络服务</li>
<li><code>-a</code> ：列出所有的网络连接</li>
<li><code>-p</code> ：列出所对应的进程信息</li>
</ul>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">netstat</span> <span class="token parameter variable">-anpl</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">ssh</span></pre></td></tr></table></figure><p>当使用 <code>netstat | more</code>  进行滚屏， <code>ctrl+f/b</code>  进行翻上 / 下页</p>
</li>
<li>
<p>路由命令 <code>route</code></p>
<p>route 查看路由</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># add/del 添加删除路由</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>route <span class="token function">add</span> <span class="token parameter variable">-net</span> <span class="token number">192.168</span>.0.0 netmask <span class="token number">255.255</span>.0.0 dev etho</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># del 删除</span></pre></td></tr><tr><td data-num="6"></td><td><pre>route del <span class="token parameter variable">-net</span> <span class="token number">192.168</span>.0.0 netmask <span class="token number">255.255</span>.0.0</pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># reject</span></pre></td></tr><tr><td data-num="9"></td><td><pre>route <span class="token function">add</span> <span class="token parameter variable">-net</span> <span class="token number">192.168</span>.0.0 netmask <span class="token number">255.255</span>.0.0 reject</pre></td></tr></table></figure></li>
<li>
<p>IP 命令 <code>ip</code></p>
<pre><code>ip addr show
ip route show
ip link set eth0 up/down
</code></pre>
<p><code>ip &lt;命令&gt; help</code>  去查看命令的一些参数</p>
</li>
<li>
<p>DNS 解析： <code>nslookup</code></p>
<p>Centos 中如果没有该命令，可以使用如下的方式进行安装</p>
<pre><code>sudo yum install bind-utils
</code></pre>
</li>
<li>
<p>查看本机 IP</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">curl</span> <span class="token punctuation">[</span>链接<span class="token punctuation">]</span></pre></td></tr></table></figure><p>几个网址也非常好记忆</p>
<ul>
<li><span class="exturl" data-url="aHR0cDovL2lwLmNuLw==">ip.cn</span> (推荐)</li>
<li><span class="exturl" data-url="aHR0cDovL2lwaW5mby5pby8=">ipinfo.io</span> (推荐)</li>
<li><span class="exturl" data-url="aHR0cDovL2NpcC5jYy8=">cip.cc</span> (推荐)</li>
<li><span class="exturl" data-url="aHR0cDovL2lmY29uZmlnLm1lLw==">ifconfig.me</span></li>
<li><span class="exturl" data-url="aHR0cDovL215aXAuaXBpcC5uZXQv">myip.ipip.net</span></li>
</ul>
</li>
</ol>
<p>GUI 网络配置操作（图形化大法好啊）：</p>
<p><code>nmtui</code></p>
<blockquote>
<p>如果提示 <code>not found</code>  命令的话，可以 <code>yum install -y NetworkManager-tui</code>  进行安装</p>
</blockquote>
<p><img data-src="./assets/nmtui.png" alt="nmtui" /></p>
<h4 id="性能硬件"><a class="anchor" href="#性能硬件">#</a> 性能 / 硬件</h4>
<ol>
<li>
<p><code>top</code>  命令：</p>
<p>top 命令替代命令：<span class="exturl" data-url="aHR0cHM6Ly9saW51eC5jbi9hcnRpY2xlLTEwMzIzLTEuaHRtbA==">参考 1</span>、<span class="exturl" data-url="aHR0cHM6Ly90dXRvcmlhbHMudWJ1bnR1LmNvbS90dXRvcmlhbC90dXRvcmlhbC1pbnN0YWxsLXVidW50dS1kZXNrdG9wIzA=">参考 2</span></p>
<pre><code>top

# m切换显示内存信息
# t切换显示CPU信息
# M对内存倒序排序显示
# P根据CPU的使用百分比进行排序
</code></pre>
</li>
<li>
<p>性能测试</p>
<ul>
<li>
<p><span class="exturl" data-url="aHR0cDovL0JlbmNoLnNo">Bench.sh</span>:</p>
<p>使用方法：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">wget</span> -qO- bench.sh <span class="token operator">|</span> <span class="token function">bash</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 或者 </span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">curl</span> -Lso- bench.sh <span class="token operator">|</span> <span class="token function">bash</span></pre></td></tr></table></figure><p>Github 地址：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RlZGR5c3VuL2Fjcm9zcy9ibG9iL21hc3Rlci9iZW5jaC5zaA==">https://github.com/teddysun/across/blob/master/bench.sh</span></p>
</li>
<li>
<p>LemonBench</p>
<p>使用方法：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">wget</span> -qO- https://ilemonrain.com/download/shell/LemonBench.sh <span class="token operator">|</span> <span class="token function">bash</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 或者</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://ilemonrain.com/download/shell/LemonBench.sh <span class="token operator">|</span> <span class="token function">bash</span></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h2 id="nginx服务"><a class="anchor" href="#nginx服务">#</a> Nginx 服务</h2>
<p>nginx [发音：engine x] 是一个 HTTP 和反向代理服务器，一个邮件代理服务器和一个通用的 TCP / UDP 代理服务器，最初由<span class="exturl" data-url="aHR0cDovL3N5c29ldi5ydS9lbi8="> Igor Sysoev</span> 编写。</p>
<p>据 Netcraft 称，nginx 在 2019 年 5 月服务或代理了 26.43％最繁忙的网站。以下是一些成功案例： Dropbox， Netflix， <span class="exturl" data-url="aHR0cDovL1dvcmRwcmVzcy5jb20=">Wordpress.com</span>， <span class="exturl" data-url="aHR0cDovL0Zhc3RNYWlsLkZN">FastMail.FM</span>。</p>
<blockquote>
<p>nginx [engine x] is an HTTP and reverse proxy server, a mail proxy server, and a generic TCP/UDP proxy server, originally written by Igor Sysoev. For a long time, it has been running on many heavily loaded Russian sites including Yandex, <span class="exturl" data-url="aHR0cDovL01haWwuUnU=">Mail.Ru</span>, VK, and Rambler. According to Netcraft, nginx served or proxied 26.43% busiest sites in May 2019. Here are some of the success stories: <span class="exturl" data-url="aHR0cHM6Ly9ibG9ncy5kcm9wYm94LmNvbS90ZWNoLzIwMTcvMDkvb3B0aW1pemluZy13ZWItc2VydmVycy1mb3ItaGlnaC10aHJvdWdocHV0LWFuZC1sb3ctbGF0ZW5jeS8=">Dropbox</span>, <span class="exturl" data-url="aHR0cHM6Ly9vcGVuY29ubmVjdC5uZXRmbGl4LmNvbS9lbi9zb2Z0d2FyZS8=">Netflix</span>,<span class="exturl" data-url="aHR0cHM6Ly93d3cubmdpbnguY29tL2Nhc2Utc3R1ZGllcy9uZ2lueC13b3JkcHJlc3MtY29tLw==">Wordpress.com</span>, <span class="exturl" data-url="aHR0cDovL2Jsb2cuZmFzdG1haWwuZm0vMjAwNy8wMS8wNC93ZWJpbWFwcG9wLWZyb250ZW5kLXByb3hpZXMtY2hhbmdlZC10by1uZ2lueC8=">FastMail.FM</span>.</p>
</blockquote>
<p>从下面的当下技术架构图中，可以看出 Nginx 在网络中的位置与重要性。Nginx 的轻量级、内存占用少、启动极快，高并发能力强的特性，使它在互联网项目中广泛应用。</p>
<p><img data-src="./assets/v2-e1826bab1d07df8e97d61aa809b94a10_hd.jpg" alt="img" /></p>
<blockquote>
<p>Service-Oriented Architecture，<strong>SOA</strong> 面向服务的架构</p>
</blockquote>
<h3 id="nginx简介"><a class="anchor" href="#nginx简介">#</a> Nginx 简介</h3>
<h4 id="什么是反向代理"><a class="anchor" href="#什么是反向代理">#</a> 什么是反向代理</h4>
<p>正向代理 ：</p>
<p><img data-src="./assets/v2-c8ac111c267ae0745f984e326ef0c47f_hd.jpg" alt="img" /></p>
<p>由于防火墙的原因，我们并不能直接访问谷歌，那么我们可以借助 VPN 来实现，这就是一个简单的正向代理的例子。这里你能够发现，<strong>正向代理 “代理” 的是客户端</strong>，而且客户端是知道目标的，而目标是不知道客户端是通过 VPN 访问的。</p>
<p>反向代理：</p>
<p><img data-src="./assets/v2-4787a512240b238ebf928cd0651e1d99_hd.jpg" alt="img" /></p>
<p>当我们在外网访问百度的时候，其实会进行一个转发，代理到内网去，这就是所谓的反向代理，即<strong>反向代理 “代理” 的是服务器端</strong>，而且这一个过程对于客户端而言是透明的。</p>
<h4 id="nginx的技术架构"><a class="anchor" href="#nginx的技术架构">#</a> Nginx 的技术架构</h4>
<p><img data-src="./assets/v2-b24eb2b29b48f59883232a58392ddae3_hd.jpg" alt="img" /></p>
<p>Master 进程的作用是<strong>读取并验证配置文件 nginx.conf；管理 worker 进程；</strong></p>
<p>Worker 进程的作用:<strong> 每一个 Worker 进程都维护一个线程（避免线程切换），处理连接和请求；</strong></p>
<blockquote>
<p>注意 Worker 进程的个数由配置文件决定，一般和 CPU 个数相关（有利于进程切换），配置几个就有几个 Worker 进程。</p>
</blockquote>
<p>特点：</p>
<ul>
<li>
<p>主进程 Master</p>
<p><code>Nginx</code>  启动时，会生成两种类型的 <strong>进程</strong> *，一个是 <strong>主进程</strong>（ <code>master</code> ），<strong>一个</strong>（ <code>windows</code>  版本的目前只有一个）或 <strong>多个工作进程</strong>（ <code>worker</code> ）。<strong>主进程</strong> 并不处理网络请求，主要负责 <strong>调度工作进程</strong>，也就是图示的  <code>3</code>  项：<strong>加载配置</strong>、<strong>启动工作进程</strong> 及 <strong>非停升级</strong>。所以， <code>Nginx</code>  启动以后，查看操作系统的进程列表，我们就能看到 <strong>至少有两个</strong>  <code>Nginx</code>  进程。</p>
</li>
<li>
<p>工作进程 Worker</p>
<p>服务器实际 <strong>处理网络请求</strong> 及 <strong>响应</strong> 的是 <strong>工作进程</strong>（ <code>worker</code> ），在类  <code>unix</code>  系统上， <code>Nginx</code>  可以配置 <strong>多个</strong>  <code>worker</code> ，而每个  <code>worker</code>  <strong>进程</strong> 都可以同时处理 <strong>数以千计</strong> 的 <strong>网络请求</strong>。</p>
</li>
<li>
<p>模块化设计</p>
<p>标准 HTTP 模块、可选的 HTTP 模块 (gzip 等)、邮件服务、第三方 (Lua)</p>
<p><code>Nginx</code>  的  <code>worker</code>  进程，包括 <strong>核心</strong> 和 <strong>功能性模块</strong>，<strong>核心模块</strong> 负责维持一个 <strong>运行循环</strong>（ <code>run-loop</code> ），执行网络请求处理的 <strong>不同阶段</strong> 的模块功能，比如：<strong>网络读写</strong>、<strong>存储读写</strong>、<strong>内容传输</strong>、<strong>外出过滤</strong>，以及 <strong>将请求发往上游服务器</strong> 等。而其代码的 <strong>模块化设计</strong>，也使得我们可以根据需要对 <strong>功能模块</strong> 进行适当的 <strong>选择</strong> 和 <strong>修改</strong>，编译成具有 <strong>特定功能</strong> 的服务器。</p>
</li>
<li>
<p>事件驱动模型</p>
<p>基于 <strong>异步及非阻塞</strong> 的 <strong>事件驱动模型</strong>，可以说是  <code>Nginx</code>  得以获得 <strong>高并发</strong>、<strong>高性能</strong> 的关键因素，同时也得益于对  <code>Linux</code> 、 <code>Solaris</code>  及类  <code>BSD</code>  等操作系统内核中 <strong>事件通知</strong> 及  <code>I/O</code>  <strong>性能增强功能</strong> 的采用，如  <code>kqueue</code> 、 <code>epoll</code>  及  <code>event ports</code> 。</p>
</li>
<li>
<p>代理设计</p>
</li>
</ul>
<p>参考资料：</p>
<ol>
<li>
<p><span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vcG9zdC81YjRiZGI1NGU1MWQ0NTE5MWUwY2Q3NzQ=">浅谈 Nginx 服务器的内部核心架构设计</span></p>
</li>
<li>
<p><span class="exturl" data-url="aHR0cHM6Ly9uZ2lueC5vcmcvZW4vI2FyY2hpdGVjdHVyZV9hbmRfc2NhbGFiaWxpdHk=">Architecture and scalability</span></p>
</li>
</ol>
<h4 id="nginx高可用"><a class="anchor" href="#nginx高可用">#</a> Nginx 高可用</h4>
<p><img data-src="./assets/v2-ec3208d1ea659d126fe2a008ec5ae927_hd.jpg" alt="img" /></p>
<p><strong>VRRP（Virtual Router Redundancy Protocol）</strong>，即<span class="exturl" data-url="aHR0cHM6Ly9saW5rLmppYW5zaHUuY29tP3Q9aHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9WUlJQ">虚拟路由冗余协议</span>。可以认为它是实现路由器高可用的容错协议，即将多台提供相同功能的路由器组成一个路由器组 (Router Group)，这个组里面有一个 master 和多个 backup，但在外界看来就像一台一样，构成虚拟路由器，拥有一个虚拟 IP（vip，也就是路由器所在局域网内其他机器的默认路由），占有这个 IP 的 master 实际负责 ARP 相应和转发 IP 数据包，组中的其它路由器作为备份的角色处于待命状态。master 会发组播消息，当 backup 在超时时间内收不到 vrrp 包时就认为 master 宕掉了，这时就需要根据 VRRP 的优先级来选举一个 backup 当 master，保证路由器的高可用。</p>
<p>Keepalived 是一个基于 VRRP 协议来实现的服务高可用方案，可以利用其来避免 IP 单点故障，类似的工具还有 heartbeat、corosync、pacemaker。但是它一般不会单独出现，而是与其它负载均衡技术（如 lvs、haproxy、nginx）一起工作来达到集群的高可用。</p>
<p>KeepAlived + Nginx 来组成高可用的方案：</p>
<p>第一：请求不要直接打到 Nginx 上，应该先通过 Keepalived（这就是所谓虚拟 IP，VIP）</p>
<p>第二：Keepalived 应该能监控 Nginx 的生命状态（提供一个用户自定义的脚本，定期检查 Nginx 进程状态，进行权重变化，，从而实现 Nginx 故障切换）</p>
<h3 id="nginx服务安装"><a class="anchor" href="#nginx服务安装">#</a> Nginx 服务安装</h3>
<h4 id="centos安装方式"><a class="anchor" href="#centos安装方式">#</a> Centos 安装方式</h4>
<p>推荐使用在线安装方式：</p>
<table>
<thead>
<tr>
<th>分类</th>
<th>yum 方式</th>
<th>源码安装</th>
</tr>
</thead>
<tbody>
<tr>
<td>网络</td>
<td>需要</td>
<td>可以不需要</td>
</tr>
<tr>
<td>安装位置</td>
<td>/etc/nginx 配置文件，/usr/sbin/nginx</td>
<td>/usr/local/nginx 目录</td>
</tr>
<tr>
<td>管理命令</td>
<td>提供</td>
<td>不提供</td>
</tr>
<tr>
<td>启动</td>
<td>service nginx start</td>
<td>执行绝对路径 /usr/local/nginx/sbin/nginx</td>
</tr>
<tr>
<td>删除</td>
<td>yum remove nginx 或者 rpm -e nginx</td>
<td>rm -rf /usr/local/nginx</td>
</tr>
</tbody>
</table>
<ol>
<li>
<p>在线安装</p>
<p>添加 nginx 的 repo：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>$ <span class="token function">vim</span> /etc/yum.repos.d/nginx.repo</pre></td></tr></table></figure><p>输入以下内容：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>nginx<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token assign-left variable">name</span><span class="token operator">=</span>nginx repo</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token assign-left variable">baseurl</span><span class="token operator">=</span>http://nginx.org/packages/centos/<span class="token variable">$releasever</span>/<span class="token variable">$basearch</span>/</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">0</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span></pre></td></tr></table></figure><p><code>:wq</code>  保存后，使用 <code>yum update</code> ，接下来就是安装了。</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>yum <span class="token function">install</span> <span class="token parameter variable">-y</span> nginx</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 管理命令:</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 启动 / 停止 / 重启</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">service</span> nginx start/stop/restart</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 卸载</span></pre></td></tr><tr><td data-num="8"></td><td><pre>yum remove <span class="token parameter variable">-y</span> nginx</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment"># 或者强制卸载，不考虑依赖</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token function">rpm</span> <span class="token parameter variable">-e</span> nginx</pre></td></tr></table></figure></li>
<li>
<p>源码安装</p>
</li>
</ol>
<ul>
<li>
<p>安装对应的依赖：</p>
<pre><code>yum -y install gcc gcc-c++ make libtool zlib zlib-devel openssl openssl-devel pcre pcre-devel
</code></pre>
</li>
<li>
<p>下载源码包：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">wget</span> <span class="token parameter variable">-O</span> /tmp/nginx.tar.gz http://nginx.org/download/nginx-<span class="token operator">&lt;</span>version<span class="token operator">></span>.tar.gz</pre></td></tr></table></figure><p>比如：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">wget</span> <span class="token parameter variable">-O</span> /tmp/nginx.tar.gz http://nginx.org/download/nginx-1.17.0.tar.gz</pre></td></tr></table></figure></li>
<li>
<p>解压</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">cd</span> /tmp/</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">tar</span> zxvf nginx.tar.gz</pre></td></tr></table></figure></li>
<li>
<p>编译</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>$ ./configure</pre></td></tr><tr><td data-num="2"></td><td><pre>Configuration summary</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>- using system PCRE library</pre></td></tr><tr><td data-num="5"></td><td><pre>- OpenSSL library is not used</pre></td></tr><tr><td data-num="6"></td><td><pre>- using system zlib library</pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>  nginx path prefix: <span class="token string">"/usr/local/nginx"</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  nginx binary file: <span class="token string">"/usr/local/nginx/sbin/nginx"</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  nginx modules path: <span class="token string">"/usr/local/nginx/modules"</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  nginx configuration prefix: <span class="token string">"/usr/local/nginx/conf"</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  nginx configuration file: <span class="token string">"/usr/local/nginx/conf/nginx.conf"</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  nginx pid file: <span class="token string">"/usr/local/nginx/logs/nginx.pid"</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  nginx error log file: <span class="token string">"/usr/local/nginx/logs/error.log"</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  nginx http access log file: <span class="token string">"/usr/local/nginx/logs/access.log"</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  nginx http client request body temporary files: <span class="token string">"client_body_temp"</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  nginx http proxy temporary files: <span class="token string">"proxy_temp"</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  nginx http fastcgi temporary files: <span class="token string">"fastcgi_temp"</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  nginx http uwsgi temporary files: <span class="token string">"uwsgi_temp"</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  nginx http scgi temporary files: <span class="token string">"scgi_temp"</span></pre></td></tr></table></figure></li>
<li>
<p>安装</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span></pre></td></tr></table></figure></li>
<li>
<p>管理方法：</p>
<p>直接可以使用可执行文件进行启动 / 停止 / 重启</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 启动</span></pre></td></tr><tr><td data-num="2"></td><td><pre>/usr/local/nginx/sbin/nginx</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 停止</span></pre></td></tr><tr><td data-num="5"></td><td><pre>/usr/local/nginx/sbin/nginx <span class="token parameter variable">-s</span> stop</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 重启</span></pre></td></tr><tr><td data-num="8"></td><td><pre>/usr/local/nginx/sbin/nginx <span class="token parameter variable">-s</span> reload</pre></td></tr></table></figure></li>
<li>
<p>管理脚本</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>$ <span class="token function">vi</span> /etc/init.d/nginx</pre></td></tr></table></figure><p>输入如下内容:</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token shebang important">#!/bin/sh</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">#</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># nginx - this script starts and stops the nginx daemon</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># chkconfig:   - 85 15</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># description:  NGINX is an HTTP(S) server, HTTP(S) reverse \</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">#               proxy and IMAP/POP3 proxy server</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># processname: nginx</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment"># config:      /usr/local/nginx/conf/nginx.conf</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment"># config:      /etc/sysconfig/nginx</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment"># pidfile:     /usr/local/nginx/logs/nginx.pid</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment"># Source function library.</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token builtin class-name">.</span> /etc/rc.d/init.d/functions</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment"># Source networking configuration.</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token builtin class-name">.</span> /etc/sysconfig/network</pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment"># Check that networking is up.</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$NETWORKING</span>"</span> <span class="token operator">=</span> <span class="token string">"no"</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">exit</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token assign-left variable">nginx</span><span class="token operator">=</span><span class="token string">"/usr/local/nginx/sbin/nginx"</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token assign-left variable">prog</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> $nginx<span class="token variable">)</span></span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token assign-left variable">NGINX_CONF_FILE</span><span class="token operator">=</span><span class="token string">"/usr/local/nginx/conf/nginx.conf"</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">[</span> <span class="token parameter variable">-f</span> /etc/sysconfig/nginx <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">.</span> /etc/sysconfig/nginx</pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token assign-left variable">lockfile</span><span class="token operator">=</span>/var/lock/subsys/nginx</pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token function-name function">make_dirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>   <span class="token comment"># make required directories</span></pre></td></tr><tr><td data-num="25"></td><td><pre>   <span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>$nginx <span class="token parameter variable">-V</span> <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"configure arguments:"</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/[^*]*--user=\([^ ]*\).*/\1/g'</span> -<span class="token variable">`</span></span></pre></td></tr><tr><td data-num="26"></td><td><pre>   <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable"><span class="token variable">`</span><span class="token function">grep</span> $user /etc/passwd<span class="token variable">`</span></span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="27"></td><td><pre>       <span class="token function">useradd</span> <span class="token parameter variable">-M</span> <span class="token parameter variable">-s</span> /bin/nologin <span class="token variable">$user</span></pre></td></tr><tr><td data-num="28"></td><td><pre>   <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="29"></td><td><pre>   <span class="token assign-left variable">options</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>$nginx <span class="token parameter variable">-V</span> <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'configure arguments:'</span><span class="token variable">`</span></span></pre></td></tr><tr><td data-num="30"></td><td><pre>   <span class="token keyword">for</span> <span class="token for-or-select variable">opt</span> <span class="token keyword">in</span> <span class="token variable">$options</span><span class="token punctuation">;</span> <span class="token keyword">do</span></pre></td></tr><tr><td data-num="31"></td><td><pre>       <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">echo</span> $opt <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'.*-temp-path'</span><span class="token variable">`</span></span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="32"></td><td><pre>           <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">echo</span> $opt <span class="token operator">|</span> <span class="token function">cut</span> <span class="token parameter variable">-d</span> <span class="token string">"="</span> <span class="token parameter variable">-f</span> <span class="token number">2</span><span class="token variable">`</span></span></pre></td></tr><tr><td data-num="33"></td><td><pre>           <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-d</span> <span class="token string">"<span class="token variable">$value</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="34"></td><td><pre>               <span class="token comment"># echo "creating" $value</span></pre></td></tr><tr><td data-num="35"></td><td><pre>               <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$value</span> <span class="token operator">&amp;&amp;</span> <span class="token function">chown</span> <span class="token parameter variable">-R</span> <span class="token variable">$user</span> <span class="token variable">$value</span></pre></td></tr><tr><td data-num="36"></td><td><pre>           <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="37"></td><td><pre>       <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="38"></td><td><pre>   <span class="token keyword">done</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token function-name function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token punctuation">[</span> <span class="token parameter variable">-x</span> <span class="token variable">$nginx</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">5</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token variable">$NGINX_CONF_FILE</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">6</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    make_dirs</pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> $<span class="token string">"Starting <span class="token variable">$prog</span>: "</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    daemon <span class="token variable">$nginx</span> <span class="token parameter variable">-c</span> <span class="token variable">$NGINX_CONF_FILE</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token assign-left variable">retval</span><span class="token operator">=</span><span class="token variable">$?</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token punctuation">[</span> <span class="token variable">$retval</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">touch</span> <span class="token variable">$lockfile</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token builtin class-name">return</span> <span class="token variable">$retval</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token function-name function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> $<span class="token string">"Stopping <span class="token variable">$prog</span>: "</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    killproc <span class="token variable">$prog</span> <span class="token parameter variable">-QUIT</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token assign-left variable">retval</span><span class="token operator">=</span><span class="token variable">$?</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token punctuation">[</span> <span class="token variable">$retval</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> <span class="token parameter variable">-f</span> <span class="token variable">$lockfile</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token builtin class-name">return</span> <span class="token variable">$retval</span></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token function-name function">restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>    configtest <span class="token operator">||</span> <span class="token builtin class-name">return</span> <span class="token variable">$?</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    stop</pre></td></tr><tr><td data-num="62"></td><td><pre>    <span class="token function">sleep</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="63"></td><td><pre>    start</pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token function-name function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>    configtest <span class="token operator">||</span> <span class="token builtin class-name">return</span> <span class="token variable">$?</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> $<span class="token string">"Reloading <span class="token variable">$prog</span>: "</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    killproc <span class="token variable">$nginx</span> <span class="token parameter variable">-HUP</span></pre></td></tr><tr><td data-num="69"></td><td><pre>    <span class="token assign-left variable">RETVAL</span><span class="token operator">=</span><span class="token variable">$?</span></pre></td></tr><tr><td data-num="70"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token function-name function">force_reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="73"></td><td><pre>    restart</pre></td></tr><tr><td data-num="74"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token function-name function">configtest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>  <span class="token variable">$nginx</span> <span class="token parameter variable">-t</span> <span class="token parameter variable">-c</span> <span class="token variable">$NGINX_CONF_FILE</span></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token function-name function">rh_status</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>    status <span class="token variable">$prog</span></pre></td></tr><tr><td data-num="80"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="81"></td><td><pre><span class="token function-name function">rh_status_q</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>    rh_status <span class="token operator">></span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span></pre></td></tr><tr><td data-num="83"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="84"></td><td><pre><span class="token keyword">case</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token keyword">in</span></pre></td></tr><tr><td data-num="85"></td><td><pre>    start<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="86"></td><td><pre>        rh_status_q <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">exit</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="87"></td><td><pre>        <span class="token variable">$1</span></pre></td></tr><tr><td data-num="88"></td><td><pre>        <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>    stop<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="90"></td><td><pre>        rh_status_q <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="91"></td><td><pre>        <span class="token variable">$1</span></pre></td></tr><tr><td data-num="92"></td><td><pre>        <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>    restart<span class="token operator">|</span>configtest<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="94"></td><td><pre>        <span class="token variable">$1</span></pre></td></tr><tr><td data-num="95"></td><td><pre>        <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="96"></td><td><pre>    reload<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="97"></td><td><pre>        rh_status_q <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">7</span></pre></td></tr><tr><td data-num="98"></td><td><pre>        <span class="token variable">$1</span></pre></td></tr><tr><td data-num="99"></td><td><pre>        <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="100"></td><td><pre>    force-reload<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="101"></td><td><pre>        force_reload</pre></td></tr><tr><td data-num="102"></td><td><pre>        <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="103"></td><td><pre>    status<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="104"></td><td><pre>        rh_status</pre></td></tr><tr><td data-num="105"></td><td><pre>        <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="106"></td><td><pre>    condrestart<span class="token operator">|</span>try-restart<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="107"></td><td><pre>        rh_status_q <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="108"></td><td><pre>            <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>    *<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="110"></td><td><pre>        <span class="token builtin class-name">echo</span> $<span class="token string">"Usage: <span class="token variable">$0</span> &#123;start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest&#125;"</span></pre></td></tr><tr><td data-num="111"></td><td><pre>        <span class="token builtin class-name">exit</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="112"></td><td><pre><span class="token keyword">esac</span></pre></td></tr></table></figure><p>添加开机启动：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 给予执行权限</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">chmod</span> a+x /etc/init.d/nginx</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 设置开机启动</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">chkconfig</span> nginx on</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 启动</span></pre></td></tr><tr><td data-num="8"></td><td><pre>systemctl start nginx</pre></td></tr></table></figure></li>
</ul>
<h4 id="ubuntu安装方式"><a class="anchor" href="#ubuntu安装方式">#</a> Ubuntu 安装方式</h4>
<ol>
<li>
<p>在线方式</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> nginx</pre></td></tr></table></figure></li>
<li>
<p>源码方式</p>
<p>安装依赖</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 安装 gcc g++</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> build-essential</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libtool</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 安装 pcre 依赖库（http://www.pcre.org/）</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token function">sudo</span> <span class="token function">apt-get</span> update</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libpcre3 libpcre3-dev</pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment"># 安装 zlib 依赖库（http://www.zlib.net）</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> zlib1g-dev</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment"># 安装 SSL 依赖库（16.04 默认已经安装了）</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> openssl</pre></td></tr></table></figure><p>下载源码启动:</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 下载最新版本：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 下面的 version 可以改为对应的版本</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># http://nginx.org/download/nginx-1.17.0.tar.gz</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">wget</span> <span class="token parameter variable">-O</span> /tmp/nginx.tar.gz http://nginx.org/download/nginx-<span class="token operator">&lt;</span>version<span class="token operator">></span>.tar.gz</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># 解压：</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token builtin class-name">cd</span> /tmp/</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> nginx.tar.gz</pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment"># 进入解压目录：</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token builtin class-name">cd</span> nginx-1.13.6</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment"># 配置：</span></pre></td></tr><tr><td data-num="14"></td><td><pre>./configure <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/usr/local/nginx </pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment"># 编译：</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token function">make</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment"># 安装：</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token function">sudo</span> <span class="token function">make</span> <span class="token function">install</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment"># 启动：</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">#注意：-c 指定配置文件的路径，不加的话，nginx 会自动加载默认路径的配置文件，可以通过 - h 查看帮助命令。</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment">#查看进程：</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token function">sudo</span> /usr/local/nginx/sbin/nginx <span class="token parameter variable">-c</span> /usr/local/nginx/conf/nginx.conf</pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment"># 查看进程启动状态</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span> <span class="token function">grep</span> nginx</pre></td></tr></table></figure></li>
</ol>
<h3 id="nginx配置及优化"><a class="anchor" href="#nginx配置及优化">#</a> Nginx 配置及优化</h3>
<ol>
<li>配置文件结构</li>
</ol>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">..</span>.              <span class="token comment">#全局块</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>events <span class="token punctuation">&#123;</span>         <span class="token comment">#events 块</span></pre></td></tr><tr><td data-num="4"></td><td><pre>   <span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>http      <span class="token comment">#http 块</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">..</span>.   <span class="token comment">#http 全局块 --start</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    server        <span class="token comment">#server 块</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token punctuation">..</span>.       <span class="token comment">#server 全局块</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        location <span class="token punctuation">[</span>PATTERN<span class="token punctuation">]</span>   <span class="token comment">#location 块</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        location <span class="token punctuation">[</span>PATTERN<span class="token punctuation">]</span> </pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    server</pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      <span class="token punctuation">..</span>.</pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">..</span>.     <span class="token comment">#http 全局块 --end</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><ul>
<li><strong>全局块</strong>：配置影响 nginx 全局的指令。一般有运行 nginx 服务器的用户组，nginx 进程 pid 存放路径，日志存放路径，配置文件引入，允许生成 worker process 数等。</li>
<li><strong>events 块</strong>：配置影响 nginx 服务器或与用户的网络连接。有每个进程的最大连接数，选取哪种事件驱动模型处理连接请求，是否允许同时接受多个网路连接，开启多个网络连接序列化等。</li>
<li><strong>http 块</strong>：可以嵌套多个 server，配置代理，缓存，日志定义等绝大多数功能和第三方模块的配置。如文件引入，mime-type 定义，日志自定义，是否使用 sendfile 传输文件，连接超时时间，单连接请求数等。</li>
<li><strong>server 块</strong>：配置虚拟主机的相关参数，一个 http 中可以有多个 server。</li>
<li><strong>location 块</strong>：配置请求的路由，以及各种页面的处理情况。</li>
</ul>
<ol start="2">
<li>
<p>配置优化</p>
<p>配置文件：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>user www-data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>pid /run/nginx.pid<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># worker_processes 用来设置 Nginx 服务的进程数。推荐是 CPU 内核数或者内核数的倍数，推荐使用 CPU 内核数</span></pre></td></tr><tr><td data-num="5"></td><td><pre>worker_processes <span class="token number">4</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># 默认情况下，Nginx 的多个进程有可能跑在某一个 CPU 或 CPU 的某一核上，导致 Nginx 进程使用硬件的资源不均</span></pre></td></tr><tr><td data-num="7"></td><td><pre>worker_cpu_affinity 0001 0010 0100 <span class="token number">1000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># 设置一个进程理论允许的最大连接数，理论上越大越好，但不可以超过 worker_rlimit_nofile 的值</span></pre></td></tr><tr><td data-num="9"></td><td><pre>worker_rlimit_nofile <span class="token number">65535</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>events <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>				<span class="token comment"># 设置事件驱动模型，是内核 2.6 以上支持</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        use epoll<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        worker_connections <span class="token number">65535</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        accept_mutex off<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        multi_accept off<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>http <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token comment">##</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token comment"># Basic Settings</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token comment">##</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        sendfile on<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        tcp_nopush on<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        tcp_nodelay on<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        keepalive_timeout <span class="token number">60</span> <span class="token number">50</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        send_timeout 10s<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        types_hash_max_size <span class="token number">2048</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        client_header_buffer_size 4k<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        client_max_body_size 8m<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        include /etc/nginx/mime.types<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        default_type application/octet-stream<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token comment">##</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token comment"># Logging Settings</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token comment">##</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        access_log /var/log/nginx/access.log<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        error_log /var/log/nginx/error.log<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token comment">##</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token comment"># Gzip Settings</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token comment">##</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token function">gzip</span> on<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        gzip_disable <span class="token string">"msie6"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        gzip_min_length <span class="token number">1024</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        gzip_vary on<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        gzip_comp_level <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        gzip_buffers <span class="token number">32</span> 4k<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token comment">##</span></pre></td></tr><tr><td data-num="53"></td><td><pre>        <span class="token comment"># Virtual Host Configs</span></pre></td></tr><tr><td data-num="54"></td><td><pre>        <span class="token comment">##</span></pre></td></tr><tr><td data-num="55"></td><td><pre>        include /etc/nginx/conf.d/*.conf<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>        include /etc/nginx/sites-enabled/*<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li>
</ol>
<p>nginxs 配置说明：</p>
<ul>
<li><code>worker_connections</code></li>
</ul>
<p>设置一个进程理论允许的最大连接数，理论上越大越好，但不可以超过 worker_rlimit_nofile 的值。还有个问题，linux 系统中有个指令 open file resource limit，它设置了进程可以打开的文件句柄数量，可以用下面的指令查看你的 linux 系统中 open file resource limit 指令的值， <code>cat /proc/sys/fs/file-max</code> <br />
 可以将该指令设置为 23900251</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">echo</span> <span class="token string">"2390251"</span> <span class="token operator">></span> /proc/sys/fs/file-max</pre></td></tr><tr><td data-num="2"></td><td><pre>   </pre></td></tr><tr><td data-num="3"></td><td><pre>   <span class="token function">sysctl</span> <span class="token parameter variable">-p</span></pre></td></tr></table></figure><ol start="3">
<li>
<p>压测工具 Apache ab</p>
<p>我们要测试 nginx 的负载能力，需要借助压力测试工具。本博客是使用 Apache 服务器自带的一个 web 压力测试工具 ApacheBench ，简称 ab。ab 是一个命令行工具，即通过  <code>ab</code>  命令行，模拟多个请求同时对某一 URL 地址进行访问，因此可以用来测试目标服务器的负载压力。</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>yum <span class="token parameter variable">-y</span> <span class="token function">install</span> httpd-tools</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 查看安装结果</span></pre></td></tr><tr><td data-num="4"></td><td><pre>ab <span class="token parameter variable">-V</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># 简单的使用</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># -c：一次并发请求的数量；-n：请求总次数</span></pre></td></tr><tr><td data-num="8"></td><td><pre>ab <span class="token parameter variable">-c</span> <span class="token number">5000</span> <span class="token parameter variable">-n</span> <span class="token number">200000</span> http://10.211.55.6：80/index.html</pre></td></tr></table></figure></li>
<li>
<p>其他优化</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>net.ipv4.ip_forward <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="2"></td><td><pre>net.ipv4.conf.default.rp_filter <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="3"></td><td><pre>net.ipv4.conf.default.accept_source_route <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="4"></td><td><pre>kernel.sysrq <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="5"></td><td><pre>kernel.core_uses_pid <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 开启 SYN Cookies，当出现 SYN 等待队列溢出时，启用 cookies 来处理。</span></pre></td></tr><tr><td data-num="8"></td><td><pre>net.ipv4.tcp_syncookies <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="9"></td><td><pre>kernel.msgmnb <span class="token operator">=</span> <span class="token number">65536</span></pre></td></tr><tr><td data-num="10"></td><td><pre>kernel.msgmax <span class="token operator">=</span> <span class="token number">65536</span></pre></td></tr><tr><td data-num="11"></td><td><pre>kernel.shmmax <span class="token operator">=</span> <span class="token number">68719476736</span></pre></td></tr><tr><td data-num="12"></td><td><pre>kernel.shmall <span class="token operator">=</span> <span class="token number">4294967296</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment"># timewait 的数量，默认是 180000</span></pre></td></tr><tr><td data-num="15"></td><td><pre>net.ipv4.tcp_max_tw_buckets <span class="token operator">=</span> <span class="token number">6000</span></pre></td></tr><tr><td data-num="16"></td><td><pre>net.ipv4.tcp_sack <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="17"></td><td><pre>net.ipv4.tcp_window_scaling <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="18"></td><td><pre>net.ipv4.tcp_rmem <span class="token operator">=</span> <span class="token number">4096</span>        <span class="token number">87380</span>   <span class="token number">4194304</span></pre></td></tr><tr><td data-num="19"></td><td><pre>net.ipv4.tcp_wmem <span class="token operator">=</span> <span class="token number">4096</span>        <span class="token number">16384</span>   <span class="token number">4194304</span></pre></td></tr><tr><td data-num="20"></td><td><pre>net.core.wmem_default <span class="token operator">=</span> <span class="token number">8388608</span></pre></td></tr><tr><td data-num="21"></td><td><pre>net.core.rmem_default <span class="token operator">=</span> <span class="token number">8388608</span></pre></td></tr><tr><td data-num="22"></td><td><pre>net.core.rmem_max <span class="token operator">=</span> <span class="token number">16777216</span></pre></td></tr><tr><td data-num="23"></td><td><pre>net.core.wmem_max <span class="token operator">=</span> <span class="token number">16777216</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment"># # 每个网络接口接收数据包的速率比内核处理这些包的速率快时，允许送到队列的数据包的最大数目。</span></pre></td></tr><tr><td data-num="26"></td><td><pre>net.core.netdev_max_backlog <span class="token operator">=</span> <span class="token number">262144</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment"># web 应用中 listen 函数的 backlog 默认会给我们内核参数的 net.core.somaxconn 限制到 128，而 nginx 定义 的 NGX_LISTEN_BACKLOG 默认为 511，所以有必要调整这个值</span></pre></td></tr><tr><td data-num="29"></td><td><pre>net.core.somaxconn <span class="token operator">=</span> <span class="token number">262144</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token comment"># 系统中最多有多少个 TCP 套接字不被关联到任何一个用户文件句柄上。如果超过这个数字，孤儿连接将即刻被复位并打印出警告信息。这个限制仅仅 是为了防止简单的 DoS 攻击，不能过分依靠它或者人为地减小这个值，更应该增加这个值 (如果增加了内存之后)。</span></pre></td></tr><tr><td data-num="32"></td><td><pre>net.ipv4.tcp_max_orphans <span class="token operator">=</span> <span class="token number">3276800</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment"># 记录的那些尚未收到客户端确认信息的连接请求的最大值。对于有 128M 内存的系统而言，缺省值是 1024，小内存的系统则是 128。</span></pre></td></tr><tr><td data-num="35"></td><td><pre>net.ipv4.tcp_max_syn_backlog <span class="token operator">=</span> <span class="token number">262144</span></pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token comment"># 时间戳可以避免序列号的卷绕。一个 1Gbps 的链路肯定会遇到以前用过的序列号。时间戳能够让内核接受这种 “异常” 的数据包。这里需要将其关掉。</span></pre></td></tr><tr><td data-num="38"></td><td><pre>net.ipv4.tcp_timestamps <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token comment"># 为了打开对端的连接，内核需要发送一个 SYN 并附带一个回应前面一个 SYN 的 ACK。也就是所谓三次握手中的第二次握手。这个设置决定了内核放弃连接之前发送 SYN+ACK 包的数量。</span></pre></td></tr><tr><td data-num="41"></td><td><pre>net.ipv4.tcp_synack_retries <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token comment"># 在内核放弃建立连接之前发送 SYN 包的数量。</span></pre></td></tr><tr><td data-num="44"></td><td><pre>net.ipv4.tcp_syn_retries <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token comment"># 启用 timewait 快速回收</span></pre></td></tr><tr><td data-num="47"></td><td><pre>net.ipv4.tcp_tw_recycle <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token comment"># 开启重用。允许将 TIME-WAIT sockets 重新用于新的 TCP 连接。</span></pre></td></tr><tr><td data-num="50"></td><td><pre>net.ipv4.tcp_tw_reuse <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="51"></td><td><pre>net.ipv4.tcp_mem <span class="token operator">=</span> <span class="token number">94500000</span> <span class="token number">915000000</span> <span class="token number">927000000</span></pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token comment"># 如果套接字由本端要求关闭，这个参数决定了它保持在 FIN-WAIT-2 状态的时间。对端可以出错并永远不关闭连接，甚至意外当机。缺省值是 60 秒。 2.2 内核的通常值是 180 秒，你可以按这个设置，但要记住的是，即使你的机器是一个轻载的 WEB 服务器，也有因为大量的死套接字而内存溢出的风险，FIN- WAIT-2 的危险性比 FIN-WAIT-1 要小，因为它最多只能吃掉 1.5K 内存，但是它们的生存期长些。</span></pre></td></tr><tr><td data-num="54"></td><td><pre>net.ipv4.tcp_fin_timeout <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="55"></td><td><pre></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token comment"># 当 keepalive 起用的时候，TCP 发送 keepalive 消息的频度。缺省是 2 小时</span></pre></td></tr><tr><td data-num="57"></td><td><pre>net.ipv4.tcp_keepalive_time <span class="token operator">=</span> <span class="token number">30</span></pre></td></tr><tr><td data-num="58"></td><td><pre></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token comment"># 允许系统打开的端口范围</span></pre></td></tr><tr><td data-num="60"></td><td><pre>net.ipv4.ip_local_port_range <span class="token operator">=</span> <span class="token number">1024</span>   <span class="token number">65000</span></pre></td></tr></table></figure></li>
</ol>
<h3 id="https"><a class="anchor" href="#https">#</a> HTTP(s)</h3>
<h4 id="httphttps协议"><a class="anchor" href="#httphttps协议">#</a> HTTP/HTTPS 协议</h4>
<p><strong>超文本传输协议</strong>（英语：<strong>H</strong>yper<strong>T</strong>ext <strong>T</strong>ransfer <strong>P</strong>rotocol，缩写：<strong>HTTP</strong>）是一种用于分布式、协作式和超媒体信息系统的应用层协议，HTTP 是万维网的数据通信的基础。</p>
<p><img data-src="./assets/HTTP_Request.png" alt="A basic HTTP request" /></p>
<p>请求信息包括：请求行、请求头、空行还有其他消息体</p>
<p><img data-src="./assets/image-20190605153656594.png" alt="/images/image-20190605153656594" /></p>
<p>HTTP 的特点：</p>
<ul>
<li>
<p>客户端 &amp; 服务端</p>
</li>
<li>
<p>简单 (路径 + 方法 + 传递的类型)</p>
<p>客户向服务器请求服务时，只需传送请求方法和路径。请求方法常用的有 GET、HEAD、POST。每种方法规定了客户与服务器联系的类型不同。由于 HTTP 协议简单，使得 HTTP 服务器的程序规模小，因而通信速度很快。</p>
</li>
<li>
<p>灵活</p>
<p>HTTP 允许传输任意类型的数据对象。正在传输的类型由 Content-Type（Content-Type 是 HTTP 包中用来表示内容类型的标识）加以标记。</p>
</li>
<li>
<p>无连接</p>
<p>无连接的含义是限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间。</p>
</li>
<li>
<p>无状态有会话</p>
<p>HTTP 协议是无状态协议，无状态是指协议对于事务处理没有记忆能力。</p>
<p>缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快。</p>
<blockquote>
<p>注意，HTTP 本质是无状态的，使用 Cookies 可以创建有状态的会话。</p>
</blockquote>
</li>
</ul>
<p>HTTP 的不足之处</p>
<ul>
<li>通信内容使用明文 —— 内容可能被窃听</li>
<li>不验证通信方的身份 —— 可能遭遇伪装</li>
<li>无法验证报文的完整性 —— 报文有可能已遭篡改</li>
</ul>
<p>HTTPS 协议：</p>
<p><strong>超文本传输安全协议</strong>（英语：<strong>H</strong>yper<strong>T</strong>ext <strong>T</strong>ransfer <strong>P</strong>rotocol <strong>S</strong>ecure，缩写：<strong>HTTPS</strong>；常称为 HTTP over TLS、HTTP over SSL 或 HTTP Secure）是一种通过计算机网络进行安全通信的传输协议。HTTPS 经由 HTTP 进行通信，但利用 SSL/TLS 来加密数据包。HTTPS 开发的主要目的，是提供对网站服务器的身份认证，保护交换数据的隐私与完整性。这个协议由网景公司（Netscape）在 1994 年首次提出，随后扩展到互联网上。</p>
<p>主要作用：在不安全的网络上创建一个安全信道。</p>
<h4 id="https认证原理"><a class="anchor" href="#https认证原理">#</a> HTTPS 认证原理</h4>
<p>认证方式：数字证书</p>
<p>认证机构：数字证书认证机构（Certificate Authority CA），EV SSL（Extended Validation SSL Certificate）证书，OpenSSL 自认证。</p>
<p>证书信任方式：</p>
<ul>
<li>操作系统和浏览器内置</li>
<li>证书颁发机构</li>
<li>手动指定证书</li>
</ul>
<p>SSL 握手过程：</p>
<p><img data-src="./assets/1506390796205179.png" alt="SSL" /></p>
<h4 id="如何配置https"><a class="anchor" href="#如何配置https">#</a> 如何配置 HTTPS</h4>
<ol>
<li>
<p><span class="exturl" data-url="aHR0cHM6Ly9sZXRzZW5jcnlwdC5vcmcv">Let's Encrypt</span> 组织介绍</p>
<p><img data-src="./assets/image-20190605160738126.png" alt="/images/image-20190605160738126" /></p>
</li>
<li>
<p>acme 来自动化申请</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL05laWxwYW5nL2FjbWUuc2g=">https://github.com/Neilpang/acme.sh</span></p>
<p>前提：需要域名</p>
</li>
</ol>
<p>前置条件：</p>
<ol>
<li>
<p>域名，配置 DNS 解析，支持列表见下方</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL05laWxwYW5nL2FjbWUuc2gvd2lraS9kbnNhcGk=">https://github.com/Neilpang/acme.sh/wiki/dnsapi</span></p>
</li>
<li>
<p>有<strong>公网 IP</strong> 的服务器 (可选)</p>
</li>
<li>
<p>安装 nginx, <span class="exturl" data-url="aHR0cDovL2FjbWUuc2g=">acme.sh</span></p>
</li>
</ol>
<p>配置过程：</p>
<ol>
<li>
<p><span class="exturl" data-url="aHR0cDovL3huLS1uZ2lueGFjbWUtemM2bjk5OWlrcDdpLnNo">安装 nginx 与 acme.sh</span></p>
<p>安装很简单，一个命令:</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">curl</span>  https://get.acme.sh <span class="token operator">|</span> <span class="token function">sh</span></pre></td></tr></table></figure><blockquote>
<p>普通用户和 root 用户都可以安装使用。安装过程进行了以下几步:</p>
<p>把 <span class="exturl" data-url="aHR0cDovL2FjbWUuc2g=">acme.sh</span> 安装到你的 <strong>home</strong> 目录下:</p>
<pre><code>~/.acme.sh/
</code></pre>
<p>并创建 一个 bash 的 alias, 方便你的使用:  <code>alias acme.sh=~/.acme.sh/acme.sh</code></p>
<p>自动为你创建 cronjob, 每天 0:00 点自动检测所有的证书，如果快过期了，需要更新，则会自动更新证书</p>
</blockquote>
<p>使用 <code>source</code>  命令，使上面的安装生效</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">source</span> ~/.bashrc</pre></td></tr></table></figure></li>
<li>
<p>两种方式，激活 SSL 证书 (推荐 DNS)</p>
<ul>
<li>
<p><strong>http 方式</strong></p>
<p>需要在你的网站根目录下放置一个文件，来验证你的域名所有权，完成验证。然后就可以生成证书了</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>acme.sh  <span class="token parameter variable">--issue</span>  <span class="token parameter variable">-d</span> mydomain.com <span class="token parameter variable">-d</span> www.mydomain.com  <span class="token parameter variable">--webroot</span>  /home/wwwroot/mydomain.com/</pre></td></tr></table></figure><p>只需要指定域名，并指定域名所在的网站根目录. <strong><span class="exturl" data-url="aHR0cDovL2FjbWUuc2g=">acme.sh</span></strong> 会全自动的生成验证文件，并放到网站的根目录，然后自动完成验证。最后会聪明的删除验证文件。整个过程没有任何副作用.</p>
<p>如果你用的 <strong>apache</strong> 服务器，<strong><span class="exturl" data-url="aHR0cDovL2FjbWUuc2g=">acme.sh</span></strong> 还可以智能的从 <strong>apache</strong> 的配置中自动完成验证，你不需要指定网站根目录:</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>acme.sh <span class="token parameter variable">--issue</span>  <span class="token parameter variable">-d</span> mydomain.com   <span class="token parameter variable">--apache</span></pre></td></tr></table></figure><p>如果你用的 <strong>nginx</strong> 服务器，或者反代，<strong><span class="exturl" data-url="aHR0cDovL2FjbWUuc2g=">acme.sh</span></strong> 还可以智能的从 <strong>nginx</strong> 的配置中自动完成验证，你不需要指定网站根目录:</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>acme.sh <span class="token parameter variable">--issue</span>  <span class="token parameter variable">-d</span> mydomain.com   <span class="token parameter variable">--nginx</span></pre></td></tr></table></figure></li>
<li>
<p><strong>dns 方式</strong> (推荐)</p>
<p>在域名上添加一条 txt 解析记录，验证域名所有权。</p>
<p>这种方式的好处是，你不需要任何服务器，<strong>不需要任何公网 ip, 只需要 dns 的解析记录即可完成验证</strong>。坏处是，如果不同时配置 Automatic DNS API，使用这种方式 <span class="exturl" data-url="aHR0cDovL2FjbWUuc2g=">acme.sh</span> 将无法自动更新证书，每次都需要手动再次重新解析验证域名所有权。</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>acme.sh  <span class="token parameter variable">--issue</span>  <span class="token parameter variable">--dns</span>   <span class="token parameter variable">-d</span> mydomain.com</pre></td></tr></table></figure><p>然后，<strong><span class="exturl" data-url="aHR0cDovL2FjbWUuc2g=">acme.sh</span></strong> 会生成相应的解析记录显示出来，你只需要在你的域名管理面板中添加这条 txt 记录即可.</p>
<p>等待解析完成之后，重新生成证书:</p>
<pre><code>acme.sh  --renew   -d mydomain.com
</code></pre>
<p>注意第二次这里用的是  <code>--renew</code></p>
<p>dns 方式的真正强大之处在于可以使用域名解析商提供的 api 自动添加 txt 记录完成验证.</p>
<p><strong><span class="exturl" data-url="aHR0cDovL2FjbWUuc2g=">acme.sh</span></strong> 目前支持 cloudflare, dnspod, cloudxns, godaddy 以及 ovh 等数十种解析商的自动集成.</p>
<p>以 dnspod 为例，你需要先登录到 dnspod 账号，生成你的 api id 和 api key, 都是免费的。然后:</p>
<pre><code>export DP_Id=&quot;1234&quot;

export DP_Key=&quot;sADDsdasdgdsf&quot;

acme.sh   --issue   --dns dns_dp   -d aa.com  -d www.aa.com
</code></pre>
<p>证书就会自动生成了。这里给出的 api id 和 api key 会被自动记录下来，将来你在使用 dnspod api 的时候，就不需要再次指定了。直接生成就好了:</p>
<pre><code>acme.sh  --issue   -d  mydomain2.com   --dns  dns_dp
</code></pre>
</li>
</ul>
</li>
<li>
<p>配置 nginx 配置，设置定时任务</p>
<p>生成 dhparam.pem</p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>$ openssl dhparam <span class="token parameter variable">-out</span> dhparam.pem <span class="token number">2048</span></pre></td></tr></table></figure><p>nginx 中正确的使用方法是使用  <code>--installcert</code>  命令，并指定目标位置，然后证书文件会被 copy 到相应的位置，例如:</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>acme.sh  <span class="token parameter variable">--installcert</span>  <span class="token parameter variable">-d</span>  <span class="token operator">&lt;</span>domain<span class="token operator">></span>.com   <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="2"></td><td><pre>        --key-file   /etc/nginx/ssl/<span class="token operator">&lt;</span>domain<span class="token operator">></span>.key <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        --fullchain-file /etc/nginx/ssl/fullchain.cer <span class="token punctuation">\</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token parameter variable">--reloadcmd</span>  <span class="token string">"service nginx force-reload"</span></pre></td></tr></table></figure><p>配置文件：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># server 部分</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    ssl_protocols TLSv1 TLSv1.1 TLSv1.2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    ssl_prefer_server_ciphers on<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    ssl on<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    ssl_certificate         /etc/nginx/ssl/fullchain.cer<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    ssl_certificate_key     /etc/nginx/ssl/<span class="token operator">&lt;</span>domain<span class="token operator">></span>.key<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token comment"># ssl_dhparam</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    ssl_dhparam             /etc/nginx/ssl/dhparam.pem<span class="token punctuation">;</span></pre></td></tr></table></figure></li>
<li>
<p>对网站的 SSL 进行检验</p>
<p>推荐：<span class="exturl" data-url="aHR0cHM6Ly9zc2xsYWJzLmNvbS9zc2x0ZXN0L2FuYWx5emUuaHRtbA==">https://ssllabs.com/ssltest/analyze.html</span></p>
</li>
<li>
<p>其他需要注意的地方：</p>
<ul>
<li>域名备案</li>
<li>防火墙</li>
</ul>
</li>
</ol>
<h2 id="云服务器"><a class="anchor" href="#云服务器">#</a> 云服务器</h2>
<h3 id="阿里云ecs"><a class="anchor" href="#阿里云ecs">#</a> 阿里云 ECS</h3>
<h4 id="虚拟化技术原理"><a class="anchor" href="#虚拟化技术原理">#</a> 虚拟化技术原理</h4>
<p><strong>虚拟化</strong>：在计算机技术中，虚拟化（技术）或虚拟技术（英语：Virtualization）是一种资源管理技术，是将计算机的各种实体资源（CPU、内存、磁盘空间、网络适配器等），予以抽象、转换后呈现出来并可供分区、组合为一个或多个电脑配置环境。</p>
<p><img data-src="./assets/img_adfcd9149ec08e90df41492ecb18b900.png" alt="img" /></p>
<p>主要的目的：降低成本，提高应用兼容性，提高服务可用性，提升资源复用率。</p>
<p>虚拟化分类：</p>
<p>主要有全虚拟化和半虚拟化。</p>
<p>典型的全虚拟化软件有 —— VMWare、Hyper-V、KVM-x86 (复杂指令集)。</p>
<p>典型的半虚拟化软件有 ——Xen、KVM-PowerPC (简易指令集）</p>
<p>参考资料：<span class="exturl" data-url="aHR0cHM6Ly95cS5hbGl5dW4uY29tL2FydGljbGVzLzQ4ODY3">虚拟化的发展历程和实现原理 —— 图文详解</span>，<span class="exturl" data-url="aHR0cDovL3ZpcnR1YWwuNTFjdG8uY29tL2FydC8yMDE4MDMvNTY5MjI4Lmh0bQ==">虚拟化类型</span></p>
<h4 id="如何选择云服务器"><a class="anchor" href="#如何选择云服务器">#</a> 如何选择云服务器</h4>
<ol>
<li>
<p>从硬件</p>
<p>使用阿里云的工具进行筛选，需要登录，链接：<span class="exturl" data-url="aHR0cHM6Ly9lY3MtYnV5LmFsaXl1bi5jb20vaW5zdGFuY2VUeXBlcw==">ECS 实例规格可购买地域总览</span></p>
<p><img data-src="./assets/image-20190604221840417.png" alt="/images/image-20190604221840417" /></p>
</li>
<li>
<p>从网络</p>
<p><img data-src="./assets/eZZfERlwBRWjZOGtmwVO.png" alt="Explanation" /></p>
<p>云服务器 ECS 的入网带宽和出网带宽皆以服务器角度出发。下表给出了入网带宽和出网带宽的具体内容：</p>
<table>
<thead>
<tr>
<th style="text-align:left">带宽类别 （Mbit/s）</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">入网带宽</td>
<td style="text-align:left">流入云服务器 ECS 的带宽 从云服务器 ECS 内部下载外部网络资源，或者从客户端 FTP 等方式上传资源到云服务器 ECS 都是入网带宽。</td>
</tr>
<tr>
<td style="text-align:left">出网带宽</td>
<td style="text-align:left">流出云服务器 ECS 的带宽 从云服务器 ECS 对外提供访问，或者从客户端 FTP 等方式下载云服务器 ECS 内部资源都是出网带宽，云服务器 ECS 出网带宽就是购买的带宽值。</td>
</tr>
</tbody>
</table>
<p>推荐公司使用固定带宽，对于测试用户或者流量比较小的用户使用按量计费带宽。</p>
<p>举例应用场景：公司网站展示类型 (按量计费)，视频 (固定带宽)</p>
<p>后期还可以购买 CDN 加速，分担静态资源的流量。</p>
</li>
<li>
<p>从地域</p>
<p>每个地域完全独立。每个可用区完全隔离，但同一个地域内的可用区之间使用低时延链路相连。地域和可用区之间的关系如下图所示。</p>
<p><img data-src="./assets/155788672444660_zh-CN.jpg" alt="img" /></p>
<ul>
<li>
<p>中国大陆</p>
<p>一般情况下建议选择和您目标用户所在地域最为接近的数据中心，可以进一步提升用户访问速度。不过，在基础设施、BGP 网络品质、服务质量、云服务器操作使用与配置等方面，阿里云中国大陆地域没有太大区别。BGP 网络可以保证中国大陆全部地域的快速访问。</p>
</li>
<li>
<p>其他国家及地区</p>
<p>其他国家及地区提供国际带宽，主要面向非中国大陆地区用户。如果您在中国大陆，使用这些地域会有较长的访问延迟，不建议您使用。</p>
<ul>
<li>对香港、东南亚有需求的用户，可以选择香港地域、亚太东南 1 地域、亚太东南 3 地域或亚太东南 5 地域。</li>
<li>对日、韩有需求的用户，可以选择亚太东北 1 地域。</li>
<li>对印度有需求的用户，可以选择亚太南部 1 地域。</li>
<li>对澳大利亚地区有需求的用户，可以选择亚太东南 2 地域。</li>
<li>对美洲有需求用户，可以选择美国地域。</li>
<li>对欧洲大陆有需求的用户，可以选择欧洲中部 1 地域。</li>
<li>对中东地区有需求的用户，可以选择中东东部 1 地域。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>从费用</p>
</li>
</ol>
<h4 id="云服务器购买"><a class="anchor" href="#云服务器购买">#</a> 云服务器购买</h4>
<h4 id="认识控制台"><a class="anchor" href="#认识控制台">#</a> 认识控制台</h4>
<h3 id="云数据库rds"><a class="anchor" href="#云数据库rds">#</a> 云数据库 RDS</h3>
<h4 id="云数据库介绍"><a class="anchor" href="#云数据库介绍">#</a> 云数据库介绍</h4>
<ol>
<li>
<p>基本概念</p>
<p>阿里云系产品：云数据库 RDS（ApsaraDB for RDS，简称 RDS）是一种稳定可靠、可弹性伸缩的在线数据库服务。基于飞天分布式系统和全 SSD 盘高性能存储，支持 MySQL、SQL Server、PostgreSQL 和 PPAS（高度兼容 Oracle) 引擎，默认部署主备架构且提供了容灾、备份、恢复、监控、迁移等方面的全套解决方案，彻底解决数据库运维的烦恼！</p>
<p>亚马逊系产品：Amazon Relational Database Service (Amazon RDS) 让您能够在云中轻松设置、操作和扩展关系数据库。它在自动执行耗时的管理任务（如<strong>硬件预置、数据库设置、修补和备份</strong>）的同时，可提供经济实用的可调容量。这使您能够腾出时间专注于应用程序，为它们提供所需的快速性能、高可用性、安全性和兼容性。</p>
<p>Amazon RDS 在多种类型的数据库实例（针对内存、性能或 I/O 进行了优化的实例）上均可用，并提供六种常用的数据库引擎供您选择，包括 Amazon Aurora、PostgreSQL、MySQL、MariaDB、Oracle Database 和 SQL Server。您可以使用 AWS Database Migration Service <strong>轻松</strong>将您现有的<strong>数据库迁移或复制到 Amazon RDS</strong>。</p>
</li>
<li>
<p>特点：</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>特点</th>
</tr>
</thead>
<tbody>
<tr>
<td>轻松管理</td>
<td>GUI 页面，从部署到生产数据库</td>
</tr>
<tr>
<td>可扩展</td>
<td>修改 CPU / 内存 / 存储资源</td>
</tr>
<tr>
<td>高可用</td>
<td>自动备份、快照 、自动主机更换</td>
</tr>
<tr>
<td>速度快</td>
<td>可选 SSD</td>
</tr>
<tr>
<td>安全</td>
<td>可建立专网，或者连接到使用 VPN</td>
</tr>
<tr>
<td>经济</td>
<td>网络成本、运维成本都低</td>
</tr>
</tbody>
</table>
</li>
</ol>
<p><strong>本课程中使用亚马逊的 RDS 作为演示</strong></p>
<h4 id="常见rds-mysql购买与操作"><a class="anchor" href="#常见rds-mysql购买与操作">#</a> 常见 RDS-MySQL 购买与操作</h4>
<ol>
<li>
<p>购买地址</p>
<p>阿里云：<span class="exturl" data-url="aHR0cHM6Ly9jbi5hbGl5dW4uY29tL3Byb2R1Y3QvcmRz">https://cn.aliyun.com/product/rds</span></p>
<p><img data-src="./assets/image-20190605084317131.png" alt="/images/image-20190605084317131" /></p>
<p>亚马逊：<span class="exturl" data-url="aHR0cHM6Ly9hd3MuYW1hem9uLmNvbS9jbi9yZHMv">https://aws.amazon.com/cn/rds/</span></p>
<p><img data-src="./assets/image-20190605084341568.png" alt="/images/image-20190605084341568" /></p>
</li>
<li>
<p>操作面板介绍 (以亚马逊为主)</p>
</li>
</ol>
<h4 id="备份与快照"><a class="anchor" href="#备份与快照">#</a> 备份与快照</h4>
<h3 id="负载均衡slb"><a class="anchor" href="#负载均衡slb">#</a> 负载均衡 SLB</h3>
<h4 id="什么是负载均衡"><a class="anchor" href="#什么是负载均衡">#</a> 什么是负载均衡</h4>
<p>负载均衡（Server Load Balancer）是对多台云服务器进行流量<strong>分发</strong>的负载均衡服务。负载均衡可以通过流量分发扩展应用系统对外的服务能力，通过消除单点故障提升应用系统的可用性。</p>
<h4 id="slb功能介绍"><a class="anchor" href="#slb功能介绍">#</a> SLB 功能介绍</h4>
<p>负载均衡通过设置虚拟服务地址，将添加的 ECS 实例虚拟成一个高性能、高可用的应用服务池，并根据转发规则，将来自客户端的请求分发给云服务器池中的 ECS 实例。</p>
<p>负载均衡默认检查云服务器池中的 ECS 实例的健康状态，自动隔离异常状态的 ECS 实例，消除了单台 ECS 实例的单点故障，提高了应用的整体服务能力。此外，负载均衡还具备抗 DDoS 攻击的能力，增强了应用服务的防护能力。</p>
<p>基本的功能：</p>
<ol>
<li>
<p><strong>调度</strong></p>
<p><strong>负载均衡支持轮询、加权轮询（WRR）、加权最小连接数（WLC）和一致性哈希（CH）调度算法。</strong></p>
</li>
<li>
<p>健康检查</p>
<p>负载均衡会检查后端服务器的运行状况。当探测到后端服务器运行状况不佳时，会停止向其发送流量，然后将流量转发给其他正常运行的后端服务器。</p>
</li>
<li>
<p>会话保持</p>
<p>负载均衡提供会话保持功能。在会话的生命周期内，可以将同一客户端的请求转发到同一台后端服务器上。</p>
</li>
<li>
<p>访问控制</p>
</li>
<li>
<p>高可用</p>
<p>负载均衡可以将流量转发给多个可用区的后端服务器。并且，负载均衡已经在大部分地域支持了多可用区部署，当主可用区出现故障时，负载均衡可自动切换到备可用区上提供服务。</p>
<p>业务场景二：</p>
<p><img data-src="./assets/1555309011947_zh-CN.png" alt="img" /></p>
</li>
<li>
<p>安全防护</p>
<p>结合云盾，可提供 5Gbps 的防 DDoS 攻击能力。</p>
</li>
<li>
<p>监控</p>
</li>
<li>
<p>证书管理</p>
</li>
<li>
<p>重定向</p>
</li>
<li>
<p>WS/WSS 支持</p>
</li>
<li>
<p>HTTP/2 支持</p>
<p>HTTP/2（Hypertext Transfer Protocol Version 2）是超文本传输协议的第二版，向下兼容 HTTP1.X 协议版本，同时带来性能的大幅提升。</p>
</li>
</ol>
<h4 id="slb技术架构"><a class="anchor" href="#slb技术架构">#</a> SLB 技术架构</h4>
<p><img data-src="http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/4091/1551152011936_zh-CN.png" alt="img" /></p>
<h4 id="阿里云slb购买与操作"><a class="anchor" href="#阿里云slb购买与操作">#</a> 阿里云 SLB 购买与操作</h4>
<h2 id="扩展知识"><a class="anchor" href="#扩展知识">#</a> 扩展知识</h2>
<h3 id="域名解析"><a class="anchor" href="#域名解析">#</a> 域名解析</h3>
<p><strong>A 记录</strong>： 将域名指向一个 IPv4 地址（例如：100.100.100.100），需要增加 A 记录</p>
<p><strong>CNAME 记录</strong>： 如果将域名指向一个域名，实现与被指向域名相同的访问效果，需要增加 CNAME 记录。这个域名一般是主机服务商提供的一个域名</p>
<p><strong>MX 记录</strong>： 建立电子邮箱服务，将指向邮件服务器地址，需要设置 MX 记录。建立邮箱时，一般会根据邮箱服务商提供的 MX 记录填写此记录</p>
<p><strong>NS 记录</strong>： 域名解析服务器记录，如果要将子域名指定某个域名服务器来解析，需要设置 NS 记录</p>
<p><strong>TXT 记录</strong>： 可任意填写，可为空。一般做一些验证记录时会使用此项，如：做 SPF（反垃圾邮件）记录</p>
<p><strong>AAAA 记录</strong>： 将主机名（或域名）指向一个 IPv6 地址（例如：ff03:0:0:0:0:0:0:c1），需要添加 AAAA 记录</p>
<p><strong>SRV 记录</strong>： 添加服务记录服务器服务记录时会添加此项，SRV 记录了哪台计算机提供了哪个服务。格式为：服务的名字。协议的类型（例如：_example-server._tcp）。</p>
<p><strong>SOA 记录</strong>： SOA 叫做起始授权机构记录，NS 用于标识多台域名解析服务器，SOA 记录用于在众多 NS 记录中那一台是主服务器</p>
<p><strong>PTR 记录</strong>： PTR 记录是 A 记录的逆向记录，又称做 IP 反查记录或指针记录，负责将 IP 反向解析为域名</p>
<h3 id="dns解析中一些问题"><a class="anchor" href="#dns解析中一些问题">#</a> DNS 解析中一些问题</h3>
<h4 id="a记录与cname记录"><a class="anchor" href="#a记录与cname记录">#</a> A 记录与 CNAME 记录</h4>
<p><code>A记录</code> 是把一个域名解析到一个 IP 地址，而 <code>CNAME记录</code> 是把域名解析到另外一个域名，而这个域名最终会指向一个 A 记录，在功能实现在上 <code>A记录</code> 与 <code>CNAME记录</code> 没有区别。</p>
<p><code>CNAME记录</code> 在做 IP 地址变更时要比 <code>A记录</code> 方便。 <code>CNAME记录</code> 允许将多个名字映射到同一台计算机，当有多个域名需要指向同一服务器 IP，此时可以将一个域名做 A 记录指向服务器 IP，然后将其他的域名做别名 (即：CNAME) 到 A 记录的域名上。当服务器 IP 地址变更时，只需要更改 A 记录的那个域名到新 IP 上，其它做别名的域名会自动更改到新的 IP 地址上，而不必对每个域名做更改。</p>
<h4 id="a记录与aaaa记录"><a class="anchor" href="#a记录与aaaa记录">#</a> A 记录与 AAAA 记录</h4>
<p>二者都是指向一个 IP 地址，但对应的 IP 版本不同。 <code>A记录</code> 指向 <code>IPv4</code>  地址， <code>AAAA记录</code> 指向 <code>IPv6</code>  地址。 <code>AAAA记录</code> 是 <code>A记录</code> 的升级版本。</p>
<h4 id="ipv4与ipv6"><a class="anchor" href="#ipv4与ipv6">#</a> IPv4 与 IPv6</h4>
<p><code>IPv4</code> ，是互联网协议（Internet Protocol，IP）的第四版，也是第一个被广泛使用的版本，是构成现今互联网技术的基础协议。 <code>IPv4</code>  的下一个版本就是 <code>IPv6</code> ，在将来将取代目前被广泛使用的 <code>IPv4</code> 。</p>
<p><code>IPv4</code>  中规定 IP 地址长度为 32 位（按 TCP/IP 参考模型划分) ，即有 2^32-1 个地址。 <code>IPv6</code>  的提出最早是为了解决，随着互联网的迅速发展 <code>IPv4</code>  地址空间将被耗尽的问题。为了扩大地址空间， <code>IPv6</code>  将 IP 地址的长度由 32 位增加到了 128 位。在 <code>IPv6</code>  的设计过程中除了一劳永逸地解决了地址短缺问题以外，还解决了 <code>IPv4</code>  中的其它问题，如：端到端 IP 连接、服务质量（QoS）、安全性、多播、移动性、即插即用等。</p>
<h4 id="ttl值"><a class="anchor" href="#ttl值">#</a> TTL 值</h4>
<p><code>TTL</code> －生存时间（Time To Live），表示解析记录在 DNS 服务器中的缓存时间， <code>TTL</code>  的时间长度单位是秒，一般为 3600 秒。比如：在访问 <code>www.itcast.cn</code>  时，如果在 DNS 服务器的缓存中没有该记录，就会向某个 NS 服务器发出请求，获得该记录后，该记录会在 DNS 服务器上保存 <code>TTL</code>  的时间长度，在 <code>TTL</code>  有效期内访问 <code>www.itcast.cn</code> ，DNS 服务器会直接缓存中返回刚才的记录。</p>
<h3 id="shell脚本入门"><a class="anchor" href="#shell脚本入门">#</a> shell 脚本入门</h3>
<p>推荐：<span class="exturl" data-url="aHR0cHM6Ly93d3cucnVub29iLmNvbS93M2Nub3RlL3NoZWxsLXF1aWNrLXN0YXJ0Lmh0bWw=">https://www.runoob.com/w3cnote/shell-quick-start.html</span></p>
<h3 id="vim编辑器入门"><a class="anchor" href="#vim编辑器入门">#</a> vim 编辑器入门</h3>
<p>推荐：<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zNDczMzA4OQ==">https://zhuanlan.zhihu.com/p/34733089</span></p>

      <div class="tags">
          <a href="/tags/Linux/" rel="tag"><i class="ic i-tag"></i> Linux</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">更新于</span>
    <time title="修改时间：2024-07-09 13:16:59" itemprop="dateModified" datetime="2024-07-09T13:16:59+08:00">2024-07-09</time>
  </span>
  <span id="2023/01/22/linux服务器/" class="item leancloud_visitors" data-flag-title="Linux" title="阅读次数">
      <span class="icon">
        <i class="ic i-eye"></i>
      </span>
      <span class="text">阅读次数</span>
      <span class="leancloud-visitors-count"></span>
      <span class="text">次</span>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> 赞赏</button>
  <p>请我喝[茶]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="dmq 微信支付">
        <p>微信支付</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="dmq 支付宝">
        <p>支付宝</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>本文作者： </strong>dmq <i class="ic i-at"><em>@</em></i>杜明清的个人博客
  </li>
  <li class="link">
    <strong>本文链接：</strong>
    <a href="https://dmqweb.cn/2023/01/22/linux%E6%9C%8D%E5%8A%A1%E5%99%A8/" title="Linux">https://dmqweb.cn/2023/01/22/linux服务器/</a>
  </li>
  <li class="license">
    <strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2023/01/12/Vue%E6%9D%82%E8%AE%B0/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s3.uuu.ovh&#x2F;imgs&#x2F;2024&#x2F;04&#x2F;13&#x2F;9404a557b00200f4.jpg" title="Vue使用笔记">
  <span class="type">上一篇</span>
  <span class="category"><i class="ic i-flag"></i> Vue</span>
  <h3>Vue使用笔记</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2023/02/02/%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s3.uuu.ovh&#x2F;imgs&#x2F;2024&#x2F;04&#x2F;13&#x2F;2376b10e610925e4.jpg" title="常见开源协议">
  <span class="type">下一篇</span>
  <span class="category"><i class="ic i-flag"></i> 开源协议</span>
  <h3>常见开源协议</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="文章目录">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#linux-%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.</span> <span class="toc-text"> Linux 服务器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#linux%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text"> Linux 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.1.</span> <span class="toc-text"> 版本介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#centosredhat"><span class="toc-number">1.1.1.1.</span> <span class="toc-text"> Centos(Redhat)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#debian"><span class="toc-number">1.1.1.2.</span> <span class="toc-text"> Debian</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ubuntu"><span class="toc-number">1.1.1.3.</span> <span class="toc-text"> Ubuntu</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.1.2.</span> <span class="toc-text"> 应用场景</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#linux-vs-windows"><span class="toc-number">1.1.2.1.</span> <span class="toc-text"> Linux vs Windows</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#linux%E7%9A%84gui%E7%95%8C%E9%9D%A2"><span class="toc-number">1.1.2.2.</span> <span class="toc-text"> Linux 的 GUI 界面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E8%BD%AF%E4%BB%B6%E5%BA%94%E7%94%A8"><span class="toc-number">1.1.2.3.</span> <span class="toc-text"> 常见软件应用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95"><span class="toc-number">1.1.3.</span> <span class="toc-text"> 安装方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#centos%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95"><span class="toc-number">1.1.3.1.</span> <span class="toc-text"> Centos 安装方法：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#windows%E4%B8%AD%E5%88%B6%E4%BD%9Cusb%E5%90%AF%E5%8A%A8%E7%9B%98"><span class="toc-number">1.1.3.2.</span> <span class="toc-text"> Windows 中制作 USB 启动盘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#macos%E4%B8%AD%E5%88%B6%E4%BD%9Cusb%E5%90%AF%E5%8A%A8%E7%9B%98"><span class="toc-number">1.1.3.3.</span> <span class="toc-text"> MacOS 中制作 USB 启动盘</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#linux%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.4.</span> <span class="toc-text"> Linux 目录结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#linux%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">1.1.5.</span> <span class="toc-text"> Linux 启动过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%BB%8B%E7%BB%8D%E9%87%8D%E7%82%B9"><span class="toc-number">1.1.6.</span> <span class="toc-text"> 常用命令介绍 (重点)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9B%B8%E5%85%B3"><span class="toc-number">1.1.6.1.</span> <span class="toc-text"> 文件相关</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%99%BB%E5%BD%95"><span class="toc-number">1.1.6.2.</span> <span class="toc-text"> 用户管理 &#x2F; 登录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C"><span class="toc-number">1.1.6.3.</span> <span class="toc-text"> 网络</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E7%A1%AC%E4%BB%B6"><span class="toc-number">1.1.6.4.</span> <span class="toc-text"> 性能 &#x2F; 硬件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nginx%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.2.</span> <span class="toc-text"> Nginx 服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nginx%E7%AE%80%E4%BB%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text"> Nginx 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="toc-number">1.2.1.1.</span> <span class="toc-text"> 什么是反向代理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nginx%E7%9A%84%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84"><span class="toc-number">1.2.1.2.</span> <span class="toc-text"> Nginx 的技术架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nginx%E9%AB%98%E5%8F%AF%E7%94%A8"><span class="toc-number">1.2.1.3.</span> <span class="toc-text"> Nginx 高可用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nginx%E6%9C%8D%E5%8A%A1%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.2.</span> <span class="toc-text"> Nginx 服务安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#centos%E5%AE%89%E8%A3%85%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.2.1.</span> <span class="toc-text"> Centos 安装方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ubuntu%E5%AE%89%E8%A3%85%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.2.2.</span> <span class="toc-text"> Ubuntu 安装方式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nginx%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BC%98%E5%8C%96"><span class="toc-number">1.2.3.</span> <span class="toc-text"> Nginx 配置及优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#https"><span class="toc-number">1.2.4.</span> <span class="toc-text"> HTTP(s)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#httphttps%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.2.4.1.</span> <span class="toc-text"> HTTP&#x2F;HTTPS 协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#https%E8%AE%A4%E8%AF%81%E5%8E%9F%E7%90%86"><span class="toc-number">1.2.4.2.</span> <span class="toc-text"> HTTPS 认证原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AEhttps"><span class="toc-number">1.2.4.3.</span> <span class="toc-text"> 如何配置 HTTPS</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.3.</span> <span class="toc-text"> 云服务器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%BF%E9%87%8C%E4%BA%91ecs"><span class="toc-number">1.3.1.</span> <span class="toc-text"> 阿里云 ECS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86"><span class="toc-number">1.3.1.1.</span> <span class="toc-text"> 虚拟化技术原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.3.1.2.</span> <span class="toc-text"> 如何选择云服务器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%B4%AD%E4%B9%B0"><span class="toc-number">1.3.1.3.</span> <span class="toc-text"> 云服务器购买</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="toc-number">1.3.1.4.</span> <span class="toc-text"> 认识控制台</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93rds"><span class="toc-number">1.3.2.</span> <span class="toc-text"> 云数据库 RDS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.3.2.1.</span> <span class="toc-text"> 云数据库介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81rds-mysql%E8%B4%AD%E4%B9%B0%E4%B8%8E%E6%93%8D%E4%BD%9C"><span class="toc-number">1.3.2.2.</span> <span class="toc-text"> 常见 RDS-MySQL 购买与操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD%E4%B8%8E%E5%BF%AB%E7%85%A7"><span class="toc-number">1.3.2.3.</span> <span class="toc-text"> 备份与快照</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1slb"><span class="toc-number">1.3.3.</span> <span class="toc-text"> 负载均衡 SLB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="toc-number">1.3.3.1.</span> <span class="toc-text"> 什么是负载均衡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#slb%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.3.3.2.</span> <span class="toc-text"> SLB 功能介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#slb%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84"><span class="toc-number">1.3.3.3.</span> <span class="toc-text"> SLB 技术架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%98%BF%E9%87%8C%E4%BA%91slb%E8%B4%AD%E4%B9%B0%E4%B8%8E%E6%93%8D%E4%BD%9C"><span class="toc-number">1.3.3.4.</span> <span class="toc-text"> 阿里云 SLB 购买与操作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E7%9F%A5%E8%AF%86"><span class="toc-number">1.4.</span> <span class="toc-text"> 扩展知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90"><span class="toc-number">1.4.1.</span> <span class="toc-text"> 域名解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dns%E8%A7%A3%E6%9E%90%E4%B8%AD%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98"><span class="toc-number">1.4.2.</span> <span class="toc-text"> DNS 解析中一些问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a%E8%AE%B0%E5%BD%95%E4%B8%8Ecname%E8%AE%B0%E5%BD%95"><span class="toc-number">1.4.2.1.</span> <span class="toc-text"> A 记录与 CNAME 记录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#a%E8%AE%B0%E5%BD%95%E4%B8%8Eaaaa%E8%AE%B0%E5%BD%95"><span class="toc-number">1.4.2.2.</span> <span class="toc-text"> A 记录与 AAAA 记录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ipv4%E4%B8%8Eipv6"><span class="toc-number">1.4.2.3.</span> <span class="toc-text"> IPv4 与 IPv6</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ttl%E5%80%BC"><span class="toc-number">1.4.2.4.</span> <span class="toc-text"> TTL 值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shell%E8%84%9A%E6%9C%AC%E5%85%A5%E9%97%A8"><span class="toc-number">1.4.3.</span> <span class="toc-text"> shell 脚本入门</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vim%E7%BC%96%E8%BE%91%E5%99%A8%E5%85%A5%E9%97%A8"><span class="toc-number">1.4.4.</span> <span class="toc-text"> vim 编辑器入门</span></a></li></ol></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="系列文章">
        <ul>
          <li class="active"><a href="/2023/01/22/linux%E6%9C%8D%E5%8A%A1%E5%99%A8/" rel="bookmark" title="Linux">Linux</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="站点概览">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="dmq"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">dmq</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">80</span>
        <span class="name">文章</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">64</span>
        <span class="name">分类</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">100</span>
        <span class="name">标签</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RtcTA/dGFiPXJlcG9zaXRvcmllcw==" title="https:&#x2F;&#x2F;github.com&#x2F;dmq0?tab&#x3D;repositories"><i class="ic i-github"></i></span>
      <span class="exturl item npm" data-url="aHR0cHM6Ly93d3cubnBtanMuY29tL35kbXEwMDA=" title="https:&#x2F;&#x2F;www.npmjs.com&#x2F;~dmq000"><i class="ic i-file"></i></span>
      <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9kLTg4LTYxLTgz" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;d-88-61-83"><i class="ic i-zhihu"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTgwMjc4OTk0OTE=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;8027899491"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vdS83NjI1OTAxNzE3" title="https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;7625901717"><i class="ic i-weibo"></i></span>
      <span class="exturl item email" data-url="bWFpbHRvOjMyNjc4MDc1MTRAcXEuY29t" title="mailto:3267807514@qq.com"><i class="ic i-envelope"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>首页</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>介绍</a>
  </li>

    
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a>
  </li>

    
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a>
  </li>

    
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a>
  </li>

    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a>
  </li>

    
  <li class="item">
    <a href="/links/" rel="section"><i class="ic i-magic"></i>工具</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2023/01/12/Vue%E6%9D%82%E8%AE%B0/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2023/02/02/%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>随机文章</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%AE%B9%E5%99%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E6%93%8D%E4%BD%9C/" title="分类于 容器化运维操作">容器化运维操作</a>
</div>

    <span><a href="/2024/02/02/%E5%AE%B9%E5%99%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E6%93%8D%E4%BD%9C/" title="容器化运维操作">容器化运维操作</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/esbuild/" title="分类于 esbuild">esbuild</a>
</div>

    <span><a href="/2024/05/17/esbuild/" title="esbuild">esbuild</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/OSI%E4%B8%83%E5%B1%82%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B/" title="分类于 OSI七层网络模型">OSI七层网络模型</a>
</div>

    <span><a href="/2024/05/27/OSI%E4%B8%83%E5%B1%82%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B/" title="OSI七层网络模型">OSI七层网络模型</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" title="分类于 解决方案">解决方案</a>
</div>

    <span><a href="/2023/06/02/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" title="解决方案">解决方案</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E4%B8%89%E6%96%B9%E5%BA%93/" title="分类于 三方库">三方库</a>
</div>

    <span><a href="/2024/04/16/%E4%B8%89%E6%96%B9%E5%8C%85/" title="三方库">三方库</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%89%8D%E7%AB%AF%E7%9B%91%E6%8E%A7/" title="分类于 前端监控">前端监控</a>
</div>

    <span><a href="/2024/04/29/%E5%89%8D%E7%AB%AF%E7%9B%91%E6%8E%A7/" title="前端监控">前端监控</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/typeScript/" title="分类于 typeScript">typeScript</a>
</div>

    <span><a href="/2023/12/11/TS/" title="typeScript笔记">typeScript笔记</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/vue/" title="分类于 vue">vue</a>
</div>

    <span><a href="/2023/09/02/vue3%E6%BA%90%E7%A0%81%E4%BD%8D%E8%BF%90%E7%AE%97/" title="vue3源码中的位运算">vue3源码中的位运算</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/JS/" title="分类于 JS">JS</a>
</div>

    <span><a href="/2023/12/21/%E6%9C%80%E5%A4%A7%E5%AE%89%E5%85%A8%E6%95%B0/" title="最大安全数与最大安全整数">最大安全数与最大安全整数</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F/" title="分类于 开发模式">开发模式</a>
</div>

    <span><a href="/2024/03/29/TDD/" title="TDD测试驱动开发">TDD测试驱动开发</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>最新评论</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2022 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">dmq @ Web blog</span>
  </div>
  <div class="count">
    <span class="post-meta-item-icon">
      <i class="ic i-chart-area"></i>
    </span>
    <span title="站点总字数">944k 字</span>

    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="ic i-coffee"></i>
    </span>
    <span title="站点阅读时长">14:18</span>
  </div>
  <div class="powered-by">
    基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2023/01/22/linux服务器/',
    favicon: {
      show: "科技引领未来",
      hide: "欢迎与我交流"
    },
    search : {
      placeholder: "文章搜索",
      empty: "关于 「 ${query} 」，什么也没搜到",
      stats: "${time} ms 内找到 ${hits} 条结果"
    },
    valine: true,fancybox: true,
    copyright: '复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://polyfill.alicdn.com/polyfill.min.js?features=Promise%2CArray.prototype.includes"></script>

<script src="//gcore.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>


  <script data-pjax>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?9ba187659e850a6910681214f0faa16b";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


</body>
</html>
