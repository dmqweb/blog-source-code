



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="æœæ˜æ¸…çš„ä¸ªäººåšå®¢" href="https://dmqweb.cn/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="æœæ˜æ¸…çš„ä¸ªäººåšå®¢" href="https://dmqweb.cn/atom.xml" />
<link rel="alternate" type="application/json" title="æœæ˜æ¸…çš„ä¸ªäººåšå®¢" href="https://dmqweb.cn/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="å¤æ‚ä¸šåŠ¡éƒ¨ç½²ä¸ä¼˜åŒ–" />


<link rel="canonical" href="https://dmqweb.cn/2024/04/12/%E5%A4%8D%E6%9D%82%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E4%B8%8A%E7%BA%BF/">



  <title>
å¤æ‚ä¸šåŠ¡éƒ¨ç½²ä¸ä¼˜åŒ– - å¤æ‚ä¸šåŠ¡éƒ¨ç½²ä¸ä¼˜åŒ– |
Web blog = æœæ˜æ¸…çš„ä¸ªäººåšå®¢ = ğŸ‘»æ¬¢è¿ä¸€èµ·äº¤æµå­¦ä¹ ğŸ‘»</title>
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">å¤æ‚ä¸šåŠ¡éƒ¨ç½²ä¸ä¼˜åŒ–
  </h1>
  
<div class="meta">
  <span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2024-04-12 08:33:58">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">å‘è¡¨äº</span>
    <time itemprop="dateCreated datePublished" datetime="2024-04-12T08:33:58+08:00">2024-04-12</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Web blog</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/15/807885ba1421e9b4.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/12/8740e71363c6800c.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/28/f7a6eb62965e0dec.webp"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/15/6d859d49c9d65157.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/12/f63f09ff2084b1f3.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/15/229ca07a8d7b6e02.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E5%A4%8D%E6%9D%82%E4%B8%9A%E5%8A%A1%E9%83%A8%E7%BD%B2%E4%B8%8E%E4%BC%98%E5%8C%96/" itemprop="item" rel="index" title="åˆ†ç±»äº å¤æ‚ä¸šåŠ¡éƒ¨ç½²ä¸ä¼˜åŒ–"><span itemprop="name">å¤æ‚ä¸šåŠ¡éƒ¨ç½²ä¸ä¼˜åŒ–</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://dmqweb.cn/2024/04/12/%E5%A4%8D%E6%9D%82%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E4%B8%8A%E7%BA%BF/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="dmq">
    <meta itemprop="description" content="ğŸ‘»æ¬¢è¿ä¸€èµ·äº¤æµå­¦ä¹ ğŸ‘», ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="æœæ˜æ¸…çš„ä¸ªäººåšå®¢">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="è½¯ä»¶ç”Ÿå‘½å‘¨æœŸï¼š"><a href="#è½¯ä»¶ç”Ÿå‘½å‘¨æœŸï¼š" class="headerlink" title="è½¯ä»¶ç”Ÿå‘½å‘¨æœŸï¼š"></a>è½¯ä»¶ç”Ÿå‘½å‘¨æœŸï¼š</h1><p><img data-src="/images/Snipaste_2024-04-16_12-54-33.jpg" alt="/images/Snipaste_2024-04-16_12-54-33.jpg"></p>
<h1 id="æ¶æ„æµç¨‹å›¾"><a href="#æ¶æ„æµç¨‹å›¾" class="headerlink" title="æ¶æ„æµç¨‹å›¾"></a>æ¶æ„æµç¨‹å›¾</h1><p><img data-src="/images/Snipaste_2024-04-17_12-16-04.jpg" alt="/images/Snipaste_2024-04-17_12-16-04.jpg"></p>
<h1 id="å¤æ‚é¡¹ç›®é€šç”¨æ–¹æ¡ˆ"><a href="#å¤æ‚é¡¹ç›®é€šç”¨æ–¹æ¡ˆ" class="headerlink" title="å¤æ‚é¡¹ç›®é€šç”¨æ–¹æ¡ˆ"></a>å¤æ‚é¡¹ç›®é€šç”¨æ–¹æ¡ˆ</h1><h4 id="ä¸šåŠ¡çš„å¤æ‚åº¦"><a href="#ä¸šåŠ¡çš„å¤æ‚åº¦" class="headerlink" title="ä¸šåŠ¡çš„å¤æ‚åº¦"></a>ä¸šåŠ¡çš„å¤æ‚åº¦</h4><ul>
<li>äº¤äº’çš„å¤æ‚æ€§</li>
<li>æ•°æ®ç»“æ„å’ŒçŠ¶æ€çš„å¤æ‚æ€§</li>
<li>å¤šé¡¹ç›®äº’ç›¸ä¾èµ–çš„å¤æ‚æ€§</li>
<li>æ‰“åŒ…</li>
<li>æ€§èƒ½ä¼˜åŒ–</li>
<li>ç¬¬ä¸‰æ–¹åº“çš„ä½¿ç”¨å’Œè°ƒç ”ä»¥åŠäºŒæ¬¡å¼€å‘</li>
</ul>
<h4 id="æµç¨‹çš„å¤æ‚åº¦"><a href="#æµç¨‹çš„å¤æ‚åº¦" class="headerlink" title="æµç¨‹çš„å¤æ‚åº¦"></a>æµç¨‹çš„å¤æ‚åº¦</h4><ul>
<li>git flow</li>
<li>lintå·¥å…·</li>
<li>å•å…ƒæµ‹è¯•</li>
<li>commitä¿¡æ¯</li>
<li>PR revirew</li>
<li>CI &#x2F; CD</li>
</ul>
<h1 id="CI-x2F-CDçš„æ¦‚å¿µ"><a href="#CI-x2F-CDçš„æ¦‚å¿µ" class="headerlink" title="CI &#x2F; CDçš„æ¦‚å¿µ"></a>CI &#x2F; CDçš„æ¦‚å¿µ</h1><p>ä¸šåŠ¡ç»„ä»¶åº“çš„å¼€å‘å’Œå‘å¸ƒæ˜¯éšç€ä¸€äº›åˆ—ä»»åŠ¡è¿›åŒ–çš„ï¼š</p>
<ul>
<li>æœ¬åœ°commité’©å­å‡½æ•°å®ŒæˆcommitéªŒè¯</li>
<li>ä»£ç pushåˆ°è¿œç«¯ä¹‹å</li>
<li>è·‘ç‰¹å®šçš„testï¼ˆä¸ä»…ä»…æ˜¯æœ¬æœºçš„unit testï¼Œä¹Ÿå¯èƒ½æœ‰æ—¶é—´å¾ˆé•¿çš„E2E testï¼‰</li>
<li>testé€šè¿‡ä¹‹åæ£€æŸ¥æ˜¯å¦æœ‰æ–°çš„tagï¼Œå¦‚æœæœ‰å°±è‡ªåŠ¨publishä¸€ä¸ªæ–°çš„ç‰ˆæœ¬</li>
<li>ç”šè‡³è¿˜æœ‰æ›´å¤šï¼Œè‡ªåŠ¨éƒ¨ç½²æ–‡æ¡£ç«™ç‚¹ç­‰ç­‰ã€‚</li>
</ul>
<p>è¿™äº›ä»»åŠ¡å¦‚æœæ‰‹åŠ¨æ“ä½œï¼Œå°±è´¹æ—¶è´¹åŠ›ï¼Œæ‰€ä»¥éœ€è¦è‡ªåŠ¨åŒ–è¿›è¡Œã€‚</p>
<h4 id="CIï¼ˆContinuous-integrationï¼‰æŒç»­é›†æˆ"><a href="#CIï¼ˆContinuous-integrationï¼‰æŒç»­é›†æˆ" class="headerlink" title="CIï¼ˆContinuous integrationï¼‰æŒç»­é›†æˆ"></a>CIï¼ˆContinuous integrationï¼‰æŒç»­é›†æˆ</h4><p>æŒç»­é›†æˆæ˜¯æŒ‡é¢‘ç¹åœ°å°†ä»£ç é›†æˆåˆ°ä¸»å¹²ï¼Œä¸€æ—¦å¼€å‘äººå‘˜å¯¹åº”ç”¨æ‰€åšçš„æ›´æ”¹è¢«åˆå¹¶ï¼Œç³»ç»Ÿå°±ä¼šé€šè¿‡è‡ªåŠ¨æ„å»ºåº”ç”¨å¹¶è¿è¡Œä¸åŒçº§åˆ«çš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆé€šå¸¸æ˜¯å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ï¼‰æ¥éªŒè¯è¿™äº›æ›´æ”¹ï¼Œç¡®ä¿è¿™äº›æ›´æ”¹æ²¡æœ‰å¯¹åº”ç”¨é€ æˆç ´åã€‚</p>
<p>ä½œç”¨æœ‰ï¼š</p>
<ul>
<li>å¿«é€Ÿå‘ç°é”™è¯¯</li>
<li>é˜²æ­¢åˆ†æ”¯å¤§å¹…åç¦»ä¸»å¹²</li>
</ul>
<p>æŒç»­é›†æˆçš„ç›®çš„å°±æ˜¯è®©äº§å“å¯ä»¥å¿«é€Ÿè¿­ä»£ï¼ŒåŒæ—¶ä¿æŒé«˜è´¨é‡ã€‚</p>
<h4 id="CDï¼ˆContinuous-Deliveryï¼‰æŒç»­äº¤ä»˜"><a href="#CDï¼ˆContinuous-Deliveryï¼‰æŒç»­äº¤ä»˜" class="headerlink" title="CDï¼ˆContinuous Deliveryï¼‰æŒç»­äº¤ä»˜"></a>CDï¼ˆContinuous Deliveryï¼‰æŒç»­äº¤ä»˜</h4><p>æŒç»­äº¤ä»˜æ˜¯æŒ‡é¢‘ç¹åœ°å°†è½¯ä»¶çš„æ–°ç‰ˆæœ¬ï¼Œäº¤ä»˜ç»™è´¨é‡å›¢é˜Ÿæˆ–è€…ç”¨æˆ·ï¼Œä»¥ä¾›è¯„å®¡ã€‚</p>
<h4 id="CDï¼ˆContinuous-Deploymentï¼‰æŒç»­éƒ¨ç½²"><a href="#CDï¼ˆContinuous-Deploymentï¼‰æŒç»­éƒ¨ç½²" class="headerlink" title="CDï¼ˆContinuous Deploymentï¼‰æŒç»­éƒ¨ç½²"></a>CDï¼ˆContinuous Deploymentï¼‰æŒç»­éƒ¨ç½²</h4><p>æŒç»­éƒ¨ç½²æ˜¯æŒç»­äº¤ä»˜çš„ä¸‹ä¸€æ­¥ï¼ŒæŒ‡çš„æ˜¯ä»£ç é€šè¿‡è¯„å®¡ä»¥åï¼Œè‡ªåŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚</p>
<h4 id="CI-x2F-CDä¸¤å¤§æœåŠ¡ï¼š"><a href="#CI-x2F-CDä¸¤å¤§æœåŠ¡ï¼š" class="headerlink" title="CI &#x2F; CDä¸¤å¤§æœåŠ¡ï¼š"></a>CI &#x2F; CDä¸¤å¤§æœåŠ¡ï¼š</h4><ul>
<li>github actions</li>
<li>travis-ci</li>
</ul>
<h1 id="åˆ—è¡¨æ’åºè§£å†³æ–¹æ¡ˆ"><a href="#åˆ—è¡¨æ’åºè§£å†³æ–¹æ¡ˆ" class="headerlink" title="åˆ—è¡¨æ’åºè§£å†³æ–¹æ¡ˆ"></a>åˆ—è¡¨æ’åºè§£å†³æ–¹æ¡ˆ</h1><p>åˆ—è¡¨æ’åºåŸç†ï¼š</p>
<pre><code class="js">&lt;template&gt;
    &lt;div&gt;
      &lt;ul class=&quot;ul&quot; @drop=&quot;onDrop&quot;&gt;
        &lt;li 
            v-for=&quot;(item,index) in list&quot; 
            :data-index=&quot;index&quot; 
            :key=&quot;item.id&quot; 
            @dragover=&quot;onDragover($event,index)&quot; 
            @dragstartart=&quot;dragstart($event,index)&quot; 
            @dragenter=&quot;dragenter($event,index)&quot; 
            draggable=&quot;true&quot; 
            :class=&quot;[item.id==currentLi?&#39;glost&#39;:&#39;&#39;]&quot;
        &gt;&#123;&#123; item.name &#125;&#125;&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
/*eslint-disable*/
import &#123; ref &#125; from &quot;vue&quot;;
import &#123;arrayMoveImmutable&#125; from &#39;array-move&#39;;
let currentLi = ref(1);
let index = ref(1);
const list = ref(
  [
  &#123;id:1,name:&#39;åˆ—è¡¨1&#39;&#125;,
  &#123;id:2,name:&#39;åˆ—è¡¨2&#39;&#125;,
  &#123;id:3,name:&#39;åˆ—è¡¨3&#39;&#125;,
  &#123;id:4,name:&#39;åˆ—è¡¨4&#39;&#125;,
  &#123;id:5,name:&#39;åˆ—è¡¨5&#39;&#125;,
]
)
const dragstart = (e,inde)=&gt;&#123;
  currentLi.value = inde;
&#125;
const dragenter = (e,ind)=&gt;&#123;
  if(ind != currentLi.value)&#123;
      list.value = arrayMoveImmutable(list.value,ind,currentLi.value)
      currentLi.value = ind;
  &#125;
&#125;
const onDrop = (e)=&gt;&#123;
  console.log(e.target.dataset.index,&#39;drop&#39;);
  list.value = arrayMoveImmutable(list.value,index.value,currentLi.value)
  console.log(list.value);
&#125;
const onDragover = (e,inde)=&gt;&#123;
  e.preventDefault();
  index.value = inde;
&#125;
&lt;/script&gt;

&lt;style  scoped&gt;
.ul&gt;li&#123;
  width: 100%;
  height: 50px;
  border: 1px solid red;
&#125;
.glost&#123;
  box-shadow: 10px 10px 3px 3px gray;
&#125;
&lt;/style&gt;
</code></pre>
<p>åˆ—è¡¨æ’åºå¸¸ç”¨å·¥å…·åŒ…ï¼š</p>
<ul>
<li>vue-draggable</li>
<li>sortable.js</li>
<li>array-move.js</li>
</ul>
<h1 id="æ‹–åŠ¨æ”¹å˜ä½ç½®åŸç†"><a href="#æ‹–åŠ¨æ”¹å˜ä½ç½®åŸç†" class="headerlink" title="æ‹–åŠ¨æ”¹å˜ä½ç½®åŸç†"></a>æ‹–åŠ¨æ”¹å˜ä½ç½®åŸç†</h1><p>é€šè¿‡ç›‘å¬mousedownå’Œmousemoveäº‹ä»¶ï¼Œç”¨element.getBoundingClientRectæ–¹æ³•è·å¾—xå’Œyï¼Œleftå’Œtopç­‰å±æ€§ï¼Œæ”¹å˜å¯¹åº”å…ƒç´ çš„topå’Œleftå±æ€§ã€‚</p>
<h1 id="æ‹–åŠ¨æ”¹å˜å¤§å°åŸç†"><a href="#æ‹–åŠ¨æ”¹å˜å¤§å°åŸç†" class="headerlink" title="æ‹–åŠ¨æ”¹å˜å¤§å°åŸç†"></a>æ‹–åŠ¨æ”¹å˜å¤§å°åŸç†</h1><p> è®¾ç½®è¾¹æ¡†å…ƒç´ ï¼Œè¾¹æ¡†å…ƒç´ çš„å››ä¸ªè§’æ·»åŠ åœ†ç‚¹å…ƒç´ ï¼Œç›‘å¬mousedownäº‹ä»¶å’Œmousemoveäº‹ä»¶ï¼Œå¹¶å°†æœ€æ–°çš„åæ ‡èµ‹å€¼ç»™å…ƒç´ çš„å°ºå¯¸å¤§å°ã€‚</p>
<h1 id="å¿«æ·é”®å®ç°åŸç†"><a href="#å¿«æ·é”®å®ç°åŸç†" class="headerlink" title="å¿«æ·é”®å®ç°åŸç†"></a>å¿«æ·é”®å®ç°åŸç†</h1><p>å¥½ç”¨çš„å¿«æ·é”®ç¬¬ä¸‰æ–¹åº“ï¼šHotkeys.js</p>
<p>äº‹ä»¶åŸç†ï¼škeydownäº‹ä»¶çš„ç›‘å¬ï¼Œé€šè¿‡event.keyåˆ¤æ–­æ˜¯é‚£ä¸ªå¿«æ·é”®ï¼Œä»è€Œæ‰§è¡Œå¯¹åº”çš„æ“ä½œã€‚</p>
<h1 id="æ’¤é”€é‡åšåŸç†"><a href="#æ’¤é”€é‡åšåŸç†" class="headerlink" title="æ’¤é”€é‡åšåŸç†"></a>æ’¤é”€é‡åšåŸç†</h1><p>ç»´æŠ¤ä¸€ä¸ªå›ºå®šé•¿åº¦çš„historiesæ•°ç»„å’ŒhistoryIndexæŒ‡é’ˆï¼Œæ¯æ¬¡ä¿®æ”¹çš„æ—¶å€™æ·»åŠ ä¸€æ¡è®°å½•ï¼ˆæ ‡è¯†æ“ä½œç±»å‹å’Œæ•°æ®ï¼‰ã€‚å›æ»šæ—¶æ”¹å˜historyIndexæŒ‡é’ˆã€‚</p>
<h1 id="å³é”®èœå•åŸç†"><a href="#å³é”®èœå•åŸç†" class="headerlink" title="å³é”®èœå•åŸç†"></a>å³é”®èœå•åŸç†</h1><p>åœ¨éœ€è¦æ˜¾ç¤ºçš„åŒºåŸŸæ‹¦æˆªé»˜è®¤çš„å³é”®ç‚¹å‡»äº‹ä»¶ï¼Œåˆ¤æ–­æ˜¯å¦ç‚¹å‡»åœ¨ç»„ä»¶å…ƒç´ ä¸Šï¼ˆé€šè¿‡event.targetï¼‰ï¼Œæ˜¾ç¤ºä¸€ä¸ªè‡ªå®šä¹‰èœå•ï¼Œå…¶ä¸­åŒ…æ‹¬æ“ä½œé¡¹ï¼Œæ˜¾ç¤ºåœ¨é¼ æ ‡çš„ä½ç½®ï¼ˆevent.clientXå’Œevent.clientYï¼‰ï¼Œç‚¹å‡»å®Œæˆæ“ä½œï¼Œé€šè¿‡display:noneéšè—ã€‚</p>
<h1 id="è‡ªåŠ¨ä¿å­˜å®ç°æ–¹æ¡ˆ"><a href="#è‡ªåŠ¨ä¿å­˜å®ç°æ–¹æ¡ˆ" class="headerlink" title="è‡ªåŠ¨ä¿å­˜å®ç°æ–¹æ¡ˆ"></a>è‡ªåŠ¨ä¿å­˜å®ç°æ–¹æ¡ˆ</h1><ul>
<li>å®šæ—¶ä¿å­˜ï¼ˆè¯­é›€ï¼‰</li>
<li>å®æ—¶ä¿å­˜ï¼ˆçŸ³å¢¨ï¼‰</li>
</ul>
<p>å®ç°åŸç†ï¼šæ·»åŠ isDrityå­—æ®µæ ‡è®°æ•°æ®æ˜¯å¦æœ‰ä¿®æ”¹ï¼Œå½“ä¿®æ”¹æ—¶å°†isDirtyè®¾ç½®ä¸ºtrueï¼Œæ ¹æ®isDIrtyçš„å€¼è®¾ç½®å®šæ—¶å™¨ï¼Œå®šæ—¶è§¦å‘ä¿å­˜é€»è¾‘ã€‚</p>
<h1 id="DOMå…ƒç´ æˆªå›¾å®ç°æ–¹æ¡ˆ"><a href="#DOMå…ƒç´ æˆªå›¾å®ç°æ–¹æ¡ˆ" class="headerlink" title="DOMå…ƒç´ æˆªå›¾å®ç°æ–¹æ¡ˆ"></a>DOMå…ƒç´ æˆªå›¾å®ç°æ–¹æ¡ˆ</h1><p>å·¥å…·åŒ…ï¼šhtml2canvas</p>
<p>å®ç°åŸç†ï¼š</p>
<p>æ ¹æ®DOMå…ƒç´ çš„stylesæ ·å¼ï¼Œé€šè¿‡svgçš„foreignObjectå…ƒç´ å¼•å…¥XMLå‘½åç©ºé—´çš„å…ƒç´ ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªimageæ ‡ç­¾ï¼Œå°†svgé€šè¿‡url.createObjectURLæ–¹æ³•åˆ›å»ºä¸€ä¸ªè·¯å¾„èµ‹å€¼ç»™ä¸€ä¸ªimageæ ‡ç­¾çš„srcå±æ€§ï¼Œé€šè¿‡canvasç”»ç¬” çš„drawImageæ–¹æ³•å°†imageå›¾ç‰‡ç»˜åˆ¶åˆ°canvasç”»å¸ƒä¸Šã€‚</p>
<p>å®ç°æµç¨‹ï¼š</p>
<ul>
<li>styleè®¾ç½®DOMæ ·å¼</li>
<li>svgå¼•å…¥DOM</li>
<li>createObjectURLåˆ›å»ºurlè·¯å¾„</li>
<li>å°†urlå¤åˆ¶åˆ°imageæ ‡ç­¾çš„src</li>
<li>canvasçš„drawImageå°†imageå›¾ç‰‡ç»˜åˆ¶åˆ°canvasç”»å¸ƒä¸Š</li>
</ul>
<pre><code class="js">const data =
&quot;&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39;width=&#39;400px&#39;height=&#39;40
&quot;&lt;foreignabject width=&#39;100%&#39;height=&#39;100%&#39;&gt;&quot;+
&quot;&lt;div xmlns=&#39;http://ww.w3.org/1999/xhtml&#39;&gt;&quot;
element.innerHTML+
&quot;&lt;/div&gt;&quot;+
&quot;&lt;/foreignobject&gt;&quot; +
&quot;&lt;/svg&gt;&quot;

const svg = new Blob([data],&#123;type:&quot;image/svg+xml;charset=utf-8&quot;&#125;);
const url = URL.createobjectURL(svg)
const image = new Image()
image.src = url
image.addEventListener(&#39;load&#39;,()=&gt;&#123;
    const ctx =anvas.getContext(&#39;2d&#39;);
    if (ctx)&#123;
    ctx.drawImage(image,0,0)
    &#125;
&#125;)
</code></pre>
<h1 id="äºŒç»´ç ç”Ÿæˆæ–¹æ¡ˆ"><a href="#äºŒç»´ç ç”Ÿæˆæ–¹æ¡ˆ" class="headerlink" title="äºŒç»´ç ç”Ÿæˆæ–¹æ¡ˆ"></a>äºŒç»´ç ç”Ÿæˆæ–¹æ¡ˆ</h1><ul>
<li>å·¥å…·åŒ…ï¼šnode-qrcode</li>
<li>tsé¡¹ç›®ä¸­éœ€è¦å®‰è£…é¢å¤–çš„å®šä¹‰æ–‡ä»¶ã€‚</li>
</ul>
<p>ç®€å•åŸç†ï¼šå°†æ•°æ®å˜ä¸ºäºŒè¿›åˆ¶ï¼Œç„¶åé€šè¿‡canvaså°†äºŒè¿›åˆ¶å˜ä¸ºå›¾åƒã€‚</p>
<pre><code class="html">&lt;body&gt;
  &lt;canvas id=&quot;qrcode&quot; width=&quot;128&quot; height=&quot;128&quot;&gt;&lt;/canvas&gt;
  &lt;script&gt;
    //å°†å­—ç¬¦ä¸²è½¬ä¸ºäºŒè¿›åˆ¶å½¢å¼
    function toBianary(str)&#123;
        let res = &#39;&#39;;
        for(let i=0;i&lt;str.length;i++)&#123;
            let charCode = str.charCodeAt(i);
            let binaryCharCode = charCode.toString(2);
            res += binaryCharCode.padStart(8,&#39;0&#39;);
        &#125;
        return res;
    &#125;
    //ç»˜åˆ¶
    function drawQRCode(text, canvas) &#123;
      var context = canvas.getContext(&quot;2d&quot;);
      // ç»˜åˆ¶é»‘ç™½åƒç´ ç‚¹
      for (var i = 0; i &lt; text.length; i++) &#123;
        var row = Math.floor(i / canvas.width);
        var col = i % canvas.width;
        var color = text.charAt(i) === &quot;1&quot; ? &quot;#000000&quot; : &quot;#FFFFFF&quot;;
        context.fillStyle = color; 
        context.fillRect(col, row, 1, 1);
      &#125;
    &#125;
    var qrcodeCanvas = document.getElementById(&quot;qrcode&quot;);
    drawQRCode(toBianary(&#39;https://dmqweb.cn&#39;), qrcodeCanvas); // ç¤ºä¾‹ï¼šç»˜åˆ¶ä¸€ä¸ªç®€å•çš„äºŒç»´ç 
  &lt;/script&gt;
</code></pre>
<h1 id="å¤åˆ¶åŠŸèƒ½å®ç°åŸç†"><a href="#å¤åˆ¶åŠŸèƒ½å®ç°åŸç†" class="headerlink" title="å¤åˆ¶åŠŸèƒ½å®ç°åŸç†"></a>å¤åˆ¶åŠŸèƒ½å®ç°åŸç†</h1><ul>
<li>å·¥å…·åŒ…ï¼šclipboard.js</li>
<li>è‡ªå¸¦typeå®šä¹‰æ–‡ä»¶</li>
</ul>
<p>å®ç°åŸç†ï¼š</p>
<p>æ–¹æ¡ˆä¸€ï¼šdocument.execCommand()æ–¹æ³•ã€‚å†…ç½®ä¸€ç³»åˆ—åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¤åˆ¶æ–‡æœ¬ï¼ˆä½†<strong>å‰ææ˜¯éœ€è¦é€‰ä¸­æ–‡æœ¬</strong>ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ä¸å¯è§å…ƒç´ è¿‚å›ã€‚</p>
<p>æ–¹æ¡ˆäºŒï¼šClipboard APIï¼ˆ navigator.clipboard ï¼‰ï¼Œä½†æ˜¯å¯¹äº<strong>æµè§ˆå™¨å…¼å®¹æ€§æœ‰å¾…åŠ å¼ºã€‚</strong></p>
<h1 id="ä¸‹è½½æ–‡ä»¶åŸç†"><a href="#ä¸‹è½½æ–‡ä»¶åŸç†" class="headerlink" title="ä¸‹è½½æ–‡ä»¶åŸç†"></a>ä¸‹è½½æ–‡ä»¶åŸç†</h1><ul>
<li>å·¥å…·åŒ…ï¼šFileSaver.jsï¼ˆå°æ–‡ä»¶ï¼‰</li>
<li>StreamSaver.jsï¼ˆå¤§æ–‡ä»¶ï¼‰</li>
</ul>
<p>æ–¹æ¡ˆä¸€ï¼šè¶…é“¾æ¥aæ ‡ç­¾æ·»åŠ downloadå±æ€§ï¼Œå±æ€§å€¼ä¸ºæ–‡ä»¶åï¼Œrelå±æ€§è®¾ç½®æ‰“å¼€é¡µé¢çš„å…·ä½“å®ç°ç»†èŠ‚ã€‚ï¼ˆä½†å‰ææ˜¯<strong>hrefå±æ€§ä¸ºå½“å‰åŒæºæƒ…å†µä¸‹</strong>ã€‚ï¼‰</p>
<p>æ–¹æ¡ˆäºŒï¼šé€šè¿‡axiosè¯·æ±‚åˆ°å›¾ç‰‡åœ°å€ï¼Œé€šè¿‡URL.createObjectURLåˆ›å»ºä¸ºä¸€ä¸ªä¸documentç›¸ç»‘å®šçš„åœ°å€ï¼Œèµ‹å€¼ç»™aæ ‡ç­¾å³å¯ã€‚ï¼ˆä¸è¦å¿˜è®°ä½¿ç”¨URL.revokeObjectURLå°†åˆ›å»ºçš„åœ°å€ç§»é™¤ã€‚ï¼‰</p>
<p>æ–¹æ¡ˆä¸‰ï¼šé€šè¿‡FileReader.readAsDataURLï¼Œåˆ›å»ºä¸€ä¸ªFileReaderå®ä¾‹ï¼Œä½¿ç”¨readAsDataURLè¯»å–å¯¹è±¡è¿”å›ä¸€æ®µbase64æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œç›‘å¬readerå®ä¾‹çš„onloadäº‹ä»¶ï¼Œåˆ›å»ºaæ ‡ç­¾å°†reader.resultèµ‹å€¼ç»™aæ ‡ç­¾çš„hrefå±æ€§ã€‚</p>
<pre><code class="js">downloadFile:function(data,fileName)&#123;
   const reader = new FileReader()
   // ä¼ å…¥è¢«è¯»å–çš„blobå¯¹è±¡
   reader.readAsDataURL(data)
   // è¯»å–å®Œæˆçš„å›è°ƒäº‹ä»¶
   reader.onload = (e) =&gt; &#123;
       let a = document.createElement(&#39;a&#39;)
       a.download = fileName
       a.style.display = &#39;none&#39;
       // ç”Ÿæˆçš„base64ç¼–ç 
       let url = reader.result
       a.href = url
       document.body.appendChild(a)
       a.click()
       document.body.removeChild(a)
   &#125;
&#125;
</code></pre>
<p>ç»ˆæè§£å†³æ–¹æ¡ˆï¼šç”±äºé€šè¿‡URL.createObjectURLå’ŒFileReaderéƒ½ä¼šå…ˆå°†æ•°æ®ä¿å­˜åˆ°å†…å­˜ä¸­ï¼Œä¸šåŠ¡ä¸­ç»å¸¸éœ€è¦åç«¯éªŒè¯tokenä¹‹åæ‰èƒ½æ‹¿åˆ°æ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨aæ ‡ç­¾ã€‚å› æ­¤å®é™…ä¸­å¯ä»¥å…ˆå‘é€ajaxè¯·æ±‚éªŒè¯tokenï¼ŒéªŒè¯ä¹‹åé¢å‘ä¸€ä¸ªè¿‡æœŸæ—¶é—´çŸ­çš„cookieï¼Œä¹‹åä½¿ç”¨aæ ‡ç­¾è¿›è¡Œä¸‹è½½å³å¯ã€‚ä½†æ˜¯åŒæ ·ä¼šå—åˆ°aæ ‡ç­¾downloadå±æ€§è·¨åŸŸè¯·æ±‚çš„é™åˆ¶ã€‚</p>
<h1 id="åº”ç”¨éƒ¨ç½²çš„æµç¨‹"><a href="#åº”ç”¨éƒ¨ç½²çš„æµç¨‹" class="headerlink" title="åº”ç”¨éƒ¨ç½²çš„æµç¨‹"></a>åº”ç”¨éƒ¨ç½²çš„æµç¨‹</h1><p><strong>æ„å»º</strong><br>Javascriptè¯­è¨€æœ¬èº«æ˜¯ä¸éœ€è¦ç¼–è¯‘çš„ã€‚<br>ä½†æ˜¯ç°ä»£çš„å‰ç«¯é¡¹ç›®ä½¿ç”¨çš„è¯­è¨€å’Œæˆ–è€…çš„æ¨¡å—ç³»ç»Ÿéƒ½æ— æ³•åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ï¼Œéƒ½éœ€è¦ä½¿ç”¨ç‰¹å®šçš„<br>bundlerå°†æºä»£ç æœ€ç»ˆè½¬æ¢ä¸ºæµè§ˆå™¨æ”¯æŒçš„ã€avascriptä»£ç ã€‚<br><strong>ä¸åŒçš„ç¯å¢ƒ:</strong><br>å¼€å‘ç¯å¢ƒ(development) ï¼šæœ¬åœ°çš„æµ‹è¯•ç¯å¢ƒ<br>æµ‹è¯•ç¯å¢ƒ(testæˆ–è€…stagingï¼‰ï¼šçº¿ä¸Šçš„æµ‹è¯•ç¯å¢ƒ</p>
<p>ç”Ÿäº§ç¯å¢ƒï¼ˆproduction)ï¼šçº¿ä¸Šçš„ç”Ÿäº§ç¯å¢ƒ</p>
<p><strong>ç”Ÿäº§å’Œå¼€å‘ç¯å¢ƒçš„åŒºåˆ«</strong><br>*å¼€å‘ç¯å¢ƒ<br>*ä¼šæ·»åŠ ä¸°å¯Œçš„é”™è¯¯æç¤º<br>å¯ä»¥ä½¿ç”¨mock serveræˆ–è€…æœ¬åœ°åç«¯ç¯å¢ƒ<br>æ·»åŠ å„ç§ä¾¿åˆ©çš„åŠŸèƒ½-æ¯”å¦‚hot reload,è‡ªåŠ¨åˆ·æ–°<br>*ä¸å¤ªå…³å¿ƒé™æ€èµ„æºçš„å¤§å°ï¼Œæœ€å¥½æä¾›æœ€ä¸°å¯Œçš„è°ƒè¯•ä¿¡æ¯(sourcemap)ç­‰ã€‚</p>
<p><strong>ç”Ÿäº§ç¯å¢ƒ</strong><br>ç¨³å®šæ˜¯æœ€é‡è¦çš„åŸåˆ™<br>é€Ÿåº¦æ˜¯ç¬¬ä¸€è¦åŠ¡<br><strong>ç”Ÿäº§ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒçš„åŒºåˆ«</strong><br>é«˜åº¦ç›¸ä¼¼<br>ä½¿ç”¨çš„åç«¯æœåŠ¡ä¸ä¸€æ ·</p>
<p><strong>ç¯å¢ƒå˜é‡è®¾ç½®ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰</strong></p>
<ul>
<li>è·¨å¹³å°è®¾ç½®ç¯å¢ƒå˜é‡å·¥å…·åŒ…ï¼šcross-env</li>
<li>å‘½ä»¤ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼ˆå¹³å°é™åˆ¶ï¼‰</li>
<li>ç¯å¢ƒå˜é‡æ–‡ä»¶ä¸­é…ç½®</li>
</ul>
<p><strong>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­æ”¾ç½®ä¸‹åˆ—æ–‡ä»¶æ¥æŒ‡å®šç¯å¢ƒå˜é‡</strong><br>.env                                        #åœ¨æ‰€æœ‰çš„ç¯å¢ƒä¸­è¢«è½½å…¥<br>.env.local                             #åœ¨æ‰€æœ‰çš„ç¯å¢ƒä¸­è¢«è½½å…¥ï¼Œä½†ä¼šè¢«gitå¿½ç•¥<br>env.[mode]                         #åªåœ¨æŒ‡å®šçš„æ¨¡å¼ä¸­è¢«è½½å…¥<br>env.[mode].local             #åªåœ¨æŒ‡å®šçš„æ¨¡å¼ä¸­è¢«è½½å…¥ï¼Œä½†ä¼šè¢«gitå¿½ç•¥</p>
<h1 id="webpackæ„å»ºä¼˜åŒ–"><a href="#webpackæ„å»ºä¼˜åŒ–" class="headerlink" title="webpackæ„å»ºä¼˜åŒ–"></a>webpackæ„å»ºä¼˜åŒ–</h1><h3 id="Bundlerï¼š"><a href="#Bundlerï¼š" class="headerlink" title="Bundlerï¼š"></a>Bundlerï¼š</h3><p>å°†æµè§ˆå™¨ä¸æ”¯æŒçš„æ¨¡å—è¿›è¡Œç¼–è¯‘ï¼Œè½¬æ¢ï¼Œ<br>åˆå¹¶æœ€åç”Ÿæˆçš„ä»£ç å¯ä»¥åœ¨æµè§ˆå™¨ç«¯è‰¯å¥½çš„è¿è¡Œçš„å·¥å…·ã€‚</p>
<h3 id="Loadersï¼š"><a href="#Loadersï¼š" class="headerlink" title="Loadersï¼š"></a><strong>Loadersï¼š</strong></h3><p><span class="exturl" data-url="aHR0cHM6Ly93ZWJwYWNrLmRvY3NjaGluYS5vcmcvY29uY2VwdHMvbG9hZGVycy8=">https://webpack.docschina.org/concepts/loaders/</span><br>loaderç”¨äºå¯¹æ¨¡å—çš„æºä»£ç è¿›è¡Œè½¬æ¢ã€‚loaderå¯ä»¥ä½¿ä½ åœ¨importæˆ–â€Ioad(åŠ è½½)â€æ¨¡å—æ—¶é¢„å¤„ç†æ–‡ä»¶ã€‚<br><strong>å¤šä¸ªLoader</strong><br>module.ruleså…è®¸ä½ åœ¨webpacké…ç½®ä¸­æŒ‡å®šå¤šä¸ªloaderã€‚è¿™ç§æ–¹å¼æ˜¯å±•ç¤ºloaderçš„ä¸€ç§ç®€æ˜æ–¹å¼ï¼Œå¹¶ä¸”æœ‰åŠ©äºä½¿ä»£ç å˜å¾—ç®€æ´å’Œæ˜“äºç»´æŠ¤ã€‚</p>
<p><strong>webpackä¸­loaderé…ç½®ï¼š</strong></p>
<pre><code class="json">const path = require(&#39;path&#39;)
module.exports = &#123;
    entry:&#39;./main.js&#39;,
    output:&#123;
        path:path.resolve(dirname,&#39;dist&#39;),
        filename:bundle.js&#39;,
    &#125;
&#125;,
module:&#123;
    rules:[
    &#123;
        test:/å…«.css$/,
        use: [
            loader:&#39;style-loader&#39;&#125;,   //å…ˆå†™çš„loaderåæ‰§è¡Œã€‚
            loader:&#39;css-loader&#39;&#125;
        ]
    &#125;]
  &#125;
&#125;
</code></pre>
<h6 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h6><p><strong>webpackä¸­loaderåŸç†ï¼š</strong></p>
<p> åœ¨webpack.config.jsçš„moduleå­—æ®µçš„rulesæ•°ç»„ä¸­è¿›è¡Œé…ç½®ï¼šæ·»åŠ ä¸€ä¸ªå¯¹è±¡æ ‡è¯†ä¸€ä¸ªç‹¬ç«‹çš„åŒ¹é…é¡¹ï¼Œtestå­—æ®µä½¿ç”¨æ­£åˆ™è¡¨ç¤ºåŒ¹é…çš„æ–‡ä»¶åï¼Œuseæ•°ç»„è¡¨ç¤ºå¯¹åº”æ–‡ä»¶éœ€è¦æ‰§è¡Œçš„loaderï¼Œwebpackåœ¨æ‰“åŒ…æ—¶ä¼š<strong>å°†æ–‡ä»¶å†…å®¹ä¼ å…¥å¹¶æ‰§è¡Œå¯¹åº”çš„loader</strong>ï¼ˆæ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰ï¼Œ<strong>æ‰§è¡Œloaderå‡½æ•°åä¼šå°†å‡½æ•°è¿”å›å€¼åŒ…è£…æˆä¸€ä¸ªæ–°çš„å‡½æ•°</strong>ï¼Œå› æ­¤webpackä¸­çš„loaderé€šå¸¸éœ€è¦è¿›è¡Œä¸¤æ¬¡module.exportsã€‚</p>
<pre><code class="js">//æ‰‹å†™ä¸€ä¸ªmdæ–‡ä»¶çš„loader
const marked = require(&#39;marked&#39;);  //ç¬¬ä¸‰æ–¹åº“ï¼Œç”¨äºå°†mdè½¬ä¸ºhtml
const utils = require(&#39;loader-utils&#39;)  //å®˜æ–¹åº“ï¼Œç”¨äºè·å–ç”¨æˆ·é…ç½®loaderæ—¶ä¼ å…¥çš„å‚æ•°
const markdownLoader = (source) =&gt; &#123;
    const options = utils.getOptions(this);
    const html = marked(source , options);
    return  `module.exports = $&#123;JSON.stringify(html)&#125;`;
&#125;
module.exports = markdownLoader;
</code></pre>
<p>é…ç½®ï¼š</p>
<pre><code class="js">const path = require(&#39;path&#39;)
module.exports = &#123;
    entry:&#39;./main.js&#39;,
    output:&#123;
        path:path.resolve(dirname,&#39;dist&#39;),
        filename:bundle.js&#39;,
    &#125;
&#125;,
module:&#123;
    rules:[
    &#123;
        test:/\.css$/,
        use: [
            &#123; loader:&#39;style-loader&#39; &#125;,   //å…ˆå†™çš„loaderåæ‰§è¡Œã€‚
            &#123; loader:&#39;css-loader&#39; &#125;
        ]
    &#125;,
    &#123;
        test:/\.md$/,
        use: [
            &#123; loader: &#39;./markdonwn-loader&#39;,options:&#123; headerIds:false &#125; &#125; //å…¶ä¸­optionsæ˜¯ç»™loaderå‡½æ•°ä¼ å…¥çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œloaderä¸­å¯ä»¥ä½¿ç”¨loader-utilså®˜æ–¹ä¸‰æ–¹åº“è¿›è¡Œæ¥å—
        ]
    &#125;]
  &#125;
&#125;
</code></pre>
<p><strong>å¤šä¸ªLoaderä¸²è”</strong><br>æœ€åçš„loaderæœ€æ—©è°ƒç”¨ï¼Œå°†ä¼šä¼ å…¥åŸå§‹èµ„æºå†…å®¹ã€‚<br>ç¬¬ä¸€ä¸ªloaderæœ€åè°ƒç”¨ï¼ŒæœŸæœ›å€¼æ˜¯ä¼ å‡ºJavaScriptå’Œsource map(å¯é€‰)ã€‚<br>ä¸­é—´çš„loaderæ‰§è¡Œæ—¶ï¼Œä¼šä¼ å…¥å‰ä¸€ä¸ªloaderä¼ å‡ºçš„ç»“æœã€‚<br><strong>å°†markdownè½¬æ¢ä¸ºhtml:turndown</strong><br>åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIub20vZG9tY2hyaXN0aWUvdHVybmRvd24=">https://github.om/domchristie/turndown</span></p>
<h3 id="plugins"><a href="#plugins" class="headerlink" title="plugins:"></a><strong>plugins:</strong></h3><p><span class="exturl" data-url="aHR0cHM6Ly93ZWJwYWNrLmRvY3NjaGluYS5vcmcvY29uY2VwdHMvcGx1Z2lucy8=">https://webpack.docschina.org/concepts/plugins/</span><br>æ’ä»¶æ˜¯webpackçš„æ”¯æŸ±åŠŸèƒ½ã€‚webpackè‡ªèº«ä¹Ÿæ˜¯æ„å»ºå¼€ä½ åœ¨webpacké…ç½®ä¸­ç”¨åˆ°çš„ç›¸åŒçš„æ’ä»¶ç³»ç»Ÿä¹‹ä¸Šï¼æ’ä»¶ç›®çš„åœ¨äºè§£å†³loaderæ— æ³•å®ç°çš„å…¶ä»–äº‹ã€‚(æˆ‘è‡ªå·±çš„ç†è§£ï¼Œloaderè§£å†³çš„æ˜¯å„ç§ä¸åŒèµ„æºçš„é—®é¢˜ï¼Œpluginsæ›´å¤šè§£å†³çš„æ˜¯é¡¹ç›®æ•´ä½“çš„äº‹æƒ…)</p>
<pre><code class="json">const path = require(&#39;path&#39;);
const HtmlWebpackPlugin = require(&#39;html-webpack-plugin&#39;);
module.exports = &#123;
    entry:&#39;./main.js&#39;,
    output:&#123;
        path:path.resolve(dirname,&#39;dist&#39;),
        filename:bundle.js&#39;,
    &#125;
&#125;,
module:&#123;
    rules:[
    &#123;
        test:/å…«.css$/,
        use: [
            loader:&#39;style-loader&#39;&#125;,   //å…ˆå†™çš„loaderåæ‰§è¡Œã€‚
            loader:&#39;css-loader&#39;&#125;
        ]
    &#125;]
  &#125;,
plugins:[
    new BundlesizeWebpackPlugin( &#123; sizeLimit:3 &#125; )  //è‡ªå·±æ‰‹å†™çš„æ’ä»¶ï¼ˆå¦‚ä¸‹ï¼‰
    new webpack.ProgressPlugin(), //æ˜¾ç¤ºæ‰“åŒ…è¿‡ç¨‹ï¼ˆwebpackå†…ç½®æ’ä»¶ï¼‰
    new HtmlwebpackPlugin(),
]
&#125;
</code></pre>
<h6 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h6><p><strong>webpackä¸­pluginsåŸç†ï¼š</strong></p>
<p>webpackæ‰§è¡Œæ—¶ä¼šå°†pluginså­—æ®µä¸­çš„æ’ä»¶å®ä¾‹å–å‡ºå¹¶å°†webpackå®ä¾‹ä¼ å…¥å¹¶æ‰§è¡Œå…¶<strong>applyæ–¹æ³•</strong>ï¼Œé€šè¿‡webpackå®ä¾‹çš„hooksä¸­çš„æ–¹æ³•æˆ‘ä»¬å¯ä»¥æ“æ§å¯¹åº”çš„é’©å­å‡½æ•°ã€‚</p>
<p>å®˜æ–¹çš„æ•™ç¨‹ï¼š<span class="exturl" data-url="aHR0cHM6Ly93ZWJwYWNrLmpzLm9yZy9jb250cmlidXRlL3dyaXRpbmctYS1wbHVnaW4v">https://webpack.js.org/contribute/writing-a-plugin/</span><br><strong>æ’ä»¶çš„æ ¼å¼</strong><br>ä¸€ä¸ªJavaScriptå‡½æ•°æˆ–JavaScriptç±»<br>åœ¨å®ƒåŸå‹ä¸Šå®šä¹‰çš„applyæ–¹æ³•ï¼Œä¼šåœ¨å®‰è£…æ’ä»¶æ—¶è¢«è°ƒç”¨ï¼Œå¹¶è¢«webpack compilerè°ƒç”¨ä¸€æ¬¡<br>æŒ‡å®šä¸€ä¸ªè§¦åŠåˆ°webpackæœ¬èº«çš„äº‹ä»¶é’©å­ï¼Œå³hooks,ç”¨äºç‰¹å®šæ—¶æœºå¤„ç†é¢å¤–çš„é€»è¾‘<br>Compiler Hooksåˆ—è¡¨<br><span class="exturl" data-url="aHR0cHM6Ly93ZWJwYWNrLmlzLm9yZy9hcGkvY29tcGlsZXItaG9va3Mv">https://webpack.is.org/api/compiler-hooks/</span></p>
<pre><code class="js">//æ‰‹å†™ä¸€ä¸ªwebpackæ’ä»¶ï¼Œæ‰“åŒ…æ–‡ä»¶è¶…å‡ºé™åˆ¶æ—¶ï¼ŒæŠ¥é”™ã€‚
const &#123; resolve &#125; = require(&#39;path&#39;);
const &#123; statSync &#125; = require(&#39;fs&#39;); //fsæ¨¡å—ä¸­åŒæ­¥è¯»å–æ–‡ä»¶ä¿¡æ¯
class BundlesizeWebpackPlugin &#123;
    constructor(options) &#123;
        this.options = options;
    &#125;
    apply(compiler) &#123;
        //è·å–åˆ°ä¼ å…¥çš„å‚æ•°
        const &#123; sizeLimit &#125; = this.options;
        compiler.hooks.compile.tap(&#39;BundleSizePlugin&#39;,(compilationParams)=&gt;&#123; //ç¼–è¯‘æ—¶é’©å­,å‚æ•°æ˜¯å‚æ•°
            console.log(&#39;compileé˜¶æ®µ&#39;,compilationParams);
        &#125;)
        compiler.hooks.done.tap(&#39;BundleSizePlugin&#39;,(stats)=&gt;&#123; //ç»“æŸæ—¶é’©å­ï¼Œå‚æ•°æ˜¯æ‰“åŒ…åçš„ä¿¡æ¯ã€‚
            console.log(&#39;done&#39;,stats); 
            //æ‹¿åˆ°æ‰“åŒ…åæ–‡ä»¶çš„è·¯å¾„å’Œæ–‡ä»¶å
            const &#123; path , filename &#125; = stats.compilation.outputOptions;
            //æ‹¼æ¥æˆæ–‡ä»¶è·¯å¾„
            const bundlePath = resolve(path,filename);
            //è·å–åˆ°æ–‡ä»¶size
            const &#123; size &#125; = statSync(bundlePath);
            const bundleSize = size / 1024;
            if(bundleSize &lt; sizeLimit) &#123;
                console.log(&#39;Safe:Bundle-Size&#39;,bundleSize,&#39;\n Size Limit:&#39;,sizeLimit);
            &#125;else&#123;
                console.error(&#39;Unsafe:Bundle-Size&#39;,bundleSize,&#39;\n Size Limit:&#39;,sizeLimit);
            &#125;
        &#125;) 
    &#125;
&#125;
module.exports = BundlesizeWebpackPlugin;
</code></pre>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><strong>Loaderså…³æ³¨ä»£ç ä¸­çš„å•ä¸ªèµ„æºï¼ŒPluginså…³æ³¨æ•´ä½“æµç¨‹ï¼Œå¯ä»¥æ¥è§¦åˆ°webpackæ„å»ºæµç¨‹ä¸­çš„<br>å„ä¸ªé˜¶æ®µå¹¶åŠ«æŒåšä¸€äº›ä»£ç å¤„ç†ã€‚</strong></p>
<h1 id="nodeåç«¯æ¡†æ¶"><a href="#nodeåç«¯æ¡†æ¶" class="headerlink" title="nodeåç«¯æ¡†æ¶"></a>nodeåç«¯æ¡†æ¶</h1><h2 id="Node-jsåç«¯æ¡†æ¶è°ƒç ”"><a href="#Node-jsåç«¯æ¡†æ¶è°ƒç ”" class="headerlink" title="Node.jsåç«¯æ¡†æ¶è°ƒç ”"></a>Node.jsåç«¯æ¡†æ¶è°ƒç ”</h2><p><strong>åç«¯æ¡†æ¶åº”è¯¥æ³¨æ„çš„ä¸‰å¤§é—®é¢˜</strong><br>è·¯ç”±Routes<br>è¯·æ±‚Request<br>å“åº”Response</p>
<h4 id="Express"><a href="#Express" class="headerlink" title="Express"></a>Express</h4><p>å®˜æ–¹ç½‘å€ï¼š[https:l&#x2F;expressis.com(https:expressis.com)<br>**å®‰è£…**<br>å®˜æ–¹ç½‘å€ï¼š[<span class="exturl" data-url="aHR0cHM6Ly9leHByZXNzaXMuY29tL3poLWNuL3N0YXJ0ZXIvaW5zdGFsbGluZy5odG1sXQ==">https://expressis.com/zh-cn/starter/installing.html]</span>(https:l&#x2F;expressjs.com&#x2F;zh-<br>cn&#x2F;starter&#x2F;installing.html)<br>ä½¿ç”¨ç”Ÿæˆå™¨å®‰è£…ï¼Œå¯ä»¥è‡ªåŠ¨ç”Ÿæˆä¸€ç³»åˆ—çš„è„šæ‰‹æ¶ä»£ç ï¼š[https:&#x2F;expressjs.com&#x2F;zh<br>cn&#x2F;starter&#x2F;generator.htmll(<span class="exturl" data-url="aHR0cHM6Ly9leHByZXNzaXMuY29tL3poLWNuL3N0YXJ0ZXIvZ2VuZXJhdG9yLmh0bWw=">https://expressis.com/zh-cn/starter/generator.html</span>)</p>
<p><strong>ä¼˜ç‚¹</strong></p>
<p>å¿«é€Ÿç®€å•ã€æ˜“ä¸Šæ‰‹</p>
<p><strong>ç¼ºç‚¹</strong></p>
<ul>
<li>è·¯ç”±å“åº”ä¸­ï¼Œå¾ˆå¯èƒ½æœ‰ï¼šä»å¤–éƒ¨è¯·æ±‚æ•°æ®çš„æœåŠ¡ï¼Œæœ‰éªŒè¯è·¯ç”±çš„è¯·æ±‚å‚æ•°ï¼Œè¿”å›ç‰¹å®šçš„æ ¼å¼ã€‚</li>
<li>æ‰€æœ‰é€»è¾‘ä¸åˆ†é’çº¢çš‚ç™½çš„å†™åœ¨ä¸€èµ·ï¼å¾ˆå®¹æ˜“äº§ç”Ÿå†—é•¿çš„éš¾ä»¥ç»´æŠ¤çš„ä»£ç ã€‚</li>
<li>ä¸€äº›å¤§å‹å¿…å¤‡çš„æ¨¡å—ï¼Œå¦‚ç¬¬ä¸‰æ–¹æœåŠ¡åˆå§‹åŒ–ï¼Œå®‰å…¨ï¼Œæ—¥å¿—éƒ½æ²¡æœ‰æ˜ç¡®çš„æ ‡å‡†ã€‚</li>
</ul>
<p><strong>Expressä¸­é—´ä»¶ï¼š</strong></p>
<p>Expressæ˜¯ä¸€ä¸ªåŸºäºä¸­é—´ä»¶çš„æ¡†æ¶ï¼Œå…¶ä½™ä»»åŠ¡éƒ½ä¼šåœ¨ä¸­é—´ä»¶ä¸­æ‰§è¡Œï¼Œä¸­é—´ä»¶æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ç»“æ„ï¼Œå…ˆå†™å…¥çš„ä»»åŠ¡å…ˆæ‰§è¡Œ,ä¸­é—´ä»¶çš„å†™æ³•æ˜¯ï¼šapp.use()ï¼Œå½“è°ƒç”¨ä¸­é—´ä»¶æ—¶ï¼Œä¼šå‘ä¼ å…¥çš„å‡½æ•°ä¸­ä¼ å…¥req,reså’Œnextå‡½æ•°ã€‚</p>
<p><strong>ä¸­é—´ä»¶å¯ä»¥å®Œæˆçš„ä»»åŠ¡</strong></p>
<ul>
<li>æ‰§è¡Œä»»ä½•ä»£ç ã€‚</li>
<li>å¯¹è¯·æ±‚å’Œå“åº”å¯¹è±¡è¿›è¡Œæ›´æ”¹ã€‚</li>
<li>ç»“æŸè¯·æ±‚&#x2F;å“åº”å¾ªç¯ã€‚</li>
<li>è°ƒç”¨å †æ ˆä¸­çš„ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ã€‚</li>
</ul>
<h4 id="Koa2"><a href="#Koa2" class="headerlink" title="Koa2"></a>Koa2</h4><p><strong>å®˜ç½‘åœ°å€</strong>ï¼š[https:I&#x2F;koajs.com(https:&#x2F;koajs.com)</p>
<p><strong>Koa2å’ŒExpressçš„åŒºåˆ«</strong></p>
<ul>
<li>ä½¿ç”¨Promise(async,await)ä»£æ›¿callback (node&gt;v7.6.0)</li>
<li>ä½¿ç”¨ctx(ä¸Šä¸‹æ–‡å¯¹è±¡)å°è£…req(Request)å’Œres(Response),ä»¥åŠä¸€äº›å¸¸ç”¨çš„åŠŸèƒ½ã€‚</li>
<li><strong>å®Œå…¨ä¸åŒçš„ä¸­é—´ä»¶æœºåˆ¶</strong></li>
<li><strong>æ›´è½»é‡çº§ï¼Œæ²¡æœ‰æ†ç»‘ä»»ä½•ä¸­é—´ä»¶</strong></li>
<li>å®˜æ–¹æ–‡ç« ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tvYWpzL2tvYS9ibG9iL21hc3Rlci9kb2NzL2tvYS12cy1leHByZXNzLm1k">https://github.com/koajs/koa/blob/naster/docs/koa-vs-express.md</span></li>
</ul>
<p><strong>Koa2ä¸­é—´ä»¶ï¼š</strong></p>
<ol>
<li>Koa2ä¸­é—´ä»¶ï¼Œç”±Expressçš„é˜Ÿåˆ—æ¨¡å‹ï¼ˆåŒæ­¥ï¼‰è½¬å˜ä¸ºæ´‹è‘±æ¨¡å‹ï¼Œå½“ç¨‹åºè¿è¡Œåˆ°<code>await next()</code>çš„æ—¶å€™å°±ä¼šæš‚åœå½“å‰ç¨‹åºï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ï¼Œå¤„ç†å®Œä¹‹åæ‰ä¼šä»”å›è¿‡å¤´æ¥ç»§ç»­å¤„ç†ã€‚</li>
<li>Koa2æ´‹è‘±æ¨¡å‹è§£å†³çš„é—®é¢˜å°±æ˜¯ä¸€ä¸ªä¸­é—´ä»¶å¯ä»¥è°ƒç”¨å…¶ä»–ä¸­é—´ä»¶æ‰§è¡Œåï¼Œå†ç»§ç»­è‡ªå·±çš„æ“ä½œï¼ŒExpressæ¡†æ¶ä¸­next()æ‰§è¡Œåå°±ç›´æ¥åˆ°ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æ“ä½œï¼Œæ— æ³•é€€å›ã€‚</li>
</ol>
<p><img data-src="/images/Snipaste_2024-04-22_14-30-49.jpg" alt="Koa2ä¸­é—´ä»¶"></p>
<p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="js">const Koa = require(&#39;koa&#39;);
const app = new Koa();
const PORT = 3000;
app.use(async (ctx, next)=&gt;&#123;
    console.log(1)
    await next();
    console.log(1)
&#125;);
app.use(async (ctx, next) =&gt; &#123;
    console.log(2)
    await next();
    console.log(2)
&#125;)
app.use(async (ctx, next) =&gt; &#123;
    console.log(3)
&#125;)
app.listen(PORT);
console.log(`http://localhost:$&#123;PORT&#125;`);
</code></pre>
<p><strong>Koa2ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å“åº”æœºåˆ¶çš„ä¸åŒ</li>
<li>Express:æˆ‘ä»¬ç›´æ¥æ“ä½œçš„æ˜¯reså¯¹è±¡ï¼Œç›´æ¥res.sendä¹‹åå°±ç«‹å³å“åº”äº†ã€‚</li>
<li>Koa2:æ•°æ®çš„å“åº”æ˜¯é€šè¿‡ctx.bodyè¿›è¡Œè®¾ç½®ï¼Œæ³¨æ„è¿™é‡Œä»…æ˜¯è®¾ç½®å¹¶æ²¡æœ‰ç«‹å³å“åº”ï¼Œè€Œæ˜¯åœ¨æ‰€æœ‰çš„ä¸­é—´ä»¶ç»“æŸä¹‹ååšäº†å“åº”ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong>Koa2åœ¨ä½¿ç”¨ä¸Šæœ‰ä¸€å®šçš„ç¼ºç‚¹ï¼Œå› ä¸ºå¤ªè¿‡äºè½»é‡ä½¿å¾—åœ¨ä½¿ç”¨æ—¶éœ€è¦æ‰‹åŠ¨å¤„ç†å¾ˆå¤šæ“ä½œï¼Œå¯ä»¥ä½¿ç”¨åŸºäºKoa2çš„ä¸Šå±‚æ¡†æ¶ï¼ˆå¦‚ï¼šegg.jsï¼‰</p>
<h4 id="egg-js"><a href="#egg-js" class="headerlink" title="egg.js"></a>egg.js</h4><p><strong>Expresså’ŒKoa2çš„ä¸è¶³</strong></p>
<ul>
<li>ç®€å•è€Œä¸”æ‰©å±•æ€§å¼ºï¼Œé€‚åˆä¸ªäººçš„æ¯”è¾ƒå°çš„é¡¹ç›®</li>
<li>æ²¡æœ‰çº¦å®šï¼Œå¯¹äºç»Ÿä¸€ç»´æŠ¤å’Œå¼€å‘éå¸¸ä¸åˆ©</li>
</ul>
<p><strong>å¯¹äºåç«¯æ¡†æ¶çš„éœ€æ±‚</strong></p>
<ul>
<li>éœ€è¦æœ‰ä¸€å¥—ä¼˜ç§€çš„ç»Ÿä¸€çš„çº¦å®šæˆ–è€…æ¶æ„è¿›è¡Œå¼€å‘</li>
<li>æœ‰ä¸°å¯Œçš„æ‰©å±•æœºåˆ¶å’Œå¯å®šåˆ¶æ€§</li>
<li>Typescriptæ”¯æŒ</li>
</ul>
<p><strong>egg.js</strong></p>
<ul>
<li>åœ°å€ï¼š[https:l&#x2F;eggis.org&#x2F;zh-cnI(https:l&#x2F;eggjs.org&#x2F;zh-cn) ï¼ˆåŸºäºKoa2ï¼‰</li>
<li>é˜¿é‡Œå¤§å‚å‡ºå“ï¼Œç»´æŠ¤æœ‰ä¿éšœã€‚å›½å†…å¼€å‘è€…å¼€å‘ï¼Œä¸­æ–‡æ–‡æ¡£è´¨é‡æœ‰ä¿è¯ã€‚</li>
<li><strong>çº¦å®šä¼˜äºé…ç½®ï¼ŒæŒ‰ç…§ä¸€å¥—ç»Ÿä¸€çš„çº¦å®šè¿›è¡Œåº”ç”¨å¼€å‘ã€‚</strong></li>
<li>ä¸€ä¸ªæ’ä»¶åªåšä¸€ä»¶äº‹ï¼Œé«˜åº¦å¯æ‰©å±•çš„æ’ä»¶æœºåˆ¶</li>
<li>æ”¯æŒTypescript</li>
</ul>
<pre><code class="bash">//nodejsç‰ˆæœ¬10ä»¥ä¸Š
npm init egg --type=ts
npm install
npm run dev
</code></pre>
<p><strong>egg.jsæ¦‚å¿µï¼š</strong></p>
<ul>
<li><p>Application-å…¨å±€åº”ç”¨å¯¹è±¡ï¼Œåªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚</p>
</li>
<li><p>Context-ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œæ¯æ¬¡è¯·æ±‚ç”Ÿæˆä¸€ä¸ªå®ä¾‹ã€‚</p>
</li>
<li><p>Request-è¯·æ±‚å¯¹è±¡ï¼Œæ¥è‡ªKoaã€‚</p>
</li>
<li><p>Response-å“åº”å¯¹è±¡ï¼Œæ¥è‡ªKoaçš„ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚</p>
</li>
<li><p>Helper-ç”¨æ¥æä¾›ä¸€äº›å®ç”¨çš„utilityå‡½æ•°ã€‚æ¡†æ¶å†…ç½®äº†å‡ ä¸ªç®€å•çš„Helperå‡½æ•°ã€‚</p>
</li>
</ul>
<h4 id="Nest-js"><a href="#Nest-js" class="headerlink" title="Nest.js"></a>Nest.js</h4><ul>
<li>åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm5lc3Rqcy5jbi8=">https:&#x2F;docs.nestjs.com</span></li>
<li>å†…ç½®å¹¶ä¸”å®Œå…¨æ”¯æŒTypescript</li>
<li>å¼€ç®±å³ç”¨çš„åº”ç”¨ç¨‹åºæ¶æ„</li>
<li>å¯æ‰©å±•ï¼Œæ¾æ•£è€¦åˆ</li>
<li>å¤§é‡é‡‡ç”¨äº†è£…é¥°å™¨çš„å†™æ³• <span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm5lc3Rqcy5jbi8xMC9vcGVuYXBpP2lkPSVFOCVBMyU4NSVFOSVBNSVCMCVFNSU5OSVBOA==">Nest.jsè£…é¥°å™¨</span></li>
</ul>
<h1 id="vue-config-js"><a href="#vue-config-js" class="headerlink" title="vue.config.js"></a>vue.config.js</h1><p><strong>ä¸ªæ€§åŒ–æ„å»ºç»“æœ-vue.config,js</strong><br>åœ¨åŸºç¡€çš„é…ç½®ä¸Šï¼Œè‡ªå®šä¹‰æ„å»ºçš„ç»“æœ-å¯ä»¥ä½¿ç”¨vue.config.js<br>æ–‡æ¡£åœ°å€ï¼šhttps:l&#x2F;cli.vuejs.org&#x2F;zh&#x2F;config#vue-config-js<br>ç®€ä»‹ä¸¤ä¸ªå­—æ®µ<br>*<strong>PublicPath</strong>-éƒ¨ç½²åº”ç”¨åŒ…æ—¶çš„åŸºæœ¬URL,è¿™ä¸ªé…ç½®å¯¹åº”çš„æ˜¯webpackçš„PublicPathå±æ€§<br>â˜…<br>é»˜è®¤å€¼ä¸ºâ€™&#x2F;â€˜ï¼ŒVue CLIä¼šå‡è®¾ä½ çš„åº”ç”¨æ˜¯è¢«éƒ¨ç½²åœ¨ä¸€ä¸ªåŸŸåçš„æ ¹è·¯å¾„ä¸Š<br><span class="exturl" data-url="aHR0cHM6Ly9hYmMuY29tLw==">https://abc.com/</span><br>â˜…<br>å¯ä»¥è®¾ç½®ä¸ºå­è·¯å¾„-å¦‚æœä½ çš„åº”ç”¨è¢«éƒ¨ç½²åœ¨https:abc,com&#x2F;sub&#x2F;é‚£ä¹ˆå°±è®¾ç½®ä¸ºâ€™&#x2F;subâ€™<br>*å¯ä»¥è®¾ç½®ä¸ºCDNè·¯å¾„-åœ¨æˆ‘ä»¬çš„åº”ç”¨ä¸­ï¼Œæœ€åé™æ€èµ„æºæ˜¯è¦å…¨éƒ¨ä¸Šä¼ åˆ°CDNçš„ï¼Œï¼ˆè„šæ‰‹<br>æ¶è‡ªåŠ¨å®Œæˆ)ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥è®¾ç½®ä¸ºä¸€ä¸ªcDNåŸŸå-â€˜https:l&#x2F;oss.imooc-Iego.com&#x2F;editorâ€™<br>*è¿˜å¯ä»¥è®¾ç½®ä¸ºç»å¯¹è·¯å¾„(â€˜â€™æˆ–è€…â€™.&#x2F;â€˜)ï¼Œè¿™æ ·æ‰€æœ‰çš„èµ„æºéƒ½ä¼šè¢«é“¾æ¥ä¸ºç›¸å¯¹è·¯å¾„</p>
<p><strong>css.loaderOptions</strong>å±æ€§<br>*å‘CSSç›¸å…³çš„loaderä¼ é€’é€‰é¡¹<br>*Ant-design-vueçš„æ ·å¼å˜é‡ï¼šhttps:lww,antd,com docs&#x2F;vue&#x2F;customize-theme-cn<br><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Z1ZUNvbXBvbmVudC9hbnQtZGVzaWduLQ==">https://github.com/vueComponent/ant-design-</span><br>yue&#x2F;blob&#x2F;master&#x2F;components&#x2F;style&#x2F;themes&#x2F;default.less<br>*æ·»åŠ æ›´å¤šçš„CSSé¢„å¤„ç†å™¨ï¼š<br><span class="exturl" data-url="aHR0cHM6Ly9jbGkudnVlanMub3JnL3poL2d1aWRlL2Nzcy5odG1sIyVFOSVBMiU4NCVFNSVBNCU4NCVFNyU5MCU4NiVFNSU5OSVBOA==">https://cli.vuejs.org/zh/guide/css.html#%E9%A2%84%E5%A4%84%E7%90%86%E5%99%A8</span><br>*ç‰¹åˆ«æ³¨æ„lesså’ŒIess-loaderçš„ç‰ˆæœ¬é—®é¢˜ã€‚ä¸è¦è£…æœ€æ–°çš„ï¼Œå»ºè®®é€‰ç”¨ï¼š</p>
<pre><code class="js">//vue.config.jsé…ç½®ï¼š
const isstaging = !process.env.VUE_APP_STAGINE
const isProduction = process.env.NODE_ENV &#39;production&#39;
module.exports = &#123;
    /ç”Ÿäº§ç¯å¢ƒè¦ä½¿ç”¨0SSåœ°å€
    /å…¶ä»–ç¯å¢ƒéƒ½ä½¿ç”¨ç»å¯¹è·¯å¾„
    publicPath:(isProduction 6 !isStaging)&#39;https://oss.imooc-lego.com/
    css:&#123;
        loaderOptions:&#123;
        less:&#123;
            lessoptions:&#123;
                modifyVars:&#123;
                   &#39;primary-color&#39;:&#39;#3E7FFF&#39;,
                &#125;ï¼Œ
                javascriptEnabled:true
            &#125;
        &#125;,
    configureWebpack: config =&gt; &#123;
        config.plugins.push(
            new webpack.IgnorePlugin(&#123;        //æ‰“åŒ…æ—¶å¿½ç•¥å¯¹åº”çš„æ–‡ä»¶
                resourceRegExp: /^\.\/locale$/,
                contextRegExp: /moment$/,
            &#125;)
        )
        if(isAnalyzeMode)&#123;
            config.plugins.push(
                new BundleAnalyzerPlugin(&#123;    //æ·»åŠ æ‰“åŒ…åçš„æ–‡ä»¶åˆ†æå·¥å…·ï¼ˆBundleAnalyzerPluginï¼‰
                    analyzerMode : &#39;static&#39;,
                &#125;)
            )
        &#125;
    &#125;
    &#125;
</code></pre>
<h1 id="é¡¹ç›®æ„å»ºä¼˜åŒ–"><a href="#é¡¹ç›®æ„å»ºä¼˜åŒ–" class="headerlink" title="é¡¹ç›®æ„å»ºä¼˜åŒ–"></a>é¡¹ç›®æ„å»ºä¼˜åŒ–</h1><p><strong>å¥½ç”¨çš„webpackæ’ä»¶:webpack-bundle-analyzer</strong></p>
<p>å¯è§†åŒ–webpackæ‰“åŒ…åçš„å·¥å…·åŒ…å¤§å°ï¼Œä¾¿äºåˆ†æä¾èµ–å’Œè¿›è¡Œé¡¹ç›®ä¼˜åŒ–ã€‚å¦‚ä¸Švue.config.jsä¸­é…ç½®ã€‚</p>
<p><strong>æ ¹æ®å›¾è¡¨çš„ä¼˜åŒ–æ­¥éª¤</strong></p>
<p>ä¸€ã€çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆé‡å¤çš„æ¨¡å—ï¼Œæˆ–è€…æ²¡æœ‰ç”¨çš„æ¨¡å—è¢«æ‰“åŒ…åˆ°äº†æœ€ç»ˆçš„ä»£ç ä¸­<br>äºŒã€çœ‹çœ‹package.json,å¯¹æ¯”ä¸€ä¸‹æ˜¯å¦æœ‰åº”è¯¥åœ¨devDepsçš„æ¨¡å—ï¼Œè¢«é”™è¯¯çš„æ”¾ç½®åˆ°äº†depså½“ä¸­<br>ä¸‰ã€æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤åŠ è½½çš„æ¨¡å—ï¼Œæˆ–è€…æ˜¯åŠŸèƒ½å¤§ä½“ç›¸åŒçš„æ¨¡å—ã€‚<br>æ¯”å¦‚ï¼šä½¿ç”¨<strong>es</strong>ç‰ˆæœ¬çš„ç¬¬ä¸‰æ–¹åº“ï¼Œäº«å—tree-shakingçš„çº¢åˆ©ã€‚<br>å››ã€æ£€æŸ¥æ˜¯å¦æœ‰æ²¡æœ‰ç”¨çš„æ¨¡å—æ˜¯å¦æ‰“åŒ…åˆ°äº†æœ€ç»ˆçš„æ–‡ä»¶ä¸­ï¼Œé€šè¿‡å¦‚ä¸‹æ’ä»¶å¿½ç•¥å¯¹åº”çš„æ–‡ä»¶ï¼Œä»è€Œtree-shakingæ‰å¿½ç•¥çš„æ–‡ä»¶ï¼ˆå¦‚å›½é™…åŒ–éœ€è¦çš„å„ç§è¯­è¨€åŒ…ï¼‰,è¯¦ç»†é…ç½®å¦‚ä¸Švue.config.jsä¸­ã€‚</p>
<p>*webpack ignore plugin <span class="exturl" data-url="aHR0cHM6Ly93ZWJwYWNrLmpzLm9yZ2xwbHVnaW5zL2lnbm9yZS1wbHVnaW4vI3Jvb3Q=">https://webpack.js.orglplugins/ignore-plugin/#root</span></p>
<p><strong>å°†ä¸‰æ–¹åº“ä¸­å…¨éƒ¨å¯¼å…¥æ›´æ¢ä¸ºæŒ‰éœ€å¯¼å…¥</strong></p>
<pre><code class="js">import &#123;Input,Dropdown,Slider,Select&#125; from &#39;Antd-vue&#39;;
const components = [Input,Dropdown,Slider,Select];
const install = (app) =&gt; &#123;
    components.forEach(item=&gt;&#123;
        app.component(item.name,item);
    &#125;)
&#125;
export default&#123; install &#125;;
// åœ¨main.jsä¸­å¯¼å…¥ï¼Œç„¶åapp.use
</code></pre>
<p><strong>æµè§ˆå™¨ç¼“å­˜ä¼˜åŒ–</strong></p>
<p>ä¸€ã€é¡¹ç›®å³ä½¿æ˜¯ä¸Šçº¿ä¹‹åä¹Ÿä¼šåœ¨åç»­è¿½åŠ æˆ–ä¿®æ”¹ä»£ç ï¼Œå¦‚æœåˆ†åŒ…è¾ƒå°‘é‡æ–°ä¸Šçº¿åå°±ä¸èƒ½ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜çš„æ–‡ä»¶ï¼Œå½“åˆ†åŒ…æ•°é‡è¾ƒå¤šæ—¶ï¼Œå°±å¯ä»¥å……åˆ†åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜ã€‚</p>
<p>äºŒã€åˆ†åŒ…è¾ƒå¤šæ—¶å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ”¯æŒå¹³è¡ŒåŠ è½½å¤šä¸ªæ–‡ä»¶çš„ç‰¹æ€§ã€‚ï¼ˆHTTP1å¯¹åŒä¸€åŸŸåå¹¶è¡Œè¯·æ±‚çš„ä¸ªæ•°è¿›è¡Œäº†é™åˆ¶ï¼ŒHTTP2å®Œå…¨çªç ´äº†è¿™ä¸ªé™åˆ¶ï¼‰</p>
<p><strong>æ‰‹åŠ¨åˆ†å‰²ç¬¬ä¸‰æ–¹åº“ä¸ºå¤šä¸ªæ–‡ä»¶</strong></p>
<p>webpackçš„config.optimizationä¸­è‡ªå¸¦ä¸€äº›ä¼˜åŒ–çš„é…ç½®é¡¹ï¼š</p>
<ul>
<li>minimizeï¼šå‹ç¼©</li>
<li>splitChunksï¼šåˆ†åŒ…ï¼ˆå¯ä»¥é…ç½®minSizeç­‰ï¼‰</li>
<li>ç­‰ç­‰</li>
</ul>
<pre><code class="js">//vue.config.jsé…ç½®ï¼š
module.exports = &#123;
    // ....çœç•¥
    configureWebpack: config =&gt; &#123;
        config.optimization.splitChunks = &#123;
            maxInitialRequests: Infinity,
            minSize: 300 * 1024,
            chunks: &#39;all&#39;,
            cacheGroups: &#123;
                antVendor: &#123;
                    name: &#39;ant-design-vue&#39;,
                    test: /[\\/]node_modules[\\/](ant-design-vue)[\\/]/,
                &#125;,
                canvasVendor: &#123;
                    name: &#39;html2canvas,
                    test: /[\\/]node_modules[\\/](html2canvas)[\\/]/,
                &#125;,
                vendor: &#123;
                    name: &#39;vendor&#39;,
                    test: /[\\/]node_modules[\\/](!html2canvas)(!ant-design-vue)[\\/]/
                &#125;,
                all &#123;
                    test: /[\\/]node_modules[\\/]/, //åŒ¹é…å…¨éƒ¨çš„node_modulesä¸­çš„æ–‡ä»¶
                    name (module) &#123; const packageName = module.context.match(/[\\/]node_modules[\\/](.*?)([\\/]|$)/)
                    return `npm.$&#123;packageName.replace(&#39;@&#39;,&#39;&#39;)&#125;`
                &#125;,
            &#125;
        &#125;
    &#125;
&#125;
</code></pre>
<h1 id="é¡¹ç›®è¿è¡Œä¼˜åŒ–"><a href="#é¡¹ç›®è¿è¡Œä¼˜åŒ–" class="headerlink" title="é¡¹ç›®è¿è¡Œä¼˜åŒ–"></a>é¡¹ç›®è¿è¡Œä¼˜åŒ–</h1><p><strong>è·¯ç”±æ‡’åŠ è½½</strong></p>
<p>ä½¿ç”¨importå‡½æ•°åŠ¨æ€åŠ è½½ï¼Œé…åˆé­”æ³•æ³¨é‡Šå¯ä»¥å’Œwebpackä¸­çš„bundlerç›¸é…åˆä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="js">import(/* webpackChunkName: &quot;my-lodash&quot; */ &#39;lodash&#39;).then(lodash=&gt;&#123;
     // ....
&#125;)
</code></pre>
<p><strong>æ”¹å˜HTMLæ ‡é¢˜ï¼Œå¢å¼ºSEO</strong></p>
<p>é¡¹ç›®ä¸­åŠ¨æ€æ·»åŠ æ ‡é¢˜çš„åŸç†ï¼šä½¿ç”¨HtmlWebpackPluginæ’ä»¶ï¼Œæ’å…¥åŠ¨æ€jsè¯­å¥è¿›è¡Œå ä½ï¼Œç„¶åé€šè¿‡é¡¹ç›®ä¸­package.jsonä¸­çš„nameè¿›è¡Œæ›¿æ¢ã€‚</p>
<pre><code class="js">//vue.config.jsé…ç½®ï¼š
module.exports = &#123;
    // ....çœç•¥
   chainWebpack: config =&gt; &#123;
       config.plugin(&#39;html&#39;).tap(args=&gt;&#123;
           args[0].title = &#39;ç½‘ç«™æ ‡é¢˜&#39;,
           args[0].desc = &#39;ç½‘ç«™è¯¦æƒ…æè¿°&#39;
           return args;
       &#125;)
   &#125;
&#125;
//è®°å¾—æ·»åŠ  &lt;meta name=&quot;viewport&quot; content=&quot;&lt;%= htmlWebpackPlugin.options.desc %&gt;&quot;&gt;
</code></pre>
<p><strong>åŒæ„æ¸²æŸ“æ–¹å¼</strong><br>æœåŠ¡ç«¯æ¸²æŸ“å’Œå®¢æˆ·ç«¯æ¸²æŸ“çš„åŒºåˆ«å°±åœ¨äºåœ¨å“ªé‡Œå®Œæˆhtmlå®Œæ•´æ–‡ä»¶çš„æ‹¼æ¥ï¼š</p>
<h3 id="å®¢æˆ·ç«¯æ¸²æŸ“"><a href="#å®¢æˆ·ç«¯æ¸²æŸ“" class="headerlink" title="å®¢æˆ·ç«¯æ¸²æŸ“"></a>å®¢æˆ·ç«¯æ¸²æŸ“</h3><p>å®¢æˆ·ç«¯æ¸²æŸ“ç”±å®¢æˆ·ç«¯å®Œæˆhtmlæ–‡ä»¶çš„æ‹¼æ¥ï¼ŒæœåŠ¡ç«¯åªè´Ÿè´£æä¾›æ•°æ®ã€‚<br>ä¼˜åŠ¿ï¼šé¦–å±åŠ è½½å¿«<br>åŠ£åŠ¿ï¼šä¸åˆ©äºSEO</p>
<h3 id="æœåŠ¡ç«¯æ¸²æŸ“"><a href="#æœåŠ¡ç«¯æ¸²æŸ“" class="headerlink" title="æœåŠ¡ç«¯æ¸²æŸ“"></a>æœåŠ¡ç«¯æ¸²æŸ“</h3><p>æœåŠ¡ç«¯æ¸²æŸ“ç”±æœåŠ¡ç«¯å®Œæˆhtmlæ–‡ä»¶çš„å‡­å€Ÿï¼Œå®¢æˆ·ç«¯ç›´æ¥æ¸²æŸ“å³å¯<br>ä¼˜åŠ¿ï¼šåˆ©äºSEOï¼Œ<br>åŠ£åŠ¿ï¼šç™½å±é—®é¢˜ï¼ˆè·å–htmlæ–‡ä»¶è¾ƒæ…¢ï¼‰,æœåŠ¡ç«¯å‹åŠ›å¤§ï¼Œå ç”¨CPUèµ„æºã€‚</p>
<h3 id="åŒæ„æ¸²æŸ“"><a href="#åŒæ„æ¸²æŸ“" class="headerlink" title="åŒæ„æ¸²æŸ“"></a>åŒæ„æ¸²æŸ“</h3><p>æœåŠ¡ç«¯å…ˆé€šè¿‡æœåŠ¡ç«¯æ¸²æŸ“ï¼Œç”Ÿæˆhtmlä»¥åŠåˆå§‹åŒ–æ•°æ®ï¼Œå®¢æˆ·ç«¯æ‹¿åˆ°ä»£ç å’Œåˆå§‹åŒ–æ•°æ®ï¼Œåœ¨å®¢æˆ·ç«¯è¿›è¡Œæ¿€æ´»æ¸²æŸ“ã€‚<br>ä¼˜åŠ¿ï¼šå…¼å®¹äº†å‰ç«¯æ¸²æŸ“çš„å¤§éƒ¨åˆ†ä¼˜ç‚¹ï¼ˆèŠ‚çœæœåŠ¡ç«¯èµ„æºã€å¤šç»ˆç«¯é€‚é…æ¸²æŸ“ã€å±€éƒ¨åˆ·æ–°ç­‰ï¼‰ï¼ŒåŒæ—¶ä¹Ÿå…·æœ‰æœåŠ¡ç«¯æ¸²æŸ“é¦–å±åŠ è½½å¿«ï¼ŒSEOæ”¯æŒå¥½çš„ç‰¹ç‚¹ã€‚<br>åŠ£åŠ¿ï¼šæœåŠ¡ç«¯å¿…é¡»æ˜¯è¦jsæ”¯æŒçš„è¯­è¨€ï¼Œå¢åŠ äº†æ•´ä¸ªç³»ç»Ÿçš„å¤æ‚åº¦å’Œç»´æŠ¤æˆæœ¬ã€‚</p>
<h3 id="SSGé¢„æ¸²æŸ“"><a href="#SSGé¢„æ¸²æŸ“" class="headerlink" title="SSGé¢„æ¸²æŸ“"></a>SSGé¢„æ¸²æŸ“</h3><p><strong>é™æ€ç«™ç‚¹ç”Ÿæˆ</strong> (Static-Site Generationï¼Œç¼©å†™ä¸º SSG)ï¼Œä¹Ÿè¢«ç§°ä¸ºé¢„æ¸²æŸ“ï¼Œæ˜¯å¦ä¸€ç§æµè¡Œçš„æ„å»ºå¿«é€Ÿç½‘ç«™çš„æŠ€æœ¯ã€‚å¦‚æœç”¨æœåŠ¡ç«¯æ¸²æŸ“ä¸€ä¸ªé¡µé¢æ‰€éœ€çš„æ•°æ®å¯¹æ¯ä¸ªç”¨æˆ·æ¥è¯´éƒ½æ˜¯ç›¸åŒçš„ï¼Œé‚£å°±å¯ä»¥åªæ¸²æŸ“ä¸€æ¬¡ï¼Œæå‰åœ¨æ„å»ºè¿‡ç¨‹ä¸­å®Œæˆï¼Œè€Œä¸æ˜¯æ¯æ¬¡è¯·æ±‚è¿›æ¥éƒ½é‡æ–°æ¸²æŸ“é¡µé¢ã€‚é¢„æ¸²æŸ“çš„é¡µé¢ç”Ÿæˆåä½œä¸ºé™æ€ HTML æ–‡ä»¶è¢«æœåŠ¡å™¨æ‰˜ç®¡ã€‚</p>
<p>SSG ä¿ç•™äº†å’Œ SSR åº”ç”¨ç›¸åŒçš„æ€§èƒ½è¡¨ç°ï¼šå®ƒå¸¦æ¥äº†ä¼˜ç§€çš„é¦–å±åŠ è½½æ€§èƒ½ã€‚åŒæ—¶ï¼Œå®ƒæ¯” SSR åº”ç”¨çš„èŠ±é”€æ›´å°ï¼Œä¹Ÿæ›´å®¹æ˜“éƒ¨ç½²ï¼Œå› ä¸ºå®ƒè¾“å‡ºçš„æ˜¯é™æ€ HTML å’Œèµ„æºæ–‡ä»¶ã€‚è¿™é‡Œçš„å…³é”®è¯æ˜¯<strong>é™æ€</strong>ï¼šSSG ä»…å¯ä»¥ç”¨äºæ¶ˆè´¹é™æ€æ•°æ®çš„é¡µé¢ï¼Œå³æ•°æ®åœ¨æ„å»ºæœŸé—´å°±æ˜¯å·²çŸ¥çš„ï¼Œå¹¶ä¸”åœ¨å¤šæ¬¡éƒ¨ç½²æœŸé—´ä¸ä¼šæ”¹å˜ã€‚æ¯å½“æ•°æ®å˜åŒ–æ—¶ï¼Œéƒ½éœ€è¦é‡æ–°éƒ¨ç½²ã€‚</p>
<p>å¦‚æœä½ è°ƒç ” SSR åªæ˜¯ä¸ºäº†ä¼˜åŒ–ä¸ºæ•°ä¸å¤šçš„è¥é”€é¡µé¢çš„ SEO (ä¾‹å¦‚ &#x2F;ã€&#x2F;about å’Œ &#x2F;contact ç­‰)ï¼Œé‚£ä¹ˆä½ å¯èƒ½éœ€è¦ SSG è€Œä¸æ˜¯ SSRã€‚SSG ä¹Ÿéå¸¸é€‚åˆæ„å»ºåŸºäºå†…å®¹çš„ç½‘ç«™ï¼Œæ¯”å¦‚æ–‡æ¡£ç«™ç‚¹æˆ–è€…åšå®¢ã€‚<span class="exturl" data-url="aHR0cHM6Ly9saW5rLmp1ZWppbi5jbi8/dGFyZ2V0PWh0dHBzOi8vdml0ZXByZXNzLmRldi8=">VitePress</span> å°±æ˜¯ä¸€ä¸ªç”± Vite å’Œ Vue é©±åŠ¨çš„é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ã€‚</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9saW5rLmp1ZWppbi5jbi8/dGFyZ2V0PWh0dHBzOi8vZ2l0aHViLmNvbS92aXRlanMvdml0ZS1wbHVnaW4tdnVlL2Jsb2IvbWFpbi9wbGF5Z3JvdW5kL3Nzci12dWUvcHJlcmVuZGVyLmpz">Viteè„šæ‰‹æ¶æ¸²æŸ“SSGä»£ç ç¤ºä¾‹</span>ã€‚</p>
<h1 id="éƒ¨ç½²ä¸HTTPä¼˜åŒ–"><a href="#éƒ¨ç½²ä¸HTTPä¼˜åŒ–" class="headerlink" title="éƒ¨ç½²ä¸HTTPä¼˜åŒ–"></a>éƒ¨ç½²ä¸HTTPä¼˜åŒ–</h1><h3 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a><strong>éƒ¨ç½²</strong></h3><p><strong>å‰ç«¯éƒ¨ç½²ï¼šhttps:llci,uejs,org&#x2F;zh&#x2F;guide&#x2F;deployment.html</strong></p>
<p>åŸç†å°±æ˜¯ï¼šå°†æ„å»ºç”Ÿæˆçš„äº§ç‰©ç›´æ¥çƒ¤è´åˆ°ä»»ä½•çš„é™æ€æ–‡ä»¶æœåŠ¡å™¨å½“ä¸­ã€‚</p>
<p><strong>åç«¯éƒ¨ç½²ï¼šhttps:&#x2F;eggis.org&#x2F;zh-cn&#x2F;core&#x2F;deployment.html</strong></p>
<p>å‡ ä¹æ²¡æœ‰æ„å»ºè¿‡ç¨‹ï¼šé™¤éä½ ç”¨äº†typescriptç­‰éœ€è¦ç¼–è¯‘çš„è¯­è¨€ã€‚</p>
<p>æ–¹æ¡ˆä¸€ï¼šç›´æ¥å°†æœ¬åœ°çš„æºä»£ç æ‰“ä¸ªå‹ç¼©åŒ…æ‹·è´åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œç„¶åå¯åŠ¨æœåŠ¡å™¨ã€‚</p>
<p>æ–¹æ¡ˆäºŒï¼šåœ¨æœåŠ¡å™¨ä¸­ç›´æ¥puå·æºä»£ç ï¼Œinstall,.ç„¶åå¯åŠ¨æœåŠ¡å™¨ã€‚</p>
<h3 id="Nginx-åå‘ä»£ç†"><a href="#Nginx-åå‘ä»£ç†" class="headerlink" title="Nginx:åå‘ä»£ç†"></a><strong>Nginx:åå‘ä»£ç†</strong></h3><p><strong>Nginx</strong>ä½œä¸ºæœåŠ¡å™¨è½¯ä»¶ï¼Œå®ƒçš„ä¼˜ç‚¹ï¼š</p>
<ul>
<li>ç‰¹åˆ«é€‚åˆå‰åç«¯åˆ†ç¦»çš„é¡¹ç›®</li>
<li>ä¿è¯å®‰å…¨</li>
<li>éå¸¸å¿«</li>
<li>æ”¯æŒè´Ÿè½½å‡è¡¡</li>
</ul>
<p>ä½¿ç”¨ï¼š</p>
<ul>
<li>å®‰è£…nginx</li>
<li>nginx    å‘½ä»¤å¯åŠ¨æœåŠ¡å™¨</li>
<li>nginx -s stop    å‘½ä»¤å…³é—­æœåŠ¡å™¨</li>
<li>nginx -v      å‘½ä»¤æŸ¥çœ‹é…ç½®ä¿¡æ¯</li>
<li>nginx -s reload      å‘½ä»¤é‡å¯æœåŠ¡</li>
<li>é…ç½®nginx.confæ–‡ä»¶</li>
</ul>
<h3 id="HTTPç¼“å­˜"><a href="#HTTPç¼“å­˜" class="headerlink" title="HTTPç¼“å­˜"></a><strong>HTTPç¼“å­˜</strong></h3><p>ï¼ˆè‹¥æœåŠ¡å™¨ä½¿ç”¨nginxï¼Œåˆ™åœ¨nginx.confä¸­é…ç½®ï¼‰</p>
<p>Expires <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRUUC9IZWFkZXJzL0V4cGlyZXM=">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Expires</span><br><strong>Expireså“åº”å¤´åŒ…å«æ—¥æœŸ&#x2F;æ—¶é—´ï¼Œå³åœ¨æ­¤æ—¶å€™ä¹‹åï¼Œå“åº”è¿‡æœŸ</strong><br>ä½¿ç”¨nginxæ·»åŠ å¯¹åº”çš„å“åº”å¤´ï¼šexpiresæŒ‡ä»¤<br>æ–‡æ¡£åœ°å€ï¼šhttp:l&#x2F;nginx.org&#x2F;en&#x2F;docs&#x2F;http&#x2F;ngx http headers module.html</p>
<p>ä½†æ˜¯ç”±äºå®¢æˆ·ç«¯æ—¶é—´å’Œç”¨æˆ·ç«¯æ—¶é—´å¹¶ä¸æ€»æ˜¯ç›¸åŒçš„ï¼Œäºæ˜¯æœ‰äº†Cache-Controlï¼š</p>
<p><strong>Cache-Control</strong>:é€šç”¨æ¶ˆæ¯å¤´å­—æ®µï¼Œè¢«ç”¨äºåœ¨httpè¯·æ±‚å’Œå“åº”ä¸­ï¼Œé€šè¿‡æŒ‡å®šæŒ‡ä»¤æ¥å®ç°ç¼“å­˜æœºåˆ¶ã€‚<br>æ–‡æ¡£åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIv">https://developer</span> mozilla.org&#x2F;zh-CN&#x2F;docs&#x2F;Web&#x2F;HTTP&#x2F;Headers&#x2F;Cache-Control</p>
<p>*<strong>Etag</strong>:ETagHTTPå“åº”å¤´æ˜¯èµ„æºçš„ç‰¹å®šç‰ˆæœ¬çš„æ ‡è¯†ç¬¦ã€‚è¿™å¯ä»¥è®©ç¼“å­˜æ›´é«˜æ•ˆï¼Œå¹¶èŠ‚çœå¸¦å®½<br>å› ä¸ºå¦‚æœå†…å®¹æ²¡æœ‰æ”¹å˜ï¼ŒWbæœåŠ¡å™¨ä¸éœ€è¦å‘é€å®Œæ•´çš„å“åº”ï¼Œç›´æ¥è¿”å›304è¡¨ç¤ºå¯ä»¥ä½¿ç”¨ç¼“å­˜æ–‡ä»¶ã€‚<br>*æ–‡æ¡£åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRUUC9IZWFkZXJzL0VUYWc=">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/ETag</span><br><strong>Last-Modified</strong>:æ˜¯ä¸€ä¸ªå“åº”é¦–éƒ¨ï¼Œå…¶ä¸­åŒ…å«æºå¤´æœåŠ¡å™¨è®¤å®šçš„èµ„æºåšå‡ºä¿®æ”¹çš„æ—¥æœŸåŠæ—¶é—´ã€‚<br>æ–‡æ¡£åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRUUC9IZWFkZXJzL0xhc3QtTW9kaWZpZWQ=">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Last-Modified</span><br>nginx Etag:<span class="exturl" data-url="aHR0cDovL25naW54Lm9yZy9lbi9kb2NzL2h0dHAvbmd4X2h0dHBfY29yZV9tb2R1bGUuaHRtbCNldGFn">http://nginx.org/en/docs/http/ngx_http_core_module.html#etag</span><br>304 Not Modified <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSElUUC9TdGF0dXMvMzA0">https://developer.mozilla.org/zh-CN/docs/Web/HITP/Status/304</span></p>
<p>æµè§ˆå™¨ä½¿ç”¨ç¼“å­˜ï¼š</p>
<p><img data-src="/images/image.png" alt="/images/image.png"></p>
<h3 id="å‹ç¼©ç®—æ³•"><a href="#å‹ç¼©ç®—æ³•" class="headerlink" title="å‹ç¼©ç®—æ³•"></a>å‹ç¼©ç®—æ³•</h3><p>å‹ç¼©æ¯”å¯¹ç…§è¡¨<br><span class="exturl" data-url="aHR0cHM6Ly9xdWl4ZGIuZ2l0aHViLmlvL3NxdWFzaC1iZW5jaG1hcmsvI3JhdGlvLXZzLWNvbXByZXNzaW9u">https://quixdb.github.io/squash-benchmark/#ratio-vs-compression</span></p>
<h4 id="gzip"><a href="#gzip" class="headerlink" title="gzip"></a>gzip</h4><p><strong>ä¸€ã€åŠ¨æ€å‹ç¼©ï¼ˆæœåŠ¡å™¨åœ¨è¿”å›é™æ€æ–‡ä»¶ä¹‹å‰ï¼Œç”±æœåŠ¡å™¨å¯¹æ¯ä¸ªè¯·æ±‚å‹ç¼©åå†è¿›è¡Œè¾“å‡ºï¼‰</strong></p>
<p>nginxä¸­å¯ç”¨gzipï¼šåœ¨nginx.confä¸­é…ç½®ï¼š</p>
<ul>
<li>gzip  on;        å¼€å¯gzip</li>
<li>gzip_types     text&#x2F;plain  application&#x2F;javascript              è®¾ç½®é‚£äº›æ–‡ä»¶éœ€è¦å‹ç¼©</li>
<li>gzip_min_length   1k;         å°äºè®¾ç½®å€¼ä¸ä¼šå‹ç¼©</li>
<li>gzip_comp_level     1;          å‹ç¼©çº§åˆ«</li>
<li>ç­‰ç­‰</li>
</ul>
<p><strong>äºŒã€é™æ€å‹ç¼©ï¼ˆæœåŠ¡å™¨ç›´æ¥ä½¿ç”¨å‹ç¼©æ–‡ä»¶è¿›è¡Œè¾“å‡ºï¼‰</strong></p>
<p>ä¸¤ä¸ªæ­¥éª¤</p>
<ul>
<li>ç”Ÿæˆå‹ç¼©æ–‡ä»¶ï¼ˆgzipå‘½ä»¤æˆ–ä½¿ç”¨webpackæ’ä»¶ compression-webpack-pluginï¼‰</li>
<li>åœ¨nginÃ—å¼€å¯æ”¯æŒé™æ€å‹ç¼©çš„æ¨¡å—ï¼ˆä¾‹å¦‚gzip_static  :  onï¼‰</li>
</ul>
<h4 id="Brotli"><a href="#Brotli" class="headerlink" title="Brotli"></a>Brotli</h4><p><strong>ä¸€ã€åŠ¨æ€å‹ç¼©ï¼ˆæœåŠ¡å™¨åœ¨è¿”å›é™æ€æ–‡ä»¶ä¹‹å‰ï¼Œç”±æœåŠ¡å™¨å¯¹æ¯ä¸ªè¯·æ±‚å‹ç¼©åå†è¿›è¡Œè¾“å‡ºï¼‰</strong></p>
<p><strong>ä½¿ç”¨å‰æ</strong><br>æµè§ˆå™¨æ”¯æŒï¼šhttps:caniuse.com&#x2F;brotli<br><strong>HTTPSåè®®</strong><br>NGINXå¯¹åº”çš„æ¨¡å—ï¼šhttps:&#x2F;github.com&#x2F;google&#x2F;nginx&#x2F;brotli</p>
<p>nginxä¸­å¯ç”¨Brotliï¼šåœ¨nginx.confä¸­é…ç½®ï¼š</p>
<ul>
<li>brotli  on;        å¼€å¯Brotli</li>
<li>brotli_types     text&#x2F;plain  application&#x2F;javascript              è®¾ç½®é‚£äº›æ–‡ä»¶éœ€è¦å‹ç¼©</li>
<li>ç­‰ç­‰</li>
</ul>
<p><strong>äºŒã€é™æ€å‹ç¼©ï¼ˆæœåŠ¡å™¨ç›´æ¥ä½¿ç”¨å‹ç¼©æ–‡ä»¶è¿›è¡Œè¾“å‡º ,å¦‚ä¸Šã€‚ï¼‰</strong></p>
<h3 id="HTTPä¼˜åŒ–"><a href="#HTTPä¼˜åŒ–" class="headerlink" title="HTTPä¼˜åŒ–"></a>HTTPä¼˜åŒ–</h3><p>HTTPæ˜¯å»ºç«‹åœ¨TCPåè®®ä¹‹ä¸Šï¼Œæ‰€ä»¥<strong>HTTPåè®®çš„ç“¶é¢ˆåŠå…¶ä¼˜åŒ–æŠ€å·§éƒ½æ˜¯åŸºäºTCPåè®®æœ¬èº«çš„ç‰¹æ€§</strong>ï¼Œä¾‹å¦‚tcpå»ºç«‹è¿æ¥çš„3æ¬¡æ¡æ‰‹å’Œæ–­å¼€è¿æ¥çš„4æ¬¡æŒ¥æ‰‹ä»¥åŠæ¯æ¬¡å»ºç«‹è¿æ¥å¸¦æ¥çš„å»¶è¿Ÿæ—¶é—´ã€‚æ‰€ä»¥å‡å°‘è¿™äº›é‡æ–°æ¡æ‰‹å’Œè‡³å…³é‡è¦ã€‚</p>
<h4 id="keepAliveå±æ€§"><a href="#keepAliveå±æ€§" class="headerlink" title="keepAliveå±æ€§"></a>keepAliveå±æ€§</h4><p>keepAliveå±æ€§å¯ä»¥ä¿æŒæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯å»ºç«‹çš„ä¼šè¯è¿æ¥ï¼Œå¼€å¯ä¹‹åé™¤é¦–æ¬¡å»ºç«‹è¿æ¥å¤–çš„å…¶ä»–è¯·æ±‚ä¸ä¼šè¿›è¡Œ<strong>DNS Lookup</strong>ï¼ˆNDSåŸŸåè§£æï¼‰å’Œ<strong>Initial connection</strong>ï¼ˆä¸‰æŠ¥æ–‡æ¡æ‰‹å»ºç«‹è¿æ¥ï¼‰ï¼Œå¯ä»¥åœ¨æœåŠ¡ç«¯æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ã€‚</p>
<p><strong>KeepAliveçš„ä¼˜ç‚¹</strong></p>
<ul>
<li>TCPè¿æ¥æ›´å°‘ï¼ŒIè¿™æ ·å°±ä¼šèŠ‚çº¦TCPè¿æ¥åœ¨å»ºç«‹ã€é‡Šæ”¾è¿‡ç¨‹ä¸­ï¼Œä¸»æœºå’Œè·¯ç”±å™¨ä¸Šçš„CPUå’Œå†…å­˜å¼€é”€ã€‚</li>
<li>ç½‘ç»œæ‹¥å¡ä¹Ÿå‡å°‘äº†ï¼Œæ‹¿åˆ°å“åº”çš„å»¶æ—¶ä¹Ÿå‡å°‘äº†</li>
</ul>
<h4 id="HTTP2"><a href="#HTTP2" class="headerlink" title="HTTP2"></a>HTTP2</h4><p><strong>ä½¿ç”¨HTTP&#x2F;2æå‡æ€§èƒ½</strong></p>
<ul>
<li>2010å¹´SPDY <span class="exturl" data-url="aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS9TUERZJUU2JUJDJTk0JUU1JThDJTk2JUU1JTg4JUIw">https://baike.baidu.com/item/SPDYæ¼”åŒ–åˆ°</span></li>
<li>2015 HTTP&#x2F;2 <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9HbG9zc2FyeS9IVFRQXzI=">https://developer.mozilla.org/zh-CN/docs/Glossary/HTTP_2</span></li>
</ul>
<p><strong>å…¼å®¹æ€§</strong></p>
<p>éœ€è¦æµè§ˆå™¨æ”¯æŒ-https:&#x2F;caniuse.com&#x2F;http2</p>
<p>éœ€è¦HTTPSåè®®æ”¯æŒ</p>
<p><strong>ä¸»è¦ç‰¹æ€§</strong></p>
<p>ä¸€ã€äºŒè¿›åˆ¶åè®®ï¼š</p>
<p>HTTP2ç”±åŸæ¥çš„æ–‡æœ¬è¯·æ±‚ï¼ˆæŠ¥æ–‡ï¼‰è½¬å˜ä¸ºäºŒè¿›åˆ¶è¯·æ±‚å¸§ï¼ŒåŠ å¿«ä¼ è¾“</p>
<p>äºŒã€å¤šè·¯å¤ç”¨ï¼š</p>
<p><strong>HTTP2å¤šè·¯å¤ç”¨è§£å†³äº†æµè§ˆå™¨åŒä¸€åŸŸåå¹¶è¡Œè¯·æ±‚æ•°é‡çš„é™åˆ¶ã€‚</strong></p>
<p>åœ¨HTTP&#x2F;2ä¸­å¼•å…¥äº†å¤šè·¯å¤ç”¨çš„æŠ€æœ¯ã€‚å¤šè·¯å¤ç”¨å¾ˆå¥½çš„è§£å†³äº†æµè§ˆå™¨é™åˆ¶åŒä¸€ä¸ªåŸŸåä¸‹çš„è¯·æ±‚æ•°é‡çš„é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿæ¥æ›´å®¹æ˜“å®ç°å…¨é€Ÿä¼ è¾“ï¼Œæ¯•ç«Ÿå¼€ä¸€ä¸ªTCPè¿æ¥éƒ½éœ€è¦æ…¢æ…¢æå‡ä¼ è¾“é€Ÿåº¦ã€‚</p>
<p><strong>åŒä¸ªåŸŸååªéœ€è¦å ç”¨ä¸€ä¸ªTCPè¿æ¥</strong>ï¼Œä½¿ç”¨ä¸€ä¸ªè¿æ¥å¹¶è¡Œå‘é€å¤šä¸ªè¯·æ±‚å’Œå“åº”ï¼Œ<strong>æ¶ˆé™¤äº†å› å¤šä¸ªTCPè¿æ¥è€Œå¸¦æ¥çš„å»¶æ—¶å’Œå†…å­˜æ¶ˆè€—</strong>ã€‚</p>
<p>ä¸‰ã€Headerå‹ç¼©å¤ç”¨</p>
<p>TTP&#x2F;2åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä½¿ç”¨â€œ<strong>é¦–éƒ¨è¡¨</strong>â€æ¥è·Ÿè¸ªå’Œå­˜å‚¨ä¹‹å‰å‘é€çš„é”®ä¸€å€¼å¯¹ï¼Œå¯¹äºç›¸åŒçš„æ•°æ®ï¼Œä¸å†é€šè¿‡æ¯æ¬¡è¯·æ±‚å’Œå“åº”å‘é€ã€‚</p>
<p><strong>é…ç½®HTTP2ï¼š</strong></p>
<p>ä¾nginxä¸ºä¾‹ï¼šåœ¨serverå­—æ®µçš„listenå­—æ®µæ·»åŠ ï¼šlisten   443   ssl   http2; </p>
<h1 id="Mongodbæ•°æ®åº“"><a href="#Mongodbæ•°æ®åº“" class="headerlink" title="Mongodbæ•°æ®åº“"></a>Mongodbæ•°æ®åº“</h1><h3 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a><strong>åŸºæœ¬æ“ä½œ</strong></h3><pre><code class="js">// å¯¼å…¥Mongodbå®¢æˆ·ç«¯æ„é€ å‡½æ•°
import &#123; MongoClient,ObjectId, &#125; from &quot;mongodb&quot;;
// åˆ›å»ºmongoå®ä¾‹(ä¼ å…¥url)
const client = new MongoClient(&#39;mongodb://localhost:27017/&#39;);
// æ‰§è¡Œå‡½æ•°ï¼Œè¿æ¥mongodbæ•°æ®åº“
async function run() &#123;
  try &#123;
    await client.connect(); //ç­‰å¾…å®ä¾‹è¿æ¥
    const db = client.db(&#39;hello&#39;); //åˆ›å»ºæ•°æ®åº“
    const res = await db.command(&#123; ping: 1 &#125;); //pingå‘½ä»¤
    console.log(&#39;connected&#39;, res);
    const userCollection = db.collection(&#39;user&#39;);//åˆ›å»ºé›†åˆè¡¨
// æ•°æ®çš„æ’å…¥
    // const result = await userCollection.insertOne(&#123;name:&quot;å¼ ä¸‰&quot;,age:18&#125;)
    // const results = await userCollection.insertMany([&#123;name:&quot;æå››&quot;,age:12&#125;,&#123;name:&quot;ç‹äº”&quot;,age:13&#125;]);
    // console.log(result,results); //è¿”å›å½±å“çš„ä¿¡æ¯ï¼Œidç­‰
//æ•°æ®çš„æŸ¥æ‰¾
    const result = await userCollection.findOne(&#123;name:&#39;å¼ ä¸‰&#39;&#125;);
    console.log(result);
    const resultCursor =  userCollection.find(); //findè¿”å›çš„æ˜¯æŒ‡é’ˆå¯¹è±¡ï¼Œä¸æ˜¯ç»“æœ
    //å°†æ¸¸æ ‡å˜ä¸ºæ•°ç»„ç»“æœ
    const results = await userCollection.find().toArray();
    // console.log(results);
//æ¯”è¾ƒæ“ä½œç¬¦ $ltå°äº $gtå¤§äº
    const results2 = await userCollection.find(&#123;age:&#123;$lt:16&#125;&#125;).toArray();
    // console.log(results2);
//é€»è¾‘æ“ä½œç¬¦ $or
    const results3 = await userCollection.find(&#123;$or:[&#123;age:&#123;$gt:12&#125;&#125;,&#123;name:&quot;ç‹äº”&quot;&#125;]&#125;).toArray();
    // console.log(results3);
//å…ƒç´ æ“ä½œç¬¦  $existså­˜åœ¨ä¸å¦  $typeæŒ‡å®šç±»å‹
    const results4 = await userCollection.find(&#123;age:&#123;$type:&#39;number&#39;&#125;&#125;).toArray();
    // console.log(results4);
//limit  ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥optionsé…ç½®ï¼ˆprojectionè¡¨ç¤ºåŒ…å«å­—æ®µå“ªäº›å­—æ®µï¼‰
    const result5 = await userCollection.find(&#123;age:&#123;$type:&#39;number&#39;&#125;&#125;,&#123;limit:2,skip:3,sort:&#123;age:-1&#125;,projection:&#123;name:0&#125;&#125;).toArray();
    // console.log(result5);
//æ›´æ–°æ›¿æ¢æ•°æ®   updateæ›´æ–°æ•°æ®  replaceOneæ›¿æ¢æ•°æ® ,ä¿®æ”¹æ“ä½œè¦ä¼ å…·ä½“æ›´æ–°æ“ä½œç¬¦ï¼š
//æ™®é€šæ›´æ–°æ“ä½œç¬¦ï¼š $setè®¾ç½®å€¼ $incå¢åŠ  $renameé‡å‘½å $unsetåˆ é™¤ 
//æ•°ç»„æ›´æ–°æ“ä½œç¬¦ï¼š $pushæ•°ç»„å­—æ®µæ·»åŠ  $popåˆ é™¤ $allåŒ…å« $regexæ­£åˆ™  .å±æ€§ç¬¦ .$å±æ€§å ä½ç¬¦
    const result6 = await userCollection.replaceOne(&#123;name:&quot;å¼ ä¸‰&quot;&#125;,&#123;name:&quot;Lebrown&quot;&#125;);
    const result7 = await userCollection.updateOne(&#123;_id:new ObjectId(&#39;6628b9876bac632e95ead1bb&#39;)&#125;,&#123;$set:&#123;name:&quot;updateOne&quot;&#125;,$inc:&#123;age:10&#125;&#125;);
    const result8 = await userCollection.updateOne(&#123;_id: new ObjectId(&#39;6628b9876bac632e95ead1bb&#39;)&#125;,&#123;$set:&#123;&quot;hobbies.0&quot;:&quot;golf&quot;&#125;&#125;)
    const result9 = await userCollection.updateOne(&#123;_id: new ObjectId(&#39;6628b9876bac632e95ead1bb&#39;),hobbies:&#39;glof&#39;&#125;,&#123;$set:&#123;&quot;hobbies.$&quot;:&quot;golf-new&quot;&#125;&#125;)
    // console.log(result8);//è¿”å›å½±å“ä¿¡æ¯
//åˆ é™¤æ•°æ®ï¼šdeleteOne(filter) å’ŒdeleteMany
  &#125; catch (e) &#123;
    console.error(e);
  &#125; finally &#123;
    await client.close();
  &#125;
&#125;
run();
</code></pre>
<h3 id="mongodbé«˜çº§"><a href="#mongodbé«˜çº§" class="headerlink" title="mongodbé«˜çº§"></a><strong>mongodbé«˜çº§</strong></h3><h5 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h5><p><strong>MongoDBç´¢å¼•</strong></p>
<ul>
<li>ç´¢å¼•(Index)<strong>ä¸ºäº†æé«˜æŸ¥è¯¢æ•ˆç‡</strong></li>
<li>MongoDBçš„æ–‡ä»¶ç±»å‹ï¼š<strong>BSON</strong>,Binary JSON,ä¸»è¦è¢«ç”¨ä½œMongoDBæ•°æ®åº“ä¸­çš„æ•°æ®å­˜å‚¨å’Œç½‘ç»œä¼ è¾“æ ¼å¼ã€‚</li>
<li>å‡å¦‚æ²¡æœ‰ç´¢å¼•ï¼Œå¿…é¡»æ‰«æè¿™ä¸ªå·¨å¤§BSONå¯¹è±¡é›†åˆä¸­çš„æ¯ä¸ªæ–‡æ¡£å¹¶é€‰å–é‚£äº›ç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„è®°å½•ï¼Œè¿™æ ·æ˜¯ä½æ•ˆçš„ã€‚</li>
<li>ç´¢å¼•æ˜¯ç‰¹æ®Šçš„æ•°æ®ç»“æ„ï¼Œç´¢å¼•å­˜å‚¨åœ¨ä¸€ä¸ªæ˜“äºéå†è¯»å–çš„æ•°æ®é›†åˆä¸­ã€‚</li>
<li>ä¸ºæŸä¸ªå­—æ®µåˆ›å»ºç´¢å¼•ä¹‹åæŸ¥æ‰¾é€Ÿåº¦éå¸¸å¿«ï¼ŒObjectIdæ˜¯è‡ªå¸¦çš„ç´¢å¼•ï¼ˆ _ id _ ï¼‰ã€‚</li>
</ul>
<p><strong>åˆ›å»ºç´¢å¼•</strong></p>
<p>åˆ›å»ºç´¢å¼•å¯ä»¥ç›´æ¥ç”¨Navicateç­‰å·¥å…·ï¼Œä¹Ÿå¯ä»¥ä»£ç ä¸­ä½¿ç”¨ï¼š</p>
<pre><code class="js">//......çœç•¥
//ç»™nameå­—æ®µåˆ›å»ºç´¢å¼•ä¹‹å‰è€—æ—¶å¾ˆå¤§ï¼Œåˆ›å»ºä¹‹åè€—æ—¶å¾ˆå°
const indexResult = await userCollection.find(&#123;name:&quot;James&quot;&#125;).explain();
console.log(indexResult);
//åˆ›å»ºç´¢å¼•ï¼Œå±æ€§è¡¨ç¤ºå­—æ®µï¼Œå€¼è¡¨ç¤ºå‡åºé™åº
const result = await userCollection.createIndex(&#123;name:1&#125;) //1è¡¨ç¤ºå‡åº
//å–æ¶ˆç´¢å¼•
const result1 = await userCollection.dropIndex(&quot;name_1&quot;)
</code></pre>
<h5 id="èšåˆ"><a href="#èšåˆ" class="headerlink" title="èšåˆ"></a>èšåˆ</h5><p>èšåˆæ“ä½œå°†æ¥è‡ªå¤šä¸ªæ–‡æ¡£çš„å€¼ç»„åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä¸”å¯ä»¥å¯¹åˆ†ç»„æ•°æ®æ‰§è¡Œå„ç§æ“ä½œä»¥è¿”å›ç›¸åº”çš„ç»“æœã€‚<br><strong>linuxå¸¸ç”¨çš„ç®¡é“å†™æ³•ï¼š</strong></p>
<pre><code class="bash">ps aux | grep mongo
</code></pre>
<p><strong>èšåˆå¸¸ç”¨çš„æ“ä½œç¬¦ï¼š</strong></p>
<ul>
<li>$groupå°†collectionä¸­çš„document:åˆ†ç»„ï¼Œå¯ç”¨äºç»Ÿè®¡ç»“æœ</li>
<li>$natchè¿‡æ»¤æ•°æ®ï¼Œåªè¾“å‡ºç¬¦åˆç»“æœçš„æ–‡æ¡£</li>
<li>$projectä¿®æ”¹è¾“å…¥æ–‡æ¡£çš„ç»“æ„ï¼ˆä¾‹å¦‚é‡å‘½åï¼Œå¢åŠ ã€åˆ é™¤å­—æ®µï¼Œåˆ›å»ºç»“ç®—ç»“æœç­‰ï¼‰</li>
<li>$sotå°†ç»“æœè¿›è¡Œæ’åºåè¾“å‡º</li>
<li>$imité™åˆ¶ç®¡é“è¾“å‡ºçš„ç»“æœä¸ªæ•°</li>
<li>$skpè·³è¿‡åˆ¶å®šæ•°é‡çš„ç»“æœï¼Œå¹¶ä¸”è¿”å›å‰©ä¸‹çš„ç»“æœ</li>
</ul>
<p><strong>è¡¨è¾¾å¼æ“ä½œç¬¦ï¼š</strong></p>
<ul>
<li>$sumè®¡ç®—æ€»å’Œï¼Œ{$sum:1}è¡¨ç¤ºè¿”å›æ€»å’ŒÃ—1çš„å€¼ï¼ˆå³æ€»å’Œçš„æ•°é‡ï¼‰ï¼Œä½¿ç”¨{$sum:â€™$åˆ¶å®šå­—æ®µâ€™}ä¹Ÿèƒ½ç›´æ¥è·å–åˆ¶å®šå­—æ®µçš„å€¼çš„æ€»å’Œ</li>
<li>$avgæ±‚å¹³å‡å€¼</li>
<li>$minæ±‚minå€¼</li>
<li>$maxæ±‚maxå€¼</li>
<li>$pushå°†ç»“æœæ–‡æ¡£ä¸­æ’å…¥å€¼åˆ°ä¸€ä¸ªæ•°ç»„ä¸­</li>
<li>$frstæ ¹æ®æ–‡æ¡£çš„æ’åºè·å–ç¬¬ä¸€ä¸ªæ–‡æ¡£æ•°æ®</li>
<li>$laståŒç†ï¼Œè·å–æœ€åä¸€ä¸ªæ•°æ®</li>
</ul>
<pre><code class="js">//.....
const pipeLine = [
    &#123; $match : &#123; age : &#123; $gt : 30 &#125;&#125;&#125;,
    &#123; $group : &#123; _id : &quot;$steam&quot; , total : &#123; $sum : &quot;$age&quot; &#125; , count : &#123; $sum : 1 &#125;&#125;&#125;,
    &#123; $sort : &#123; total : 1 &#125;&#125;
]
cosnt result = await userCollection.aggregate(pipeLine).toArray();
//....
</code></pre>
<h5 id="å¤šè¡¨è”æŸ¥"><a href="#å¤šè¡¨è”æŸ¥" class="headerlink" title="å¤šè¡¨è”æŸ¥"></a>å¤šè¡¨è”æŸ¥</h5><p><strong>æ™®é€šæ–¹å¼ä½¿ç”¨å¤šè¡¨è”æŸ¥éœ€è¦ä¸¤æ¬¡æŸ¥è¯¢</strong></p>
<pre><code class="js">// å¯¼å…¥Mongodbå®¢æˆ·ç«¯æ„é€ å‡½æ•°
import &#123; MongoClient,ObjectId, &#125; from &quot;mongodb&quot;;
// åˆ›å»ºmongoå®ä¾‹(ä¼ å…¥url)
const client = new MongoClient(&#39;mongodb://localhost:27017/&#39;);
// æ‰§è¡Œå‡½æ•°ï¼Œè¿æ¥mongodbæ•°æ®åº“
async function run() &#123;
  try &#123;
    await client.connect(); //ç­‰å¾…å®ä¾‹è¿æ¥
    const db = client.db(&#39;hello&#39;); //åˆ›å»ºæ•°æ®åº“
    const res = await db.command(&#123; ping: 1 &#125;); //pingå‘½ä»¤
    console.log(&#39;connected&#39;, res);
//è·å–è¡¨
     const teamCollection = db.collection(&#39;team&#39;);
     const playerCollection = db.collection(&#39;player&#39;);
     const netsTeam = await teamCollection.findOne(&#123;team:&quot;NETS&quot;&#125;);
     const netsPlayers = await playerCollection.find(&#123;team:netsTeam._id&#125;).toArray();
  &#125; catch (e) &#123;
    console.error(e);
  &#125; finally &#123;
    await client.close();
  &#125;
&#125;
run();
</code></pre>
<p><strong>ä½¿ç”¨èšåˆä¸­$lookupè¿›è¡Œå¤šè¡¨è”æŸ¥åªéœ€è¦ä¸€æ¬¡æŸ¥è¯¢ï¼š</strong></p>
<pre><code class="js">//...
const pipeLine2 = [
    &#123;
        $match : &#123; team : &#123; $exists : true &#125; &#125;
    &#125;,
    &#123;
        $lookup : &#123;
            from : &quot;team&quot;,
            localField : &quot;team&quot;,
            foreignField : &quot;_id&quot;,
            as : &quot;team&quot;
        &#125;
    &#125;
] 
const playerWithTeam = await playerCollection.aggregate(pipeLine2).toArray();
console.log(playerWithTeam);
//...
</code></pre>
<h3 id="æ•°æ®åº“è®¾è®¡"><a href="#æ•°æ®åº“è®¾è®¡" class="headerlink" title="æ•°æ®åº“è®¾è®¡"></a>æ•°æ®åº“è®¾è®¡</h3><p><em>MongoDBæœ€ä½³è®¾è®¡å®è·µï¼š</em>[https:l<span class="exturl" data-url="aHR0cDovL3d3dy5tb25nb2RiLmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS9tb25nb2RiLXNjaGVtYS1kZXNpZ24tYmVzdC1wcmFjdGljZXMvXQ==">www.mongodb.Com/developer/article/mongodb-schema-design-best-practices/]</span>(<span class="exturl" data-url="aHR0cHM6Ly93d3cubW9uZ29kYi5jb20vZGV2ZWxvcGVyL2FydGljbGUvbW9uZ29kYi0=">https://www.mongodb.com/developer/article/mongodb-</span><br>schema-design-best-practices&#x2F;)</p>
<p>  å…³é”®é—®é¢˜ï¼šæ•°æ®äº§ç”Ÿå…³ç³»çš„æ—¶å€™ï¼Œé€‰æ‹©å†…åµŒè¿˜æ˜¯å¼•ç”¨ï¼Ÿ</p>
<p><strong>å†…åµŒæ¨¡å¼ï¼š</strong></p>
<p>ä¼˜åŠ¿ï¼š</p>
<ul>
<li>åªéœ€è¦ä¸€æ¬¡æŸ¥è¯¢å°±å¯ä»¥æŸ¥è¯¢æ‰€æœ‰çš„ä¿¡æ¯ã€‚</li>
<li>é¿å…å¤šé›†åˆæŸ¥è¯¢ã€‚</li>
<li>åªéœ€è¦ä¸€ä¸ªæ“ä½œå°±å¯ä»¥æ›´æ–°å¤šä¸ªä¿¡æ¯ã€‚</li>
</ul>
<p>åŠ£åŠ¿ï¼š</p>
<ul>
<li>å•ä¸ªæ–‡æ¡£å¤ªå¤§ï¼ŒæŸ¥è¯¢å¯èƒ½æ›´è€—æ—¶ï¼Œè·å¾—çš„æ— å…³ä¿¡æ¯æ¦‚ç‡å¢å¤§ã€‚</li>
<li>é’ˆå¯¹æ¯ä¸ªæ–‡æ¡£ï¼ŒMongoDBæœ‰ä¸€ä¸ª16Mçš„æœ€å¤§é™åˆ¶ï¼Œå†…åµŒå¤ªå¤šï¼Œå¯èƒ½è¶…è¿‡è¿™ä¸ªé™åˆ¶ã€‚</li>
</ul>
<p><strong>å¼•ç”¨æ¨¡å¼ï¼š</strong></p>
<p>ä¼˜åŠ¿ï¼š</p>
<ul>
<li>å°†æ•°æ®åˆ†æ•£åˆ°ä¸åŒæ–‡æ¡£ï¼Œæ•°æ®é‡ä¼šå˜å°ã€‚</li>
<li>ä¸å¤ªä¼šè¶…è¿‡16Mæœ€å¤§é™åˆ¶ã€‚</li>
<li>æ¯æ¬¡æŸ¥è¯¢å–å¾—ä¸å¿…è¦æ•°æ®çš„æ…¨ç‡é™ä½ã€‚</li>
</ul>
<p>åŠ£åŠ¿ï¼šéœ€è¦å¤šæ¬¡æŸ¥è¯¢æ‰èƒ½è·å¾—æœ€ç»ˆæ•°æ®</p>
<p><strong>æœ€ä½³è®¾è®¡å®è·µï¼š</strong></p>
<ul>
<li><p>ä¸€å¯¹å‡ ä¸ªï¼šæ¨èä½¿ç”¨å†…åµŒå½¢å¼</p>
</li>
<li><p>ä¸€å¯¹å¾ˆå¤šï¼šæ¨èä½¿ç”¨å¼•ç”¨å½¢å¼</p>
<ul>
<li>å­é›†åˆä¸­ä½¿ç”¨ä¸€ä¸ªå­—æ®µä¿å­˜çˆ¶é›†åˆçš„_id   ï¼› æˆ–è€…ï¼š</li>
<li>çˆ¶é›†åˆä¸­ä½¿ç”¨ä¸€ä¸ªæ•°ç»„ä¿å­˜å­é›†åˆçš„_id</li>
</ul>
</li>
<li><p>ä¸€å¯¹äº¿ä¸‡ï¼šåªèƒ½å­é›†åˆä¸­ä½¿ç”¨ä¸€ä¸ªå­—æ®µä¿å­˜çˆ¶é›†åˆçš„_id</p>
</li>
</ul>
<h3 id="è®¿é—®æƒé™ç®¡ç†"><a href="#è®¿é—®æƒé™ç®¡ç†" class="headerlink" title="è®¿é—®æƒé™ç®¡ç†"></a><strong>è®¿é—®æƒé™ç®¡ç†</strong></h3><p><strong>æˆæƒæ–‡æ¡£</strong>ï¼šhttps:&#x2F;docs.mongodb.com&#x2F;manual&#x2F;core&#x2F;authentication&#x2F;<br><strong>å†…ç½®çš„Roles</strong>ï¼šhttps:&#x2F;docs.mongodb.com&#x2F;manual&#x2F;reference&#x2F;built-in-roles&#x2F;</p>
<p><strong>åœ¨mongoå‘½ä»¤è¡Œä¸­è¾“å…¥ï¼š</strong></p>
<pre><code class="cmd">show dbs
use admin
# mongodbåŸºäºRBACè¿›è¡Œæƒé™ç®¡ç†ï¼Œè®¾ç½®roleså¯ä»¥è®¾ç½®ç›¸åº”çš„å…¨é€‰ï¼Œè§ä¸Šã€‚
db.createUser(&#123; user : &#39;root&#39; , pwd : &#39;123456&#39; , roles : [&#39;root&#39;] &#125;) 
db.auth(&#39;root&#39;,&#39;123456&#39;)
# --auth å¼€å¯æ•°æ®åº“çš„æƒé™éªŒè¯ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨mongo.confä¸­é…ç½®ï¼ˆå…ˆç»ˆæ­¢è¿è¡Œmongodï¼‰
mongod --config /usr/local/etc/mongo.conf --auth
# æ“ä½œé…ç½®äº†æƒé™ç®¡ç†çš„æ•°æ®åº“
mongo -u &quot;root&quot; -p &quot;123456&quot; --authenticationDatabase &quot;admin&quot;
</code></pre>
<p><strong>åˆå§‹åŒ–ä¸€ä¸ªæ–°æ•°æ®åº“ä»¥åæœŸæœ›çš„æ­¥éª¤</strong></p>
<ul>
<li>åˆ›å»ºadminçº§è°œåˆ«çš„rootç”¨æˆ·&#x2F;roles:root</li>
<li>åˆ›å»ºå¯¹åº”çš„æ•°æ®åº“lego</li>
<li>åˆ›å»ºè¯¥æ•°æ®åº“çš„ç®¡ç†å‘˜dmq&#x2F;roles:readWrite</li>
<li>ä»£ç ä¸­ï¼Œä½¿ç”¨ç®¡ç†å‘˜dmqçš„ç”¨æˆ·åå¯†ç é“¾æ¥æ•°æ®åº“å¹¶ä¸”å®Œæˆæ“ä½œã€‚</li>
</ul>
<p>æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<pre><code>show dbs
use lego
db.createUser(&#123; user : &quot;dmq&quot; , pwd : &#39;123456&#39; , roles : [&#123; role : &quot;readWrite&quot; , db : &quot;lego&quot; &#125;]&#125;)
# é‡å¯æœåŠ¡ï¼šmongod --config /usr/local/etc/mongo.conf --auth
# è¿™æ ·åœ¨mongodbçš„é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ç”¨æˆ·ä¿¡æ¯ï¼Œå°±ä¿è¯åªèƒ½è¯»å–æ•°æ®åº“ä¿¡æ¯ï¼Œä¿è¯äº†æ•°æ®åº“çš„å®‰å…¨ã€‚ï¼ˆå¦‚æœç”¨æˆ·ä¿¡æ¯æ¥è‡ªadminæ•°æ®åº“å°±éœ€è¦é…ç½®authSource:&#39;admin&#39;ã€‚ï¼‰
</code></pre>
<h1 id="Mongoose"><a href="#Mongoose" class="headerlink" title="Mongoose"></a>Mongoose</h1><p><strong>å‡ºç°çš„åŸå› ï¼š</strong></p>
<p>ä½¿ç”¨åŸç”Ÿçš„mongoDB nodejs driveræ•°æ®ç»“æ„åŠå…¶æ“ä½œè¿‡äºçµæ´»ï¼Œç±»ä¼¼äºORMï¼š</p>
<p><strong>mongooseï¼š</strong>ï¼ˆmongooseä¹‹äºmongodbç±»ä¼¼äºtsä¹‹äºjsï¼Œéƒ½æ˜¯åœ¨åŸæœ‰çš„åŸºç¡€ä¹‹ä¸ŠåŠ ä¸€å±‚æŠ½è±¡å±‚ï¼Œè¿›è¡Œç±»å‹å®šä¹‰ç­‰æ“ä½œï¼‰</p>
<p>mongooseï¼š<span class="exturl" data-url="aHR0cHM6Ly9tb25nb29zZWlzLmNvbS8=">https://mongooseis.com/</span></p>
<ul>
<li>å»ºç«‹åœ¨native mongoDB nodejs driverä¹‹ä¸Š</li>
<li>æå‡ºModl,æ•°æ®æ¨¡å‹çš„æ¦‚å¿µï¼Œç”¨æ¥çº¦æŸé›†åˆä¸­çš„æ•°æ®ç»“æ„</li>
<li>éå¸¸å¤šæ‰©å±•çš„å†…å®¹</li>
<li>å®ƒæ˜¯ä¸€ä¸ªODM(Object Document Mapping)å·¥å…·ã€‚</li>
</ul>
<h3 id="ORM"><a href="#ORM" class="headerlink" title="ORM"></a>ORM</h3><p>ORMæŒ‡çš„æ˜¯<strong>Object Relational Mappingå¯¹è±¡å…³ç³»æ˜ å°„</strong>ï¼Œé’ˆå¯¹äºå…³ç³»å‹æ•°æ®åº“ã€‚</p>
<p><strong>ç®€å•è¯´ï¼ŒORMå°±æ˜¯é€šè¿‡å®ä¾‹å¯¹è±¡çš„è¯­æ³•ï¼Œå®Œæˆå…³ç³»å‹æ•°æ®åº“çš„æ“ä½œçš„æŠ€æœ¯ã€‚</strong></p>
<p><strong>ORMä¼˜ç‚¹</strong></p>
<ul>
<li>ä¸éœ€è¦å†å»å†™æ™¦æ¶©çš„SQLè¯­å¥ã€‚</li>
<li>ä½¿ç”¨é¢å‘å¯¹è±¡çš„æ–¹å¼æ“ä½œæ•°æ®ï¼Œä»£ç é‡å°‘ï¼Œè¯­ä¹‰æ€§å¥½ï¼Œå®¹æ˜“ç†è§£ã€‚</li>
<li>Classesç±»-Tables</li>
<li>Objectså®ä¾‹-Records(è¡¨ä¸­çš„ä¸€è¡Œæ•°æ®)</li>
<li>Attributeså±æ€§-Records</li>
<li>å†…ç½®å¾ˆå¤šåŠŸèƒ½ï¼Œæ•°æ®éªŒè¯ï¼Œæ¸…æ´—ï¼Œé¢„å¤„ç†ç­‰ç­‰æ“ä½œã€‚</li>
</ul>
<h3 id="ODM"><a href="#ODM" class="headerlink" title="ODM"></a>ODM</h3><p>ODMæŒ‡çš„æ˜¯<strong>Object Document Mappingå¯¹è±¡æ–‡æ¡£æ˜ å°„</strong>ã€‚ODMé’ˆå¯¹äºnoSqlæ•°æ®åº“ï¼Œå…³æ³¨æ–‡æ¡£æ¨¡å‹ï¼Œmongooseæ˜¯ODMçš„ä¸€ç§å®ç°ï¼Œå¯ä»¥ç”¨äºçº¦æŸæ•°æ®ç±»å‹ã€‚</p>
<pre><code class="javascript">const User = mongoose.model(&quot;User&quot;,&#123;
    username:&#123; type : string &#125;,
    password:&#123; type : String &#125;
&#125;)
//user object
const newUser new User(&#123;
    username:&quot;john-doe&quot;,
    password:&quot;helloworld&quot;,
&#125;)
await newUser.save()
</code></pre>
<h1 id="egg-mongoose"><a href="#egg-mongoose" class="headerlink" title="egg-mongoose"></a>egg-mongoose</h1><p>è¯¦è§æºç ï¼Œæ­¤å¤„çœç•¥ã€‚</p>
<h1 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h1><h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>Streamçš„å®˜æ–¹æ–‡æ¡£ï¼š<span class="exturl" data-url="aHR0cHM6Ly9ub2RlanMub3JnL2FwaS9zdHJlYW0uaHRtbA==">https://nodejs.org/api/stream.html</span><br><strong>æµæ˜¯Node.jsä¸­æœ€å¥½ï¼Œä¹Ÿæ˜¯æœ€å®¹æ˜“è¯¯è§£çš„æ…¨å¿µ</strong><br>æµå°±æ˜¯æ•°æ®çš„åˆé›†ï¼Œæ•°æ®å¯ä»¥æ˜¯å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ˜¯æ•°ç»„ï¼Œæµçš„æ•°æ®ä¸æ˜¯ä¸€æ¬¡æ€§å…¨éƒ¨è·å¾—çš„ã€‚</p>
<p>å¤§æ–‡ä»¶è¾“å‡ºæ–¹å¼ï¼š</p>
<ul>
<li><p>ç›´æ¥è¯»å–</p>
<p>è¾“å…¥çš„æ–‡ä»¶â€”â€”â€”â€”è¯»å–åˆ°å†…å­˜â€”â€”â€”â€”â€”-è¾“å‡ºæ–‡ä»¶å†…å®¹</p>
</li>
<li><p>æµå¼è¯»å–</p>
<p>è¾“å…¥çš„æ–‡ä»¶â€”â€”â€”â€”é€šè¿‡å¯è¯»æµè¯»å–åˆ°ç®¡é“â€”â€”â€”â€”â€”â€“é€šè¿‡å¯å†™æµè¾“å‡ºæ–‡ä»¶å†…å®¹</p>
</li>
</ul>
<p><strong>Node.jsæ”¯æŒæµçš„å†…ç½®æ¨¡å—ï¼š</strong></p>
<p><strong>Readable Streams:</strong></p>
<ul>
<li>HTTP responses,on the client</li>
<li>HTTP requests,on the server</li>
<li>fs read streams</li>
<li>zlib streams</li>
<li>crypto streams</li>
<li>TCP sockets</li>
<li>child process stdout and stderr</li>
<li>process.stdin</li>
</ul>
<p><strong>Writable  Streams:</strong></p>
<ul>
<li>HTTP requests,on the client</li>
<li>HTTP responses,on the server</li>
<li>fs write streams</li>
<li>zlib streams</li>
<li>crypto streams</li>
<li>TCP sockets</li>
<li>child process stdin</li>
<li>process.stdout,process.stderr</li>
</ul>
<p><strong>æµçš„ç±»å‹ï¼š</strong></p>
<ul>
<li>Readable-å¯è¯»æ“ä½œã€‚</li>
<li>Vritable-å¯å†™æ“ä½œã€‚</li>
<li>Duplex-å¯è¯»å¯å†™æ“ä½œ. </li>
<li>Transform-æ“ä½œè¢«å†™å…¥æ•°æ®ï¼Œç„¶åè¯»å‡ºç»“æœã€‚</li>
</ul>
<h3 id="pipe"><a href="#pipe" class="headerlink" title="pipe"></a>pipe</h3><p><strong>æµçš„æµåŠ¨ï¼š</strong></p>
<p>å¯è¯»æµReadableï¼ˆæ•°æ®æºinputï¼‰â€”â€”â€”â€”â€”â€”â€”-pipeç®¡é“â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-å¯å†™æµWritableï¼ˆè¾“å‡ºoutputï¼‰</p>
<pre><code class="js">import &#123; createReadStream, createWriteStream &#125; from &#39;fs&#39;;
const readStream = createReadStream(&#39;./a.txt&#39;);
readStream.pipe(process.stdout);
</code></pre>
<p>å¯è¯»æµReadableï¼ˆæ•°æ®æºinputï¼‰â€”â€”â€”â€”-pipeç®¡é“â€”â€”â€”â€”â€”è½¬æ¢æµTransformâ€”â€”â€”â€”â€”-pipeç®¡é“â€”â€”â€”â€“å¯å†™æµWritableï¼ˆè¾“å‡ºoutputï¼‰</p>
<pre><code class="js">import &#123; createReadStream, createWriteStream, write &#125; from &#39;fs&#39;;
const readStream = createReadStream(&#39;./a.txt&#39;);
const writeStream = createWriteStream(&#39;./b.txt&#39;);
readStream.pipe(writeStream);
</code></pre>
<h3 id="åŸç†-2"><a href="#åŸç†-2" class="headerlink" title="åŸç†"></a>åŸç†</h3><p><strong>æµæ˜¯åŸºäºEventEmitterï¼ˆäº‹ä»¶ï¼‰ï¼Œpipeæ–¹æ³•æ˜¯åŸºäºäº‹ä»¶å°è£…çš„çš„è¯­æ³•ç³–ï¼Œå¸¸è§çš„äº‹ä»¶æœ‰ï¼š</strong></p>
<p><strong>Readable  Streamsï¼šå¯è¯»æµäº‹ä»¶å’Œå‡½æ•°</strong></p>
<ul>
<li>Events<ul>
<li>dataâ€“å½“æ²¡æœ‰æ•°æ®æ—¶è§¦å‘</li>
<li>endâ€“æ²¡æœ‰æ›´å¤šçš„æ•°æ®å¯è¯»æ—¶è§¦å‘</li>
<li>errorâ€“åœ¨æ¥å—å’Œå†™å…¥è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘</li>
<li>finishâ€“æ‰€æœ‰æ•°æ®å·²è¢«å†™å…¥åˆ°åº•å±‚ç³»ç»Ÿæ—¶è§¦å‘</li>
<li>close</li>
<li>readable</li>
</ul>
</li>
<li>Functions<ul>
<li>pipe() , unpipe()</li>
<li>read() , unshift() , resume()</li>
<li>pause() , isPaused()</li>
<li>setEncoding()</li>
</ul>
</li>
</ul>
<p><strong>Writable  Streamsï¼šå†™å…¥æµäº‹ä»¶å’Œå‡½æ•°</strong></p>
<ul>
<li>Events<ul>
<li>drain</li>
<li>finish</li>
<li>error</li>
<li>close</li>
<li>pipe&#x2F;unpipe</li>
</ul>
</li>
<li>Functions<ul>
<li>write()</li>
<li>end()</li>
<li>cork() , uncork()</li>
<li>setDefaultEncoding()</li>
</ul>
</li>
</ul>
<p><strong>pipeæ–¹æ³•åŸç†ï¼š</strong></p>
<pre><code class="js">import &#123; createReadStream , createWriteStream &#125; from &#39;fs&#39;;
const readStream = createReadStream(&#39;./a.txt&#39;);
const writeStream = createWriteStream(&#39;./b.txt&#39;);
readStream.on(&#39;data&#39; , chunk=&gt;&#123;
    writeStream.write(chunk);
&#125;)
readStream.on(&#39;end&#39;,()=&gt;&#123;
    writeStream.end();
&#125;)
</code></pre>
<p>å‹ç¼©ï¼š</p>
<pre><code class="js">import &#123; createReadStream , createWriteStream &#125; from &#39;fs&#39;;
import &#123; createGzip &#125; from &#39;zlib&#39;;
const readStream = createReadStream(&#39;./a.txt&#39;);
const writeStream = createWriteStream(&#39;./b.txt&#39;);
readStream.pipe(createGzip()).pipe(writeStream);
</code></pre>
<p>å°è£…ï¼š</p>
<pre><code class="js">cosnt savePromise = (readStream , writeStream = stdout)&#123;
    return new Promise(resolve,reject)&#123;
        readStream
            .pipe(writeStream)
            .on(&#39;finish&#39;,resolve)
            .on(&#39;error&#39;,reject)
    &#125;
&#125;
</code></pre>
<h3 id="pipeline"><a href="#pipeline" class="headerlink" title="pipeline"></a>pipeline</h3><p><strong>ä½¿ç”¨pipeæ–¹æ³•æœ‰æ—¶ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼š</strong></p>
<pre><code class="js">//....
createReadStream(&#39;./a.txt&#39;)
    .pipe(stdout)
    .on(&#39;finish&#39;,finishFn)
    .on(&#39;error&#39;,errFn);  //è¿™é‡Œç›‘å¬çš„æ˜¯pipeåçš„é”™è¯¯ï¼Œå¯¹äºcreateReadStreamçš„é”™è¯¯åˆ™ä¼šå¡æ­»
</code></pre>
<p><strong>äºæ˜¯æ¨å‡ºäº†pipelineæ–¹æ³•ï¼š</strong></p>
<pre><code class="js">//...
pipeLine(fs.createReadStream(&#39;./a.txt&#39;),zlib.createGzip(),fs.createWriteStream(&#39;./b.txt&#39;),(err)=&gt;&#123;
    if (err) &#123; console.error(&#39;pipeline failed&#39;,error) &#125;;
    else &#123; console.log(&#39;successed&#39;) &#125;
&#125;)
</code></pre>
<h1 id="å¯¹è±¡å­˜å‚¨æœåŠ¡"><a href="#å¯¹è±¡å­˜å‚¨æœåŠ¡" class="headerlink" title="å¯¹è±¡å­˜å‚¨æœåŠ¡"></a>å¯¹è±¡å­˜å‚¨æœåŠ¡</h1><p><strong>è‡ªå·±å®Œæˆé™æ€æ–‡ä»¶å­˜å‚¨çš„é—®é¢˜</strong></p>
<ul>
<li>Nod.jsä¸æ“…é•¿å¤„ç†é™æ€æ–‡ä»¶çš„å­˜å‚¨å’Œå±•ç¤ºï¼Œæ²¡æœ‰æœªé™æ€æ–‡ä»¶åšç‰¹æ®Šçš„ä¼˜åŒ–</li>
<li>å¦‚æœå°†å›¾ç‰‡ç”Ÿæˆå¤šç§å¤„ç†æ ¼å¼è¦è€—è´¹å¤§é‡çš„èµ„æºå’Œç©ºé—´</li>
</ul>
<p><strong>å„ä¸‰æ–¹æ¯”å¯¹</strong></p>
<h3 id="é˜¿é‡Œäº‘OSS"><a href="#é˜¿é‡Œäº‘OSS" class="headerlink" title="é˜¿é‡Œäº‘OSS"></a><span class="exturl" data-url="aHR0cHM6Ly93d3cuYWxpeXVuLmNvbS9wcm9kdWN0Li9vc3M=">é˜¿é‡Œäº‘OSS</span></h3><p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li>æ”¯æŒä¸°å¯Œçš„å›¾ç‰‡å¤„ç†<span class="exturl" data-url="aHR0cHM6Ly9oZWxwLmFsaXl1bi5jb20vZG9jdW1lbnQuX2RldGFpbC80NDY4Ni5odG1s">https://help.aliyun.com/document._detail/44686.html</span></li>
<li>egg.jsæœ‰å¯¹åº”çš„æ’ä»¶ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2VnZ2pzL2VnZy1vc3M=">https://github.com/eggjs/egg-oss</span></li>
</ul>
<p><strong>ä»·æ ¼</strong></p>
<ul>
<li>ä¸‹è¡Œæµé‡100GBä¸€å¹´352å…ƒ<span class="exturl" data-url="aHR0cHM6Ly9jb21tb24tYnV5LmFsaXl1bi5jb20vP3NwbT01MTc2Ljc5MzM2OTEuSl81MjUzNzg1MTYwLjEuMmUzOTRjNTlxM0ZJc0EmY29tbW9kaXR5Q29kZT1vc3NiYWcjL2J1eQ==">https://common-buy.aliyun.com/?spm=5176.7933691.J_5253785160.1.2e394c59q3FIsA&amp;commodityCode=ossbag#/buy</span></li>
<li>åŸºæœ¬å›¾ç‰‡å¤„ç†ï¼šæ¯æœˆ0-10TB:å…è´¹&gt;10TB:0.025å…ƒ&#x2F;GB</li>
</ul>
<h3 id="ä¸ƒç‰›äº‘KODO"><a href="#ä¸ƒç‰›äº‘KODO" class="headerlink" title="ä¸ƒç‰›äº‘KODO"></a><span class="exturl" data-url="aHR0cHM6Ly93d3cucWluaXUuY29tL3ByaWNlcy9rb2Rv">ä¸ƒç‰›äº‘KODO</span></h3><p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å¤šåª’ä½“å¤„ç†åŠŸèƒ½éå¸¸ä¸°å¯Œ<span class="exturl" data-url="aHR0cHM6Ly93d3cuZ2luaXUuY29tL3Byb2R1Y3RzL2RvcmE=">https://www.giniu.com/products/dora</span></li>
<li>å›¾ç‰‡è§†é¢‘å¤„ç†</li>
<li>å®¡æ ¸</li>
<li>äººå·¥æ™ºèƒ½åˆ†æ</li>
</ul>
<p><strong>ä»·æ ¼ï¼š</strong></p>
<ul>
<li>å¤–ç½‘æµå‡º100GB-å¹´278.4å…ƒ<span class="exturl" data-url="aHR0cHM6Ly9xbWFsbC5xaW5pdS5jb20vdGVtcGxhdGUuL01URXk/c3BlY19jb21ibz1NekUwTlE=">https://qmall.qiniu.com/template./MTEy?spec_combo=MzE0NQ</span></li>
<li>åŸºæœ¬å›¾ç‰‡å¤„ç†ï¼šæ¯æœˆ0-20TB:å…è´¹20TBä»¥ä¸Šï¼š0.025å…ƒ&#x2F;GB https:&#x2F;<span class="exturl" data-url="aHR0cDovL3d3dy5xaW5pdS5jb20vcHJpY2VzL2RvcmE=">www.qiniu.com/prices/dora</span></li>
</ul>
<h3 id="è…¾è®¯äº‘COS"><a href="#è…¾è®¯äº‘COS" class="headerlink" title="è…¾è®¯äº‘COS"></a><span class="exturl" data-url="aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kb2N1bWVudC9wcm9kdWN0LzQzNg==">è…¾è®¯äº‘COS</span></h3><p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<p>å›¾åƒå¤„ç†æœ‰ä¸€äº›æ–°çš„äº®ç‚¹ï¼Œæ¯”å¦‚è‡ªç ”çš„TPGå‹ç¼©ç­‰</p>
<p><strong>ä»·æ ¼ï¼š</strong></p>
<ul>
<li>å¤–ç½‘æµå‡º100GBä¸€å¹´396å…ƒ<span class="exturl" data-url="aHR0cHM6Ly9idXkuY2xvdWQudGVuY2VudC4uY29tL3ByaWNlL2NvcyN0YWIwLWxpc3Qx">https://buy.cloud.tencent..com/price/cos#tab0-list1</span></li>
<li>åŸºæœ¬å›¾ç‰‡å¤„ç†ï¼šæ¯æœˆ0-20TB:å…è´¹20TBä»¥ä¸Šï¼š0.025å…ƒ&#x2F;GB</li>
<li><span class="exturl" data-url="aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kb2N1bWVudC9wcm9kdWN0LzEyNDYvNDUyNzQ=">https://cloud.tencent.com/document/product/1246/45274</span></li>
<li>å›¾ç‰‡å‹ç¼©ï¼š1å…ƒ&#x2F;åƒæ¬¡</li>
</ul>
<h1 id="SSRæœåŠ¡ç«¯æ¸²æŸ“"><a href="#SSRæœåŠ¡ç«¯æ¸²æŸ“" class="headerlink" title="SSRæœåŠ¡ç«¯æ¸²æŸ“"></a>SSRæœåŠ¡ç«¯æ¸²æŸ“</h1><h3 id="ä»‹ç»-1"><a href="#ä»‹ç»-1" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p><strong>SSR-Server Side Rendering</strong></p>
<p>Vueå…³äºSSRçš„ä»‹ç»ï¼šhttps:&#x2F;sSr.uejs.org&#x2F;zh</p>
<p><strong>SSRçš„ä¼˜ç‚¹</strong></p>
<ul>
<li>æ›´å¥½çš„SEO</li>
<li>æ›´å¿«çš„æ¸²æŸ“æ—¶é—´(Time to content)ï¼Œ</li>
</ul>
<p><strong>SSRçš„ç¼ºç‚¹</strong></p>
<ul>
<li><p>å¼€å‘çš„é™åˆ¶ï¼Œæµè§ˆå™¨ç›¸å…³çš„æ“ä½œåªèƒ½åœ¨ç‰¹å®šçš„é’©å­å‡½æ•°ä¸­ä½¿ç”¨</p>
</li>
<li><p>SPAåº”ç”¨å®Œå…¨é™æ€åŒ–ï¼Œè€ŒSSR appéœ€è¦Node.js Serveræ‰èƒ½è¿è¡Œ</p>
</li>
<li><p>æœåŠ¡ç«¯è´Ÿè·æ›´é«˜</p>
</li>
</ul>
<p><strong>SSRçš„å®ç°ï¼š</strong></p>
<ul>
<li><p>åŸºæœ¬åŸç†ï¼š@vue&#x2F;server-renderer https:lv3.uejs.org&#x2F;guide&#x2F;ssr&#x2F;getting-started.html#installation</p>
</li>
<li><p>ä½¿ç”¨createSSRApp,renderToStringä»¥åŠrenderToStreamæ–¹æ³•</p>
</li>
</ul>
<p><strong>æˆç†Ÿçš„ï¼Œå¤§è€Œå…¨çš„SSRé€šç”¨å¼€å‘æ¡†æ¶ï¼š</strong></p>
<ul>
<li>Nuxt.js <span class="exturl" data-url="aHR0cHM6Ly9udXh0anMub3JnLw==">https://nuxtjs.org/</span>  ï¼ˆVueï¼‰</li>
<li>Reactç±»ä¼¼çš„Next.js https:&#x2F;nextjs.orgl ï¼ˆReactï¼‰</li>
</ul>
<h3 id="SSR"><a href="#SSR" class="headerlink" title="SSR"></a>SSR</h3><p>expressç­‰æ¡†æ¶çš„res.renderæ–¹æ³•å¯ä»¥æ¸²æŸ“htmlæ¨¡æ¿ï¼Œä½¿ç”¨çš„æ˜¯nunjucksåº“è¿›è¡Œæ•°æ®å¡«å……ã€‚</p>
<p>index.html</p>
<pre><code class="html">&lt;!DOCTYPE html&gt;
&lt;html class=&quot;no-js&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta name=&quot;description&quot; content=&quot;&#123;&#123; desc &#125;&#125;&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;title&gt;Document&lt;/title&gt;
&lt;/head&gt;
&lt;body style=&quot;&#123;&#123; bodyStyle &#125;&#125;&quot;&gt;  //æ ¹æ®ä¼ å…¥çš„propsåŠ¨æ€æ·»åŠ styleæ ·å¼
    &#123;&#123; html | safe &#125;&#125;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>index.js  (ä¾æ®expressæ¡†æ¶ä¸ºä¾‹ï¼š)</p>
<pre><code>//...resæ˜¯å“åº”å‚æ•°
res.render(&#39;index&#39;,function(err,html)&#123;
    res.send(html);
&#125;)
</code></pre>
<h3 id="vueä¸­SSR"><a href="#vueä¸­SSR" class="headerlink" title="vueä¸­SSR"></a>vueä¸­SSR</h3><p>1ã€vue3æœ‰åŒ…ï¼š@vue&#x2F;server-rendererï¼Œåœ¨3.2.13ç‰ˆæœ¬ä»¥ä¸Šå†…ç½®äº†ï¼Œä½äºæ­¤ç‰ˆæœ¬éœ€è¦è‡ªè¡Œå®‰è£…ã€‚</p>
<p>2ã€ä½¿ç”¨ï¼š</p>
<pre><code class="js">//.......... resæ˜¯æœåŠ¡ç«¯è¿”å›
import &#123; pipeline &#125; from &#39;stream/promises&#39;;
import &#123; createSSRApp &#125; from &#39;vue&#39;;
import &#123; renderToString , renderToNodeStream &#125; from &#39;@vue/server-renderer&#39;
const vueApp = createSSRApp(&#123;
    data:()=&gt;&#123; msg:&#39;hello world&#39; &#125;,
    template: &#39;&lt;h1&gt;&#123;&#123; msg &#125;&#125;&lt;/h1&gt;&#39;
&#125;)
const appContent = await renderToString(vueApp);
res.type = &#39;text/html&#39;;
res.body = appContent;
// æˆ–è€…ä½¿ç”¨æµå¼è¾“å‡ºï¼š
const stream = renderToNodeStream(vueApp);
res.statys = 200;
await pipeline(stream,res);
</code></pre>
<h1 id="RBACæƒé™éªŒè¯"><a href="#RBACæƒé™éªŒè¯" class="headerlink" title="RBACæƒé™éªŒè¯"></a>RBACæƒé™éªŒè¯</h1><h3 id="ä»‹ç»-2"><a href="#ä»‹ç»-2" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p><strong>æƒé™éªŒè¯çš„åœºæ™¯ä»¥åŠéœ€æ±‚ï¼š</strong></p>
<ul>
<li>ç‰¹å®šçš„è§’è‰²çš„ç”¨æˆ·æ‰èƒ½æ“ä½œç‰¹å®šçš„èµ„æº</li>
<li>ä¸åŒçš„ç”¨æˆ·èƒ½æ“ä½œåŒç±»èµ„æºçš„ç‰¹å®šå®ä½“</li>
<li>ä¸åŒçš„ç”¨æˆ·æ“ä½œç‰¹å®šèµ„æºçš„ä¸åŒå±æ€§</li>
</ul>
<p><strong>è°(User)æ‹¥æœ‰ä»€ä¹ˆæƒé™(Authorityï¼‰å»æ“ä½œ(Operation)å“ªäº›èµ„æº(Resource)</strong><br>æ ¹æ®è§’è‰²å®Œæˆæƒé™çš„æ§åˆ¶-RBAC(role based access control)ï¼Œå…¶å®å°±æ˜¯åœ¨åŸæœ¬ç”¨æˆ·â€”â€”-æƒé™çš„å¯¹åº”å…³ç³»ä¹‹ä¸ŠåŠ ä¸€å±‚ä¸­é—´å±‚è§’è‰²ï¼šç”¨æˆ·â€”â€”è§’è‰²â€”â€“æƒé™ã€‚å¥½å¤„æ˜¯ä½¿å¾—ç”¨æˆ·å’Œæƒé™çš„å¯¹åº”å…³ç³»æ›´åŠ æ¸…æ™°å’Œæ˜“äºæŒæ§ã€‚</p>
<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>Node.jså®ç°RBACçš„åº“ï¼š</p>
<ul>
<li><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL29udXJ5L2FjY2Vzc2NvbnRyb2w=">AccessControl.jsï¼ˆä¸æ¨èï¼Œä¸ç»´æŠ¤äº†ï¼‰</span></p>
<ul>
<li>1.6k Star</li>
<li>3å¹´æ²¡æœ‰æ›´æ–°ï¼Œå¾ˆå¤šissueæ²¡äººå¤„ç†</li>
<li>ä¸æ”¯æŒts</li>
</ul>
</li>
<li><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nhc2Jpbi9ub2RlLWNhc2Jpbg==">Casbin</span></p>
<ul>
<li>1.7k Star</li>
<li>tsç¼–å†™ï¼Œæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€</li>
<li>æ¦‚å¿µæ¯”è¾ƒå¤æ‚ï¼Œä½¿ç”¨ç•¥ç¹ç</li>
</ul>
</li>
<li><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N0YWxuaXkvY2FzbA==">Casl</span></p>
<ul>
<li><p>3.4k Star</p>
</li>
<li><p>tsç¼–å†™</p>
</li>
<li><p>ç®€å•æ˜“ç”¨ï¼Œå¯è¯»æ€§è‰¯å¥½</p>
</li>
</ul>
</li>
</ul>
<h3 id="Caslä½¿ç”¨"><a href="#Caslä½¿ç”¨" class="headerlink" title="Caslä½¿ç”¨"></a><strong>Caslä½¿ç”¨</strong></h3><pre><code class="js">import &#123; AbilityBuilder , Ability &#125; from &#39;@casl/ability&#39;;
class Work &#123;
    constructor(attrs)&#123;
        Object.assign(this,attrs);
    &#125;
&#125;
const templateWork = new Work(&#123; id : 1 , isTemplate : true &#125;);
const notWork = new Work(&#123; id : 2 , isTemplate : false &#125;);
function defineRules()&#123;
    const &#123; can , cannot ,build &#125; = new AbilityBuilder(Ability);
    can(&#39;read&#39;,&#39;Work&#39;);
    cannot(&#39;delete&#39;,&#39;Work&#39;);
    can(&#39;update&#39;,&#39;Work&#39;,&#123;isTemplate:false&#125;);
    return build();
&#125;
console.log(templateWork.constructor.name)
const rules defineRules()
console.log(rules.can(&#39;read&#39;,&#39;Work&#39;))
console.log(rules.can(&#39;delete&#39;,&#39;Work&#39;))
console.log(rules.can(&#39;update&#39;,templateWork))
console.log(rules.can(&#39;update&#39;,notWork))
</code></pre>
<h1 id="éƒ¨ç½²-1"><a href="#éƒ¨ç½²-1" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h1><h3 id="ä¼ ç»Ÿæ¨¡å¼"><a href="#ä¼ ç»Ÿæ¨¡å¼" class="headerlink" title="ä¼ ç»Ÿæ¨¡å¼"></a>ä¼ ç»Ÿæ¨¡å¼</h3><p><strong>æœ¬åœ°å¼€å‘</strong><br>ä½¿ç”¨<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2VnZ2pzL2VnZy1iaW4=">egg-bin</span>ï¼Œæä¾›äº†ä¾¿æ·çš„æ–¹å¼åœ¨æœ¬åœ°è¿›è¡Œå¼€å‘ã€è°ƒè¯•ã€å•å…ƒæµ‹è¯•ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨çš„ç›‘æ§æ–‡ä»¶çš„ä¿®æ”¹ï¼Œç„¶åé‡æ–°è¿è¡Œå¯¹åº”çš„å‘½ä»¤ã€‚<br>é‡‡ç”¨çš„é…ç½®æ–‡ä»¶æ˜¯ï¼šconfig.default.ts<br>å¯åŠ¨å¼€å‘ç¯å¢ƒå‘½ä»¤ä¸º<code>egg-bin dev</code><br><strong>ç”Ÿäº§ç¯å¢ƒè¿è¡Œç¨‹åº</strong><br><span class="exturl" data-url="aHR0cHM6Ly9wbTIua2V5bWV0cmljcy5pby8=">pm2-process manager</span></p>
<p><code>node script.js pm2 start script.js</code></p>
<p><strong>PM2çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>clusteræ¨¡å¼è¿è¡Œ</li>
<li>è‡ªåŠ¨é‡å¯auto reload</li>
<li>çƒ­æ›¿æ¢hot reload</li>
<li>æ€§èƒ½ç›‘æ§Monitoring</li>
</ul>
<p><strong>egg.jsä¸­æœ‰å¯¹åº”äºPM2çš„å†…ç½®æ–¹æ³•ï¼š</strong></p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2VnZ2pzL2VnZy1zY3JpcHRz">egg-scripts</span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2VnZ2pzL2VnZy1jbHVzdGVy">egg-cluster</span></li>
</ul>
<p><strong>egg.jsç”Ÿäº§ç¯å¢ƒå¯åŠ¨å’Œå…³é—­</strong><br><code>egg-scripts start egg-scripts stop</code></p>
<p><strong>é…ç½®æ–‡ä»¶</strong><br>config.prod.ts config.default.ts<br><strong>ç¼–è¯‘è¿‡ç¨‹</strong><br>éœ€è¦æ‰‹åŠ¨å°†tsè½¬æ¢ä¸ºjs,å€ŸåŠ©<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3doeGF4ZXMvZWdnLXRzLWhlbHBlcg==">ets</span><br><code>ç‰¹åˆ«æ³¨æ„å°†é¡¹ç›®ä¸­çš„typscriptç‰ˆæœ¬å‡çº§åˆ°4.4.3 </code></p>
<p><code>npm run tsc</code></p>
<h2 id="Clusteræ¨¡å‹"><a href="#Clusteræ¨¡å‹" class="headerlink" title="Clusteræ¨¡å‹"></a>Clusteræ¨¡å‹</h2><p><strong>Egg.js Clusteræ¨¡å‹çš„åŸç†</strong><br>Egg.jså…³äºè¿™éƒ¨åˆ†å†…å®¹çš„æ–‡æ¡£ï¼š<span class="exturl" data-url="aHR0cHM6Ly9lZ2dqcy5vcmcvemgtY24vY29yZS9jbHVzdGVyLWFuZC1pcGMuaHRtbA==">https://eggjs.org/zh-cn/core/cluster-and-ipc.html</span><br><strong>ä¸ºä»€ä¹ˆè¦é‡‡ç”¨Clusteræ¨¡å¼</strong><br>JavaScriptä»£ç æ˜¯è¿è¡Œåœ¨å•çº¿ç¨‹ä¸Šçš„ï¼Œé‚£ä¹ˆå¦‚æœç”¨Node.jsæ¥åšWeb Server,å°±æ— æ³•äº«å—åˆ°å¤šæ ¸è¿ç®—çš„å¥½å¤„ã€‚<br><strong>ä»€ä¹ˆæ˜¯Clusteræ¨¡å¼</strong><br>æ–‡æ¡£ï¼šhttp:l&#x2F;nodejs.cn&#x2F;api&#x2F;cluster.html</p>
<p>Node.jSçš„å•ä¸ªå®ä¾‹åœ¨å•ä¸ªçº¿ç¨‹ä¸­è¿è¡Œã€‚ä¸ºäº†åˆ©ç”¨å¤šæ ¸ç³»ç»Ÿï¼Œç”¨æˆ·æœ‰æ—¶ä¼šæƒ³<br>è¦å¯åŠ¨Node.jsè¿›ç¨‹çš„é›†ç¾¤æ¥å¤„ç†è´Ÿè½½ã€‚</p>
<ul>
<li>åœ¨æœåŠ¡å™¨ä¸ŠåŒæ—¶å¯åŠ¨å¤šä¸ªè¿›ç¨‹</li>
<li>æ¯ä¸ªè¿›ç¨‹é‡Œéƒ½è·‘çš„æ˜¯åŒä¸€ä»½æºä»£ç ï¼ˆå°†ä¸€ä¸ªè¿›ç¨‹çš„å·¥ä½œåˆ†ç»™å¤šä¸ªè¿›ç¨‹å»åšï¼‰</li>
<li>è¿™äº›è¿›ç¨‹å¯ä»¥åŒæ—¶ç›‘å¬ä¸€ä¸ªç«¯å£</li>
</ul>
<p><strong>Clusterçš„è¿è¡Œæ¨¡å¼ï¼š</strong></p>
<p>Requestâ€”â€”â€”â€”-master_processä¸»è¿›ç¨‹â€”â€”â€”â€”â€”â€”â€”workersè¿›ç¨‹ï¼ˆå¤šä¸ªï¼‰</p>
<p><strong>è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰ï¼š</strong></p>
<p><span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvJUU4JUExJThDJUU3JUE4JThCJUU5JTk2JTkzJUU5JTgwJTlBJUU4JUE4JThB">IPC Inter-Process Communication</span></p>
<p>IPCæŒ‡çš„æ˜¯è‡³å°‘ä¸¤ä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹é—´ä¼ é€æ•°æ®æˆ–ä¿¡å·çš„ä¸€äº›æŠ€æœ¯æˆ–è€…æ–¹æ³•ï¼ŒNode.jså°†å…¶å°è£…ä¸ºåŸºäºäº‹ä»¶çš„å½¢å¼ä¾¿äºä½¿ç”¨ã€‚</p>
<p><strong>Clusterä½¿ç”¨ï¼š</strong></p>
<pre><code class="js">import http from &#39;http&#39;;
import cluster from &#39;cluster&#39;;
import &#123; cpus &#125; from &#39;os&#39;;
import process from &#39;process&#39;;
if(cluster.isPrimary)&#123;
    console.log(`master $&#123;process.pid&#125; running`);
    const cpuLength = cpus().length;
    for(let i = 0 ; i &lt; cpuLength ; i++)&#123;
        cluster.fork();
    &#125;
    cluster.on(&#39;exit&#39;,(worker)=&gt;&#123;
        console.log(`worker $&#123;worker.process.pid&#125; exited`);
    &#125;)
&#125;else&#123;
    http.createServer((req,res)=&gt;&#123;
        res.writeHead(200);
        res.end(&quot;hello world&quot;);
    &#125;).listen(8000);
    console.log(`worker $&#123;process.pid&#125; started`);
    console.log(cluster.workers); //è·å¾—å­è¿›ç¨‹ï¼Œå¯ä»¥é€šè¿‡process.sendå’Œon(&#39;message&#39;)äº‹ä»¶è¿›è¡Œè¿›ç¨‹é—´é€šä¿¡ã€‚
&#125;
</code></pre>
<p><strong>egg.jsä¸­å¯¹äºClusterçš„äºŒæ¬¡å°è£…ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨egg-scriptså¯åŠ¨master process</li>
<li>ä½¿ç”¨egg-clusterå¯åŠ¨å’ŒCPUæ ¸æ•°ç›¸ç­‰çš„app_worker process</li>
<li>ä½¿ç”¨egg-clusterå¯åŠ¨çš„ä¸€ä¸ªç‹¬ç‰¹çš„agent_.worker process</li>
</ul>
<p><strong>è¿›ç¨‹å®ˆæŠ¤</strong><br>è€ƒè™‘åˆ°ç”Ÿäº§ç¯å¢ƒçš„å¥å£®æ€§ï¼Œå¿…é¡»ä¿è¯è¿›ç¨‹å¼‚å¸¸çš„æƒ…å†µä¸‹æ€æ ·å¤„ç†ã€‚<br><strong>å½“ä»£ç æŠ›å‡ºå¼‚å¸¸å¹¶æ²¡æœ‰è¢«æ•è·çš„æ—¶å€™ï¼Œworkerä½¿ç”¨process.on(â€˜uncaughtExceptionâ€™,handler)æ¥æ•è·å¯¹åº”çš„é”™è¯¯ï¼Œè¿™æ—¶è¿›ç¨‹å¤„äºä¸ç¡®å®šçš„çŠ¶æ€ï¼Œéœ€è¦ä¼˜é›…é€€å‡ºã€‚</strong></p>
<p><strong>ç³»ç»Ÿå¼‚å¸¸</strong><br>è€Œå½“ä¸€ä¸ªè¿›ç¨‹å‡ºç°å¼‚å¸¸å¯¼è‡´crashæˆ–è€…è¢«ç³»ç»Ÿæ€æ­»æ—¶ï¼Œä¸åƒæœªæ•è·å¼‚å¸¸å‘ç”Ÿæ—¶æˆ‘ä»¬è¿˜æœ‰æœºä¼šè®©è¿›ç¨‹ç»§ç»­æ‰§è¡Œï¼ŒMasterç«‹åˆ»forkä¸€ä¸ªæ–°çš„Workerã€‚<br><strong>Agentæœºåˆ¶</strong><br>æœ‰ä¸€äº›ç‰¹æ®Šæ€§è´¨çš„å·¥ä½œï¼Œä¸èƒ½å¤šä¸ªworkerä¸€èµ·åˆä½œï¼Œå®¹æ˜“é€ æˆæ··ä¹±ã€‚å¯¹äºè¿™ç§å·¥ä½œegg.jsæä¾›äº†ä¸€ä¸ªæ–°çš„agentè¿›ç¨‹æ¥å®Œæˆã€‚</p>
<p><strong>Egg.jsä¸‰ç§è¿›ç¨‹çš„æ€»ç»“ï¼š</strong></p>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>è¿›ç¨‹æ•°é‡</th>
<th>ä½œç”¨</th>
<th>ç¨³å®šæ€§</th>
<th>æ˜¯å¦è¿è¡Œä¸šåŠ¡ä»£ç </th>
</tr>
</thead>
<tbody><tr>
<td>Masterè¿›ç¨‹</td>
<td>1</td>
<td>è¿›ç¨‹ç®¡ç†ï¼Œè¿›ç¨‹é—´æ¶ˆæ¯è½¬å‘</td>
<td>éå¸¸é«˜</td>
<td>å¦</td>
</tr>
<tr>
<td>Agentè¿›ç¨‹</td>
<td>1</td>
<td>åå°è¿è¡Œå·¥ä½œ</td>
<td>é«˜</td>
<td>å°‘é‡</td>
</tr>
<tr>
<td>Workersè¿›ç¨‹</td>
<td>CPUæ ¸æ•°</td>
<td>æ‰§è¡Œä¸šåŠ¡ä»£ç </td>
<td>ä¸€èˆ¬</td>
<td>æ˜¯</td>
</tr>
</tbody></table>
<p><strong>Clusteræ¨¡å‹å’ŒNodeå¤šè¿›ç¨‹çš„åŒºåˆ«ï¼š</strong></p>
<ul>
<li>Clusteræ¨¡å—å¯ä»¥å°†ä¸€ä¸ªnodeè¿›ç¨‹åˆ†è£‚æˆå¤šä¸ªå­è¿›ç¨‹ï¼Œæ¯ä¸ªå­è¿›ç¨‹ç‹¬ç«‹è¿è¡Œåœ¨cpuå†…æ ¸ä¸Šï¼Œä»¥æå‡åº”ç”¨ç¨‹åºçš„å¹¶å‘èƒ½åŠ›å’Œæ€§èƒ½ï¼Œé€šè¿‡ä¸»è¿›ç¨‹å’Œå­è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æ¥å®ç°è´Ÿè½½å‡è¡¡ï¼Œå¤„ç†å¹¶å‘è¯·æ±‚ã€‚</li>
<li>nodeå¤šè¿›ç¨‹ä½¿ç”¨child_processæ¨¡å—ï¼Œå…¶ä¸å…·å¤‡è´Ÿè½½å‡è¡¡å’Œé€šä¿¡æœºåˆ¶ï¼Œéœ€è¦è‡ªè¡Œå®ç°è¿›ç¨‹é—´é€šä¿¡å’Œè´Ÿè½½å‡è¡¡é€»è¾‘ã€‚å¯ç”¨äºå¤„ç†é•¿æ—¶æ“ä½œï¼Œè¿”å›ç»“æœç»™ä¸»è¿›ç¨‹ã€‚</li>
</ul>
<p><strong>Node.jså‹åŠ›æµ‹è¯•å·¥å…·ï¼š</strong></p>
<p>æ¨¡æ‹Ÿé«˜å¹¶å‘åœºæ™¯ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvbG9hZHRlc3Q=">Loadtest</span></p>
<pre><code class="bash"># n                   æ€»è¿‡å‘é€å¤šå°‘ä¸ªè¯·æ±‚
# c concurrency       åŒæ—¶æœ‰å‡ ä¸ªå®¢æˆ·ç«¯åœ¨å‘é€è¯·æ±‚
# rps request per seconds   æ¯ç§’å‘é€å¤šå°‘ä¸ªè¯·æ±‚
loadtest -n 400 -c 10 --rps 200 http://mysite.com/ 
</code></pre>
<h1 id="äº‘æœåŠ¡å™¨"><a href="#äº‘æœåŠ¡å™¨" class="headerlink" title="äº‘æœåŠ¡å™¨"></a>äº‘æœåŠ¡å™¨</h1><h4 id="è´­ä¹°"><a href="#è´­ä¹°" class="headerlink" title="è´­ä¹°"></a>è´­ä¹°</h4><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuYWxpeXVuLmNvbS9wcm9kdWN0L2Vjcw==">é˜¿é‡Œäº‘ECS</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9wcm9kdWN0L2N2bQ==">è…¾è®¯äº‘CVM</span></p>
<p>ä»·æ ¼ï¼ˆå­¦ç”Ÿä¼˜æƒ ï¼‰ï¼š<span class="exturl" data-url="aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9hY3QvY2FtcHVzP2Zyb209MTQ1OTk=">https://cloud.tencent.com/act/campus?from=14599</span> 12G 38</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuaHVhd2VpY2xvdWQuY29tL3Byb2R1Y3QvZWNzLmh0bWw=">åä¸ºäº‘ECS</span></p>
<h4 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h4><p><strong>ä¸ºä»€ä¹ˆä½¿ç”¨rootç™»å½•æ—¶ä¸€ä¸ªä¸å¥½çš„å®è·µ</strong></p>
<ul>
<li>æœ‰éå¸¸å¤šçš„botä¼šå°è¯•ä½¿ç”¨root+pwdçš„sshæ–¹å¼æš´åŠ›ç™»å½•æœºå™¨ï¼Œå½“å°è¯•æˆåŠŸä»¥åï¼Œé»‘å®¢å°±ä¼šæ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚</li>
<li><em>å‡å¦‚ä½¿ç”¨ç‰¹å®šç”¨æˆ·å+pwd,botéœ€è¦å…ˆçŒœæµ‹ç”¨æˆ·å(Næ¬¡)ï¼Œç„¶åæ˜¯å¯†ç (Mæ¬¡)ï¼Œè¿™æ ·å¤æ‚åº¦æå‡åˆ°N</em>M</li>
<li>rootå¯ä»¥é€ æˆæ›´å¤§çš„å±å®³ï¼Œå½±å“æ•´ä¸ªç³»ç»Ÿï¼Œè€ŒæŸä¸ªç‰¹å®šç”¨æˆ·åªèƒ½å½±å“å®ƒçš„æ–‡ä»¶ç³»ç»Ÿ</li>
</ul>
<p><strong>åˆ›å»ºä¸€ä¸ªç”¨æˆ·è´¦å·è¿›è¡Œç™»å½•</strong></p>
<pre><code class="bash"># è¿œç¨‹ç™»å½•
ssh root@xxx.xx.xx.xx
# æ·»åŠ ç”¨æˆ·ä»¥åŠè®¾ç½®å¯†ç 
adduser dmq
</code></pre>
<p><strong>è®¾ç½®è¯¥ç”¨æˆ·æ‹¥æœ‰sudoæƒé™ï¼Œç»™äºˆå®ƒåœ¨ç™»å½•ä»¥ååˆ‡æ¢åˆ°rootçš„èƒ½åŠ›</strong></p>
<pre><code class="bash"># ä¿®æ”¹æƒé™ï¼Œuè¡¨ç¤ºæ‰€æœ‰è€…ï¼Œwè¡¨ç¤ºå†™æƒé™+è¡¨ç¤ºæ·»åŠ 
chmod u+w /etc/sudoers
# ç¼–è¾‘æ–‡ä»¶
vim /etc/sudoers
# æ‰¾åˆ°  `root ALL=(ALL)  ALL`
# å†åŠ ä¸€è¡Œ  `dmq ALL=(ALL)  ALL`
</code></pre>
<p><strong>ä½¿ç”¨æ–°ç”¨æˆ·ç™»å½•å¹¶ä¸”æµ‹è¯•æƒé™</strong></p>
<pre><code class="bash">ssh dmq@xxx.xx.xx.xx
# å¯ä»¥ä½¿ç”¨ su ç›´æ¥åˆ‡æ¢ä¸ºrootç”¨æˆ·
# ä¹Ÿå¯ä»¥ä½¿ç”¨sudoå¿«æ·çš„ä½¿ç”¨rootæƒé™è¿›è¡Œæ“ä½œ
</code></pre>
<p><strong>ç¦æ­¢ä½¿ç”¨rootè¿œç¨‹ç™»å½•ssh</strong></p>
<pre><code class="bash"># ä¿®æ”¹sshé…ç½®
vim /etc/ssh/sshd_config I
# ä¿®æ”¹yesä¸ºno
PermitRootLogin no
# é‡å¯sshdæœåŠ¡
service sshd restart
</code></pre>
<p><strong>å¯é€‰ï¼šä¸ä½¿ç”¨å¯†ç ç™»å½•</strong><br>ä¸ºä»€ä¹ˆä½¿ç”¨å¯†ç ç™»å½•æœ‰æ—¶å€™æ˜¯ä¸€ä¸ªä¸å¥½çš„å®è·µï¼Ÿ<br><strong>éå¸¸ç®€å•ï¼šç”¨æˆ·ç»å¸¸ä½¿ç”¨éå¸¸é”™è¯¯ï¼ˆç®€å•çš„ï¼‰ç”¨æˆ·å¯†ç ï¼Œå…¨çƒæœ€å¸¸ç”¨çš„å¯†ç æ˜¯123456ä»¥åŠbc123,è€Œä¸”ç”¨æˆ·ä¼šåœ¨å¤šä¸ªè´¦æˆ·å¤§é‡é‡å¤ä½¿ç”¨ï¼Œæ‰€ä»¥é»‘å®¢ä»åˆ«çš„åœ°æ–¹ç›—å–çš„å¯†ç å¾ˆå¯èƒ½åœ¨å…¶ä»–è´¦æˆ·ä¹Ÿå¯ä»¥ä½¿ç”¨</strong></p>
<p><strong>ä½¿ç”¨SSH kevè®²è¡Œç™»å½•</strong><br>SSH keyé‡‡è§’äº†ç»å…¸çš„éå¯¹ç§°åŠ å¯†æŠ€æœ¯ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…·åˆ›å»ºä¸€ä¸ªå…¬é’¥å’Œç§é’¥ï¼Œä½ å¯ä»¥å°†å…¬é’¥æ”¾ç½®åœ¨ä»»ä½•çš„æœåŠ¡å™¨å½“ä¸­ï¼Œåœ¨æœ¬åœ°ä¿ç•™ç§é’¥ã€‚åœ¨sshç™»å½•çš„æ—¶å€™ï¼ŒSSHéªŒè¯å…¬é’¥å’Œç§é’¥çš„åˆæ³•æ€§ï¼Œå½“åˆæ³•çš„æ—¶å€™ï¼Œå°±å¯ä»¥å…å¯†ç ç™»å½•äº†ã€‚è¯ä¹¦ç”±1024Bitsåˆ°4096Bitsï¼ˆ128åˆ°512å­—ç¬¦)çš„éšæœºå­—ç¬¦ç»„æˆï¼Œ<br>è¦æ¯”ä½ è‡ªå·±çš„å¯†ç å®‰å…¨çš„å¤šã€‚</p>
<pre><code class="bash">#åˆ›å»ºssh key pair
ssh-keygen -t rsa -b 4096 -C &quot;your email@example.com&quot;
windowså¯ä»¥ä½¿ç”¨puttyæˆ–è€…git scmaè½¯ä»¶ç”Ÿæˆï¼Œå¤‡æ³¨ç½‘å€ï¼š
https://www.jianshu.com/p/95262f5eba7a
# æœ¬åœ°sshè¯ä¹¦çš„ä½ç½®
-/.ssh/id rsa
-/.ssh/id rsa.pub
# ç™»å½•è¿œç¨‹æœºå™¨
ssh viking@xxx.xx.xx.xx
# åˆ›å»ºå—ä¿¡ä»»çš„ç™»å½•å¯†é’¥
# è¿™ä¸ªæ–‡ä»¶å½“ä¸­çš„å…¬é’¥ä¼šè¢«å½“å‰çš„ä¸»æœºè®¾ç½®ä¸ºä¿¡ä»»æ–¹
touch -/.ssh/authorized keys
# å°†id rsa.pubçš„æ–‡æœ¬å†…å®¹é»è´´è¿›æ¥
</code></pre>
<p><strong>å¯é€‰ï¼Œå…³é—­å¯†ç ç™»å½•æœåŠ¡å™¨çš„åŠŸèƒ½</strong></p>
<pre><code class="bash#ä¿®æ”¹sshé…ç½®">vim /etc/ssh/sshd config
#ä¿®æ”¹ä¸ºno
PasswordAuthentication no
#é‡å¯æœåŠ¡
service sshd i restart
</code></pre>
<h4 id="ä½¿ç”¨-1"><a href="#ä½¿ç”¨-1" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><p><strong>å‡†å¤‡äº‘æœåŠ¡å™¨å¿…å¤‡è½¯ä»¶</strong></p>
<ul>
<li>nodejs (16)</li>
<li>MongoDB</li>
<li>Redis</li>
<li>Git</li>
</ul>
<p><strong>Linuxå‘è¡Œç‰ˆçš„ä¸¤å¤§å®¶æ—</strong></p>
<ul>
<li>Debian(å®Œå…¨å…è´¹çš„Linuxå‘è¡Œç‰ˆ)-Ubuntu(åŸºäºDebian,æ›´åŠ å®¹æ˜“ä¸Šæ‰‹)-aptåŒ…ç®¡ç†ç³»ç»Ÿ-è½¯ä»¶æ ¼å¼ä¸ºdebåŒ…å¤§</li>
<li>Red Hat(å•†ç”¨Linuxå‘è¡Œç‰ˆ)-CentOS(Red Hatå‡å»æ”¶è´¹è½¯ä»¶)-yumåŒ…ç®¡ç†ç³»ç»Ÿ-è½¯ä»¶æ ¼å¼ä¸ºrpm</li>
</ul>
<p><strong>è½¯ä»¶å®‰è£…</strong><br><strong>å®‰è£…Node.js</strong><br>1å®‰è£…nvmç®¡ç†nodeç‰ˆæœ¬<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL252bS1zaC9udm0=">https://github.com/nvm-sh/nvm</span><br>2ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…nodeæœ€æ–°ç‰ˆæœ¬<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL25vZGVzb3VyY2UvZGlzdHJpYnV0aW9ucy9ibG9iL21hc3Rlci9SRUFETUUubWQjZGVi">https://github.com/nodesource/distributions/blob/master/README.md#deb</span></p>
<p><strong>å®‰è£…MongoDB</strong><br>1ä»æºä»£ç ä¸‹è½½å®‰è£…ï¼Œå›é¡¾ä¹‹å‰çš„å†…å®¹<br>2ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…<br>Ubuntu:<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29tL21hbnVhbC90dXRvcmlhbC9pbnN0YWxsLW1vbmdvZGItb24tdWJ1bnR1Lw==">https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/</span><br>Centos:<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29tL21hbnVhbC90dXRvcmlhbC9pbnN0YWxsLW1vbmdvZGItb24tcmVkLWhhdC8=">https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/</span></p>
<p><strong>å®‰è£…Redis</strong><br>*1ä»æºä»£ç ä¸‹è½½å®‰è£…ï¼Œå›é¡¾ä¹‹å‰çš„åŸºç¡€çŸ¥è¯†<br>*2ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…<br>CentOS:<span class="exturl" data-url="aHR0cHM6Ly93d3cuZGlnaXRhbG9jZWFuLmNvbS9jb21tdW5pdHkvdHV0b3JpYWxzL2hvdy10by1pbnN0YWxsLXNlY3VyZS1yZWRpcy1jZW50b3MtNw==">https://www.digitalocean.com/community/tutorials/how-to-install-secure-redis-centos-7</span><br>Ubuntu:<span class="exturl" data-url="aHR0cHM6Ly93d3cuZGlnaXRhbG9jZWFuLmNvbS9jb21tdW5pdHkvdHV0b3JpYWxzL2hvdy10by1pbnN0YWxsLWFuZC1zZWN1cmUtcmVkaXMtb24tdWJ1bnR1LTE4LTA0">https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-redis-on-ubuntu-18-04</span></p>
<h4 id="ç®¡ç†"><a href="#ç®¡ç†" class="headerlink" title="ç®¡ç†"></a>ç®¡ç†</h4><p><strong>ä½¿ç”¨serviceæˆ–è€…systemctlç®¡ç†æœåŠ¡</strong></p>
<pre><code class="bash"># systemd æ¨¡å— - https://en.wikipedia.org/wiki/Systemd
service  æœåŠ¡åç§°(mongod)  æ“ä½œæŒ‡ä»¤(status/start/stop/restart)
systemctl  æ“ä½œæŒ‡ä»¤(start/stop/status/restart/reload)  æœåŠ¡åç§°service
</code></pre>
<h1 id="æ™®é€šéƒ¨ç½²"><a href="#æ™®é€šéƒ¨ç½²" class="headerlink" title="æ™®é€šéƒ¨ç½²"></a>æ™®é€šéƒ¨ç½²</h1><p><strong>åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²å¹¶è¿è¡Œ</strong></p>
<ul>
<li><p>1ç™»å½•è¿œç¨‹æœºå™¨ï¼Œä½¿ç”¨æ™®é€šç”¨æˆ·ã€‚</p>
</li>
<li><p>2åœ¨è‡ªå·±çš„ç›®å½•ä¸‹é¢ï¼Œcloneä»£ç </p>
</li>
<li><p>3å®‰è£…å¯¹åº”çš„ä¾èµ–</p>
<ul>
<li><p>å¯ä»¥ä½¿ç”¨sharpæ·˜å®mirroræ¥å®‰è£…æ¯”è¾ƒå¤§çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>
</li>
<li><p><span class="exturl" data-url="aHR0cHM6Ly9zaGFycC5waXhlbHBsdW1iaW5nLmNvbS9pbnN0YWxsI2NoaW5lc2UtbWlycm9y">https://sharp.pixelplumbing.com/install#chinese-mirror</span></p>
</li>
</ul>
</li>
<li><p>4åˆ›å»ºå¹¶ä¸”è®¾ç½®.envæ–‡ä»¶</p>
</li>
<li><p>5å¼€å¯äº‘æœåŠ¡å¯¹åº”çš„ç«¯å£(7001)è®¿é—®ã€‚</p>
<ul>
<li><p>é˜¿é‡Œäº‘ï¼šå·¦ä¾§å¯¼èˆªâ€œæœ¬å®ä¾‹å®‰å…¨ç»„â€ï¼Œâ€œé…ç½®è§„åˆ™â€ï¼Œâ€œæ‰‹åŠ¨æ·»åŠ â€ç«¯å£</p>
</li>
<li><p>å…¶ä»–äº‘å¹³å°è¯·è‡ªè¡ŒæŸ¥çœ‹ã€‚</p>
</li>
</ul>
</li>
<li><p>6å¯åŠ¨æœåŠ¡å™¨</p>
<ul>
<li><p>ç¡®è®¤mongo,redisåœ¨è¿è¡ŒçŠ¶æ€</p>
</li>
<li><p>npm run tsc</p>
</li>
<li><p>npm run start</p>
</li>
</ul>
</li>
</ul>
<p>äºæ­¤å¯ä»¥å®ŒæˆåŸºæœ¬çš„é¡¹ç›®éƒ¨ç½²ï¼Œä½†æ˜¯è¿™ç§éƒ¨ç½²æ–¹å¼å¯åŠ¨å’Œæ›´æ–°æ—¶è¿‡äºå¤æ‚ï¼Œå­˜åœ¨å¦‚ä¸‹é—®é¢˜ï¼š</p>
<p>ä¸‰ä¸ªé—®é¢˜</p>
<ul>
<li>å‰ç½®è½¯ä»¶çš„å®‰è£…ï¼Œå®ƒä»¬åœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¸­å®‰è£…çš„æ–¹å¼ï¼Œå¯åŠ¨çš„è„šæœ¬ï¼Œé¢„è®¾åˆå§‹çš„æ–¹å¼æœ‰å¯èƒ½éƒ½ä¸ç›¸åŒï¼Œè¿™å°±ç»™æˆ‘ä»¬é€ æˆä¸€ä¸ªå¾ˆå¤§çš„å›°æ‰°ï¼Œå‡å¦‚ä½ åœ¨å¤šå°æœºå™¨ä¸Šéƒ¨ç½²çš„è¯ï¼Œå¯èƒ½ä¼šé‡åˆ°å„ç§å„æ ·çš„é—®é¢˜ã€‚</li>
<li>é¡¹ç›®éœ€è¦è¿è¡Œä¸€ç³»åˆ—å¯¹åº”çš„å‘½ä»¤æ‰èƒ½å¯åŠ¨</li>
<li>é¡¹ç›®æ›´æ–°çš„é—®é¢˜ï¼Œéœ€è¦ä¸€ç³»åˆ—æ‰‹åŠ¨çš„æ­¥éª¤ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸ç¹çï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™çš„æ­¥éª¤ã€‚æœ‰æ²¡æœ‰æ›´æ–¹ä¾¿çš„æ–¹å¼å¯ä»¥å®Œæˆè¿™ä¸ªè¿‡ç¨‹å‘¢ï¼Ÿ<ul>
<li>å®Œæˆå¯¹åº”çš„pullä»£ç ï¼Œæ›´æ–°ä¾èµ–ï¼Œå¯åŠ¨åº”ç”¨çš„è¿‡ç¨‹</li>
<li>æ˜¯åœ¨ç‰¹å®šçš„æäº¤è‡ªåŠ¨è§¦å‘è¿™ä¸ªè¿‡ç¨‹</li>
</ul>
</li>
</ul>
<p>æƒ³è¦æ›´åŠ æ–¹ä¾¿çš„è¿›è¡Œéƒ¨ç½²å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å·¥å…·ï¼š</p>
<h2 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a><span class="exturl" data-url="aHR0cHM6Ly93d3cuZG9ja2VyLmNvbS9wcm9kdWN0cy9kb2NrZXItZGVza3RvcA==">Docker</span></h2><h3 id="ä»‹ç»-3"><a href="#ä»‹ç»-3" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p><strong>é—®é¢˜</strong><br>æˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ä¸ªå·¥å…·å¯ä»¥å¸®æˆ‘ä»¬ä¸€é”®æ™ºèƒ½éƒ¨ç½²ï¼Œå‡å¦‚ä½ è¦éƒ¨ç½²åœ¨å¤šå°ä¸åŒçš„æœºå™¨ä¸Šï¼Œå¯ä»¥ä¸ç”¨åœ¨æ‹…å¿ƒä¸åŒç³»ç»Ÿï¼Œä¸åŒç‰ˆæœ¬çš„å·®å¼‚ï¼Œä»¥åŠè¿è¡Œä¹‹å‰éœ€è¦å®‰è£…ä¸åŒè½¯ä»¶çš„ç—›è‹¦ã€‚<br><strong>è§£å†³</strong><br>å½“çº¢çš„è™šæ‹ŸåŒ–è½¯ä»¶ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cuZG9ja2VyLmNvbWwv">Docker</span><br>Dockerçš„è¿›åŒ–</p>
<p><img data-src="/images/Snipaste_2024-04-26_20-27-53.jpg" alt="Dockerçš„è¿›åŒ–"></p>
<ul>
<li>ä¼ ç»Ÿè™šæ‹Ÿæœºï¼Œè™šæ‹Ÿç¡¬ä»¶ä»¥åï¼Œéœ€è¦åœ¨ä¸Šé¢å®‰è£…ä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿã€‚</li>
<li>Docker:æ¨å‡ºäº†å®¹å™¨çš„æ¦‚å¿µï¼Œæ¯ä¸ªå®¹å™¨ä¸éœ€è¦å®‰è£…å®Œæˆçš„æ“ä½œç³»ç»Ÿï¼Œé‡Œé¢çš„è¿›ç¨‹ç›´æ¥è¿è¡Œåœ¨Dockeråˆ›é€ çš„å®¿ä¸»å†…æ ¸ä¸­ï¼Œä¸éœ€è¦è™šæ‹Ÿç¡¬ä»¶ã€‚</li>
</ul>
<p><strong>Dockerçš„ä¼˜ç‚¹</strong></p>
<ul>
<li>æ›´å¿«é€Ÿçš„å¯åŠ¨é€Ÿåº¦</li>
<li>æ›´å°‘çš„èµ„æºå ç”¨</li>
<li>ä¸€è‡´çš„è¿è¡Œç¯å¢ƒï¼Œä½¿ç”¨æˆ·ä¸å…³æ³¨æ“ä½œç³»ç»Ÿè€Œåªå…³å¿ƒåº”ç”¨ç¨‹åºã€‚</li>
<li>å¾®æœåŠ¡æ¶æ„ï¼Œdockerå¤©ç”Ÿé€‚é…å¾®æœåŠ¡æ¶æ„ï¼ˆDocker æœ‰åŠ©äºå°†ä¸€ä¸ªå¤æ‚ç³»ç»Ÿåˆ†è§£æˆä¸€ç³»åˆ—å¯ç»„åˆçš„éƒ¨åˆ†ï¼Œè¿™è®©ç”¨æˆ·å¯ä»¥ç”¨æ›´ç¦»æ•£çš„æ–¹å¼æ¥æ€è€ƒå…¶æœåŠ¡ã€‚ç”¨æˆ·å¯ä»¥åœ¨ä¸å½±å“å…¨å±€çš„å‰æä¸‹é‡ç»„è½¯ä»¶ï¼Œä½¿å…¶å„éƒ¨åˆ†æ›´æ˜“äºç®¡ç†å’Œå¯æ’æ‹”ã€‚ï¼‰</li>
<li>ç”¨æˆ·å¯ä»¥æ›´å‡†ç¡®åœ°æ§åˆ¶æ„å»ºç¯å¢ƒçš„çŠ¶æ€ï¼ŒDocker æ„å»ºæ¯”ä¼ ç»Ÿè½¯ä»¶æ„å»ºæ–¹æ³•æ›´å…·æœ‰å¯é‡ç°æ€§å’Œå¯å¤åˆ¶æ€§ã€‚ä½¿æŒç»­äº¤ä»˜çš„å®ç°å˜å¾—æ›´å®¹æ˜“ã€‚</li>
</ul>
<h3 id="Docker-images"><a href="#Docker-images" class="headerlink" title="Docker  images"></a><strong>Docker  images</strong></h3><p>å¯ä»¥åœ¨<span class="exturl" data-url="aHR0cHM6Ly9odWIuZG9ja2VyLmNvbS9zZWFyY2g/Zz0mdHlwZT1pbWFnZSVFNCVCOCVBRCVFOCU4RSVCNyVFNSU4RiU5NiVFNSU5MCU4NCVFNyVBNyU4RCVFNSVBRSU5OCVFNiU5NiVCOSVFNyU5QSU4NCVFOSU5NSU5QyVFNSU4MyU4RiVFRiVCQyU4QyVFNSVCOSVCNiVFNCVCOCU5NCVFNSU4RiVBRiVFNCVCQiVBNSVFNCVCOCU4QSVFNCVCQyVBMCVFNCVCRCVBMCVFOCU4NyVBQSVFNSVCNyVCMSVFNyU5QSU4NCVFOCU4NyVBQSVFNSVBRSU5QSVFNCVCOSU4OSVFOSU5NSU5QyVFNSU4MyU4Rg==">https://hub.docker.com/search?g=&amp;type=imageä¸­è·å–å„ç§å®˜æ–¹çš„é•œåƒï¼Œå¹¶ä¸”å¯ä»¥ä¸Šä¼ ä½ è‡ªå·±çš„è‡ªå®šä¹‰é•œåƒ</span><br>Dockeré•œåƒä»“åº“è·å–é•œåƒçš„å‘½ä»¤æ˜¯docker pull</p>
<pre><code class="bash"># ä¸‹è½½é•œåƒ
docker pull &lt;image-name&gt;:&lt;tag&gt;
# æŸ¥çœ‹ä»¥åŠä¸‹è½½çš„é•œåƒ
docker images
# åˆ é™¤é•œåƒ
docker rmi &lt;image-id&gt;
# ä¸Šä¼ 
docker push &lt;username&gt;/&lt;repository&gt;:&lt;tag&gt;
</code></pre>
<p><strong>ä½¿ç”¨é•œåƒä»£ç†ï¼š</strong></p>
<pre><code class="json">&quot;registry-mirrors&quot;: [
    &quot;https://docker.mirrors.ustc.edu.cn/&quot;,
    &quot;https://reg-mirror.qiniu.com&quot;
]
</code></pre>
<h3 id="Docker-Container"><a href="#Docker-Container" class="headerlink" title="Docker Container"></a><strong>Docker Container</strong></h3><p><strong>å¯åŠ¨Dockerå®¹å™¨</strong></p>
<pre><code class="bash">docker run -d -p ä¸»æœºç«¯å£:é•œåƒç«¯å£ --name å®¹å™¨åç§° é•œåƒåç§°
# ä¾‹å¦‚ï¼šï¼ˆ--name å®¹å™¨åç§°çœç•¥ï¼‰
docker run -d -p 81:80 nginx
# -d  åå°è¿è¡Œ
# -p  ç«¯å£æ˜ å°„ï¼Œ81ä¸ºä¸»æœºçš„ç«¯å£ï¼Œ80ä¸ºé•œåƒç«¯å£
# --name è‡ªå®šä¹‰å®¹å™¨åç§°
# é•œåƒåç§°ï¼Œå‡å¦‚æœ¬åœ°æ²¡æœ‰ï¼Œä¼šè‡ªåŠ¨pullä¸€æ¬¡é•œåƒè¿›è¡Œä¸‹è½½ã€‚
</code></pre>
<p><strong>å…¶ä»–å‘½ä»¤</strong></p>
<pre><code class="bash"># æŸ¥çœ‹æ‰€æœ‰å®¹å™¨
docker  ps
# åœæ­¢å®¹å™¨
docker stop container-id
# åˆ é™¤å®¹å™¨
docker rm container-id
# å¯åŠ¨å·²ç»ˆæ­¢å®¹å™¨
docker container start container-id
</code></pre>
<p><strong>è¿›å…¥å®¹å™¨å†…éƒ¨</strong></p>
<pre><code class="bash">docker exec -it &lt;container-id&gt; command
-i : å³ä½¿æ²¡æœ‰é™„åŠ ä¹Ÿä¿æŒSTDIN æ‰“å¼€
-t : åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯
</code></pre>
<h3 id="æŒä¹…åŒ–å®¹å™¨æ•°æ®"><a href="#æŒä¹…åŒ–å®¹å™¨æ•°æ®" class="headerlink" title="æŒä¹…åŒ–å®¹å™¨æ•°æ®"></a><strong>æŒä¹…åŒ–å®¹å™¨æ•°æ®</strong></h3><p>ä½¿ç”¨-vå‚æ•°ï¼Œå¯ä»¥è®¾å®šä¸€ä¸ªæ•°æ®çš„æ˜ å°„å…³ç³»ï¼Œå°†æœ¬åœ°çš„æ–‡ä»¶æ˜ å°„åˆ°å®¹å™¨ä¸­å¯¹åº”çš„æ–‡ä»¶ä¸­å»ã€‚</p>
<pre><code class="bash">docker run -d -p 81:80 -v host:container image-name
#ä¾‹å¦‚ï¼šå°†æœ¬åœ°æ•°æ®å·æ˜ å°„åˆ°å®¹å™¨ä¸­
docker run -d -v /data/db:/data/db mongo
</code></pre>
<p><strong>åˆ›å»ºå¯¹åº”çš„æ•°æ®å·volumn</strong></p>
<pre><code class="bash"># åˆ›å»ºæ•°æ®å·
docker volume create &lt;volumn-name&gt;
#ä¾‹å¦‚ï¼šdocker volume create mongo
# ä½¿ç”¨volumnæ•°æ®å·
docker run -d -v &lt;volumn-name&gt;:/data/db mongo
# ä¾‹å¦‚ï¼šdocker run -d -v mongo:/data/db mongo
# æ£€æŸ¥æ•°æ®å·
docker volume inspect &lt;volumn-name&gt;
# åˆ é™¤æ•°æ®å·
docker volume remove mongo
</code></pre>
<h3 id="Dockerfileè‡ªå®šä¹‰é•œåƒ"><a href="#Dockerfileè‡ªå®šä¹‰é•œåƒ" class="headerlink" title="Dockerfileè‡ªå®šä¹‰é•œåƒ"></a>Dockerfileè‡ªå®šä¹‰é•œåƒ</h3><p>Docker imageä¸­çš„é•œåƒè™½ç„¶éå¸¸å¤šï¼Œä½†æ˜¯ä¸èƒ½å®Œå…¨ç¬¦åˆè‡ªå·±é¡¹ç›®çš„å…¨éƒ¨éœ€æ±‚ï¼Œå¯ä»¥è‡ªå®šä¹‰æ„å»ºä¸€ä¸ªè‡ªå·±çš„é•œåƒã€‚</p>
<p>Dockerfileæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ç³»åˆ—æŒ‡ä»¤ï¼Œç”¨äºæ„å»ºå¯¹åº”çš„é•œåƒã€‚</p>
<p><strong><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vZW5naW5lL3JlZmVyZW5jZS9idWlsZGVyLyNmcm9t">æŒ‡ä»¤</span></strong></p>
<p> <strong>Dockerfileç¤ºä¾‹ï¼š</strong></p>
<pre><code class="dockerfile"># æŒ‡å®šåŸºç¡€é•œåƒï¼Œä»node14å¼€å§‹æ„å»º
FROM node:14

# åˆ›å»ºå¯¹åº”çš„æ–‡ä»¶å¤¹ï¼Œä½œä¸ºé¡¹ç›®è¿è¡Œçš„ä½ç½®
RUN mkdir -p /usr/src/app

# æŒ‡å®šå·¥ä½œåŒºï¼Œåé¢çš„è¿è¡Œä»»ä½•å‘½ä»¤éƒ½æ˜¯åœ¨è¿™ä¸ªå·¥ä½œåŒºä¸­å®Œæˆçš„
WORKDIR /usr/sec/app

# ä»æœ¬åœ°æ‹·è´å¯¹åº”çš„æ–‡ä»¶ åˆ° å·¥ä½œåŒº
COPY server.js /usr/src/app

# æ‰§è¡Œå®‰è£…å‘½ä»¤
RUN npm install --registry=https://registry.npm.taobao.org
RUN npm run tsc

#å‘ŠçŸ¥å½“å‰Docker imageæš´éœ²çš„æ˜¯3000ç«¯â˜
EXPOSE 3000

#æ‰§è¡Œå¯åŠ¨å‘½ä»¤ï¼Œä¸€ä¸ªDockerfileåªèƒ½æœ‰ä¸€ä¸ª
CMD node server.js
</code></pre>
<p><strong>æ„å»ºï¼š</strong></p>
<pre><code class="bash"># è¿™é‡Œç‰¹åˆ«æ³¨æ„ä¸Šä¸‹æ–‡çš„æ¦‚å¿µï¼Œä¸è¦åœ¨æ ¹ç›®å½•ä½¿ç”¨Dockerfi1e
docker build [é€‰é¡¹] &lt;ä¸Šä¸‹æ–‡è·¯å¾„/URL/-&gt;
# ä¾‹å¦‚ï¼š(åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­è¿è¡Œ)
docker build -t test-node .
</code></pre>
<p><strong>.dockerignoreæ–‡ä»¶ç”¨äºå¿½ç•¥dockerä¸­éœ€è¦æ‰“åŒ…è¿›é•œåƒçš„æ–‡ä»¶</strong></p>
<p><strong>.dockerignoreç¤ºä¾‹ï¼š</strong></p>
<pre><code class="dockerfile"># Microbundle cache
.rpt2_cache/
.rts2_cache_cjs/
.rts2_cache_es/
.rts2_cache_umd/
# Optional REPL history
.node_repl_history
# Output of &#39;npm pack&#39;
*.tgz
# Yarn Integrity file
.yarn-integrity
</code></pre>
<p> <strong>å¤šä¸ªå®¹å™¨ç›¸äº’é€šä¿¡ï¼š</strong></p>
<p>è¦ç‚¹ï¼šDockerä¸­æ¯ä¸€ä¸ªcontaineråº”è¯¥åªå®Œæˆä¸€ä¸ªå·¥ä½œï¼Œå¹¶ä¸”å°†å®ƒåšå¥½ã€‚</p>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>è§£è€¦ï¼Œè¿™æ ·ä¸åŒçš„æœåŠ¡å’Œåç«¯ä»£ç €éƒ½å¯ä»¥å®Œå…¨åˆ†ç¦»å¼€æ¥ï¼Œæ–¹ä¾¿ç®¡ç†ä»¥åŠæœªæ¥çš„æ‰©å±•ã€‚</li>
<li>æœåŠ¡çš„æ›´æ–°ä»¥åŠå‡çº§éƒ½æ˜¯å®Œå…¨ç‹¬ç«‹çš„ã€‚</li>
<li>åœ¨ä¸€ä¸ªcontainerä¸­ï¼Œå¯åŠ¨å¤šä¸ªä¸åŒçš„è¿›ç¨‹ï¼Œéœ€è¦ä¸€ä¸ªè¿›ç¨‹ç®¡ç†å™¨</li>
</ul>
<p><strong>é€šä¿¡è¿‡ç¨‹ï¼š</strong></p>
<p>dockerå®¹å™¨ä¹‹é—´ä¸èƒ½ç›´æ¥è¿›è¡Œè®¿é—®ï¼Œè€Œæ˜¯åº”è¯¥é€šè¿‡dockerç½‘ç»œè¿›è¡Œè®¿é—®ã€‚</p>
<pre><code class="bash"># åˆ›å»ºdockerç½‘ç»œ
docker network create test
# åœ¨åˆ›å»ºçš„dockerç½‘ç»œä¸­å¯åŠ¨æœåŠ¡
docker run -d --network test --name mongo -p 27017:27017 mongo
# å°†åŸæ¥é¡¹ç›®ä¸­çš„çš„ipåœ°å€æ›¿æ¢ä¸ºdockerçš„nameåç§°
# ä¾‹å¦‚åŸæ¥ä¸ºï¼šmongodb://localhost:27017/api  çš„åœ°å€è¦æ›¿æ¢ä¸ºï¼š mongodb://mongo:27017/api
# åªæœ‰åœ¨åŒä¸€ä¸ªdockerç½‘ç»œä¸­å¯åŠ¨çš„é¡¹ç›®é—´æ‰èƒ½è¿›è¡Œè®¿é—®ã€‚
docker run -d --network test --name use -p 80:3000 use
</code></pre>
<p>å¦‚æœæ¯ä¸ªå®¹å™¨éƒ½è¦è¿™æ ·æ“ä½œä¸€éå°±ä¼šæ˜¾å¾—éå¸¸éº»çƒ¦ï¼Œè¿™æ—¶å°±éœ€è¦ä½¿ç”¨Docer composeå·¥å…·ï¼ˆé…ç½®docker-compose.ymlæ–‡ä»¶ï¼‰</p>
<p>Docker composeå·¥å…·</p>
<p>Docker composeæ˜¯Dockerå®˜æ–¹æ¨å‡ºçš„å·¥å…·ï¼Œç”¨æ¥ç®¡ç†å’Œå…±äº«å¤šä¸ªå®¹å™¨çš„åº”ç”¨ï¼ŒMacç³»ç»Ÿå’ŒWindowsç³»ç»Ÿå®‰è£…å®¢æˆ·ç«¯æ—¶è‡ªå¸¦ã€‚<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vY29tcG9zZS9pbnN0YWxsLw==">Linuxéœ€è¦å•ç‹¬å®‰è£…</span>ã€‚</p>
<pre><code class="bash">docker-compose version
</code></pre>
<p><strong>é…ç½®ï¼š</strong></p>
<ul>
<li>docker composeé€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„ymlæ–‡ä»¶ï¼Œè¿›è¡Œé…ç½®ï¼Œè¿™ä¸ªæ–‡ä»¶å¿…é¡»å‘½åä¸º<strong>docker-compose.yml</strong></li>
<li>docker-composeæ‰€æœ‰çš„å­—æ®µå‚è€ƒæ–‡æ¡£ï¼š<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vY29tcG9zZS9jb21wb3NlLWZpbGUvY29tcG9zZS1maWxlLXYzLw==">https://docs.docker.com/compose/compose-file/compose-file-v3/</span></li>
</ul>
<p><strong>docker-compose.ymlæ–‡ä»¶é…ç½®ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="yaml">version: &#39;3&#39; # dockeræŒ‡ä»¤ç‰ˆæœ¬
services: # è¦å¯åŠ¨çš„æœåŠ¡
  test-mongo: # æœåŠ¡åç§°ï¼Œè¿™é‡Œçš„æœåŠ¡åç§°å¯¹åº”ç€å®¹å™¨é€šä¿¡æ—¶çš„å‰ç¼€ï¼
    image: mongo # ä½¿ç”¨çš„é•œåƒåç§°
    container_name: test-mongo # å®¹å™¨åç§°
    volumes:  # ä½¿ç”¨çš„æ•°æ®å·æ˜ å°„
      - &#39;.docker-volumes/mongo/data:/data/db&#39;
    ports:  # ç«¯å£æ˜ å°„
      - 27017:27017
    environment: # è®¾ç½®ç¯å¢ƒå˜é‡
      - MONGO_INITDB_ROOT_USERNAME=admin  # å†…ç½®çš„ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥åˆå§‹åŒ–æ·»åŠ ä¸€ä¸ªUser
      - MONGO_INITDB_ROOT_PASSWORD=pass
    env_file: # è®¾ç½®ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼Œå°†æ•æ„Ÿä¿¡æ¯æ”¾ç½®åˆ°ç¯å¢ƒå˜é‡æ–‡ä»¶ä¸­
      - .env
  test-use: # ç¬¬äºŒä¸ªé¡¹ç›®ï¼Œæ³¨æ„å¯¹é½å…³ç³»
    depends_on: # é…ç½®æ‰€ä¾èµ–çš„æœåŠ¡
      - test-mongo
    build: # è®¾ç½®æ„å»ºé…ç½®
      context: . # æ“ä½œä¸Šä¸‹æ–‡ä¸ºå½“å‰ç›®å½•
      dockerfile: Dockerfile # åŸºäºDockerfileè¿›è¡Œæ„å»º
    image: test-use-image
    container_name: test-use
    ports:
      - 7001:7001
</code></pre>
<p><strong>å¯åŠ¨ä»¥åŠå…³é—­ï¼š</strong></p>
<pre><code class="bash"># å¯åŠ¨
docker-compose up -d
# å…³é—­
docker-compose down
</code></pre>
<h3 id="æ•°æ®åº“é…ç½®"><a href="#æ•°æ®åº“é…ç½®" class="headerlink" title="æ•°æ®åº“é…ç½®"></a>æ•°æ®åº“é…ç½®</h3><p><strong>æ•°æ®åº“å‡†å¤‡å·¥ä½œ</strong></p>
<ul>
<li>æ•°æ®åº“é…ç½®ï¼Œåˆå§‹åŒ–å·¥ä½œï¼Œæ¯”å¦‚æ’å…¥ä¸€äº›ç‰¹å®šçš„æ•°æ®</li>
<li>é¿å…ä½¿ç”¨rootç”¨æˆ·å»å¯åŠ¨æœåŠ¡ï¼Œä»è€Œæé«˜å®‰å…¨æ€§ï¼ˆé…ç½®æ•°æ®åº“è®¿é—®æƒé™ï¼‰</li>
</ul>
<p><strong>ç‰¹æ®Šçš„åˆå§‹åŒ–æ•°æ®åº“çš„ä½ç½®ï¼š&#x2F;docker-entrypoint-initdb.dï¼ˆè¿™ä¸ªæ–‡ä»¶å¤¹ä¸­çš„è„šæœ¬ä¼šåœ¨å®¹å™¨å¯åŠ¨å‰è‡ªåŠ¨æ‰§è¡Œï¼‰</strong></p>
<ul>
<li><p>å¯ä»¥åˆ›å»ºjsæ–‡ä»¶æˆ–è€…shæ–‡ä»¶ï¼ˆshellï¼‰è¿›è¡Œæ‰§è¡Œã€‚</p>
</li>
<li><p>mongoDBï¼š<span class="exturl" data-url="aHR0cHM6Ly9odWIuZG9ja2VyLmNvbS9fbW9uZ28=">https://hub.docker.com/_mongo</span></p>
</li>
<li><p>Postgres:<span class="exturl" data-url="aHR0cHM6Ly9odWIuZG9ja2VyLmNvbS9fbHBvc3RncmVz">https://hub.docker.com/_lpostgres</span></p>
</li>
<li><p>ç‰¹åˆ«æ³¨æ„ï¼Œåªæœ‰åœ¨æ•°æ®åº“æ²¡æœ‰è¢«åˆ›å»ºçš„æƒ…å†µä¸‹ï¼Œä¹Ÿå°±æ˜¯<strong>æ•°æ®åº“çš„æ–‡ä»¶å¤¹æ˜¯ç©ºçš„æƒ…å†µä¸‹</strong>ï¼Œè„šæœ¬æ‰ä¼šè¢«æ‰§è¡Œã€‚</p>
</li>
</ul>
<p><strong>docker-compose.ymlæ–‡ä»¶ä¸­é…ç½®env_fileä¸ºå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„.envæ–‡ä»¶ã€‚</strong></p>
<p>å¯ä»¥ä½¿ç”¨jsæ–‡ä»¶æˆ–è€…shæ–‡ä»¶ï¼Œä½†æ˜¯ç”±äºæ­¤æ–‡ä»¶åœ¨å…¶ä½™æ–‡ä»¶ä¹‹å‰è¿è¡Œï¼Œæ­¤æ—¶jsæ–‡ä»¶ä¸­é€šè¿‡process.envè·å–ä¸åˆ°æ‰€éœ€è¦çš„ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥é€‰ç”¨shæ–‡ä»¶ã€‚</p>
<p><strong>Shellä¸­EOF&lt;&lt;çš„ç”¨æ³•</strong><br>åœ¨Shellä¸­æˆ‘ä»¬é€šå¸¸å°†EOFä¸&lt;ç»“åˆä½¿ç”¨ï¼Œè¡¨ç¤ºï¼ŒäºŒå€ºçš„è¾“å…¥ä½œä¸ºå­å‘½ä»¤æˆ–å­Shellçš„è¾“å…¥ï¼Œç›´åˆ°é‡åˆ°EOFä¸ºæ­¢ï¼Œå†è¿”å›åˆ°ä¸»è°ƒShellã€‚.</p>
<pre><code class="shell">#!/bin/bash
mongo &lt;&lt;EOF
use admin
db.auth(&#39;root&#39;,&#39;123456&#39;)
use lego
db.createUser(&#123;
    user: &#39;$MONGO_DB_USERNAME&#39;,
    pwd: &#39;$MONGO_DB_PASSWORD&#39;,
    roles: [&#123;
        role: &#39;readWrite&#39;,
        db: &#39;lego&#39;
    &#125;]
&#125;)
db.createCollection(&#39;works&#39;)
db.works.insertMany([
    &#123;
          id:19,
          title:&#39;æµ‹è¯•æ ‡é¢˜&#39;,
          name:&#39;å¼ ä¸‰&#39;
    &#125;
])
EOF
</code></pre>
<h3 id="ä¼˜åŒ–é•œåƒå¤§å°"><a href="#ä¼˜åŒ–é•œåƒå¤§å°" class="headerlink" title="ä¼˜åŒ–é•œåƒå¤§å°"></a>ä¼˜åŒ–é•œåƒå¤§å°</h3><p> <strong>Dockeré•œåƒæ„å»ºä¼˜åŒ–ï¼šä½¿ç”¨alpineç‰ˆæœ¬çš„é•œåƒ</strong></p>
<p>ä¼˜åŒ–é•œåƒå¤§å°  ï¼š   ä»€ä¹ˆæ˜¯Alpine Linux:<span class="exturl" data-url="aHR0cHM6Ly9hbHBpbmVsaW51eC5vcmcv">https://alpinelinux.org</span></p>
<p><strong>Alpineçš„ä¼˜ç‚¹</strong></p>
<ul>
<li><p>Smallå°</p>
<ul>
<li><p>é»˜è®¤è½¯ä»¶åŒ…ï¼Œalpineé€‰æ‹©busybox</p>
</li>
<li><p>Cè¿è¡Œåº“ï¼Œä¸€èˆ¬ä¼šç”¨glibc,alpineé€‰æ‹©musl</p>
</li>
</ul>
</li>
<li><p>æœ€ç®€ä¾èµ–ï¼ŒSimple</p>
<ul>
<li><p>å¾ˆå¤šå†…ç½®è½¯ä»¶çš„æ’ä»¶éƒ½å»æ‰ã€‚</p>
</li>
<li><p>å›½é™…åŒ–å†…å®¹éƒ½è¢«åˆ é™¤</p>
</li>
</ul>
</li>
<li><p>Secureå®‰å…¨</p>
</li>
</ul>
<p><strong>ä½¿ç”¨alpineç‰ˆæœ¬çš„é•œåƒå¯ä»¥å¤§å¤§å‡å°é•œåƒçš„ä½“ç§¯ã€‚</strong></p>
<p><strong>DockerBuildæ„å»ºæé€Ÿ</strong></p>
<p>dockerä¸­è¿è¡Œå‘½ä»¤æ˜¯åŸºäºä¸€å±‚ä¸€å±‚çš„ï¼Œå½“ä¿®æ”¹æ–‡ä»¶ä¹‹åï¼ŒCOPYåçš„ç¼“å­˜å…¨éƒ¨å¤±æ•ˆï¼Œè¿™æ—¶å°±ä¼šé‡æ–°æ‰§è¡Œåç»­å‘½ä»¤ï¼Œä½¿ç”¨ä¸äº†ç¼“å­˜ï¼Œå¯¼è‡´æ„å»ºé€Ÿåº¦å¾ˆæ…¢ã€‚æ­¤æ—¶å¯ä»¥å°†åŸæ¥COPYæ–‡ä»¶å¤¹ï¼Œæ”¹ä¸ºCOPYå…·ä½“çš„æ–‡ä»¶ï¼ˆè¿›è¡Œæ‹†åˆ†ï¼‰ï¼Œä»¥æ›´å¥½åœ°ä½¿ç”¨ç¼“å­˜ã€‚</p>
<h3 id="éƒ¨ç½²-2"><a href="#éƒ¨ç½²-2" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h3><p><strong>å®‰è£…Dockerï¼ˆæœ‰çš„äº‘æœåŠ¡å¯ä»¥è‡ªå®šä¹‰å®‰è£…ï¼‰</strong></p>
<p>Ubuntuï¼šï¼ˆéœ€è¦ä½¿ç”¨rootè´¦æˆ·è¿›è¡Œå®‰è£…ï¼‰</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cucnVub29iLmNvbS9kb2NrZXIvdWJ1bnR1LWRvY2tlci1pbnN0YWxsLmh0bWw=">https://www.runoob.com/docker/ubuntu-docker-install.html</span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vZW5naW5lL2luc3RhbGwvdWJ1bnR1Lw==">https://docs.docker.com/engine/install/ubuntu/</span></li>
</ul>
<p><strong>é…ç½®ç”¨æˆ·ç»„</strong><br>å› ä¸ºæ˜¯rootå®‰è£…ï¼Œæ™®é€šç”¨æˆ·æ‰§è¡Œå¯¹åº”çš„å‘½ä»¤çš„æ—¶å€™æœ‰å¯èƒ½ä¼šæŠ¥é”™ï¼š<br><code>Can&#39;t connect to docker daemonGot permission denied while trying to connect to the Docker daemonsocket at unix:///var/run/docker.sock</code></p>
<p><strong>éœ€è¦å°†å¯¹åº”çš„ç”¨æˆ·æ·»åŠ åˆ°dockerçš„ç”¨æˆ·ç»„ä¸­ã€‚</strong></p>
<pre><code class="bash">#usermodå‘½ä»¤ä¿®æ”¹ç”¨æˆ·è´¦æˆ·
#a--appendæ·»åŠ -G--groups
ç»„çš„åç§°
sudo usermod-aG docker ä½ çš„ç”¨æˆ·å
#å¦‚æœç»„ä¸å­˜åœ¨ï¼Œæ·»åŠ å¯¹åº”çš„dockerç»„
sudo groupadd docker
#æŸ¥çœ‹ä¸€ä¸ªç”¨æˆ·æ‰€å±çš„ç»„
groups
</code></pre>
<p><strong>æ·»åŠ ä¸‹è½½é•œåƒï¼š</strong></p>
<pre><code class="bash"># root
vim /etc/docker/daemon.json
&#123;
&quot;registry-mirrors&quot;:
&quot;https://docker.mirrors.ustc.edu.cn/&quot;,
&quot;https://reg-mirror.qiniu.com&quot;
]
</code></pre>
<p><strong>è¿è¡Œï¼š</strong></p>
<pre><code class="bash"># æ‹‰æœ€æ–°çš„ä»£ç 
git pull
# å…ˆæŸ¥çœ‹ç›®å‰ç«¯å£æ˜¯å¦è¢«å ç”¨
# å¦‚æœè¢«å ç”¨ï¼Œé‡Šæ”¾ç«¯å£
# æˆ–è€…æ”¹å˜docker-compose,ymlçš„æ˜ å°„ç«¯å£
docker-compose up -d
</code></pre>
<h1 id="YAMLè¯­è¨€"><a href="#YAMLè¯­è¨€" class="headerlink" title="YAMLè¯­è¨€"></a>YAMLè¯­è¨€</h1><p>YAML<br>(YAML Ainâ€™t a Markup Language)æ˜¯ä¸€ç§æ ‡è®°è¯­è¨€ï¼Œå®ƒä½¿ç”¨ç©ºæ ¼ä½œä¸ºç¼©è¿›ï¼Œçœ‹èµ·æ¥éå¸¸çš„ç®€æ´ï¼Œå¯è¯»æ€§éå¸¸çš„å¥½ï¼Œéå¸¸é€‚åˆä¸€äº›å†…å®¹å¤§çº²å’Œé…ç½®æ–‡ä»¶ã€‚ä»–æœ€ç»ˆæ˜¯é€šè¿‡å·¥å…·è½¬åŒ–ä¸ºJSONæ–‡ä»¶çš„ï¼Œä½†æ˜¯YAMLçš„å¯è¯»æ€§æ¯”JSONå¼ºå¾ˆå¤šï¼Œå› æ­¤å¤æ‚çš„é…ç½®æ–‡ä»¶ä¸€èˆ¬ä½¿ç”¨YAMLã€‚</p>
<p><strong>ä¾‹å¦‚ï¼š</strong></p>
<pre><code class="yaml"># å­—ç¬¦ä¸²ä¸ç”¨åŠ å¼•å·
key: value
number: 100
boolean: true
# å­—ç¬¦ä¸²ä¸ç”¨åŠ å¼•å·ï¼Œä½†æ˜¯åŠ ä¸Šä¹Ÿä¸ä¼šæŠ¥é”™
quote_string: &#39;quote String&#39;
# å¤šè¡Œå­—ç¬¦ä¸²ä½¿ç”¨ literal blockè¯­æ³•ï¼šä¹Ÿå°±æ˜¯ç«–çº¿
mutiple_string: |
  line one
  line two
  line three
# collection types é›†åˆç±»å‹
# ä½¿ç”¨ç¼©è¿›è¡¨ç¤ºå±‚çº§å…³ç³»ï¼Œæœ€å¥½ä½¿ç”¨ä¸¤ä¸ªç©ºæ ¼ï¼Œä¸æ˜¯ä¸¤ä¸ªç©ºæ ¼ä¹Ÿæ²¡å…³ç³»ï¼Œå¯¹é½å°±è¡Œ
person:
  name: dmq
  age: 18
  address:
    city: ä¸Šæµ·

# sequences æ•°ç»„æˆ–è€…åˆ—è¡¨
hobbies:
  - Item 1
  - Item 2
  - name: weson
    value: xyz
    address:
      city: åŒ—äº¬
</code></pre>
<h1 id="Github-Action"><a href="#Github-Action" class="headerlink" title="Github Action"></a>Github Action</h1><p>Githubå®˜æ–¹çš„CI&#x2F;CDå·¥å…·ï¼Œä½œä¸ºgithubçš„äº²å„¿å­ï¼Œå’Œgithubå‡ ä¹æ˜¯å®Œç¾çš„æ— ç¼è¡”æ¥çš„ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§ã€‚</p>
<p>CI   CDå¸¸ç”¨å·¥å…·ï¼š</p>
<ul>
<li>Github actions <span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmdpdGh1Yi5jb20vZW4vYWN0aW9ucw==">https://docs.github.com/en/actions</span></li>
<li>Travis <span class="exturl" data-url="aHR0cHM6Ly93d3cudHJhdmlzLWNpLmNvbS8=">https://www.travis-ci.com/</span></li>
<li>CircleCl <span class="exturl" data-url="aHR0cHM6Ly9jaXJjbGVjaS5jb20v">https://circleci.com/</span></li>
<li>Jenkins <span class="exturl" data-url="aHR0cHM6Ly93d3cuamVua2lucy5pby8=">https://www.jenkins.io/</span></li>
<li>ä¼˜åŠ¿è®¨è®ºï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzMwNjE5NTAzMy9hbnN3ZXIvMTg3MDMyMjExOA==">https://www.zhihu.com/question/306195033/answer/1870322118</span></li>
</ul>
<p><img data-src="/images/Snipaste_2024-04-27_18-37-04.jpg" alt="/images/Snipaste_2024-04-16_12-54-33.jpg"></p>
<p><strong>Workflow</strong><br><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmdpdGh1Yi5jb20vY24vYWN0aW9ucy9sZWFybi1naXRodWItYWN0aW9ucy91bmRlcnN0YW5kaW5nLWdpdGh1Yi1hY3Rpb25zI3dvcmtmbG93cw==">https://docs.github.com/cn/actions/learn-github-actions/understanding-github-actions#workflows</span><br>Workflowæ˜¯ä¸€ä¸ªå¯é…ç½®çš„è‡ªåŠ¨åŒ–æµç¨‹ï¼Œå¯ä»¥åŒ…å«å¤šä¸ªjobs,é€šè¿‡ä¸€ä¸ªåœ¨repoå½“ä¸­çš„ymlæ–‡ä»¶æ¥å®šä¹‰å¯¹åº”çš„æµç¨‹ï¼Œä¸€ä¸ªrepoå¯ä»¥åŒ…å«å¤šä¸ªworkflowã€‚<br><strong>Events</strong><br>Eventæ˜¯è§¦å‘workflowçš„ç‰¹æ®Šäº‹ä»¶ï¼Œæ¯”å¦‚pull request,pushæˆ–è€…issue,ä¹Ÿå¯ä»¥å®Œå…¨è‡ªå®šä¹‰ï¼Œå®Œæ•´åˆ—è¡¨è¯·çœ‹ï¼šhttps:&#x2F;docs.github.com&#x2F;cn&#x2F;actions&#x2F;learn-github-actions&#x2F;events-that-trigger-workflows</p>
<p><strong>Jobs</strong></p>
<p>Jobæ˜¯Workflowå½“ä¸­ä¸€ç³»åˆ—çš„å¯æ‰§è¡Œæ­¥éª¤ï¼Œæ¯ä¸ªJobæ˜¯åœ¨åŒä¸€ä¸ªrunnerä¸­è¿›è¡Œçš„ï¼ˆ(Runneræ˜¯æŒ‡å¤„äºgithubçš„ä¸€å°ç‰¹æ®Šçš„è™šæ‹Ÿæœºï¼Œæ”¯æŒå„ç§æ“ä½œç³»ç»Ÿ)ï¼Œæ¯ä¸ªæ­¥éª¤æˆ–è€…æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼ŒæŠ‘æˆ–æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œçš„action,æ¯ä¸ªæ­¥éª¤æ˜¯æŒ‰é¡ºåºæ‰§è¡Œï¼Œå¹¶ä¸”äº’ç›¸ä¾èµ–çš„ã€‚</p>
<p><img data-src="/images/Snipaste_2024-04-27_19-54-06.jpg" alt="/images/Snipaste_2024-04-16_12-54-33.jpg"></p>
<p><strong>Actions</strong></p>
<p>Actionæ˜¯github actionsä¸­çš„ä¸€ä¸ªè‡ªå®šä¹‰åº”ç”¨ï¼Œå®ƒå¯ä»¥è¿è¡Œä¸€ç³»åˆ—å¤æ‚çš„å¹¶ä¸”å¸¸ç”¨çš„ä»»åŠ¡ï¼Œä½¿ç”¨actionå¯ä»¥å¸®æˆ‘ä»¬å‡å°‘åœ¨workflowä¸­å†™é‡å¤ä»£ç ï¼ŒGithubæä¾›äº†éå¸¸å¤šå¸¸ç”¨çš„action,å¯ä»¥åœ¨<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21hcmtldHBsYWNlP3R5cGU9YWN0aW9ucw==">è¿™é‡ŒæŸ¥é˜…</span>ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å†™è‡ªå·±çš„actionã€‚</p>
<p><strong>github secrets</strong></p>
<p>é¡¹ç›®ä¸­æœ‰çš„ç§å¯†ä¿¡æ¯ä¸å¸Œæœ›å…¬å¼€æš´éœ²ï¼Œé€šå¸¸çš„åšæ³•æ˜¯å°†ç§å¯†ä¿¡æ¯å†™é“envæ–‡ä»¶ä¸­ï¼Œä½¿ç”¨gitingoreå°†å…¶å¿½ç•¥æ‰ï¼Œè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªåšæ³•å°±æ˜¯github secretsï¼Œåœ¨githubå®˜ç½‘è®¾ç½®github secretï¼Œç„¶ååœ¨æ–‡ä»¶ä¸­ç›´æ¥ä¹¦å†™å˜é‡ã€‚</p>
<p><strong>ä¾‹å¦‚ï¼š.githubæ–‡ä»¶å¤¹ä¸‹workflowæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªymlæ–‡ä»¶ï¼Œå†™å…¥ï¼š</strong></p>
<pre><code class="yaml">name: Github Actions Demo
on: [push]
jobs:
  Check-Github-actions:
    runs-on: ubuntu-latest
    steps:
      - run: echo &quot;triggered by a $&#123;&#123; github.event_name &#125;&#125; event&quot;
      - run: echo &quot;running on a $&#123;&#123; runner.os &#125;&#125; server hosted by github&quot;
      - name: check out repo code
        uses: actions/checkout@v2 # åœ¨å·¥ä½œæµç¨‹ä¸­æ£€å‡ºä»£ç ä»“åº“çš„å†…å®¹ã€ç¡®ä¿å·¥ä½œæµç¨‹å§‹ç»ˆä½¿ç”¨ä¸€è‡´çš„ä»£ç ç‰ˆæœ¬
      - run: echo &quot;the $&#123;&#123; github.reopsitory &#125;&#125; has been cloned&quot;
      - name: List files in the repo
        run: |
          ls $&#123;&#123; github.workspace &#125;&#125;
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        width:
          repository: &#39;vikingmute/lego-bricks&#39;
      - name: List files in the repo
        run: |
          ls $&#123;&#123; github.workspace &#125;&#125;
      - uses: actions/setup-node@v2
        with:
          node-version: &#39;16&#39;
      - run: node -v
      - run: npm install -g typescript
      - run: tsc -v
  jobs:
    SECRET-SSH-ACTIONS:
      runs-on: ubuntu-latest
      steps:
      #ä½¿ç”¨ssh-actionå®Œæˆè¿œç¨‹ç™»é™†ï¼šæ–‡æ¡£åœ°å€ï¼šhttps://github.com/appleboy/ssh-action
        - uses: appleboy/ssh-action@master 
          with:
            host: $&#123;&#123; secrets.HOST &#125;&#125;
            username: $&#123;&#123; secrets.SSH_USER &#125;&#125;
            password: $&#123;&#123; secrets.SSH_PWD &#125;&#125;
            script_stop: true
            script: |
              pwd
              ls -l
              touch secret.txt
              echo $&#123;&#123; secrets.MY_SECRET &#125;&#125; &gt;&gt; secret.txt
</code></pre>
<h1 id="è‡ªåŠ¨åŒ–éƒ¨ç½²"><a href="#è‡ªåŠ¨åŒ–éƒ¨ç½²" class="headerlink" title="è‡ªåŠ¨åŒ–éƒ¨ç½²"></a>è‡ªåŠ¨åŒ–éƒ¨ç½²</h1><h2 id="æ¨é€è¿œç¨‹é•œåƒä»“åº“"><a href="#æ¨é€è¿œç¨‹é•œåƒä»“åº“" class="headerlink" title="æ¨é€è¿œç¨‹é•œåƒä»“åº“"></a>æ¨é€è¿œç¨‹é•œåƒä»“åº“</h2><p><strong>æ™®é€šçº¿ä¸Šæ›´æ–°æµç¨‹ï¼š</strong></p>
<pre><code class="bash"># æ¯æ¬¡ä»£ç æ›´æ–°ä»¥åï¼Œç™»å½•åˆ°sshæœåŠ¡å™¨
# å…³é—­æœåŠ¡
docker-compose down
# æ›´æ–°ä»£ç 
git pull
# å‡å¦‚æœ‰.envï¼Œçš„æ›´æ–°éœ€è¦é‡æ–°è®¾ç½®ï¼Œenvæ–‡ä»¶
# é‡æ–°buildåº”ç”¨é•œåƒ
docker-compose build lego-backend
# é‡å¯æœåŠ¡
docker-compose up -d
</code></pre>
<p><strong>å¼Šç«¯ï¼š</strong></p>
<ul>
<li><p>åˆæ¬¡ä¸Šçº¿å’Œæ›´æ–°å±äºä¸¤æ­¥</p>
</li>
<li><p>åˆæ¬¡ä¸Šçº¿éœ€è¦ç‰¹åˆ«çš„æ“ä½œï¼Œå°±æ˜¯ä¹‹å‰æ‰‹åŠ¨éƒ¨ç½²ä¸Šçº¿çš„è¿è¡Œçš„è¿‡ç¨‹</p>
<ul>
<li><p>cloneä»£ç </p>
</li>
<li><p>è®¾ç½®ç¯å¢ƒå˜é‡.env</p>
</li>
<li><p>docker-compose up -d</p>
</li>
</ul>
</li>
</ul>
<p><strong>è¿½æ±‚çš„æˆæœï¼š</strong></p>
<p><strong>æ¯æ¬¡æäº¤ï¼Œå¯ä»¥è‡ªåŠ¨ä¸€æ¬¡æ€§çš„éƒ¨ç½²åˆ°ä»»ä½•æœåŠ¡å™¨ï¼Œå®ç°åˆæ¬¡å¯åŠ¨æˆ–è€…æ›´æ–°çš„æ•ˆæœï¼Œè¿™æ‰æ˜¯ä¸€ä¸ªå®Œç¾çš„devopsçš„æµç¨‹</strong></p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<p>å°†ä¸Šé¢æœ¬åœ°çš„é•œåƒå­˜åœ¨äºdocker hubæœåŠ¡å™¨ä¸­ï¼Œè¿™æ ·æ¯æ¬¡å°±ä¸ç”¨é‡æ–°buildï¼Œè€Œæ˜¯ç›´æ¥æ‹‰å–ã€‚</p>
<pre><code class="yaml">services:
  lego-redis:
    image:redis:6
  lego-mongo:
    image:mongo:latest
  lego-backend:
    image:lego-backend
#æˆ‘ä»¬éœ€è¦æ¯æ¬¡æ‰‹åŠ¨çš„buildé•œåƒï¼Œä¹Ÿå°±è¯´é•œåƒåªå­˜åœ¨äºæœ¬åœ°
  build:
    ......context:.
    dockerfile:Dockerfile
</code></pre>
<p><strong>æ”¹ä¸ºï¼š</strong></p>
<pre><code class="yaml"># æ›´å¥½çš„æ–¹æ¡ˆ
# ä¸éœ€è¦ä»»ä½•ä»£ç åº“ä¸­çš„æ–‡ä»¶ï¼Œåªéœ€è¦ä¸€ä¸ªdocker-compose.ymlæ–‡ä»¶
# å°±å¯ä»¥è½»æ¾çš„åœ¨ä»»ä½•æœåŠ¡å™¨è¿è¡Œ
services:
  lego-redis:
    image:redis:6
  lego-mongo
    image:mongo:latest
  lego-backend:
# ä¸éœ€è¦build,è€Œæ˜¯å­˜åœ¨äºdocker hubæœåŠ¡å™¨ä¸­ï¼Œå¯ä»¥æ¯æ¬¡ç›´æ¥æ‹‰å–
    image:lego-backend:1.0.1
</code></pre>
<p><strong>docker hubå…è´¹ç‰ˆæœ‰é™åˆ¶ï¼Œæ¨èä½¿ç”¨é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ï¼š</strong></p>
<p><strong><span class="exturl" data-url="aHR0cHM6Ly9sd3d3LmFsaXl1bi5jb20vcHJvZHVjdC9hY3I=">é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ACR</span></strong><br>ä¸ªäººç‰ˆå®Œå…¨å…è´¹</p>
<p>åˆ›å»ºé•œåƒä»“åº“ä¹‹åï¼Œéœ€è¦å°†æœ¬åœ°é•œåƒæ¨é€åˆ°ACRä»“åº“ä¸­ï¼š</p>
<pre><code class="bash"># æ¥åˆ°é•œåƒä»“åº“çš„åŸºæœ¬ä¿¡æ¯é¡µé¢
# ç™»å½•
docker login --username=ç”¨æˆ·å registry.cn-hangzhou.aliyuncs.com
# tagä¸¤ç§æ–¹å¼ï¼š
# 1:ä½¿ç”¨tag bui1d
docker build--tag &quot;registry.cn-hangzhou.aliyuncs.com/dmq00/test:[é•œåƒç‰ˆæœ¬å·]&quot;
# 2:ç»™ build å¥½çš„æ‰“ tag
docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/dmq00/test:[é•œåƒç‰ˆæœ¬å·]
# æŸ¥çœ‹é•œåƒæ˜¯å¦ build å®Œæˆ
docker images
# æ¨é€é•œåƒ
docker push registry.cn-hangzhou.aliyuncs.com/dmq00/test:[é•œåƒç‰ˆæœ¬å·]
# åœ¨é˜¿é‡Œäº‘ACRç•Œé¢æ£€æŸ¥çœ‹æ˜¯å¦å·²ç»å­˜åœ¨
</code></pre>
<h2 id="Github-Actionsè‡ªåŠ¨éƒ¨ç½²"><a href="#Github-Actionsè‡ªåŠ¨éƒ¨ç½²" class="headerlink" title="Github Actionsè‡ªåŠ¨éƒ¨ç½²"></a>Github Actionsè‡ªåŠ¨éƒ¨ç½²</h2><p><strong>ä½¿ç”¨github actionsåŠ æˆè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼šå½“æ¨é€ä»£ç åˆ°githubä»“åº“æ—¶ï¼Œè®©æˆ‘ä»¬çš„ä»£ç è‡ªåŠ¨æäº¤é•œåƒåˆ°é•œåƒä»“åº“ã€‚</strong></p>
<p><strong>å¤§ä½“åˆ†ä¸ºä¸¤æ­¥</strong></p>
<ul>
<li><h6 id="åœ¨githubæœåŠ¡å™¨ä¸Šbuild-imageå¹¶ä¸”push"><a href="#åœ¨githubæœåŠ¡å™¨ä¸Šbuild-imageå¹¶ä¸”push" class="headerlink" title="åœ¨githubæœåŠ¡å™¨ä¸Šbuild imageå¹¶ä¸”push"></a>åœ¨githubæœåŠ¡å™¨ä¸Šbuild imageå¹¶ä¸”push</h6></li>
<li><p><strong>ä½¿ç”¨docker-compose-onlineæ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œåº”ç”¨</strong></p>
</li>
</ul>
<p><strong>ç¬¬ä¸€æ­¥è¯¦ç»†æµç¨‹åˆ†æï¼Œåœ¨github runnerä¸Šè¿è¡Œ</strong></p>
<ul>
<li><p>checkoutä»£ç ï¼ˆåœ¨githubæœåŠ¡å™¨ä¸Šï¼‰</p>
</li>
<li><p>åˆ›å»º.envæ–‡ä»¶ï¼Œå¹¶ä¸”æ·»åŠ ä¸¤ä¸ªç¯å¢ƒå˜é‡( upload to OSSéœ€è¦ä¸¤ä¸ªå¯¹åº”çš„ä¿¡æ¯ )</p>
</li>
<li><p>ä½¿ç”¨é˜¿é‡Œäº‘ACRå®Œæˆdocker login</p>
</li>
<li><p>ä½¿ç”¨æ­£ç¡®çš„é˜¿é‡Œäº‘tagè¿›è¡Œdocker build</p>
<ul>
<li>æ€æ ·æ¯æ¬¡pushç”Ÿæˆç‰¹æ®Šçš„tagï¼Ÿæ˜¯ä¸€ä¸ªåç»­çš„é—®é¢˜</li>
</ul>
</li>
<li><p>docker push</p>
</li>
</ul>
<p>ä¾‹å¦‚ï¼šã€1ã€‘åœ¨é¡¹ç›®æ–‡ä»¶å¤¹.github&#x2F;workflowä¸‹åˆ›å»ºymlæ–‡ä»¶ï¼Œå†™å…¥ï¼š</p>
<pre><code>name: build image,push to ACR
on: [push]
jobs:
  build-and-push:
    runs-on: ubuntu-latest
    steps:
      # checkout ä»£ç 
      - uses: actions/checkout@v2
      # åˆ›å»ºenvæ–‡ä»¶
      - run: touch .env
      # ä½¿ç”¨â€œ &gt;&gt; â€æ·»åŠ ä¿¡æ¯
      - run: echo ALC_ACCESS_KEY=$&#123;&#123; secrets.ALC_ACCESS_KEY &#125;&#125; &gt;&gt; .env
      - run: echo ALC_SECRET_KEY=$&#123;&#123; secrets.ALC_SECRET_KEY &#125;&#125; &gt;&gt; .env
      # ä½¿ç”¨é˜¿é‡Œäº‘ACR å®Œæˆ docker login
      - name: Login to Aliyun ACR
        uses: aliyun/acr-login@v1 # ä½¿ç”¨ä¸“å±çš„é•œåƒ
        with:
          login-server: https://registry.cn-hangzhou.aliyuncs.com
          region-id: cn-hangzhou # æŸ¥çœ‹å®˜ç½‘è‡ªå·±ä»“åº“çš„ä¿¡æ¯
          username: &quot;$&#123;&#123; secrets.ACR_USERNAME &#125;&#125;&quot;
          password: &quot;$&#123;&#123; secrets.ACR_PASSWORD &#125;&#125;&quot;
        # ä½¿ç”¨æ­£ç¡®çš„é˜¿é‡Œäº‘ tag è¿›è¡Œ docker build
        - name: Build image for Docker
          run: docker build --tag &quot;registry.cn-hangzhou.aliyuncs.com/dmq00/test:0.0.2&quot;
        - name: Push Image to ACR
          run: docker push registry.cn-hangzhou.aliyuncs.com/dmq00/test:0.0.2
</code></pre>
<p>è¿™æ ·å°±èƒ½ä¿è¯ä»£ç pushåˆ°githubä¸Šä¹‹åè‡ªåŠ¨å°†é•œåƒæ¨é€åˆ°dockeré•œåƒä»“åº“ï¼Œç»“åˆdockerfileæ–‡ä»¶å°±èƒ½ä¿è¯ä½¿ç”¨dockeré•œåƒæ—¶è‡ªåŠ¨æ‰§è¡Œå‘½ä»¤ï¼Œå®‰è£…å¯¹åº”ä¾èµ–å¹¶æ‰§è¡Œé¡¹ç›®ã€‚</p>
<p><strong>ç¬¬äºŒæ­¥è¯¦ç»†æµç¨‹åˆ†æï¼Œåœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²å¯¹åº”çš„ä»£ç å¹¶ä¸”è¿è¡Œ</strong></p>
<ul>
<li><p>checkoutä»£ç </p>
</li>
<li><p>åˆ›å»º.envæ–‡ä»¶ï¼Œæ·»åŠ å¤šä¸ªç¯å¢ƒå˜é‡ã€‚(åº”ç”¨æ‰€æœ‰éœ€è¦çš„ç¯å¢ƒå˜é‡)ï¼Œgithub  secretsä¸­æ·»åŠ ã€‚</p>
</li>
<li><p>åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œæ‹·è´å¦‚ä¸‹æ–‡ä»¶åˆ°æ–‡ä»¶å¤¹å†…</p>
<ul>
<li>.env</li>
<li>docker-compose-online.yml</li>
<li>mongo-entrypointæ–‡ä»¶å¤¹</li>
</ul>
</li>
<li><p>å°†æ–°å»ºçš„æ–‡ä»¶å¤¹æ‹·è´åˆ°æœåŠ¡å™¨(SCP)å½“ä¸­</p>
<ul>
<li>ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FwcGxlYm95L3NjcC1hY3Rpb24=">https://github.com/appleboy/scp-action</span></li>
</ul>
</li>
<li><p>SSHåˆ°æœåŠ¡å™¨ä¸­</p>
<ul>
<li>è¿›å…¥æ‹·è´çš„æ–‡ä»¶å¤¹å†…</li>
<li>ç™»å½•é˜¿é‡Œäº‘ACR</li>
<li>åœæ­¢æœåŠ¡docker-compose down ï¼ˆç¬¬ä¸€æ¬¡çš„è¯ï¼Œæ²¡æœ‰å¯åŠ¨ä¹Ÿä¸ä¼šæŠ¥é”™ï¼‰</li>
<li>å¯åŠ¨æœåŠ¡docker-compose up</li>
<li>æ¸…ç†å·¥ä½œå¯é€‰ï¼Œä¿è¯å®‰å…¨ï¼ˆåˆ é™¤.envæ–‡ä»¶ï¼Œç™»å‡ºdockerè´¦æˆ·ï¼‰</li>
</ul>
</li>
</ul>
<p><strong>åç»­è¿‡ç¨‹éœ€è¦å®Œæˆï¼š</strong></p>
<ul>
<li><p>åœ¨push tagsçš„æ—¶å€™æ‰è§¦å‘å¯¹åº”çš„job</p>
<p>ï¼š<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmdpdGh1Yi5jb20vY24vYWN0aW9ucy9sZWFybi1naXRodWItYWN0aW9ucy9ldmVudHMtdGhhdC10cmlnZ2VyLXdvcmtmbG93cw==">https://docs.github.com/cn/actions/learn-github-actions/events-that-trigger-workflows</span></p>
</li>
<li><p>æ€æ ·è·å–å¯¹åº”çš„æ¯æ¬¡æäº¤ç›¸å…³çš„ç‰¹æ®Šä¿¡æ¯</p>
<p>ï¼š<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmdpdGh1Yi5jb20vZW4vYWN0aW9ucy9sZWFybi1naXRodWItYWN0aW9ucy9jb250ZXh0cw==">https://docs.github.com/en/actions/learn-github-actions/contexts</span></p>
</li>
<li><p>ä½¿ç”¨è¿™ä¸ªç‰¹æ®Šä¿¡æ¯ï¼Œåœ¨å¯¹åº”çš„docker-compose-online.ymlä¸­è¿›è¡Œæ›¿æ¢ï¼Œå°†è¦å¯åŠ¨çš„ç‰ˆæœ¬æ›¿æ¢ä¸ºå°†è¦æ„å»ºçš„ç‰ˆæœ¬ã€‚</p>
</li>
</ul>

      <div class="tags">
          <a href="/tags/%E5%A4%8D%E6%9D%82%E4%B8%9A%E5%8A%A1%E9%83%A8%E7%BD%B2%E4%B8%8E%E4%BC%98%E5%8C%96/" rel="tag"><i class="ic i-tag"></i> å¤æ‚ä¸šåŠ¡éƒ¨ç½²ä¸ä¼˜åŒ–</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">æ›´æ–°äº</span>
    <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-05-23 14:27:17" itemprop="dateModified" datetime="2024-05-23T14:27:17+08:00">2024-05-23</time>
  </span>
  <span id="2024/04/12/å¤æ‚é¡¹ç›®éƒ¨ç½²ä¸Šçº¿/" class="item leancloud_visitors" data-flag-title="å¤æ‚ä¸šåŠ¡éƒ¨ç½²ä¸ä¼˜åŒ–" title="é˜…è¯»æ¬¡æ•°">
      <span class="icon">
        <i class="ic i-eye"></i>
      </span>
      <span class="text">é˜…è¯»æ¬¡æ•°</span>
      <span class="leancloud-visitors-count"></span>
      <span class="text">æ¬¡</span>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> èµèµ</button>
  <p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="dmq å¾®ä¿¡æ”¯ä»˜">
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="dmq æ”¯ä»˜å®">
        <p>æ”¯ä»˜å®</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>dmq <i class="ic i-at"><em>@</em></i>æœæ˜æ¸…çš„ä¸ªäººåšå®¢
  </li>
  <li class="link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://dmqweb.cn/2024/04/12/%E5%A4%8D%E6%9D%82%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E4%B8%8A%E7%BA%BF/" title="å¤æ‚ä¸šåŠ¡éƒ¨ç½²ä¸ä¼˜åŒ–">https://dmqweb.cn/2024/04/12/å¤æ‚é¡¹ç›®éƒ¨ç½²ä¸Šçº¿/</a>
  </li>
  <li class="license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2024/03/30/jest/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s3.uuu.ovh&#x2F;imgs&#x2F;2024&#x2F;04&#x2F;13&#x2F;2376b10e610925e4.jpg" title="jest">
  <span class="type">ä¸Šä¸€ç¯‡</span>
  <span class="category"><i class="ic i-flag"></i> TDD</span>
  <h3>jest</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2024/04/12/%E8%84%9A%E6%89%8B%E6%9E%B6/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s3.uuu.ovh&#x2F;imgs&#x2F;2024&#x2F;04&#x2F;12&#x2F;61baca9d80b5756d.jpg" title="è„šæ‰‹æ¶å¼€å‘">
  <span class="type">ä¸‹ä¸€ç¯‡</span>
  <span class="category"><i class="ic i-flag"></i> è„šæ‰‹æ¶å¼€å‘</span>
  <h3>è„šæ‰‹æ¶å¼€å‘</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BD%AF%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%EF%BC%9A"><span class="toc-number">1.</span> <span class="toc-text">è½¯ä»¶ç”Ÿå‘½å‘¨æœŸï¼š</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84%E6%B5%81%E7%A8%8B%E5%9B%BE"><span class="toc-number">2.</span> <span class="toc-text">æ¶æ„æµç¨‹å›¾</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%8D%E6%9D%82%E9%A1%B9%E7%9B%AE%E9%80%9A%E7%94%A8%E6%96%B9%E6%A1%88"><span class="toc-number">3.</span> <span class="toc-text">å¤æ‚é¡¹ç›®é€šç”¨æ–¹æ¡ˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%9A%E5%8A%A1%E7%9A%84%E5%A4%8D%E6%9D%82%E5%BA%A6"><span class="toc-number">3.0.0.1.</span> <span class="toc-text">ä¸šåŠ¡çš„å¤æ‚åº¦</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E7%9A%84%E5%A4%8D%E6%9D%82%E5%BA%A6"><span class="toc-number">3.0.0.2.</span> <span class="toc-text">æµç¨‹çš„å¤æ‚åº¦</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CI-x2F-CD%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">4.</span> <span class="toc-text">CI &#x2F; CDçš„æ¦‚å¿µ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CI%EF%BC%88Continuous-integration%EF%BC%89%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90"><span class="toc-number">4.0.0.1.</span> <span class="toc-text">CIï¼ˆContinuous integrationï¼‰æŒç»­é›†æˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CD%EF%BC%88Continuous-Delivery%EF%BC%89%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%98"><span class="toc-number">4.0.0.2.</span> <span class="toc-text">CDï¼ˆContinuous Deliveryï¼‰æŒç»­äº¤ä»˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CD%EF%BC%88Continuous-Deployment%EF%BC%89%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2"><span class="toc-number">4.0.0.3.</span> <span class="toc-text">CDï¼ˆContinuous Deploymentï¼‰æŒç»­éƒ¨ç½²</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CI-x2F-CD%E4%B8%A4%E5%A4%A7%E6%9C%8D%E5%8A%A1%EF%BC%9A"><span class="toc-number">4.0.0.4.</span> <span class="toc-text">CI &#x2F; CDä¸¤å¤§æœåŠ¡ï¼š</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E6%8E%92%E5%BA%8F%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">5.</span> <span class="toc-text">åˆ—è¡¨æ’åºè§£å†³æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8B%96%E5%8A%A8%E6%94%B9%E5%8F%98%E4%BD%8D%E7%BD%AE%E5%8E%9F%E7%90%86"><span class="toc-number">6.</span> <span class="toc-text">æ‹–åŠ¨æ”¹å˜ä½ç½®åŸç†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8B%96%E5%8A%A8%E6%94%B9%E5%8F%98%E5%A4%A7%E5%B0%8F%E5%8E%9F%E7%90%86"><span class="toc-number">7.</span> <span class="toc-text">æ‹–åŠ¨æ”¹å˜å¤§å°åŸç†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-number">8.</span> <span class="toc-text">å¿«æ·é”®å®ç°åŸç†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%92%A4%E9%94%80%E9%87%8D%E5%81%9A%E5%8E%9F%E7%90%86"><span class="toc-number">9.</span> <span class="toc-text">æ’¤é”€é‡åšåŸç†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95%E5%8E%9F%E7%90%86"><span class="toc-number">10.</span> <span class="toc-text">å³é”®èœå•åŸç†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E4%BF%9D%E5%AD%98%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88"><span class="toc-number">11.</span> <span class="toc-text">è‡ªåŠ¨ä¿å­˜å®ç°æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DOM%E5%85%83%E7%B4%A0%E6%88%AA%E5%9B%BE%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88"><span class="toc-number">12.</span> <span class="toc-text">DOMå…ƒç´ æˆªå›¾å®ç°æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E7%BB%B4%E7%A0%81%E7%94%9F%E6%88%90%E6%96%B9%E6%A1%88"><span class="toc-number">13.</span> <span class="toc-text">äºŒç»´ç ç”Ÿæˆæ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%8D%E5%88%B6%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-number">14.</span> <span class="toc-text">å¤åˆ¶åŠŸèƒ½å®ç°åŸç†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E5%8E%9F%E7%90%86"><span class="toc-number">15.</span> <span class="toc-text">ä¸‹è½½æ–‡ä»¶åŸç†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="toc-number">16.</span> <span class="toc-text">åº”ç”¨éƒ¨ç½²çš„æµç¨‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96"><span class="toc-number">17.</span> <span class="toc-text">webpackæ„å»ºä¼˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Bundler%EF%BC%9A"><span class="toc-number">17.0.1.</span> <span class="toc-text">Bundlerï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Loaders%EF%BC%9A"><span class="toc-number">17.0.2.</span> <span class="toc-text">Loadersï¼š</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">17.0.2.0.0.1.</span> <span class="toc-text">åŸç†</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#plugins"><span class="toc-number">17.0.3.</span> <span class="toc-text">plugins:</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-1"><span class="toc-number">17.0.3.0.0.1.</span> <span class="toc-text">åŸç†</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">17.0.4.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#node%E5%90%8E%E7%AB%AF%E6%A1%86%E6%9E%B6"><span class="toc-number">18.</span> <span class="toc-text">nodeåç«¯æ¡†æ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Node-js%E5%90%8E%E7%AB%AF%E6%A1%86%E6%9E%B6%E8%B0%83%E7%A0%94"><span class="toc-number">18.1.</span> <span class="toc-text">Node.jsåç«¯æ¡†æ¶è°ƒç ”</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Express"><span class="toc-number">18.1.0.1.</span> <span class="toc-text">Express</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Koa2"><span class="toc-number">18.1.0.2.</span> <span class="toc-text">Koa2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#egg-js"><span class="toc-number">18.1.0.3.</span> <span class="toc-text">egg.js</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Nest-js"><span class="toc-number">18.1.0.4.</span> <span class="toc-text">Nest.js</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#vue-config-js"><span class="toc-number">19.</span> <span class="toc-text">vue.config.js</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96"><span class="toc-number">20.</span> <span class="toc-text">é¡¹ç›®æ„å»ºä¼˜åŒ–</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E8%BF%90%E8%A1%8C%E4%BC%98%E5%8C%96"><span class="toc-number">21.</span> <span class="toc-text">é¡¹ç›®è¿è¡Œä¼˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B8%B2%E6%9F%93"><span class="toc-number">21.0.1.</span> <span class="toc-text">å®¢æˆ·ç«¯æ¸²æŸ“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93"><span class="toc-number">21.0.2.</span> <span class="toc-text">æœåŠ¡ç«¯æ¸²æŸ“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8C%E6%9E%84%E6%B8%B2%E6%9F%93"><span class="toc-number">21.0.3.</span> <span class="toc-text">åŒæ„æ¸²æŸ“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSG%E9%A2%84%E6%B8%B2%E6%9F%93"><span class="toc-number">21.0.4.</span> <span class="toc-text">SSGé¢„æ¸²æŸ“</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E4%B8%8EHTTP%E4%BC%98%E5%8C%96"><span class="toc-number">22.</span> <span class="toc-text">éƒ¨ç½²ä¸HTTPä¼˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2"><span class="toc-number">22.0.1.</span> <span class="toc-text">éƒ¨ç½²</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nginx-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="toc-number">22.0.2.</span> <span class="toc-text">Nginx:åå‘ä»£ç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E7%BC%93%E5%AD%98"><span class="toc-number">22.0.3.</span> <span class="toc-text">HTTPç¼“å­˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9%E7%AE%97%E6%B3%95"><span class="toc-number">22.0.4.</span> <span class="toc-text">å‹ç¼©ç®—æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#gzip"><span class="toc-number">22.0.4.1.</span> <span class="toc-text">gzip</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Brotli"><span class="toc-number">22.0.4.2.</span> <span class="toc-text">Brotli</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E4%BC%98%E5%8C%96"><span class="toc-number">22.0.5.</span> <span class="toc-text">HTTPä¼˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#keepAlive%E5%B1%9E%E6%80%A7"><span class="toc-number">22.0.5.1.</span> <span class="toc-text">keepAliveå±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP2"><span class="toc-number">22.0.5.2.</span> <span class="toc-text">HTTP2</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mongodb%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">23.</span> <span class="toc-text">Mongodbæ•°æ®åº“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">23.0.1.</span> <span class="toc-text">åŸºæœ¬æ“ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mongodb%E9%AB%98%E7%BA%A7"><span class="toc-number">23.0.2.</span> <span class="toc-text">mongodbé«˜çº§</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95"><span class="toc-number">23.0.2.0.1.</span> <span class="toc-text">ç´¢å¼•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%81%9A%E5%90%88"><span class="toc-number">23.0.2.0.2.</span> <span class="toc-text">èšåˆ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E8%81%94%E6%9F%A5"><span class="toc-number">23.0.2.0.3.</span> <span class="toc-text">å¤šè¡¨è”æŸ¥</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="toc-number">23.0.3.</span> <span class="toc-text">æ•°æ®åº“è®¾è®¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="toc-number">23.0.4.</span> <span class="toc-text">è®¿é—®æƒé™ç®¡ç†</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mongoose"><span class="toc-number">24.</span> <span class="toc-text">Mongoose</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ORM"><span class="toc-number">24.0.1.</span> <span class="toc-text">ORM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ODM"><span class="toc-number">24.0.2.</span> <span class="toc-text">ODM</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#egg-mongoose"><span class="toc-number">25.</span> <span class="toc-text">egg-mongoose</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Stream"><span class="toc-number">26.</span> <span class="toc-text">Stream</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">26.0.1.</span> <span class="toc-text">ä»‹ç»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pipe"><span class="toc-number">26.0.2.</span> <span class="toc-text">pipe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-2"><span class="toc-number">26.0.3.</span> <span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pipeline"><span class="toc-number">26.0.4.</span> <span class="toc-text">pipeline</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E6%9C%8D%E5%8A%A1"><span class="toc-number">27.</span> <span class="toc-text">å¯¹è±¡å­˜å‚¨æœåŠ¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%BF%E9%87%8C%E4%BA%91OSS"><span class="toc-number">27.0.1.</span> <span class="toc-text">é˜¿é‡Œäº‘OSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%83%E7%89%9B%E4%BA%91KODO"><span class="toc-number">27.0.2.</span> <span class="toc-text">ä¸ƒç‰›äº‘KODO</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%85%BE%E8%AE%AF%E4%BA%91COS"><span class="toc-number">27.0.3.</span> <span class="toc-text">è…¾è®¯äº‘COS</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SSR%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93"><span class="toc-number">28.</span> <span class="toc-text">SSRæœåŠ¡ç«¯æ¸²æŸ“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-1"><span class="toc-number">28.0.1.</span> <span class="toc-text">ä»‹ç»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSR"><span class="toc-number">28.0.2.</span> <span class="toc-text">SSR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vue%E4%B8%ADSSR"><span class="toc-number">28.0.3.</span> <span class="toc-text">vueä¸­SSR</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RBAC%E6%9D%83%E9%99%90%E9%AA%8C%E8%AF%81"><span class="toc-number">29.</span> <span class="toc-text">RBACæƒé™éªŒè¯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-2"><span class="toc-number">29.0.1.</span> <span class="toc-text">ä»‹ç»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-number">29.0.2.</span> <span class="toc-text">ä½¿ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Casl%E4%BD%BF%E7%94%A8"><span class="toc-number">29.0.3.</span> <span class="toc-text">Caslä½¿ç”¨</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2-1"><span class="toc-number">30.</span> <span class="toc-text">éƒ¨ç½²</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E7%BB%9F%E6%A8%A1%E5%BC%8F"><span class="toc-number">30.0.1.</span> <span class="toc-text">ä¼ ç»Ÿæ¨¡å¼</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cluster%E6%A8%A1%E5%9E%8B"><span class="toc-number">30.1.</span> <span class="toc-text">Clusteræ¨¡å‹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">31.</span> <span class="toc-text">äº‘æœåŠ¡å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%AD%E4%B9%B0"><span class="toc-number">31.0.0.1.</span> <span class="toc-text">è´­ä¹°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%99%BB%E5%BD%95"><span class="toc-number">31.0.0.2.</span> <span class="toc-text">ç™»å½•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-1"><span class="toc-number">31.0.0.3.</span> <span class="toc-text">ä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%A1%E7%90%86"><span class="toc-number">31.0.0.4.</span> <span class="toc-text">ç®¡ç†</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%99%AE%E9%80%9A%E9%83%A8%E7%BD%B2"><span class="toc-number">32.</span> <span class="toc-text">æ™®é€šéƒ¨ç½²</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker"><span class="toc-number">32.1.</span> <span class="toc-text">Docker</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-3"><span class="toc-number">32.1.1.</span> <span class="toc-text">ä»‹ç»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-images"><span class="toc-number">32.1.2.</span> <span class="toc-text">Docker  images</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-Container"><span class="toc-number">32.1.3.</span> <span class="toc-text">Docker Container</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E5%8C%96%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE"><span class="toc-number">32.1.4.</span> <span class="toc-text">æŒä¹…åŒ–å®¹å™¨æ•°æ®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dockerfile%E8%87%AA%E5%AE%9A%E4%B9%89%E9%95%9C%E5%83%8F"><span class="toc-number">32.1.5.</span> <span class="toc-text">Dockerfileè‡ªå®šä¹‰é•œåƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE"><span class="toc-number">32.1.6.</span> <span class="toc-text">æ•°æ®åº“é…ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E5%8C%96%E9%95%9C%E5%83%8F%E5%A4%A7%E5%B0%8F"><span class="toc-number">32.1.7.</span> <span class="toc-text">ä¼˜åŒ–é•œåƒå¤§å°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2-2"><span class="toc-number">32.1.8.</span> <span class="toc-text">éƒ¨ç½²</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#YAML%E8%AF%AD%E8%A8%80"><span class="toc-number">33.</span> <span class="toc-text">YAMLè¯­è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Github-Action"><span class="toc-number">34.</span> <span class="toc-text">Github Action</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2"><span class="toc-number">35.</span> <span class="toc-text">è‡ªåŠ¨åŒ–éƒ¨ç½²</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A8%E9%80%81%E8%BF%9C%E7%A8%8B%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93"><span class="toc-number">35.1.</span> <span class="toc-text">æ¨é€è¿œç¨‹é•œåƒä»“åº“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Github-Actions%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2"><span class="toc-number">35.2.</span> <span class="toc-text">Github Actionsè‡ªåŠ¨éƒ¨ç½²</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%9C%A8github%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8Abuild-image%E5%B9%B6%E4%B8%94push"><span class="toc-number">35.2.0.0.0.1.</span> <span class="toc-text">åœ¨githubæœåŠ¡å™¨ä¸Šbuild imageå¹¶ä¸”push</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« ">
        <ul>
          <li class="active"><a href="/2024/04/12/%E5%A4%8D%E6%9D%82%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E4%B8%8A%E7%BA%BF/" rel="bookmark" title="å¤æ‚ä¸šåŠ¡éƒ¨ç½²ä¸ä¼˜åŒ–">å¤æ‚ä¸šåŠ¡éƒ¨ç½²ä¸ä¼˜åŒ–</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="dmq"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">dmq</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">71</span>
        <span class="name">æ–‡ç« </span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">52</span>
        <span class="name">åˆ†ç±»</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">94</span>
        <span class="name">æ ‡ç­¾</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RtcTA/dGFiPXJlcG9zaXRvcmllcw==" title="https:&#x2F;&#x2F;github.com&#x2F;dmq0?tab&#x3D;repositories"><i class="ic i-github"></i></span>
      <span class="exturl item npm" data-url="aHR0cHM6Ly93d3cubnBtanMuY29tL35kbXEwMDA=" title="https:&#x2F;&#x2F;www.npmjs.com&#x2F;~dmq000"><i class="ic i-file"></i></span>
      <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9kLTg4LTYxLTgz" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;d-88-61-83"><i class="ic i-zhihu"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTgwMjc4OTk0OTE=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;8027899491"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vdS83NjI1OTAxNzE3" title="https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;7625901717"><i class="ic i-weibo"></i></span>
      <span class="exturl item email" data-url="bWFpbHRvOjMyNjc4MDc1MTRAcXEuY29t" title="mailto:3267807514@qq.com"><i class="ic i-envelope"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>ä»‹ç»</a>
  </li>

    
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a>
  </li>

    
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a>
  </li>

    
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a>
  </li>

    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>å‹é“¾</a>
  </li>

    
  <li class="item">
    <a href="/links/" rel="section"><i class="ic i-magic"></i>å·¥å…·</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2024/03/30/jest/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2024/04/12/%E8%84%9A%E6%89%8B%E6%9E%B6/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>éšæœºæ–‡ç« </h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/jenkins%E9%85%8D%E5%90%88git-hook%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90/" title="åˆ†ç±»äº jenkinsé…åˆgit hookæŒç»­é›†æˆ">jenkinsé…åˆgit hookæŒç»­é›†æˆ</a>
</div>

    <span><a href="/2024/02/02/%E4%BD%BF%E7%94%A8Jenkins%E9%85%8D%E5%90%88github%20hook%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90/" title="jenkinsé…åˆgit hookæŒç»­é›†æˆ">jenkinsé…åˆgit hookæŒç»­é›†æˆ</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/JS/" title="åˆ†ç±»äº JS">JS</a>
</div>

    <span><a href="/2024/02/02/serviceWorker/" title="serviceWorker">serviceWorker</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%89%8D%E7%AB%AF%E7%9B%91%E6%8E%A7/" title="åˆ†ç±»äº å‰ç«¯ç›‘æ§">å‰ç«¯ç›‘æ§</a>
</div>

    <span><a href="/2024/04/29/%E5%89%8D%E7%AB%AF%E7%9B%91%E6%8E%A7/" title="å‰ç«¯ç›‘æ§">å‰ç«¯ç›‘æ§</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/JS/" title="åˆ†ç±»äº JS">JS</a>
</div>

    <span><a href="/2023/12/07/Blob/" title="Blob">Blob</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/vue-router%E5%8E%9F%E7%90%86/" title="åˆ†ç±»äº vue-routeråŸç†">vue-routeråŸç†</a>
</div>

    <span><a href="/2024/04/12/vue-router/" title="vue-router">vue-router</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%B8%B2%E6%9F%93%E6%A8%A1%E5%BC%8F/" title="åˆ†ç±»äº æ¸²æŸ“æ¨¡å¼">æ¸²æŸ“æ¨¡å¼</a>
</div>

    <span><a href="/2024/05/17/%E6%B8%B2%E6%9F%93%E6%A8%A1%E5%BC%8F/" title="æ¸²æŸ“æ¨¡å¼">æ¸²æŸ“æ¨¡å¼</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E7%AE%97%E6%B3%95/" title="åˆ†ç±»äº ç®—æ³•">ç®—æ³•</a>
</div>

    <span><a href="/2023/06/02/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" title="å›¾ç‰‡ä¸Šä¼ è§£å†³æ–¹æ¡ˆ">å›¾ç‰‡ä¸Šä¼ è§£å†³æ–¹æ¡ˆ</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/JS/" title="åˆ†ç±»äº JS">JS</a>
</div>

    <span><a href="/2023/12/08/NaN/" title="NaNå†å²é—ç•™é—®é¢˜">NaNå†å²é—ç•™é—®é¢˜</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="åˆ†ç±»äº æ€§èƒ½ä¼˜åŒ–">æ€§èƒ½ä¼˜åŒ–</a>
</div>

    <span><a href="/2024/05/11/%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87/" title="æ€§èƒ½æŒ‡æ ‡">æ€§èƒ½æŒ‡æ ‡</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E4%B8%9A%E5%8A%A1%E5%A4%84%E7%90%86/" title="åˆ†ç±»äº ä¸šåŠ¡å¤„ç†">ä¸šåŠ¡å¤„ç†</a>
</div>

    <span><a href="/2024/03/29/%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E5%9B%BE%E7%89%87/" title="æœ¬åœ°é¢„è§ˆå›¾ç‰‡">æœ¬åœ°é¢„è§ˆå›¾ç‰‡</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>æœ€æ–°è¯„è®º</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 â€“ 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">dmq @ Web blog</span>
  </div>
  <div class="powered-by">
    åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2024/04/12/å¤æ‚é¡¹ç›®éƒ¨ç½²ä¸Šçº¿/',
    favicon: {
      show: "ç§‘æŠ€å¼•é¢†æœªæ¥",
      hide: "æ¬¢è¿ä¸æˆ‘äº¤æµ"
    },
    search : {
      placeholder: "æ–‡ç« æœç´¢",
      empty: "å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",
      stats: "${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"
    },
    valine: true,fancybox: true,
    copyright: 'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//gcore.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>


  <script data-pjax>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?9ba187659e850a6910681214f0faa16b";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


</body>
</html>
