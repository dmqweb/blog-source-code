



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="æœæ˜æ¸…çš„ä¸ªäººåšå®¢" href="https://dmqweb.cn/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="æœæ˜æ¸…çš„ä¸ªäººåšå®¢" href="https://dmqweb.cn/atom.xml" />
<link rel="alternate" type="application/json" title="æœæ˜æ¸…çš„ä¸ªäººåšå®¢" href="https://dmqweb.cn/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="è„šæ‰‹æ¶å¼€å‘" />


<link rel="canonical" href="https://dmqweb.cn/2024/04/12/%E8%84%9A%E6%89%8B%E6%9E%B6/">



  <title>
è„šæ‰‹æ¶å¼€å‘ - è„šæ‰‹æ¶å¼€å‘ |
Web blog = æœæ˜æ¸…çš„ä¸ªäººåšå®¢ = ğŸ‘»æ¬¢è¿ä¸€èµ·äº¤æµå­¦ä¹ ğŸ‘»</title>
  <meta name="keywords" content="å‰ç«¯å¼€å‘, HTML, CSS, JavaScript, åšå®¢">
  <meta name="description" content="æ¢ç´¢å‰ç«¯å¼€å‘çš„æ— é™å¯èƒ½ã€‚æœ¬åšå®¢æä¾›æœ€æ–°çš„å‰ç«¯çŸ¥è¯†åº“ï¼Œä»¥åŠå®ç”¨çš„å¼€å‘æŠ€å·§å’Œæœ€ä½³å®è·µã€‚åŠ å…¥æˆ‘ä»¬çš„ç¤¾åŒºï¼Œå…±åŒæˆé•¿ã€‚">
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">è„šæ‰‹æ¶å¼€å‘
  </h1>
  
<div class="meta">
  <span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2024-04-12 08:36:07">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">å‘è¡¨äº</span>
    <time itemprop="dateCreated datePublished" datetime="2024-04-12T08:36:07+08:00">2024-04-12</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Web blog</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/03/29/4e134f025ae53f2b.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/07/971b0200f59eab4c.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/28/91b1bdcfda8d22da.webp"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/28/dc01f095118914ac.webp"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/25/d919179c20f6fc96.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/25/1b093314ebaab948.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91/" itemprop="item" rel="index" title="åˆ†ç±»äº è„šæ‰‹æ¶å¼€å‘"><span itemprop="name">è„šæ‰‹æ¶å¼€å‘</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://dmqweb.cn/2024/04/12/%E8%84%9A%E6%89%8B%E6%9E%B6/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="dmq">
    <meta itemprop="description" content="ğŸ‘»æ¬¢è¿ä¸€èµ·äº¤æµå­¦ä¹ ğŸ‘», ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="æœæ˜æ¸…çš„ä¸ªäººåšå®¢">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="éœ€æ±‚åˆ†æ"><a class="anchor" href="#éœ€æ±‚åˆ†æ">#</a> éœ€æ±‚åˆ†æ</h1>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦ä¼˜åŒ–ç ”å‘æµç¨‹ï¼Ÿ</strong></p>
<ul>
<li>é¡¹ç›®é‡çº§å¢åŠ ï¼šå‡ å¹²è¡Œä»£ç  -&gt; å‡ ä¸‡è¡Œä»£ç </li>
<li>é¡¹ç›®æ•°é‡æ‰©å¤§ï¼šå‡ ä¸ªé¡¹ç›® -&gt; å‡ å¹²ä¸ªé¡¹ç›®</li>
<li>é¡¹ç›®å¤æ‚åº¦é«˜ï¼šWb é¡¹ç›® -&gt;H5/PC/ å°ç¨‹åº / åç«¯ / è„šæ‰‹æ¶</li>
<li>å›¢é˜Ÿäººæ•°å¢é•¿ï¼šå‡ ä¸ªäºº -&gt; å‡ ç™¾äºº</li>
<li>ä¼ ç»Ÿçš„é¡¹ç›®ç ”å‘æµç¨‹å·²ç»æ— æ³•æ»¡è¶³ä¸šåŠ¡éœ€æ±‚</li>
</ul>
<h1 id="gitå¼€å‘æµç¨‹"><a class="anchor" href="#gitå¼€å‘æµç¨‹">#</a> git å¼€å‘æµç¨‹</h1>
<p>å•äºº git é¡¹ç›®å¼€å‘æµç¨‹</p>
<p><img data-src="/images/Snipaste_2024-05-27_13-57-14.png" alt="images" /></p>
<p>å¤šäºº git é¡¹ç›®å¼€å‘æµç¨‹</p>
<p><img data-src="/images/Snipaste_2024-05-27_14-05-13.png" alt="images" /></p>
<h1 id="æµè§ˆå™¨è·å–èµ„æºæ­¥éª¤"><a class="anchor" href="#æµè§ˆå™¨è·å–èµ„æºæ­¥éª¤">#</a> æµè§ˆå™¨è·å–èµ„æºæ­¥éª¤</h1>
<p><img data-src="/images/Snipaste_2024-05-27_14-34-47.png" alt="images" /></p>
<p><strong>é¡¹ç›®åˆ›å»ºæµç¨‹æ€è€ƒ</strong></p>
<p>å½“å›¢é˜Ÿè¾ƒå¤§æ—¶ï¼Œè®©æ¯ä¸€ä¸ªå›¢é˜Ÿæˆå‘˜å¼€å‘åˆ›å»ºé¡¹ç›®ä½“éªŒè¶‹äºä¸€è‡´å°±éå¸¸é‡è¦ã€‚</p>
<p><strong>é¡¹ç›®åˆ›å»ºæµç¨‹</strong></p>
<ul>
<li>é¡¹ç›®ä»£ç </li>
<li>æŠ½è±¡å‡ºé¡¹ç›®æ¨¡æ¿</li>
<li>å­˜å‚¨åˆ°æ•°æ®åº“</li>
<li>è„šæ‰‹æ¶è¯»å–æ•°æ®åº“</li>
<li>æ ¹æ®è„šæ‰‹æ¶åˆ›å»ºæ–°çš„é¡¹ç›®</li>
</ul>
<p><strong>æå‡å‰ç«¯ç ”å‘æ•ˆç‡çš„æ‰‹æ®µ</strong></p>
<ul>
<li>ç‰©æ–™å’Œæ¨¡æ¿</li>
<li>ä½ä»£ç æ­å»º</li>
<li>ç­‰ç­‰</li>
</ul>
<p>ä»ä½¿ç”¨è§’åº¦ç†è§£ä»€ä¹ˆæ˜¯è„šæ‰‹æ¶ï¼Ÿ</p>
<h1 id="è„šæ‰‹æ¶ç®€ä»‹"><a class="anchor" href="#è„šæ‰‹æ¶ç®€ä»‹">#</a> è„šæ‰‹æ¶ç®€ä»‹</h1>
<p>è„šæ‰‹æ¶æœ¬è´¨æ˜¯ä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„å®¢æˆ·ç«¯ï¼Œå®ƒé€šè¿‡å‘½ä»¤è¡Œæ‰§è¡Œï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>vue create vue-test-app</pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ¡å‘½ä»¤ç”± 3 ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p>
<ul>
<li>ä¸»å‘½ä»¤ï¼švue</li>
<li>command:create</li>
<li>command çš„ param:vue-test-app</li>
</ul>
<p>å®ƒè¡¨ç¤ºåˆ›å»ºä¸€ä¸ª vue é¡¹ç›®ï¼Œé¡¹ç›®çš„åç§°ä¸º vue-test-app, ä»¥ä¸Šæ˜¯æœ€ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„è„šæ‰‹æ¶å‘½ä»¤ï¼Œä½†å®é™…åœºæ˜“<br />
å¾€æ›´åŠ å¤æ‚ï¼Œæ¯”å¦‚ï¼š<br />
å½“å‰ç›®å½•å·²ç»æœ‰æ–‡ä»¶äº†ï¼Œæˆ‘ä»¬éœ€è¦è¦†ç›–å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¼ºåˆ¶è¿›è¡Œå®‰è£… ue é¡¹ç›®ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥è¾“å…¥ï¼š</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>vue create vue-test-app <span class="token parameter variable">--force</span></pre></td></tr></table></figure><p>è¿™é‡Œçš„ - force å«åš option, ç”¨æ¥è¾…åŠ©è„šæ‰‹æ¶ç¡®è®¤åœ¨ç‰¹å®šåœºæ™¯ä¸‹ç”¨æˆ·çš„é€‰æ‹©ï¼ˆå¯ä»¥ç†è§£ä¸ºé…ç½®ï¼‰ã€‚è¿˜æœ‰ä¸€ç§åœºæ™¯<br />
é€šè¿‡ vue create<br />
 åˆ›å»ºé¡¹ç›®æ—¶ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œ npm install å¸®ç”¨æˆ·å®‰è£…ä¾èµ–ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨æ·˜å®æºæ¥å®‰è£…ï¼Œ<br />
å¯ä»¥è¾“å…¥å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>vue create vue-test-app <span class="token parameter variable">--force</span> <span class="token parameter variable">-r</span> https://registry.npm.taobao.org</pre></td></tr></table></figure><p>è¿™é‡Œçš„ - x ä¹Ÿå«åš option, å®ƒä¸ --force ä¸åŒçš„æ˜¯å®ƒä½¿ç”¨ -ï¼Œå¹¶ä¸”ä½¿ç”¨ç®€å†™ï¼Œè¿™é‡Œçš„ - x ä¹Ÿå¯ä»¥æ›¿æ¢æˆ --registry, æœ‰çš„åŒå­¦å¯èƒ½è¦é—®ï¼Œä¸ºä»€ä¹ˆè€å¸ˆçŸ¥é“è¿™ä¸ªå‘½ä»¤ï¼Œå…¶å®æˆ‘ä»¬è¾“å…¥ä¸‹é¢çš„å‘½ä»¤å°±å¯ä»¥çœ‹åˆ° vue create æ”¯æŒçš„æ‰€æœ‰ options:<br />
vue create  --help</p>
<p>-r  https:/registry.npm.taobao.org åé¢çš„ https://registry.npm.taobao.org æˆä¸º option çš„ param, å…¶å®ä»» - force å¯ä»¥ç†è§£ä¸ºï¼š-force true,f ç®€å†™ä¸ºï¼š--force æˆ– - f</p>
<h1 id="è„šæ‰‹æ¶åŸç†"><a class="anchor" href="#è„šæ‰‹æ¶åŸç†">#</a> è„šæ‰‹æ¶åŸç†</h1>
<p><strong>è„šæ‰‹æ¶çš„æ‰§è¡ŒåŸç†å¦‚ä¸‹ï¼š</strong></p>
<ul>
<li>åœ¨ç»ˆç«¯è¾“å…¥ vue create vue-test-app</li>
<li>ç»ˆç«¯è§£æå‡º vue å‘½ä»¤</li>
<li>ç»ˆç«¯åœ¨ç¯å¢ƒå˜é‡ä¸­æ‰¾åˆ° ue å‘½ä»¤</li>
<li>ç»ˆç«¯æ ¹æ® vue å‘½ä»¤é“¾æ¥åˆ°å®é™…æ–‡ä»¶ vue.js</li>
<li>ç»ˆç«¯åˆ©ç”¨ node æ‰§è¡Œ `ue.js</li>
<li>vue.js è§£æ command/options</li>
<li>vue.js æ‰§è¡Œ command</li>
<li>æ‰§è¡Œå®Œæ¯•ï¼Œé€€å‡ºæ‰§è¡Œ</li>
</ul>
<p><strong>ä»åº”ç”¨çš„è§’åº¦çœ‹å¦‚ä½•å¼€å‘ä¸€ä¸ªè„šæ‰‹æ¶</strong></p>
<p>è¿™é‡Œä»¥ vue-cli ä¸ºä¾‹ï¼š</p>
<ul>
<li>å¼€å‘ npm é¡¹ç›®ï¼Œè¯¥é¡¹ç›®ä¸­åº”åŒ…å«ä¸€ä¸ª bin/vue.js æ–‡ä»¶ï¼Œå¹¶å°†è¿™ä¸ªé¡¹ç›®å‘å¸ƒåˆ° npm</li>
<li>å°† npm é¡¹ç›®å®‰è£…åˆ° node çš„ lib/node_modules</li>
<li>åœ¨ node çš„ bin ç›®å½•ä¸‹é…ç½® vue è½¯é“¾æ¥æŒ‡å‘ lib/node modules/Qvue/cli/bin/vue.js</li>
<li>è¿™æ ·æˆ‘ä»¬åœ¨æ‰§è¡Œ vue å‘½ä»¤çš„æ—¶å€™å°±å¯ä»¥æ‰¾åˆ° vue.js è¿›è¡Œæ‰§è¡Œ</li>
</ul>
<p><strong>è¿˜æœ‰å¾ˆå¤šç–‘é—®éœ€è¦è§£ç­”</strong></p>
<ul>
<li>
<p>ä¸ºä»€ä¹ˆå…¨å±€å®‰è£… vue/cli åä¼šæ·»åŠ çš„å‘½ä»¤ä¸º vue?  ï¼ˆnpm install -g @vue/cliï¼‰</p>
</li>
<li>
<p>ç­”ï¼švue/cli é¡¹ç›®çš„ package.json ä¸­çš„ bin å­—æ®µé…ç½®çš„åç§°ä¸º vueã€‚</p>
</li>
<li>
<p>å…¨å±€å®‰è£… vue/c1i æ—¶å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
</li>
<li>
<p>ç­”ï¼šå…¨å±€ node_modules ä¸­ä¸‹è½½é¡¹ç›®æ–‡ä»¶ï¼Œå¹¶æ ¹æ®é¡¹ç›® package.json ä¸­çš„ bin å­—æ®µé…ç½®å¯æ‰§è¡Œæ–‡ä»¶è½¯é“¾æ¥ã€‚</p>
</li>
<li>
<p>ä¸ºä»€ä¹ˆ vue æŒ‡å‘ä¸€ä¸ª js æ–‡ä»¶ï¼Œæˆ‘ä»¬å´å¯ä»¥ç›´æ¥é€šè¿‡ vue å‘½ä»¤ç›´æ¥å»æ‰§è¡Œå®ƒï¼Ÿ</p>
</li>
<li>
<p>ç­”ï¼šjs æ–‡ä»¶é…ç½®äº†è›‡æ£’ï¼ˆæ“ä½œç³»ç»Ÿçš„æ¥å£ï¼‰ï¼Œä¾‹å¦‚ï¼š</p>
</li>
<li>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token hashbang comment">#!/usr/bin/env node</span></pre></td></tr></table></figure><p>é€šå¸¸ä½¿ç”¨ç¯å¢ƒå˜é‡ä¸­æ‰¾ node å‘½ä»¤ï¼Œå› ä¸ºæ¯ä¸ªç”µè„‘ä¸Šçš„ node æ–‡ä»¶ä½ç½®ä¸åŒï¼Œä½†æ˜¯ç¯å¢ƒå˜é‡ä¸­éƒ½ä¼šæœ‰ node è½¯è¿æ¥ã€‚</p>
</li>
</ul>
<h1 id="è„šæ‰‹æ¶çš„å¼€å‘æµç¨‹"><a class="anchor" href="#è„šæ‰‹æ¶çš„å¼€å‘æµç¨‹">#</a> è„šæ‰‹æ¶çš„å¼€å‘æµç¨‹</h1>
<p><strong>è„šæ‰‹æ¶å¼€å‘æµç¨‹è¯¦è§£</strong></p>
<p>å¼€å‘æµç¨‹</p>
<ul>
<li>åˆ›å»º npm é¡¹ç›®</li>
<li>åˆ›å»ºè„šæ‰‹æ¶å…¥å£æ–‡ä»¶ï¼Œæœ€ä¸Šæ–¹æ·»åŠ  #!/usr/bin/env node</li>
<li>é…ç½® package.json, æ·»åŠ  bin å±æ€§</li>
<li>ç¼–å†™è„šæ‰‹æ¶ä»£ç </li>
<li>å°†è„šæ‰‹æ¶å‘å¸ƒåˆ° npm</li>
</ul>
<p><strong>ä½¿ç”¨æµç¨‹</strong></p>
<ul>
<li>
<p>å®‰è£…è„šæ‰‹æ¶</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">-g</span> your-own-cli</pre></td></tr></table></figure></li>
<li>
<p>ä½¿ç”¨è„šæ‰‹æ¶</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>your-own-cli-binName</pre></td></tr></table></figure></li>
</ul>
<p><strong>è„šæ‰‹æ¶å¼€å‘éš¾ç‚¹è§£æ</strong></p>
<ul>
<li>
<p>åˆ†åŒ…ï¼šå°†å¤æ‚çš„ç³»ç»Ÿæ‹†åˆ†æˆè‹¥å¹²ä¸ªæ¨¡å—</p>
</li>
<li>
<p>å‘½ä»¤æ³¨å†Œï¼š</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>- vue create</pre></td></tr><tr><td data-num="2"></td><td><pre>- vue <span class="token function">add</span></pre></td></tr><tr><td data-num="3"></td><td><pre>- vue invoke</pre></td></tr></table></figure></li>
<li>
<p>å‚æ•°è§£æï¼š</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>vue <span class="token builtin class-name">command</span> <span class="token punctuation">[</span>options <span class="token operator">&lt;</span>params<span class="token operator">></span></pre></td></tr></table></figure></li>
<li>
<p>options: å…¨ç§°ï¼š--versionã€--helpã€‚ç®€å†™ä¸ºï¼š-v   -h</p>
</li>
<li>
<p>å¸®åŠ©æ–‡æ¡£ï¼šglobal help</p>
</li>
<li>
<p>å‘½ä»¤è¡Œäº¤äº’</p>
</li>
<li>
<p>æ—¥å¿—æ‰“å°</p>
</li>
<li>
<p>å‘½ä»¤è¡Œæ–‡å­—å˜è‰²</p>
</li>
<li>
<p>ç½‘ç»œé€šä¿¡</p>
</li>
<li>
<p>æ–‡ä»¶å¤„ç†</p>
</li>
</ul>
<h1 id="å¼€å‘ç»†èŠ‚"><a class="anchor" href="#å¼€å‘ç»†èŠ‚">#</a> å¼€å‘ç»†èŠ‚</h1>
<p><strong>ä¸¤ç§é“¾æ¥æœ¬åœ°æ–‡ä»¶çš„æ–¹å¼</strong></p>
<ul>
<li>
<p>npm  link å‘½ä»¤ä¼šå°†å‘½ä»¤æ‰§è¡Œçš„å½“å‰æ–‡ä»¶å¤¹æ ¹æ® bin å­—æ®µè½¯è¿æ¥åˆ°å…¨å±€çš„ node_modulsã€‚</p>
</li>
<li>
<p>npm link åŒ…åç§° ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šå°†å…¨å±€åŒ…æ·»åŠ è½¯è¿æ¥åˆ°å½“å‰é¡¹ç›®çš„ node_modules ä¸­ã€‚</p>
</li>
<li>
<p>npm unlink åŒ…åç§° ï¼Œè¿™ä¸ªå‘½ä»¤ç”¨äºç§»é™¤å…¨å±€ node_modules ä¸­æŒ‡å®šçš„è½¯è¿æ¥ã€‚ï¼ˆä¸è¿‡è¿™ä¸ªå‘½ä»¤ä¸å¥½ç”¨ï¼Œå»ºè®®ä½¿ç”¨ <code>npm uninstall -g </code> åŒ…åç§°ã€æˆ–è€… <code>npm remove -g </code> åŒ…åç§°  ä»£æ›¿ï¼‰</p>
</li>
<li>
<p>è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œå½“æœ¬åœ°åŒ…ç›¸äº’ä¾èµ–æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ File: è·¯å¾„è¿›è¡ŒæŒ‡å‘ã€‚</p>
<p><strong>ä¸¤ç§æ–¹å¼çš„åŒºåˆ«</strong></p>
</li>
</ul>
<p>npm  link çš„æ–¹å¼åˆ›å»ºçš„è½¯è¿æ¥å¯ä»¥å®æ—¶åŒæ­¥æ›´æ”¹çš„æ–‡ä»¶ï¼Œä½†æ˜¯é¡¹ç›®æ–‡ä»¶å¤šäº†å°±ä¸æ–¹ä¾¿ç®¡ç†ã€å¾ˆå¤æ‚ï¼ŒFile è·¯å¾„ä¸èƒ½å®æ—¶åŒæ­¥æ–‡ä»¶ä¿®æ”¹ï¼Œéœ€è¦æ‰§è¡Œ npm installï¼Œä½†æ˜¯ç®¡ç†æ–¹ä¾¿ã€‚</p>
<h1 id="è„šæ‰‹æ¶å‘å¸ƒä½“ç³»"><a class="anchor" href="#è„šæ‰‹æ¶å‘å¸ƒä½“ç³»">#</a> è„šæ‰‹æ¶å‘å¸ƒä½“ç³»</h1>
<p><strong>åˆ©ç”¨è„šæ‰‹æ¶ç»Ÿä¸€ç®¡ç†å‘å¸ƒé˜¶æ®µ</strong></p>
<p><strong>åˆ©ç”¨è„šæ‰‹æ¶åšå‘å¸ƒçš„ä¼˜åŠ¿</strong></p>
<ul>
<li>è§„èŒƒï¼šåˆ©ç”¨ç»Ÿä¸€å‘å¸ƒè§„èŒƒï¼Œå¦‚ commiti è®°å½•ã€åˆ†æ”¯åç§°ã€ä»£ç è§„èŒƒç­‰</li>
<li>æ•ˆç‡ï¼šé¿å…å¤§é‡é‡å¤æ“ä½œï¼Œæµªè´¹å¼€å‘æ—¶é—´</li>
<li>å®‰å…¨ï¼šæ„å»ºå’Œå‘å¸ƒå…¨éƒ¨åœ¨äº‘ç«¯æ“ä½œï¼Œé¿å…ä¸ªäººå‘å¸ƒæ—¶å¸¦æ¥çš„å®‰å…¨éšæ‚£</li>
</ul>
<p><strong>è„šæ‰‹æ¶å‘å¸ƒçš„æµç¨‹ï¼Ÿ</strong></p>
<ul>
<li>GitF1low è‡ªåŠ¨åŒ–ä»£ç æäº¤</li>
<li>è¿œç¨‹ä»£ç è‡ªåŠ¨æ£€æŸ¥</li>
<li>äº‘ç«¯å®Œæˆæ„å»ºä¸å‘å¸ƒæ“ä½œ</li>
</ul>
<h1 id="è„šæ‰‹æ¶å‘å¸ƒæµç¨‹"><a class="anchor" href="#è„šæ‰‹æ¶å‘å¸ƒæµç¨‹">#</a> è„šæ‰‹æ¶å‘å¸ƒæµç¨‹</h1>
<ul>
<li>æ£€æŸ¥ package.json ä¸­ name å’Œ bin å­—æ®µï¼Œname å­—æ®µä¸èƒ½å’Œå·²å­˜åœ¨çš„çº¿ä¸ŠåŒ…åé‡å¤ï¼Œ</li>
<li>æ£€æŸ¥ç‰ˆæœ¬å·ï¼Œæ˜¯å¦éœ€è¦æ›´æ–°</li>
<li>npm login</li>
<li>npm publish</li>
</ul>
<h1 id="npmæ–°ç‰¹æ€§workspace"><a class="anchor" href="#npmæ–°ç‰¹æ€§workspace">#</a> npm æ–°ç‰¹æ€§ï¼šworkspace</h1>
<p><strong>ä½œç”¨</strong></p>
<p>æœ¬åœ°è°ƒè¯•æ—¶ï¼Œéœ€è¦å¤šæ¬¡æ‰§è¡Œ npm  linkï¼Œnode15 ç‰ˆæœ¬æ¨å‡º workspaceï¼Œworkspace æ–°ç‰¹æ€§å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œå¤š package åŒ…ç®¡ç†ï¼Œå¯ä»¥è®©å¤šä¸ª npm åŒ…åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­è¿›è¡Œå¼€å‘å’Œç®¡ç†ï¼š</p>
<ul>
<li>å°†å­åŒ…ä¸­æ‰€æœ‰çš„ä¾èµ–åŒ…éƒ½æå‡åˆ°æ ¹ç›®å½•è¿›è¡Œå®‰è£…ï¼Œæå‡åŒ…çš„å®‰è£…é€Ÿåº¦</li>
<li>åˆå§‹åŒ– (npm install) åè‡ªåŠ¨å°†å­åŒ…ä¹‹é—´çš„ä¾èµ–è¿›è¡Œå…³è”</li>
<li>å„ä¸ªå­åŒ…å…±äº«ä¸€äº›æµç¨‹ï¼ˆeslintã€githookã€publish flow ç­‰ç­‰ï¼‰</li>
</ul>
<h1 id="lernaå¤špackageç®¡ç†"><a class="anchor" href="#lernaå¤špackageç®¡ç†">#</a> Lerna å¤š package ç®¡ç†</h1>
<h3 id="lernaç®€ä»‹"><a class="anchor" href="#lernaç®€ä»‹">#</a> Lerna ç®€ä»‹</h3>
<p><strong>åŸç”Ÿè„šæ‰‹æ¶å¼€å‘ç—›ç‚¹åˆ†æ</strong>ï¼ˆLerna è§£å†³äº†å“ªäº›é—®é¢˜ï¼š ï¼‰</p>
<p><strong>ç—›ç‚¹ä¸€ï¼šé‡å¤æ“ä½œ</strong></p>
<ul>
<li>å¤š Package æœ¬åœ° link</li>
<li>å¤š Package ä¾èµ–å®‰è£…</li>
<li>å¤š Package. å•å…ƒæµ‹è¯•</li>
<li>å¤š Package ä»£ç æäº¤</li>
<li>å¤š Package ä»£ç å‘å¸ƒ</li>
</ul>
<p><strong>ç—›ç‚¹äºŒï¼šç‰ˆæœ¬ä¸€è‡´æ€§</strong></p>
<ul>
<li>å‘å¸ƒæ—¶ç‰ˆæœ¬ä¸€è‡´æ€§</li>
<li>å‘å¸ƒåç›¸äº’ä¾èµ–æ¿æœ¬å‡çº§</li>
<li>package è¶Šå¤šï¼Œç®¡ç†å¤æ‚åº¦è¶Šé«˜</li>
</ul>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Lerna æ˜¯ä¸€ä¸ªä¼˜åŒ–åŸºäº git+npm çš„å¤š package é¡¹ç›®çš„ç®¡ç†å·¥å…·ã€‚</p>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>å¤§å¹…å‡å°‘é‡å¤æ“ä½œ</li>
<li>æå‡æ“ä½œçš„æ ‡å‡†åŒ–</li>
</ul>
<p>Lera æ˜¯æ¶æ„ä¼˜åŒ–çš„äº§ç‰©ï¼Œå®ƒæ­ç¤ºäº†ä¸€ä¸ªæ¶æ„çœŸç†ï¼šé¡¹ç›®å¤æ‚åº¦æå‡åï¼Œå°±éœ€è¦å¯¹é¡¹ç›®è¿›è¡Œæ¶æ„ä¼˜åŒ–ã€‚ä¼˜åŒ–çš„ä¸»è¦ç›®æ ‡å¾€å¾€éƒ½æ˜¯ä»¥æ•ˆèƒ½ä¸ºæ ¸å¿ƒã€‚</p>
<h3 id="lernaä½¿ç”¨"><a class="anchor" href="#lernaä½¿ç”¨">#</a> Lerna ä½¿ç”¨</h3>
<p><strong>Lerna å¼€å‘è„šæ‰‹æ¶æµç¨‹å¦‚ä¸‹ï¼š</strong></p>
<ul>
<li>
<p>npm ä¸Šåˆ›å»º group</p>
</li>
<li>
<p>åˆå§‹åŒ– npm é¡¹ç›®</p>
</li>
<li>
<p>å®‰è£… lerna</p>
</li>
<li>
<p>package.json ä¸­é…ç½® workspaces</p>
<figure class="highlight json"><figcaption data-lang="JSON"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token property">"workspaces"</span><span class="token operator">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token string">"packages/*"</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">//workspaces å­—æ®µå…è®¸æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªç›®å½•ä½œä¸ºå·¥ä½œåŒºã€‚ä¸€ã€å¯ä»¥åœ¨çˆ¶çº§ç›®å½•çš„ package.json ä¸­ç®¡ç†ä»–ä»¬çš„ä¾èµ–ï¼Œä»è€Œè¾ƒå°‘ä½“ç§¯ã€‚äºŒã€å·¥ä½œåŒºæ¯ä¸ªåŒ…ä¹‹é—´ç›´æ¥ç›¸äº’å¼•ç”¨ï¼Œæœ‰åŠ©äºæé«˜å¼€å‘æ•ˆç‡ã€‚ä¸‰ã€å·¥ä½œåŒºæ‰€æœ‰åŒ…å…±äº«ç‰ˆæœ¬æ§åˆ¶å†å²ã€‚</span></pre></td></tr></table></figure></li>
<li>
<p>lerna init åˆå§‹åŒ–é¡¹ç›®ï¼ˆåˆ›å»ºäº† gitï¼‰</p>
</li>
<li>
<p>é…ç½® gitignore æ’é™¤ä¸éœ€è¦æäº¤çš„æ–‡ä»¶</p>
</li>
<li>
<p>--------------------------- åˆå§‹åŒ–å®Œæˆ</p>
</li>
<li>
<p>lerna create åˆ›å»º package</p>
</li>
<li>
<p>lerna add å®‰è£…ä¾èµ–ï¼ˆæœ€æ–°ç‰ˆåºŸå¼ƒï¼‰ï¼Œä½¿ç”¨ npm install &lt;dependency&gt; --workspace  &lt;workspace &gt; ä»£æ›¿ã€‚</p>
</li>
<li>
<p>lerna link é“¾æ¥ä¾èµ–ï¼ˆæœ€æ–°ç‰ˆåºŸå¼ƒï¼‰ï¼Œworkspace è‡ªåŠ¨é“¾æ¥ã€‚</p>
</li>
<li>
<p>---------------------------- é¡¹ç›®åˆ›å»ºå®Œæˆ</p>
</li>
<li>
<p>lerna exec æ‰§è¡Œ shell è„šæœ¬</p>
</li>
<li>
<p>lerna run æ‰§è¡Œ npm å‘½ä»¤</p>
</li>
<li>
<p>lerna clean æ¸…ç©ºä¾èµ–</p>
</li>
<li>
<p>lerna bootstrap é‡è£…ä¾èµ–ï¼ˆæœ€æ–°ç‰ˆåºŸå¼ƒï¼‰ï¼Œä½¿ç”¨ npm install ä»£æ›¿</p>
</li>
<li>
<p>---------------------------- é¡¹ç›®å¼€å‘å®Œæˆ</p>
</li>
<li>
<p>git push æäº¤åˆ°è¿œç¨‹ä»“åº“</p>
</li>
<li>
<p>lerna version å‡çº§ç‰ˆæœ¬å·</p>
</li>
<li>
<p>lerna changed æŸ¥çœ‹ä¸Šç‰ˆæœ¬ä»¥æ¥å…¨éƒ¨çš„å˜æ›´ã€‚</p>
</li>
<li>
<p>git add . æ·»åŠ åˆ° git å·¥ä½œåŒº</p>
</li>
<li>
<p>lerna diff æŸ¥çœ‹ diff</p>
</li>
<li>
<p>lerna publish è¿›è¡Œé¡¹ç›®å‘å¸ƒ</p>
<figure class="highlight json"><figcaption data-lang="JSON"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// é»˜è®¤æ˜¯ç§æœ‰ä»“åº“ï¼Œéœ€è¦åœ¨ package.json ä¸­è¿›è¡Œé…ç½®ï¼š</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token property">"publishConfig"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>	<span class="token property">"access"</span><span class="token operator">:</span><span class="token string">"public"</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li>
<li>
<p>---------------------------- é¡¹ç›®å‘å¸ƒå®Œæˆ</p>
</li>
</ul>
<p>è¿™é‡Œæ³¨æ„ npm æœ€æ–°ç‰ˆ workspace ç‰¹æ€§çš„æ¨å¹¿å¯¼è‡´ lerna è®¸å¤šå‘½ä»¤åœ¨æœ€æ–°ç‰ˆè¢«åºŸå¼ƒã€‚</p>
<h3 id="lernaå­¦ä¹ æ”¶è·"><a class="anchor" href="#lernaå­¦ä¹ æ”¶è·">#</a> Lerna å­¦ä¹ æ”¶è·</h3>
<ul>
<li>ç†Ÿæ‚‰ Yargs è„šæ‰‹æ¶å¼€å‘æ¡†æ¶</li>
<li>ç†Ÿæ‚‰å¤š Package ç®¡ç†å·¥å…· Lerna çš„ä½¿ç”¨æ–¹æ³•å’Œå®ç°åŸç†</li>
<li>æ·±å…¥ç†è§£ Node.js æ¨¡å—è·¯å¾„è§£ææµç¨‹</li>
</ul>
<h4 id="ä¸€-yargs"><a class="anchor" href="#ä¸€-yargs">#</a> <strong>ä¸€ã€yargs</strong></h4>
<p><strong>è„šæ‰‹æ¶æ„æˆ</strong></p>
<ul>
<li>
<p>bin:package,json ä¸­é…ç½® bin å±æ€§ï¼Œnpm link æœ¬åœ°å®‰è£…</p>
</li>
<li>
<p>command: å‘½ä»¤</p>
</li>
<li>
<p>options: å‚æ•° (boolean/string/number)</p>
</li>
<li>
<p>æ–‡ä»¶é¡¶éƒ¨å¢åŠ   #ï¼/usr/bin/env node</p>
</li>
</ul>
<p><strong>è„šæ‰‹æ¶åˆå§‹åŒ–æµç¨‹</strong></p>
<ul>
<li>
<p>æ„é€ å‡½æ•°ï¼šYargs (0</p>
</li>
<li>
<p>å¸¸ç”¨æ–¹æ³•ï¼š</p>
</li>
</ul>
<ol>
<li>
<p>Yargs.options</p>
</li>
<li>
<p>Yargs.option</p>
</li>
<li>
<p>Yargs.group</p>
</li>
<li>
<p>Yargs.demandCommand</p>
</li>
<li>
<p>Yargs.recommendCommands</p>
</li>
<li>
<p>Yargs.strict</p>
</li>
<li>
<p>Yargs.fail</p>
</li>
<li>
<p>Yargs.alias</p>
</li>
<li>
<p>Yargs.wrap</p>
</li>
<li>
<p>Yargs.epilogue</p>
</li>
</ol>
<ul>
<li>è„šæ‰‹æ¶å‚æ•°è§£æ</li>
</ul>
<ol>
<li>hideBin(process.argv)/Yargs.argv</li>
<li>Yargs.parse(argv,options)</li>
</ol>
<ul>
<li>å‘½ä»¤æ³¨å†Œæ–¹æ³•</li>
</ul>
<ol>
<li>Yargs.command(command,describe,builder,handler)</li>
<li>Yargs.command({command,describe,builder,handler )</li>
</ol>
<h4 id="äºŒ-lernaå®ç°åŸç†"><a class="anchor" href="#äºŒ-lernaå®ç°åŸç†">#</a> <strong>äºŒã€Lerna å®ç°åŸç†</strong></h4>
<p>Lerna æ˜¯åŸºäº git+npm çš„å¤š package é¡¹ç›®ç®¡ç†å·¥å…·</p>
<p><strong>å®ç°åŸç†ï¼š</strong></p>
<ul>
<li>é€šè¿‡ import-local ä¼˜å…ˆè°ƒç”¨æœ¬åœ° lerna å‘½ä»¤</li>
<li>é€šè¿‡ Yargs ç”Ÿæˆè„šæ‰‹æ¶ï¼Œå…ˆæ³¨å†Œå…¨å±€å±æ€§ï¼Œå†æ³¨å†Œå‘½ä»¤ï¼Œæœ€åé€šè¿‡ parse æ–¹æ³•è§£æå‚æ•°</li>
<li>lerna å‘½ä»¤æ³¨å†Œæ—¶éœ€è¦ä¼ å…¥ builder å’Œ handler ä¸¤ä¸ªæ–¹æ³•ï¼Œbuilder æ–¹æ³•ç”¨äºæ³¨å†Œå‘½ä»¤ä¸“å±çš„ options</li>
<li>handler ç”¨æ¥å¤„ç†å‘½ä»¤çš„ä¸šåŠ¡é€»è¾‘</li>
<li>lerna é€šè¿‡é…ç½® npm æœ¬åœ°ä¾èµ–çš„æ–¹å¼æ¥è¿›è¡Œæœ¬åœ°å¼€å‘ï¼Œå…·ä½“å†™æ³•æ˜¯åœ¨ package.json çš„ä¾èµ–ä¸­å†™å…¥ï¼šfile:your-local--module-path, åœ¨ lerna publish æ—¶ä¼šè‡ªåŠ¨å°†è¯¥è·¯å¾„æ›¿æ¢</li>
</ul>
<h4 id="ä¸‰-nodejsæ¨¡å—è·¯å¾„è§£ææµç¨‹"><a class="anchor" href="#ä¸‰-nodejsæ¨¡å—è·¯å¾„è§£ææµç¨‹">#</a> ä¸‰ã€Node.js æ¨¡å—è·¯å¾„è§£ææµç¨‹</h4>
<ul>
<li>
<p>Node.js é¡¹ç›®æ¨¡å—è·¯å¾„è§£ææ˜¯é€šè¿‡ require.resolve æ–¹æ³•æ¥å®ç°çš„</p>
</li>
<li>
<p>require,resolve å°±æ˜¯é€šè¿‡ Module.reso1 veFileName æ–¹æ³•å®ç°çš„</p>
</li>
<li>
<p>require,resolve å®ç°åŸç†ï¼š<strong>Module,resolveFileName æ–¹æ³•æ ¸å¿ƒæµç¨‹æœ‰ 3 ç‚¹ï¼š</strong></p>
<ol>
<li>
<p>åˆ¤æ–­æ˜¯å¦ä¸ºå†…ç½®æ¨¡å—</p>
</li>
<li>
<p>é€šè¿‡ Module,resolveLookupPaths æ–¹æ³•ç”Ÿæˆ node_modules å¯èƒ½å­˜åœ¨çš„è·¯å¾„</p>
</li>
<li>
<p>é€šè¿‡ Module,findPath æŸ¥è¯¢æ¨¡å—çš„çœŸå®è·¯å¾„</p>
</li>
</ol>
<p><strong>Module,findPath æ ¸å¿ƒæµç¨‹æœ‰ 4 ç‚¹ï¼š</strong></p>
<ol>
<li>
<p>æŸ¥è¯¢ç¼“å­˜ï¼ˆå°† request å’Œ paths é€šè¿‡ \xoo åˆå¹¶æˆ cacheKey)</p>
</li>
<li>
<p>éå† paths, å°† path ä¸ request ç»„æˆæ–‡ä»¶è·¯å¾„ basePath</p>
</li>
<li>
<p>å¦‚æœ basePath å­˜åœ¨åˆ™è°ƒç”¨ fs,realPathSync è·å–æ–‡ä»¶çœŸå®è·¯å¾„</p>
</li>
<li>
<p>å°†æ–‡ä»¶çœŸå®è·¯å¾„ç¼“å­˜åˆ° Module.pathCache (key å°±æ˜¯å‰é¢ç”Ÿæˆçš„ cacheKey)</p>
</li>
</ol>
<p><strong>fs.realPathSync æ ¸å¿ƒæµç¨‹æœ‰ 3 ç‚¹ï¼š</strong></p>
</li>
</ul>
<ol>
<li>
<p>æŸ¥è¯¢ç¼“å­˜ï¼ˆç¼“å­˜çš„ key ä¸º p, å³ Module.findPath ä¸­ç”Ÿæˆçš„æ–‡ä»¶è·¯å¾„ï¼‰ã€‘</p>
</li>
<li>
<p>ä»å·¦å¾€å³éå†è·¯å¾„å­—ç¬¦ä¸²ï¼ŒæŸ¥è¯¢åˆ° / æ—¶ï¼Œæ‹†åˆ†è·¯å¾„ï¼Œåˆ¤æ–­è¯¥è·¯å¾„æ˜¯å¦ä¸ºè½¯é“¾æ¥ï¼Œå¦‚æœæ˜¯è½¯é“¾æ¥åˆ™æŸ¥è¯¢çœŸå®é“¾æ¥ï¼Œå¹¶ç”Ÿæˆæ–°è·¯å¾„ P, ç„¶åç»§ç»­å¾€åéå†ï¼Œè¿™é‡Œæœ‰ 1 ä¸ªç»†èŠ‚éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š</p>
<p>éå†è¿‡ç¨‹ä¸­ç”Ÿæˆçš„å­è·¯å¾„ base ä¼šç¼“å­˜åœ¨ knownHard å’Œ cache ä¸­ï¼Œé¿å…é‡å¤æŸ¥è¯¢</p>
</li>
<li>
<p>éå†å®Œæˆå¾—åˆ°æ¨¡å—å¯¹åº”çš„çœŸå®è·¯å¾„ï¼Œæ­¤æ—¶ä¼šå°†åŸå§‹è·¯å¾„ original ä½œä¸º key, çœŸå®è·¯å¾„ä½œä¸º value, ä¿å­˜åˆ°ç¼“å­˜ä¸­</p>
</li>
</ol>
<ul>
<li>
<p>require.resolve,paths ç­‰ä»·äº Module.resolveLookupPathsï¼Œ, è¯¥æ–¹æ³•ç”¨äºè·å–æ‰€æœ‰ node_modules å¯èƒ½å­˜åœ¨çš„è·¯å¾„</p>
</li>
<li>
<p>require.resolve,paths å®ç°åŸç†ï¼š<br />
å¦‚æœè·¯å¾„ä¸º /ï¼ˆæ ¹ç›®å½•ï¼‰ï¼Œç›´æ¥è¿”å›ã€'/node modules'ã€‘å¦åˆ™ï¼Œå°†è·¯å¾„å­—ç¬¦ä¸²ä»åå¾€å‰éå†ï¼ŒæŸ¥è¯¢åˆ° / æ—¶ï¼Œæ‹†åˆ†è·¯å¾„ï¼Œåœ¨åé¢åŠ ä¸Š node_modules, å¹¶ä¼ å…¥ä¸€ä¸ª paths æ•°ç»„ï¼Œç›´è‡³æŸ¥è¯¢ä¸åˆ° / åè¿”å› paths æ•°ç»„</p>
</li>
</ul>
<h1 id="yargs"><a class="anchor" href="#yargs">#</a> yargs</h1>
<p><strong>yargs ä½¿ç”¨ç®€è¦ä»‹ç»ï¼š</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token hashbang comment">#! /usr/bin/env node</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// è·å¾— yargs æ„é€ å®ä¾‹</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> yargs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'yargs/yargs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// å‚æ•°è§£æå‡½æ•°</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">const</span> <span class="token punctuation">&#123;</span> hideBin <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'yargs/helpers'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">const</span> arg <span class="token operator">=</span> <span class="token function">hideBin</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">const</span> cli <span class="token operator">=</span> <span class="token function">yargs</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// é…ç½®å‘½ä»¤ï¼š</span></pre></td></tr><tr><td data-num="10"></td><td><pre>cli</pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">usage</span><span class="token punctuation">(</span><span class="token string">'Usage: $0 [command] &lt;options>'</span><span class="token punctuation">)</span> <span class="token comment">// ä½¿ç”¨è¯´æ˜ï¼Œ$0 è¡¨ç¤ºå‘½ä»¤</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">demandCommand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'A command is required,pass --help to see info'</span><span class="token punctuation">)</span> <span class="token comment">// æœ€å°‘ä¸€ä¸ªæ¬¡å‘½ä»¤</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">strict</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// å¯¹äºæœªçŸ¥çš„å‘½ä»¤è¡Œå‚æ•°è¿›è¡Œæç¤ºè¾“å‡ºã€‚</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">recommendCommands</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// æŸ¥æ‰¾æç¤ºè¿‘ä¼¼å‘½ä»¤</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">alias</span><span class="token punctuation">(</span><span class="token string">'h'</span><span class="token punctuation">,</span><span class="token string">'help'</span><span class="token punctuation">)</span> <span class="token comment">//options åˆ«å</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">alias</span><span class="token punctuation">(</span><span class="token string">'v'</span><span class="token punctuation">,</span><span class="token string">'version'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span>cli<span class="token punctuation">.</span><span class="token function">terminalWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// å‘½ä»¤è¡Œè¾“å‡ºå®½åº¦</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">epilog</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">welcomn use cli-core</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span> <span class="token comment">// ç»“è¯­</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token comment">// æ³¨å†Œå¤šä¸ª options é€‰é¡¹</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token literal-property property">debug</span><span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>      <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">"boolean"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token literal-property property">describe</span><span class="token operator">:</span> <span class="token string">"bootstrap debug mode"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="23"></td><td><pre>      <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token string">"d"</span> <span class="token comment">// æ·»åŠ åˆ«å</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">'registry'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token comment">// æ·»åŠ å•ä¸ªé€‰é¡¹</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token literal-property property">hidden</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// ä¸å¯¹å¤–æš´éœ²å‘½ä»¤</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">"string"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token literal-property property">describe</span><span class="token operator">:</span><span class="token string">"define global registry"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token literal-property property">alias</span><span class="token operator">:</span><span class="token string">'r'</span></pre></td></tr><tr><td data-num="31"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'debug'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'Dev Options'</span><span class="token punctuation">)</span> <span class="token comment">// å¯¹ Options é€‰é¡¹è¿›è¡Œåˆ†ç±»</span></pre></td></tr><tr><td data-num="33"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'registry'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"Extra Options"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">'init [name]'</span><span class="token punctuation">,</span><span class="token string">'init a project'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">yargs</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span> <span class="token comment">// æ³¨å†Œæ¬¡å‘½ä»¤ï¼Œåˆ¶å®šå¯¹åº” options</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    yargs</pre></td></tr><tr><td data-num="36"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token literal-property property">describe</span><span class="token operator">:</span> <span class="token string">'Name of a project'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token string">'n'</span></pre></td></tr><tr><td data-num="40"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">argv</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>argv<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    <span class="token comment">// ç¬¬äºŒç§æ³¨å†Œå‘½ä»¤çš„æ–¹æ³•ï¼ˆæ›´åŠ ç²¾ç»†ï¼‰</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token literal-property property">command</span><span class="token operator">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token literal-property property">aliases</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'ls'</span><span class="token punctuation">,</span><span class="token string">'la'</span><span class="token punctuation">,</span><span class="token string">'ll'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token literal-property property">describe</span><span class="token operator">:</span> <span class="token string">'List local packages'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token function-variable function">builder</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">yargs</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">[</span></pre></td></tr><tr><td data-num="49"></td><td><pre>      <span class="token comment">//.... æ“ä½œ</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">argv</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>argv<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="55"></td><td><pre>  <span class="token punctuation">.</span>argv<span class="token punctuation">;</span> <span class="token comment">// ä½¿ç”¨å‚æ•°</span></pre></td></tr></table></figure><h1 id="commander"><a class="anchor" href="#commander">#</a> commander</h1>
<p><strong>commander ç®€å•å•ä¾‹æ¨¡å¼</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token hashbang comment">#! /usr/bin/env node</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> commander <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'commander'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> pkg <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../package.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> <span class="token punctuation">&#123;</span> program <span class="token punctuation">&#125;</span> <span class="token operator">=</span> commander<span class="token punctuation">;</span> <span class="token comment">//commander å•ä¾‹ï¼ŒåŒ…å«å·²æ³¨å†Œå¥½çš„åŸºç¡€å‘½ä»¤</span></pre></td></tr><tr><td data-num="5"></td><td><pre>program</pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span>pkg<span class="token punctuation">.</span>version<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>argv<span class="token punctuation">)</span></pre></td></tr></table></figure><p><strong>commander å¼ºå¤§åŠŸèƒ½</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token hashbang comment">#! /usr/bin/env node</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> commander <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'commander'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> pkg <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../package.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> program <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">commander<span class="token punctuation">.</span>Command</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æ‰‹åŠ¨å®ä¾‹åŒ–ä¸€ä¸ª commander å®ä¾‹</span></pre></td></tr><tr><td data-num="5"></td><td><pre>program</pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>pkg<span class="token punctuation">.</span>bin<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">usage</span><span class="token punctuation">(</span><span class="token string">'&lt;command> [options]'</span><span class="token punctuation">)</span> <span class="token comment">// ä½¿ç”¨è¯´æ˜</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span>pkg<span class="token punctuation">.</span>version<span class="token punctuation">)</span> <span class="token comment">// ç‰ˆæœ¬</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">'-d,--debug'</span><span class="token punctuation">,</span><span class="token string">'æ˜¯å¦å¼€å¯è°ƒè¯•æ¨¡å¼'</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token comment">// é…ç½® option é€‰é¡¹ï¼šé€‰é¡¹ï¼Œå¸®åŠ©ä¿¡æ¯ï¼Œé»˜è®¤å€¼</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">'-e,--envName &lt;envName>'</span><span class="token punctuation">,</span><span class="token string">'è·å–å˜é‡åç§°'</span><span class="token punctuation">)</span><span class="token comment">//option è·å¾—ä¼ å‚</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token comment">// è§£æå‚æ•°</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// ä½¿ç”¨ command æ³¨å†Œå‘½ä»¤</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">const</span> clone <span class="token operator">=</span> program<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">'clone &lt;source> [destination]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&lt; å¿…é€‰é¡¹ >ï¼Œ[å¯é€‰é¡¹]</span></pre></td></tr><tr><td data-num="14"></td><td><pre>clone</pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">'clone a repository'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">'-f,--force'</span><span class="token punctuation">,</span><span class="token string">'æ˜¯å¦å¼ºåˆ¶å…‹éš†'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">,</span>destination<span class="token punctuation">,</span>cmdObj</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'do clone'</span><span class="token punctuation">,</span>source<span class="token punctuation">,</span>destination<span class="token punctuation">,</span>cmdObj<span class="token punctuation">.</span>force<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">// ä½¿ç”¨ addCommand æ³¨å†Œå­å‘½ä»¤</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">const</span> service <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">commander<span class="token punctuation">.</span>Command</span><span class="token punctuation">(</span><span class="token string">'service'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>service</pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">'start [port]'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">'start service at port'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">port</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'do service start'</span><span class="token punctuation">,</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>service</pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">'stop'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">'stop service'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'stop service'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>program<span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span>service<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment">// å‚æ•°è§£é‡Šå’Œè‡ªåŠ¨åŒ¹é…åŠŸèƒ½</span></pre></td></tr><tr><td data-num="37"></td><td><pre>program</pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">arguments</span><span class="token punctuation">(</span><span class="token string">'&lt;cmd> [options]'</span><span class="token punctuation">)</span> <span class="token comment">// å¼ºåˆ¶ä¼ å…¥å‘½ä»¤</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">'test command'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token comment">// æè¿°</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token literal-property property">cmd</span><span class="token operator">:</span> <span class="token string">'å‘½ä»¤'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token string">'å‚æ•°'</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">cmd<span class="token punctuation">,</span>options</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">// åŒ¹é…å…¨éƒ¨å‘½ä»¤</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token comment">// é»˜è®¤å‘½ä»¤ä¸å‘½ä»¤è½¬å‘åŠŸèƒ½</span></pre></td></tr><tr><td data-num="48"></td><td><pre>program</pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">'install [name]'</span><span class="token punctuation">,</span><span class="token string">'install package'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>            <span class="token literal-property property">executableFile</span><span class="token operator">:</span> <span class="token string">'imooc-cli'</span><span class="token punctuation">,</span> <span class="token comment">// å°† install [name] å‘½ä»¤è½¬å‘ imooc-cli</span></pre></td></tr><tr><td data-num="51"></td><td><pre>            <span class="token literal-property property">isDefault</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// è®¾ç½®ä¸ºé»˜è®¤å‘½ä»¤</span></pre></td></tr><tr><td data-num="52"></td><td><pre>            <span class="token literal-property property">hidden</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// å‘½ä»¤ä¸å¯è§</span></pre></td></tr><tr><td data-num="53"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="54"></td><td><pre>        <span class="token punctuation">.</span><span class="token function">alias</span><span class="token punctuation">(</span><span class="token string">'i'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token comment">// é«˜çº§å®šåˆ¶ 1ï¼šè‡ªå®šä¹‰ help ä¿¡æ¯</span></pre></td></tr><tr><td data-num="57"></td><td><pre>program<span class="token punctuation">.</span><span class="token function-variable function">helpInformation</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>program<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'--help'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'my help information'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre></pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token comment">// é«˜çº§å®šåˆ¶ 2ï¼šç›‘å¬ debug</span></pre></td></tr><tr><td data-num="65"></td><td><pre>program<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'option:debug'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>program<span class="token punctuation">.</span>debug<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>        process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">LOG_LEVEL</span> <span class="token operator">=</span> <span class="token string">'verbose'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">LOG_LEVEL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="71"></td><td><pre></pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token comment">// é«˜çº§å®šåˆ¶ 3ï¼šç›‘å¬æœªçŸ¥å‘½ä»¤ï¼ˆä¸é»˜è®¤å‘½ä»¤å†²çªï¼‰</span></pre></td></tr><tr><td data-num="73"></td><td><pre>program<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'command:*'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æœªçŸ¥å‘½ä»¤:'</span><span class="token operator">+</span> obj<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>    <span class="token keyword">const</span> avaliableCommands <span class="token operator">=</span> program<span class="token punctuation">.</span>commands<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">cmd</span><span class="token operator">=></span>cmd<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å¯ç”¨å‘½ä»¤ï¼š'</span><span class="token operator">+</span>avaliableCommands<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="78"></td><td><pre></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token comment">// æœ€åè¦è¿›è¡Œå‚æ•°è§£æï¼</span></pre></td></tr><tr><td data-num="80"></td><td><pre>program<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>argv<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="81"></td><td><pre></pre></td></tr><tr><td data-num="82"></td><td><pre><span class="token comment">// å†…ç½®å±æ€§å’Œæ–¹æ³•</span></pre></td></tr><tr><td data-num="83"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>program<span class="token punctuation">.</span>debug<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="84"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>program<span class="token punctuation">.</span>envName<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>program<span class="token punctuation">.</span><span class="token function">outputHelp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å†…ç½®æ–¹æ³•ï¼Œå¼¹å‡ºå¸®åŠ©ä¿¡æ¯</span></pre></td></tr><tr><td data-num="86"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>program<span class="token punctuation">.</span><span class="token function">opts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å†…ç½®æ–¹æ³•ï¼Œè¿”å› options ä¿¡æ¯</span></pre></td></tr></table></figure><h1 id="requireåŠ è½½æœºåˆ¶"><a class="anchor" href="#requireåŠ è½½æœºåˆ¶">#</a> require åŠ è½½æœºåˆ¶</h1>
<p><strong>require ç›´æ¥åŠ è½½.jsã€.json å’Œ.node æ–‡ä»¶ï¼Œå…¶ä½™æ–‡ä»¶æŒ‰ç…§ js è¯­æ³•è¿›è¡ŒåŠ è½½</strong></p>
<ol>
<li>åŠ è½½ js æ–‡ä»¶ï¼Œrequire åŠ è½½çš„ js æ–‡ä»¶éœ€è¦è¿›è¡Œå¯¼å‡º</li>
<li>åŠ è½½ json æ–‡ä»¶ï¼Œé€šè¿‡ JSON.parse è¿›è¡Œæ–‡ä»¶è§£æ</li>
<li>åŠ è½½ node æ–‡ä»¶ï¼Œé€šè¿‡ process.dlopen æ–¹æ³•åŠ è½½ï¼ˆnode æ–‡ä»¶æ˜¯ C++ è¯­æ³•ï¼‰</li>
<li>å…¶ä½™æ–‡ä»¶ï¼Œä½¿ç”¨ js è¯­æ³•åŠ è½½ï¼Œæ­¤æ—¶è¯­æ³•é”™è¯¯çš„ä¼šæŠ¥é”™ã€‚</li>
</ol>
<h1 id="nodeå¤šè¿›ç¨‹"><a class="anchor" href="#nodeå¤šè¿›ç¨‹">#</a> node å¤šè¿›ç¨‹</h1>
<h3 id="ä»‹ç»"><a class="anchor" href="#ä»‹ç»">#</a> ä»‹ç»</h3>
<p><strong>è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯ CPU è°ƒåº¦çš„æœ€å°å•ä½</strong></p>
<p>ä»€ä¹ˆæ˜¯è¿›ç¨‹</p>
<p>è¿›ç¨‹ (Process) æ˜¯è®¡ç®—æœºä¸­çš„ç¨‹åºå…³äºæŸæ•°æ®é›†åˆä¸Šçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨ï¼Œæ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•</p>
<p>ä½ï¼Œæ˜¯æ“ä½œç³»ç»Ÿç»“æ„çš„åŸºç¡€ã€‚</p>
<p>è¿›ç¨‹çš„æ¦‚å¿µä¸»è¦æœ‰ä¸¤ç‚¹ï¼š</p>
<ul>
<li>ç¬¬ä¸€ï¼Œè¿›ç¨‹æ˜¯ä¸€ä¸ªå®ä½“ã€‚æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æœ‰å®ƒè‡ªå·±çš„åœ°å€ç©ºé—´ã€‚</li>
<li>ç¬¬äºŒï¼Œè¿›ç¨‹æ˜¯ä¸€ä¸ª â€œæ‰§è¡Œä¸­çš„ç¨‹åºâ€ï¼Œå­˜åœ¨åµŒå¥—å…³ç³»ã€‚</li>
</ul>
<p>node å¤šè¿›ç¨‹å®˜æ–¹æ–‡æ¡£ï¼š</p>
<p>ä¸­æ–‡ç‰ˆï¼š<span class="exturl" data-url="aHR0cDovL25vZGVpcy5jbi9hcGkvY2hpbGRfcHJvY2VzcyxodG1s">http://nodeis.cn/api/child_process,html</span></p>
<p><strong>æ“ä½œç³»ç»Ÿä¼šä½¿ç”¨æ—¶ä¼šå¼€è¾Ÿä¸€ä¸ª node è¿›ç¨‹ï¼Œæ¯ä¸ª node æ–‡ä»¶åœ¨è¿è¡Œæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ª child_process è¿›è¡Œï¼Œä¹Ÿå°±æ˜¯ node.js çš„å­è¿›ç¨‹ã€‚</strong></p>
<h3 id="child_precessç”¨æ³•"><a class="anchor" href="#child_precessç”¨æ³•">#</a> child_precess ç”¨æ³•</h3>
<p><strong>ä¸€ã€æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> cp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span> <span class="token comment">// é»˜è®¤å†…ç½®åº“</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">//exec æ–¹æ³•ï¼Œå¯ä»¥ä¼ æ‰§è¡Œå‘½ä»¤ï¼Œä¹Ÿå¯ä»¥ä¼ æ–‡ä»¶è·¯å¾„ï¼Œä½†ä¸æ”¯æŒç»™æ–‡ä»¶ä¼ å‚ã€‚</span></pre></td></tr><tr><td data-num="3"></td><td><pre>cp<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'ls -al|grep node_modules'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>stdout<span class="token punctuation">,</span>stderr</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>stdout<span class="token punctuation">,</span>stderr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">//execFile æ–¹æ³•ï¼Œä¼ æ–‡ä»¶è·¯å¾„ï¼Œå¹¶ä¸”æ”¯æŒç»™æ–‡ä»¶ä¼ å‚æ•°ã€‚</span></pre></td></tr><tr><td data-num="7"></td><td><pre>cp<span class="token punctuation">.</span><span class="token function">execFile</span><span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'-al'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>stdout<span class="token punctuation">,</span>stderr</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span>stdout<span class="token punctuation">,</span>stderr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">//spawn æ–¹æ³•ï¼Œä¼ å…¥æ–‡ä»¶è·¯å¾„ï¼Œä»¥æµå¼çš„æ–¹å¼è¾“å‡ºï¼Œæ˜¯ exec å’Œ execFile çš„åº•å±‚åŸç†</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">const</span> child <span class="token operator">=</span> cp<span class="token punctuation">.</span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token string">'npm'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>install<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token literal-property property">cwd</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'/User/dmq/Desktop/test'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>child<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'stdout'</span><span class="token punctuation">,</span>chunk<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>child<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'stderr'</span><span class="token punctuation">,</span>chunk<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><strong>exec å’Œ spawn ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<p>å½“æ–‡ä»¶æ“ä½œè¿‡ç¨‹å¤æ‚ï¼Œå¹¶ä¸”éœ€è¦é¢‘ç¹è¾“å‡ºæ—¥å¿—æ—¶ï¼Œä½¿ç”¨ spawn è¿›è¡Œæµå¼æ“ä½œã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> child <span class="token operator">=</span> cp<span class="token punctuation">.</span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token string">'npm'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>install<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token literal-property property">cwd</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'/User/dmq/Desktop/test'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token literal-property property">stdio</span><span class="token operator">:</span> <span class="token string">'inherit'</span><span class="token punctuation">,</span> <span class="token comment">// å°†è¾“å‡ºä¼ ç»™çˆ¶è¿›ç¨‹ã€‚</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// ç›‘å¬é”™è¯¯äº‹ä»¶</span></pre></td></tr><tr><td data-num="6"></td><td><pre>child<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span><span class="token parameter">e</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// ç›‘å¬é€€å‡ºäº‹ä»¶</span></pre></td></tr><tr><td data-num="10"></td><td><pre>child<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'exit'</span><span class="token punctuation">,</span><span class="token parameter">e</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å‘½ä»¤æ‰§è¡ŒæˆåŠŸ'</span> <span class="token operator">+</span> e<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>child<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'stdout'</span><span class="token punctuation">,</span>chunk<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>child<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'stderr'</span><span class="token punctuation">,</span>chunk<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>å½“æ–‡ä»¶æ“ä½œè¿‡ç¨‹ç®€å•ï¼Œéœ€è¦ç›´æ¥è¾“å‡ºæ—¶ï¼Œä½¿ç”¨ exec æ–¹æ³•</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>cp<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'npm install'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>	<span class="token literal-property property">cwd</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'/User/dmq/Desktop/test'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>stdout<span class="token punctuation">,</span>stderr</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stdout<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stderr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><strong>äºŒã€æ‰§è¡ŒæŒ‡å®š JS æ–‡ä»¶ï¼ˆä¸æ”¯æŒå›è°ƒï¼‰</strong></p>
<p>fork æ–¹æ³•ç±»ä¼¼äº require å‡½æ•°ï¼Œä½†æ˜¯åŒºåˆ«åœ¨äº fork æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ª node å­è¿›ç¨‹æ‰§è¡Œ JS æ–‡ä»¶ï¼Œä½¿ç”¨ç‹¬ç«‹çš„ v8 å¼•æ“å»è§£æä»£ç ã€‚</p>
<p>index.js æ–‡ä»¶ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> child <span class="token operator">=</span> cp<span class="token punctuation">.</span><span class="token function">fork</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'child.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>child<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'hello child process!'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    child<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åŠæ—¶æ–­å¼€è¿æ¥ï¼Œé˜²æ­¢ä¸»è¿›ç¨‹å’Œå­è¿›ç¨‹é•¿æœŸå¤„äºç­‰å¾…çŠ¶æ€</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>child<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'main pid:'</span><span class="token punctuation">,</span>process<span class="token punctuation">.</span>pid<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>child.js æ–‡ä»¶ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'child process pid:'</span><span class="token punctuation">,</span>process<span class="token punctuation">.</span>pid<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>process<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'hello main process'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="child_processæºç "><a class="anchor" href="#child_processæºç ">#</a> child_process æºç </h3>
<p>ç–‘é—®ï¼š</p>
<ul>
<li>execã€execFileã€spanwn å’Œ fork åŒºåˆ«ï¼š
<ul>
<li>exec: åŸç†æ˜¯è°ƒç”¨ /bin/sh-c æ‰§è¡Œæˆ‘ä»¬ä¼ å…¥çš„ shell è„šæœ¬ï¼Œåº•å±‚è°ƒç”¨äº† execFile</li>
<li>execFile: åŸç†æ˜¯ç›´æ¥æ‰§è¡Œæˆ‘ä»¬ä¼ å…¥çš„ file å’Œ args, åº•å±‚è°ƒç”¨ spawn åˆ›å»ºå’Œæ‰§è¡Œå­è¿›ç¨‹ï¼Œå¹¶å»ºç«‹äº†å›è°ƒï¼Œä¸€æ¬¡æ€§å°†æ‰€æœ‰çš„ stdout å’Œ stderr ç»“æœè¿”å›</li>
<li>spawn: åŸç†æ˜¯è°ƒç”¨äº† internal/child_.process, å®ä¾‹åŒ–äº† ChildProcess å­è¿›ç¨‹å¯¹è±¡ï¼Œå†è°ƒç”¨ child.spawn åˆ›å»ºå­è¿›ç¨‹å¹¶æ‰§è¡Œå‘½ä»¤ï¼Œåº•å±‚æ˜¯è°ƒç”¨äº† child._handle.spawn æ‰§è¡Œ process_wrap ä¸­çš„ spwn æ–¹æ³•ï¼Œæ‰§è¡Œè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œæ‰§è¡Œå®Œæ¯•åé€šè¿‡ PIPE è¿›è¡Œå•å‘æ•°æ®é€šä¿¡ï¼Œé€šä¿¡ç»“æŸåä¼šå­è¿›ç¨‹å‘èµ· onexit å›è°ƒï¼ŒåŒæ—¶ Socket ä¼šæ‰§è¡Œ close å›è°ƒ</li>
<li>fork: åŸç†æ˜¯é€šè¿‡ spawn åˆ›å»ºå­è¿›ç¨‹å’Œæ‰§è¡Œå‘½ä»¤ï¼Œé€šè¿‡ setupchannel åˆ›å»º IPC ç”¨äºå­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹ä¹‹</li>
</ul>
</li>
</ul>
<h1 id="eggjsmongodb"><a class="anchor" href="#eggjsmongodb">#</a> egg.js+mongodb</h1>
<p><strong>1ã€egg.js</strong></p>
<p>ç”¨äºå¿«é€Ÿç”Ÿæˆåç«¯ api çš„æ¡†æ¶ã€‚</p>
<p><strong>2ã€npm init egg å‘½ä»¤</strong></p>
<p>å½“æ‰§è¡Œ <code>npm init egg</code>  å‘½ä»¤æ—¶ï¼Œnpm ä¼šè‡ªåŠ¨æ‰¾åˆ° create-egg è¿™ä¸ªåŒ…ï¼ˆå…¶ä»–åŒ…åŒç†ï¼Œæ‰¾åˆ° create - åŒ…åï¼‰ï¼Œè¿›è¡Œæ‰§è¡Œã€‚<strong>å½“ä¸æƒ³å°†è„šæ‰‹æ¶å®‰è£…åˆ°æœ¬åœ°ï¼Œè€Œæ˜¯åœ¨çº¿ä¸Šç›´æ¥ä½¿ç”¨æ—¶ï¼Œè¿™ä¸ªæœºåˆ¶å°±æ˜¾å¾—ååˆ†é‡è¦ã€‚</strong></p>
<p><strong>3ã€mongodb æ•°æ®åº“</strong></p>
<p>éå…³ç³»å‹æ•°æ®åº“ã€‚</p>
<ul>
<li>
<p><strong>äº‘ mongodb</strong></p>
<ul>
<li>
<p>äº‘ mongodb å¼€é€š</p>
</li>
<li>
<p>åœ°å€ï¼šhttps:/mongodb.console.aliyun.comL, åˆ›å»ºå®ä¾‹å¹¶ä»˜æ¬¾å³å¯</p>
</li>
</ul>
</li>
<li>
<p><strong>æœ¬åœ° mongodb</strong></p>
<ul>
<li>
<p>åœ°å€ï¼šhttps:/www.runoob.com/mongodb/mongodb-tutorial.html</p>
</li>
<li>
<p>mongodb ä½¿ç”¨æ–¹æ³•</p>
</li>
<li>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cucnVub29iLmNvbS9tb25nb2RiL21vbmdvZGItZGF0YWJhc2VzLWRvY3VtZW50cy1jb2xsZWN0aW9ucy5odG1s">https://www.runoob.com/mongodb/mongodb-databases-documents-collections.html</span></p>
</li>
</ul>
</li>
</ul>
<p>4ã€egg.js é“¾æ¥ mongodb æ•°æ®åº“</p>
<p>utils/mongo.js</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token string">'use strict'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'npmlog'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>logger<span class="token punctuation">.</span>level <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">LOG_LEVEL</span> <span class="token operator">?</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">LOG_LEVEL</span> <span class="token operator">:</span> <span class="token string">'info'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>logger<span class="token punctuation">.</span>heading <span class="token operator">=</span> <span class="token string">'pick'</span><span class="token punctuation">;</span> <span class="token comment">// è‡ªå®šä¹‰å¤´éƒ¨</span></pre></td></tr><tr><td data-num="5"></td><td><pre>logger<span class="token punctuation">.</span><span class="token function">addLevel</span><span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">fg</span><span class="token operator">:</span> <span class="token string">'green'</span><span class="token punctuation">,</span> <span class="token literal-property property">bold</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è‡ªå®šä¹‰ success æ—¥å¿—</span></pre></td></tr><tr><td data-num="6"></td><td><pre>logger<span class="token punctuation">.</span><span class="token function">addLevel</span><span class="token punctuation">(</span><span class="token string">'notice'</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">fg</span><span class="token operator">:</span> <span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token literal-property property">bg</span><span class="token operator">:</span> <span class="token string">'black'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è‡ªå®šä¹‰ notice æ—¥å¿—</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">const</span> MongoClient <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongodb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>MongoClient<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Mongo</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> dbName</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> url<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">this</span><span class="token punctuation">.</span>dbName <span class="token operator">=</span> dbName<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      MongoClient<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>          <span class="token literal-property property">useNewUrlParser</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>          <span class="token literal-property property">useUnifiedTopology</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> client</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>          <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>          <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token keyword">const</span> db <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">db</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dbName<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> db<span class="token punctuation">,</span> client <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>          <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>  <span class="token function">connectAction</span><span class="token punctuation">(</span><span class="token parameter">docName<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>      <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> db<span class="token punctuation">,</span> client <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>      <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token keyword">const</span> collection <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span>docName<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token function">action</span><span class="token punctuation">(</span>collection<span class="token punctuation">,</span> <span class="token parameter">result</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>          logger<span class="token punctuation">.</span><span class="token function">verbose</span><span class="token punctuation">(</span><span class="token string">'result'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>          <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>          logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>          <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>      <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>  <span class="token function">query</span><span class="token punctuation">(</span><span class="token parameter">docName</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">connectAction</span><span class="token punctuation">(</span>docName<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">collection<span class="token punctuation">,</span> onSuccess<span class="token punctuation">,</span> onError</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>      collection<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">projection</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">_id</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> docs</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>          <span class="token function">onError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>          <span class="token function">onSuccess</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>  <span class="token function">insert</span><span class="token punctuation">(</span><span class="token parameter">docName<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">connectAction</span><span class="token punctuation">(</span>docName<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">collection<span class="token punctuation">,</span> onSuccess<span class="token punctuation">,</span> onError</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>      collection<span class="token punctuation">.</span><span class="token function">insertMany</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>          <span class="token function">onError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>          <span class="token function">onSuccess</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="73"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>  <span class="token function">remove</span><span class="token punctuation">(</span><span class="token parameter">docName<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">connectAction</span><span class="token punctuation">(</span>docName<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">collection<span class="token punctuation">,</span> onSuccess<span class="token punctuation">,</span> onError</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>      collection<span class="token punctuation">.</span><span class="token function">deleteOne</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>          <span class="token function">onError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>          <span class="token function">onSuccess</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="84"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>  <span class="token comment">//   update(collection, data) &#123;</span></pre></td></tr><tr><td data-num="86"></td><td><pre>  <span class="token comment">//   &#125;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>  <span class="token function">close</span><span class="token punctuation">(</span><span class="token parameter">client</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>    client <span class="token operator">&amp;&amp;</span> client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="90"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Mongo<span class="token punctuation">;</span></pre></td></tr></table></figure><p>db.js</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> mongo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mongodb</span><span class="token punctuation">(</span><span class="token string">'mongodb://dmq:dmq0216@127.0.0.1:27017/dbName'</span><span class="token punctuation">,</span><span class="token string">'dbName'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">mongo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'project'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h1 id="inquireræºç "><a class="anchor" href="#inquireræºç ">#</a> inquirer æºç </h1>
<h2 id="å­¦ä¹ è·¯å¾„"><a class="anchor" href="#å­¦ä¹ è·¯å¾„">#</a> å­¦ä¹ è·¯å¾„</h2>
<ul>
<li>æŒæ¡ä¸€äº›åº“ï¼šreadlineï¼ˆå‘½ä»¤è¡Œè¯»å–ï¼‰/eventsï¼ˆäº‹ä»¶é©±åŠ¨ï¼‰/streamï¼ˆè¾“å…¥è¾“å‡ºæµï¼‰/ansi-escapesï¼ˆå‘½ä»¤è¡Œæ–‡å­—æ ·å¼ï¼‰/rxjsï¼ˆå¤„ç†å¼‚æ­¥äº‹ä»¶ï¼‰</li>
<li>æŒæ¡å‘½ä»¤è¡Œäº¤äº’çš„å®ç°åŸç†ï¼Œå¹¶å®ç°ä¸€ä¸ªå¯äº¤äº’çš„åˆ—è¡¨</li>
<li>åˆ†æ inquirer æºç æŒæ¡å…¶ä¸­çš„å…³é”®å®ç°</li>
</ul>
<h1 id="ejsglob"><a class="anchor" href="#ejsglob">#</a> ejs+glob</h1>
<p>ejs ä¸‰æ–¹åº“ç”¨äº xml åŠ¨æ€æ¨¡æ¿æ¸²æŸ“ï¼Œglob ä¸‰æ–¹åº“ç”¨äºæ ¹æ® <code>æ–‡ä»¶è·¯å¾„è¿›è¡Œéå†å’ŒåŒ¹é…æ–‡ä»¶</code> ï¼Œæ‹¿åˆ°æ–‡ä»¶çš„å†…å®¹ã€‚</p>
<h1 id="ejsæºç "><a class="anchor" href="#ejsæºç ">#</a> ejs æºç </h1>
<p>çœç•¥ï¼Œè¯¦è§å®˜ç½‘</p>
<h1 id="requireæºç "><a class="anchor" href="#requireæºç ">#</a> require æºç </h1>
<p>çœç•¥ï¼Œè¯¦è§å®˜ç½‘</p>
<h1 id="ä»£ç å¤ç”¨å®è·µ"><a class="anchor" href="#ä»£ç å¤ç”¨å®è·µ">#</a> ä»£ç å¤ç”¨å®è·µ</h1>
<p>** ä»£ç å¤ç”¨ç›®çš„ï¼š** æé«˜äººæ•ˆï¼Œé™ä½å¼€å‘æˆæœ¬ã€‚</p>
<p><strong>è®¡ç®—å…¬å¼</strong>ä¸ºï¼š<strong>èŠ‚çº¦å·¥æ—¶ = æœç”¨ä»£ç èŠ‚çº¦æ—¶é—´  *  ä»£ç å¤ç”¨ç³»æ•°  *  å¤ç”¨æ¬¡æ•°</strong></p>
<p><strong>èƒŒåæ€è€ƒï¼š</strong></p>
<ul>
<li>ä¸åŒå¼€å‘è€…ã€å›¢é˜Ÿä¹‹é—´ä¼šäº§ç”Ÿäº†å¤§é‡é‡å¤ã€é€šç”¨çš„ä»£ç </li>
<li>è¿™äº›ä»£ç æ•£è½åœ¨å„è‡ªå›¢é˜Ÿçš„é¡¹ç›®ä»£ç é‡Œ</li>
<li>å¤ç”¨çš„æ—¶å€™å¤§å®¶ä¹ æƒ¯äºç›´æ¥æ‹·è´è¿™äº›ä»£ç åˆ°é¡¹ç›®ä¸­ï¼Œå› ä¸ºè¿™æ ·åšå¯¹ä¸ªäººæˆæœ¬æœ€ä½ï¼ˆå¼€å‘è€…å¾€å¾€æ›´ç†Ÿæ‚‰è‡ªå·±å†™çš„ä»£ç )ï¼Œä½†æ˜¯è¿™ç§åšæ³•ä¸åˆ©äºå›¢é˜Ÿä¹‹é—´ä»£ç å…±äº«ï¼Œå› ä¸ºæ¯ä¸ªäººå¼€å‘ä¸åŒçš„ä¸šåŠ¡ï¼Œå¯¹ä¸åŒé¡µé¢çš„ç†Ÿæ‚‰ç¨‹åº¦ä¸ä¸€æ ·ï¼Œè€Œä»£ç å¤ç”¨çš„å®—æ—¨å°±æ˜¯è¦å°½å¯èƒ½å°†å›¢é˜Ÿä¸­çš„å¼€å‘ç€çš„æ•´ä½“æ°´å¹³æ‹‰é½</li>
<li>æ‰€ä»¥éœ€è¦é€šè¿‡å·¥å…·åŒ–çš„æ–¹å¼é™ä½ä»£ç å¤ç”¨çš„æˆæœ¬</li>
</ul>

      <div class="tags">
          <a href="/tags/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91/" rel="tag"><i class="ic i-tag"></i> è„šæ‰‹æ¶å¼€å‘</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">æ›´æ–°äº</span>
    <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-06-22 10:21:17" itemprop="dateModified" datetime="2024-06-22T10:21:17+08:00">2024-06-22</time>
  </span>
  <span id="2024/04/12/è„šæ‰‹æ¶/" class="item leancloud_visitors" data-flag-title="è„šæ‰‹æ¶å¼€å‘" title="é˜…è¯»æ¬¡æ•°">
      <span class="icon">
        <i class="ic i-eye"></i>
      </span>
      <span class="text">é˜…è¯»æ¬¡æ•°</span>
      <span class="leancloud-visitors-count"></span>
      <span class="text">æ¬¡</span>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> èµèµ</button>
  <p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="dmq å¾®ä¿¡æ”¯ä»˜">
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="dmq æ”¯ä»˜å®">
        <p>æ”¯ä»˜å®</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>dmq <i class="ic i-at"><em>@</em></i>æœæ˜æ¸…çš„ä¸ªäººåšå®¢
  </li>
  <li class="link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://dmqweb.cn/2024/04/12/%E8%84%9A%E6%89%8B%E6%9E%B6/" title="è„šæ‰‹æ¶å¼€å‘">https://dmqweb.cn/2024/04/12/è„šæ‰‹æ¶/</a>
  </li>
  <li class="license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2024/04/12/%E5%A4%8D%E6%9D%82%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E4%B8%8A%E7%BA%BF/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s3.uuu.ovh&#x2F;imgs&#x2F;2024&#x2F;04&#x2F;15&#x2F;66e62db68b7b65eb.webp" title="å¤æ‚ä¸šåŠ¡éƒ¨ç½²ä¸ä¼˜åŒ–">
  <span class="type">ä¸Šä¸€ç¯‡</span>
  <span class="category"><i class="ic i-flag"></i> å¤æ‚ä¸šåŠ¡éƒ¨ç½²ä¸ä¼˜åŒ–</span>
  <h3>å¤æ‚ä¸šåŠ¡éƒ¨ç½²ä¸ä¼˜åŒ–</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2024/04/12/vue-router/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s3.uuu.ovh&#x2F;imgs&#x2F;2024&#x2F;04&#x2F;28&#x2F;02824114036dc293.webp" title="vue-router">
  <span class="type">ä¸‹ä¸€ç¯‡</span>
  <span class="category"><i class="ic i-flag"></i> vue-routeråŸç†</span>
  <h3>vue-router</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-number">1.</span> <span class="toc-text"> éœ€æ±‚åˆ†æ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#git%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text"> git å¼€å‘æµç¨‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E8%8E%B7%E5%8F%96%E8%B5%84%E6%BA%90%E6%AD%A5%E9%AA%A4"><span class="toc-number">3.</span> <span class="toc-text"> æµè§ˆå™¨è·å–èµ„æºæ­¥éª¤</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%84%9A%E6%89%8B%E6%9E%B6%E7%AE%80%E4%BB%8B"><span class="toc-number">4.</span> <span class="toc-text"> è„šæ‰‹æ¶ç®€ä»‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%84%9A%E6%89%8B%E6%9E%B6%E5%8E%9F%E7%90%86"><span class="toc-number">5.</span> <span class="toc-text"> è„šæ‰‹æ¶åŸç†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%84%9A%E6%89%8B%E6%9E%B6%E7%9A%84%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B"><span class="toc-number">6.</span> <span class="toc-text"> è„šæ‰‹æ¶çš„å¼€å‘æµç¨‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E7%BB%86%E8%8A%82"><span class="toc-number">7.</span> <span class="toc-text"> å¼€å‘ç»†èŠ‚</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%84%9A%E6%89%8B%E6%9E%B6%E5%8F%91%E5%B8%83%E4%BD%93%E7%B3%BB"><span class="toc-number">8.</span> <span class="toc-text"> è„šæ‰‹æ¶å‘å¸ƒä½“ç³»</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%84%9A%E6%89%8B%E6%9E%B6%E5%8F%91%E5%B8%83%E6%B5%81%E7%A8%8B"><span class="toc-number">9.</span> <span class="toc-text"> è„šæ‰‹æ¶å‘å¸ƒæµç¨‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#npm%E6%96%B0%E7%89%B9%E6%80%A7workspace"><span class="toc-number">10.</span> <span class="toc-text"> npm æ–°ç‰¹æ€§ï¼šworkspace</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lerna%E5%A4%9Apackage%E7%AE%A1%E7%90%86"><span class="toc-number">11.</span> <span class="toc-text"> Lerna å¤š package ç®¡ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#lerna%E7%AE%80%E4%BB%8B"><span class="toc-number">11.0.1.</span> <span class="toc-text"> Lerna ç®€ä»‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lerna%E4%BD%BF%E7%94%A8"><span class="toc-number">11.0.2.</span> <span class="toc-text"> Lerna ä½¿ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lerna%E5%AD%A6%E4%B9%A0%E6%94%B6%E8%8E%B7"><span class="toc-number">11.0.3.</span> <span class="toc-text"> Lerna å­¦ä¹ æ”¶è·</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80-yargs"><span class="toc-number">11.0.3.1.</span> <span class="toc-text"> ä¸€ã€yargs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C-lerna%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-number">11.0.3.2.</span> <span class="toc-text"> äºŒã€Lerna å®ç°åŸç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89-nodejs%E6%A8%A1%E5%9D%97%E8%B7%AF%E5%BE%84%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B"><span class="toc-number">11.0.3.3.</span> <span class="toc-text"> ä¸‰ã€Node.js æ¨¡å—è·¯å¾„è§£ææµç¨‹</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#yargs"><span class="toc-number">12.</span> <span class="toc-text"> yargs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#commander"><span class="toc-number">13.</span> <span class="toc-text"> commander</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#require%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6"><span class="toc-number">14.</span> <span class="toc-text"> require åŠ è½½æœºåˆ¶</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#node%E5%A4%9A%E8%BF%9B%E7%A8%8B"><span class="toc-number">15.</span> <span class="toc-text"> node å¤šè¿›ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">15.0.1.</span> <span class="toc-text"> ä»‹ç»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#child_precess%E7%94%A8%E6%B3%95"><span class="toc-number">15.0.2.</span> <span class="toc-text"> child_precess ç”¨æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#child_process%E6%BA%90%E7%A0%81"><span class="toc-number">15.0.3.</span> <span class="toc-text"> child_process æºç </span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#eggjsmongodb"><span class="toc-number">16.</span> <span class="toc-text"> egg.js+mongodb</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#inquirer%E6%BA%90%E7%A0%81"><span class="toc-number">17.</span> <span class="toc-text"> inquirer æºç </span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E8%B7%AF%E5%BE%84"><span class="toc-number">17.1.</span> <span class="toc-text"> å­¦ä¹ è·¯å¾„</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ejsglob"><span class="toc-number">18.</span> <span class="toc-text"> ejs+glob</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ejs%E6%BA%90%E7%A0%81"><span class="toc-number">19.</span> <span class="toc-text"> ejs æºç </span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#require%E6%BA%90%E7%A0%81"><span class="toc-number">20.</span> <span class="toc-text"> require æºç </span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%94%A8%E5%AE%9E%E8%B7%B5"><span class="toc-number">21.</span> <span class="toc-text"> ä»£ç å¤ç”¨å®è·µ</span></a></li></ol>
      </div>
      <div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« ">
        <ul>
          <li><a href="/2024/03/30/%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E9%93%BE%E6%8E%A5/" rel="bookmark" title="æœ¬åœ°æ–‡ä»¶é“¾æ¥">æœ¬åœ°æ–‡ä»¶é“¾æ¥</a></li><li class="active"><a href="/2024/04/12/%E8%84%9A%E6%89%8B%E6%9E%B6/" rel="bookmark" title="è„šæ‰‹æ¶å¼€å‘">è„šæ‰‹æ¶å¼€å‘</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="dmq"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">dmq</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">76</span>
        <span class="name">æ–‡ç« </span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">55</span>
        <span class="name">åˆ†ç±»</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">97</span>
        <span class="name">æ ‡ç­¾</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RtcTA/dGFiPXJlcG9zaXRvcmllcw==" title="https:&#x2F;&#x2F;github.com&#x2F;dmq0?tab&#x3D;repositories"><i class="ic i-github"></i></span>
      <span class="exturl item npm" data-url="aHR0cHM6Ly93d3cubnBtanMuY29tL35kbXEwMDA=" title="https:&#x2F;&#x2F;www.npmjs.com&#x2F;~dmq000"><i class="ic i-file"></i></span>
      <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9kLTg4LTYxLTgz" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;d-88-61-83"><i class="ic i-zhihu"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTgwMjc4OTk0OTE=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;8027899491"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vdS83NjI1OTAxNzE3" title="https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;7625901717"><i class="ic i-weibo"></i></span>
      <span class="exturl item email" data-url="bWFpbHRvOjMyNjc4MDc1MTRAcXEuY29t" title="mailto:3267807514@qq.com"><i class="ic i-envelope"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>ä»‹ç»</a>
  </li>

    
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a>
  </li>

    
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a>
  </li>

    
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a>
  </li>

    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>å‹é“¾</a>
  </li>

    
  <li class="item">
    <a href="/links/" rel="section"><i class="ic i-magic"></i>å·¥å…·</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2024/04/12/%E5%A4%8D%E6%9D%82%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E4%B8%8A%E7%BA%BF/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2024/04/12/vue-router/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>éšæœºæ–‡ç« </h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/HTTP/" title="åˆ†ç±»äº HTTP">HTTP</a>
</div>

    <span><a href="/2023/05/02/HTTP/" title="HTTP">HTTP</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%A1%8C%E9%9D%A2%E7%AB%AF%E5%BC%80%E5%8F%91/" title="åˆ†ç±»äº æ¡Œé¢ç«¯å¼€å‘">æ¡Œé¢ç«¯å¼€å‘</a>
</div>

    <span><a href="/2024/05/21/%E6%A1%8C%E9%9D%A2%E7%AB%AF%E5%BC%80%E5%8F%91/" title="æ¡Œé¢ç«¯å¼€å‘">æ¡Œé¢ç«¯å¼€å‘</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F/" title="åˆ†ç±»äº å¼€å‘æ¨¡å¼">å¼€å‘æ¨¡å¼</a>
</div>

    <span><a href="/2024/03/29/TDD/" title="TDDæµ‹è¯•é©±åŠ¨å¼€å‘">TDDæµ‹è¯•é©±åŠ¨å¼€å‘</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/react/" title="åˆ†ç±»äº react">react</a>
</div>

    <span><a href="/2023/12/02/react/" title="reactç¬”è®°">reactç¬”è®°</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="åˆ†ç±»äº æ€§èƒ½ä¼˜åŒ–">æ€§èƒ½ä¼˜åŒ–</a>
</div>

    <span><a href="/2024/05/11/%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87/" title="æ€§èƒ½æŒ‡æ ‡">æ€§èƒ½æŒ‡æ ‡</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE/" title="åˆ†ç±»äº å¼€æºåè®®">å¼€æºåè®®</a>
</div>

    <span><a href="/2023/02/02/%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE/" title="å¸¸è§å¼€æºåè®®">å¸¸è§å¼€æºåè®®</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/JS/" title="åˆ†ç±»äº JS">JS</a>
</div>

    <span><a href="/2023/07/02/forEach/" title="forEach">forEach</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/jQuery/" title="åˆ†ç±»äº jQuery">jQuery</a>
</div>

    <span><a href="/2023/01/02/jQuery%E6%A1%86%E6%9E%B6%E5%BA%94%E7%94%A8/" title="jQuery">jQuery</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/webpack/" title="åˆ†ç±»äº webpack">webpack</a>
</div>

    <span><a href="/2023/10/21/webpack/" title="webpackç¬”è®°">webpackç¬”è®°</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/three-js/" title="åˆ†ç±»äº three.js">three.js</a>
</div>

    <span><a href="/2023/10/24/ThreeJS/" title="three.js">three.js</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>æœ€æ–°è¯„è®º</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 â€“ 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">dmq @ Web blog</span>
  </div>
  <div class="powered-by">
    åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2024/04/12/è„šæ‰‹æ¶/',
    favicon: {
      show: "ç§‘æŠ€å¼•é¢†æœªæ¥",
      hide: "æ¬¢è¿ä¸æˆ‘äº¤æµ"
    },
    search : {
      placeholder: "æ–‡ç« æœç´¢",
      empty: "å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",
      stats: "${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"
    },
    valine: true,fancybox: true,
    copyright: 'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//gcore.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>


  <script data-pjax>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?9ba187659e850a6910681214f0faa16b";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


</body>
</html>
