



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="æœæ˜æ¸…çš„ä¸ªäººåšå®¢" href="https://dmqweb.cn/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="æœæ˜æ¸…çš„ä¸ªäººåšå®¢" href="https://dmqweb.cn/atom.xml" />
<link rel="alternate" type="application/json" title="æœæ˜æ¸…çš„ä¸ªäººåšå®¢" href="https://dmqweb.cn/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="node.js" />


<link rel="canonical" href="https://dmqweb.cn/2024/01/02/node.js%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/">



  <title>
node.jså†…ç½®æ¨¡å— - node.js |
Web blog = æœæ˜æ¸…çš„ä¸ªäººåšå®¢ = ğŸ‘»æ¬¢è¿ä¸€èµ·äº¤æµå­¦ä¹ ğŸ‘»</title>
  <meta name="keywords" content="å‰ç«¯å¼€å‘, HTML, CSS, JavaScript, åšå®¢">
  <meta name="description" content="æ¢ç´¢å‰ç«¯å¼€å‘çš„æ— é™å¯èƒ½ã€‚æœ¬åšå®¢æä¾›æœ€æ–°çš„å‰ç«¯çŸ¥è¯†åº“ï¼Œä»¥åŠå®ç”¨çš„å¼€å‘æŠ€å·§å’Œæœ€ä½³å®è·µã€‚åŠ å…¥æˆ‘ä»¬çš„ç¤¾åŒºï¼Œå…±åŒæˆé•¿ã€‚">
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">node.jså†…ç½®æ¨¡å—
  </h1>
  
<div class="meta">
  <span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2024-01-02 02:24:04">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">å‘è¡¨äº</span>
    <time itemprop="dateCreated datePublished" datetime="2024-01-02T02:24:04+08:00">2024-01-02</time>
  </span>
  <span class="item" title="æœ¬æ–‡å­—æ•°">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">æœ¬æ–‡å­—æ•°</span>
    <span>43k</span>
    <span class="text">å­—</span>
  </span>
  <span class="item" title="é˜…è¯»æ—¶é•¿">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">é˜…è¯»æ—¶é•¿</span>
    <span>39 åˆ†é’Ÿ</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Web blog</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/07/5a293b82670a4885.webp"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/03/29/5c162f03529c2f38.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/28/6b39a7fcfcafff7b.webp"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/04/61e9f78d997bc7c9.webp"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/15/6cedcb364082ed12.webp"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/25/1b093314ebaab948.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/node-js/" itemprop="item" rel="index" title="åˆ†ç±»äº node.js"><span itemprop="name">node.js</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://dmqweb.cn/2024/01/02/node.js%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="dmq">
    <meta itemprop="description" content="ğŸ‘»æ¬¢è¿ä¸€èµ·äº¤æµå­¦ä¹ ğŸ‘», ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="æœæ˜æ¸…çš„ä¸ªäººåšå®¢">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="05-nodejså†…ç½®æ¨¡å—ä¸Š"><a class="anchor" href="#05-nodejså†…ç½®æ¨¡å—ä¸Š">#</a> 05 ã€nodejs å†…ç½®æ¨¡å—ï¼ˆä¸Šï¼‰ã€‘</h1>
<h2 id="nodejs-çš„å®˜æ–¹apiæ–‡æ¡£"><a class="anchor" href="#nodejs-çš„å®˜æ–¹apiæ–‡æ¡£">#</a> nodejs çš„å®˜æ–¹ API æ–‡æ¡£</h2>
<ul>
<li>Node.js çš„ API æ–‡æ¡£ï¼ˆè‹±æ–‡ï¼‰ï¼š <span class="exturl" data-url="aHR0cHM6Ly9ub2RlanMub3JnL2RvY3MvbGF0ZXN0LXY4LngvYXBpL2luZGV4Lmh0bWw=">https://nodejs.org/docs/latest-v8.x/api/index.html</span></li>
<li>Node.js çš„ API æ–‡æ¡£ï¼ˆä¸­æ–‡ï¼‰ï¼š<span class="exturl" data-url="aHR0cDovL25vZGVqcy5jbi9hcGkv">http://nodejs.cn/api/</span></li>
</ul>
<p>å…³äº Node.js çš„å†…ç½®æ¨¡å—å’Œå¸¸è§ APIï¼Œå¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚</p>
<p>æŸ¥é˜…æ–‡æ¡£æ—¶ï¼Œç¨³å®šæŒ‡æ•°å¦‚ä¸‹ï¼š</p>
<ul>
<li>çº¢è‰²ï¼šåºŸå¼ƒã€‚</li>
<li>æ©™è‰²ï¼šå®éªŒã€‚è¡¨ç¤ºå½“å‰ç‰ˆæœ¬å¯ç”¨ï¼Œå…¶ä»–ç‰ˆæœ¬ä¸ç¡®å®šã€‚ä¹Ÿè®¸ä¸å‘ä¸‹å…¼å®¹ï¼Œå»ºè®®ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥ç‰¹æ€§ã€‚</li>
<li>ç»¿è‰²ï¼šç¨³å®šã€‚ä¸ npm ç”Ÿæ€ç³»ç»Ÿçš„å…¼å®¹æ€§æ˜¯æœ€é«˜çš„ä¼˜å…ˆçº§ã€‚</li>
</ul>
<h2 id="nodejs-ä¸­æ¨¡å—çš„åˆ†ç±»"><a class="anchor" href="#nodejs-ä¸­æ¨¡å—çš„åˆ†ç±»">#</a> nodejs ä¸­æ¨¡å—çš„åˆ†ç±»</h2>
<p>Node.js åº”ç”¨ç”±æ¨¡å—ç»„æˆï¼Œé‡‡ç”¨ CommonJS æ¨¡å—è§„èŒƒã€‚Node.js ä¸­çš„æ¨¡å—åˆ†ä¸ºä¸‰ç§ï¼š</p>
<ul>
<li>å†…ç½®æ¨¡å—</li>
<li>ç¬¬ä¸‰æ–¹æ¨¡å—</li>
<li>è‡ªå®šä¹‰æ¨¡å—</li>
</ul>
<p>ä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹ã€‚</p>
<h3 id="å†…ç½®æ¨¡å—"><a class="anchor" href="#å†…ç½®æ¨¡å—">#</a> å†…ç½®æ¨¡å—</h3>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> process <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'process'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>version<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'../'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>require æ–¹æ³•ç”¨äºåŠ è½½æ¨¡å—ã€‚</p>
<p>å¸¸è§çš„å†…ç½®æ¨¡å—åŒ…æ‹¬ï¼š</p>
<ul>
<li>FSï¼šæ–‡ä»¶ç³»ç»Ÿæ¨¡å—</li>
<li>pathï¼šè·¯å¾„æ¨¡å—</li>
<li>OSï¼šæ“ä½œç³»ç»Ÿç›¸å…³</li>
<li>netï¼šç½‘ç»œç›¸å…³</li>
<li>http</li>
<li>...</li>
</ul>
<p>ä½ å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼šNode.js è¿™ä¹ˆç‰›å—ï¼Ÿè¿˜èƒ½ç›´æ¥å’Œæ“ä½œç³»ç»Ÿåšäº¤äº’ï¼Ÿ</p>
<p>å¸¦ç€è¿™ä¸ªç–‘é—®ï¼Œæˆ‘ä»¬ä¸å¦¨ç®€å•çœ‹çœ‹ Node.js çš„æºç ï¼Œä»¥ os æ¨¡å—ä¸¾ä¾‹ï¼š</p>
<ul>
<li>æ‰“å¼€ os æ¨¡å—çš„æºç ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL25vZGVqcy9ub2RlL2Jsb2IvbWFzdGVyL2xpYi9vcy5qcyVFRiVCQyU4QyVFNyVCRiVCQiVFNSU4OCVCMCVFNiU5QyU4MCVFNSVCQSU5NSVFOSU4MyVBOCVFRiVCQyU4QyVFNiU4OSVCRSVFNSU4OCVCMA==">https://github.com/nodejs/node/blob/master/lib/os.jsï¼Œç¿»åˆ°æœ€åº•éƒ¨ï¼Œæ‰¾åˆ°</span>  <code>cpus</code>  è¿™ä¸ªæ–¹æ³•</li>
<li>è¿›è€Œæ‰¾åˆ°  <code>getCPUs()</code></li>
<li>internalBinding ('os')ï¼šé€šè¿‡ internalBinding å¯ä»¥è°ƒç”¨ç³»ç»Ÿåº•å±‚çš„æ–¹æ³•ã€‚internalBinding ä¸»è¦æ˜¯ JS è™šæ‹Ÿæœºåœ¨åšçš„äº‹æƒ…ã€‚</li>
<li><code>internalBinding('os')</code>  çš„å®ç°ï¼Œåœ¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL25vZGVqcy9ub2RlL2Jsb2IvbWFzdGVyL3NyYy9ub2RlX29zLmNj">https://github.com/nodejs/node/blob/master/src/node_os.cc</span> é‡Œï¼Œé‡Œé¢éƒ½æ˜¯ C++ çš„ä»£ç ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ª <code>getCPUs</code>  æ–¹æ³•ã€‚</li>
</ul>
<p>ç°åœ¨ä½ çŸ¥é“äº†ï¼ŒJS æœ¬èº«æ˜¯æ²¡æœ‰èƒ½åŠ›è·å–åº•å±‚ç³»ç»Ÿèµ„æºçš„ï¼Œè¿™ä¸€åˆ‡éƒ½æ˜¯ JS è™šæ‹Ÿæœºåœ¨å’Œåº•å±‚åšäº¤äº’ï¼Œç„¶åé€šè¿‡ JS çš„è¡¨ç°å½¢å¼ï¼Œæš´éœ²ç»™åº”ç”¨å±‚ã€‚</p>
<p>å¦å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šåº“ï¼Œæ˜¯ç›´æ¥ä½¿ç”¨ C/++ ç¼–å†™çš„ï¼Œé€šè¿‡ç¼–è¯‘ä¹‹åï¼Œå†æä¾›ç»™ JS åº”ç”¨å±‚è°ƒç”¨ï¼Œæˆ–è€…ç›´æ¥æä¾›ç»™ Node.js å±‚ä½¿ç”¨ã€‚</p>
<p><strong>æ‰€æœ‰çš„ç¼–ç¨‹è¯­è¨€åº•å±‚éƒ½ä¼šå›å½’ C/C++</strong>ï¼Œç”šè‡³æ˜¯æ±‡ç¼–è¯­è¨€ã€‚</p>
<h3 id="require-åŠ è½½ç¬¬ä¸‰æ–¹åŒ…çš„æœºåˆ¶"><a class="anchor" href="#require-åŠ è½½ç¬¬ä¸‰æ–¹åŒ…çš„æœºåˆ¶">#</a> require åŠ è½½ç¬¬ä¸‰æ–¹åŒ…çš„æœºåˆ¶</h3>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>require åŠ è½½ç¬¬ä¸‰æ–¹åŒ…çš„æœºåˆ¶ï¼š</p>
<p>ï¼ˆ1ï¼‰ç¬¬ä¸‰æ–¹åŒ…å®‰è£…å¥½åï¼Œè¿™ä¸ªåŒ…ä¸€èˆ¬ä¼šå­˜æ”¾åœ¨å½“å‰é¡¹ç›®çš„ node_modules æ–‡ä»¶å¤¹ä¸­ã€‚æˆ‘ä»¬æ‰¾åˆ°è¿™ä¸ªåŒ…çš„ package.json æ–‡ä»¶ï¼Œå¹¶ä¸”æ‰¾åˆ°é‡Œé¢çš„ main å±æ€§å¯¹åº”çš„å…¥å£æ¨¡å—ï¼Œè¿™ä¸ªå…¥å£æ¨¡å—å°±æ˜¯è¿™ä¸ªåŒ…çš„å…¥å£æ–‡ä»¶ã€‚</p>
<p>ï¼ˆ2ï¼‰å¦‚æœç¬¬ä¸‰æ–¹åŒ…ä¸­æ²¡æœ‰æ‰¾åˆ° package.json æ–‡ä»¶ï¼Œæˆ–è€… package.json æ–‡ä»¶ä¸­æ²¡æœ‰ main å±æ€§ï¼Œåˆ™é»˜è®¤åŠ è½½ç¬¬ä¸‰æ–¹åŒ…ä¸­çš„ index.js æ–‡ä»¶ã€‚</p>
<p>ï¼ˆ3ï¼‰å¦‚æœåœ¨ node_modules æ–‡ä»¶å¤¹ä¸­æ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªåŒ…ï¼Œæˆ–è€…ä»¥ä¸Šæ‰€æœ‰æƒ…å†µéƒ½æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä¼šå‘ä¸Šä¸€çº§çˆ¶çº§ç›®å½•ä¸‹æŸ¥æ‰¾ node_modules æ–‡ä»¶å¤¹ï¼ŒæŸ¥æ‰¾è§„åˆ™å¦‚ä¸Šä¸€è‡´ã€‚</p>
<p>ï¼ˆ4ï¼‰å¦‚æœä¸€ç›´æ‰¾åˆ°è¯¥æ¨¡å—çš„ç£ç›˜æ ¹è·¯å¾„éƒ½æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä¼šæŠ¥é”™ï¼šcan not find module xxxã€‚</p>
<h3 id="è‡ªå®šä¹‰æ¨¡å—module"><a class="anchor" href="#è‡ªå®šä¹‰æ¨¡å—module">#</a> è‡ªå®šä¹‰æ¨¡å—ï¼ˆmoduleï¼‰</h3>
<p>æ¯ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œæœ‰è‡ªå·±çš„ä½œç”¨åŸŸã€‚åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢å®šä¹‰çš„å˜é‡ã€å‡½æ•°ã€ç±»ï¼Œéƒ½æ˜¯ç§æœ‰çš„ï¼Œå¯¹å…¶ä»–æ–‡ä»¶ä¸å¯è§ã€‚</p>
<p>ä¸¾ä¾‹ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> example <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./example.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span></pre></td></tr><tr><td data-num="3"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">addX</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 6</span></pre></td></tr></table></figure><h2 id="ç½‘ç»œæœåŠ¡-http"><a class="anchor" href="#ç½‘ç»œæœåŠ¡-http">#</a> ç½‘ç»œæœåŠ¡ http</h2>
<h3 id="httpæ¨¡å—æ¦‚è§ˆ"><a class="anchor" href="#httpæ¨¡å—æ¦‚è§ˆ">#</a> http æ¨¡å—æ¦‚è§ˆ</h3>
<p>å¤§å¤šæ•° nodejs å¼€å‘è€…éƒ½æ˜¯å†²ç€å¼€å‘ web server çš„ç›®çš„é€‰æ‹©äº† nodejsã€‚æ­£å¦‚å®˜ç½‘æ‰€å±•ç¤ºçš„ï¼Œå€ŸåŠ© http æ¨¡å—ï¼Œå¯ä»¥å‡ è¡Œä»£ç å°±æå®šä¸€ä¸ªè¶…è¿·ä½ çš„ web serverã€‚</p>
<p>åœ¨ nodejs ä¸­ï¼Œ <code>http</code>  å¯ä»¥è¯´æ˜¯æœ€æ ¸å¿ƒçš„æ¨¡å—ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æ¯”è¾ƒå¤æ‚çš„ä¸€ä¸ªæ¨¡å—ã€‚ä¸Šæ‰‹å¾ˆç®€å•ï¼Œä½†ä¸€æ—¦æ·±å…¥å­¦ä¹ ï¼Œä¸å°‘åˆå­¦è€…å°±ä¼šè§‰å¾—å¤´ç–¼ï¼Œä¸çŸ¥ä»ä½•å…¥æ‰‹ã€‚</p>
<p>æœ¬æ–‡å…ˆä»ä¸€ä¸ªç®€å•çš„ä¾‹å­å‡ºå‘ï¼Œå¼•å‡º <code>http</code>  æ¨¡å—æœ€æ ¸å¿ƒçš„å››ä¸ªå®ä¾‹ã€‚çœ‹å®Œæœ¬æ–‡ï¼Œåº”è¯¥å°±èƒ½å¤Ÿå¯¹ http æ¨¡å—æœ‰ä¸ªæ•´ä½“çš„è®¤è¯†ã€‚</p>
<h3 id="ä¸€ä¸ªç®€å•çš„ä¾‹å­"><a class="anchor" href="#ä¸€ä¸ªç®€å•çš„ä¾‹å­">#</a> ä¸€ä¸ªç®€å•çš„ä¾‹å­</h3>
<p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº† 1 ä¸ª web æœåŠ¡å™¨ã€1 ä¸ª http å®¢æˆ·ç«¯</p>
<ul>
<li>æœåŠ¡å™¨ serverï¼šæ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶å°†å®¢æˆ·ç«¯è¯·æ±‚çš„åœ°å€è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li>
<li>å®¢æˆ·ç«¯ clientï¼šå‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œå¹¶å°†æœåŠ¡å™¨è¿”å›çš„å†…å®¹æ‰“å°åˆ°æ§åˆ¶å°ã€‚</li>
</ul>
<p>ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œåªæœ‰å‡ è¡Œï¼Œä½†åŒ…å«äº†ä¸å°‘ä¿¡æ¯é‡ã€‚ä¸‹ä¸€å°èŠ‚ä¼šè¿›è¡Œç®€å•ä»‹ç»ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">//http server ä¾‹å­</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">serverReq<span class="token punctuation">,</span> serverRes</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">var</span> url <span class="token operator">=</span> serverReq<span class="token punctuation">.</span>url<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    serverRes<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span> <span class="token string">'æ‚¨è®¿é—®çš„åœ°å€æ˜¯ï¼š'</span> <span class="token operator">+</span> url <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">//http client ä¾‹å­</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">var</span> client <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://127.0.0.1:3000'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">clientRes</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    clientRes<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="ä¾‹å­è§£é‡Š"><a class="anchor" href="#ä¾‹å­è§£é‡Š">#</a> ä¾‹å­è§£é‡Š</h3>
<p>åœ¨ä¸Šé¢è¿™ä¸ªç®€å•çš„ä¾‹å­é‡Œï¼Œæ¶‰åŠäº† 4 ä¸ªå®ä¾‹ã€‚å¤§éƒ¨åˆ†æ—¶å€™ï¼ŒserverReqã€serverRes æ‰æ˜¯ä¸»è§’ã€‚</p>
<ul>
<li>serverï¼šhttp.Server å®ä¾‹ï¼Œç”¨æ¥æä¾›æœåŠ¡ï¼Œå¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</li>
<li>clientï¼šhttp.ClientReques å®ä¾‹ï¼Œç”¨æ¥å‘æœåŠ¡ç«¯å‘èµ·è¯·æ±‚ã€‚</li>
<li>serverReq/clientResï¼šå…¶å®éƒ½æ˜¯ http.IncomingMessage å®ä¾‹ã€‚serverReq ç”¨æ¥è·å–å®¢æˆ·ç«¯è¯·æ±‚çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ request headerï¼›è€Œ clientRes ç”¨æ¥è·å–æœåŠ¡ç«¯è¿”å›çš„ç›¸å…³ä¿¡æ¯ï¼Œæ¯”å¦‚ response headerã€‚</li>
<li>serverResï¼šhttp.ServerResponse å®ä¾‹</li>
</ul>
<h3 id="å…³äºhttpincomingmessage-httpserverresponse"><a class="anchor" href="#å…³äºhttpincomingmessage-httpserverresponse">#</a> å…³äº http.IncomingMessageã€http.ServerResponse</h3>
<p>å…ˆè®²ä¸‹ http.ServerResponse å®ä¾‹ã€‚ä½œç”¨å¾ˆæ˜ç¡®ï¼ŒæœåŠ¡ç«¯é€šè¿‡ http.ServerResponse å®ä¾‹ï¼Œæ¥ä¸ªè¯·æ±‚æ–¹å‘é€æ•°æ®ã€‚åŒ…æ‹¬å‘é€å“åº”è¡¨å¤´ï¼Œå‘é€å“åº”ä¸»ä½“ç­‰ã€‚</p>
<p>æ¥ä¸‹æ¥æ˜¯ http.IncomingMessage å®ä¾‹ï¼Œç”±äºåœ¨ serverã€client éƒ½å‡ºç°äº†ï¼Œåˆå­¦è€…éš¾å…æœ‰ç‚¹è¿·èŒ«ã€‚å®ƒçš„ä½œç”¨æ˜¯</p>
<p>åœ¨ server ç«¯ï¼šè·å–è¯·æ±‚å‘é€æ–¹çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•ã€è·¯å¾„ã€ä¼ é€’çš„æ•°æ®ç­‰ã€‚ åœ¨ client ç«¯ï¼šè·å– server ç«¯å‘é€è¿‡æ¥çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•ã€è·¯å¾„ã€ä¼ é€’çš„æ•°æ®ç­‰ã€‚</p>
<p>http.IncomingMessage å®ä¾‹ æœ‰ä¸‰ä¸ªå±æ€§éœ€è¦æ³¨æ„ï¼šmethodã€statusCodeã€statusMessageã€‚</p>
<ul>
<li>methodï¼šåªåœ¨ server ç«¯çš„å®ä¾‹æœ‰ï¼ˆä¹Ÿå°±æ˜¯ serverReq.methodï¼‰</li>
<li>statusCode/statusMessageï¼šåªåœ¨ client ç«¯ çš„å®ä¾‹æœ‰ï¼ˆä¹Ÿå°±æ˜¯ clientRes.methodï¼‰</li>
</ul>
<h2 id="ç½‘ç»œæœåŠ¡-http-res"><a class="anchor" href="#ç½‘ç»œæœåŠ¡-http-res">#</a> ç½‘ç»œæœåŠ¡ http res</h2>
<h3 id="æ¦‚è§ˆ"><a class="anchor" href="#æ¦‚è§ˆ">#</a> æ¦‚è§ˆ</h3>
<p>http æ¨¡å—å››å‰‘å®¢ä¹‹ä¸€çš„ <code>res</code> ï¼Œåº”è¯¥éƒ½ä¸é™Œç”Ÿäº†ã€‚ä¸€ä¸ª web æœåŠ¡ç¨‹åºï¼Œæ¥å—åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„ http è¯·æ±‚åï¼Œå‘å®¢æˆ·ç«¯è¿”å›æ­£ç¡®çš„å“åº”å†…å®¹ï¼Œè¿™å°±æ˜¯ <code>res</code>  çš„èŒè´£ã€‚</p>
<p>è¿”å›çš„å†…å®¹åŒ…æ‹¬ï¼šçŠ¶æ€ä»£ç  / çŠ¶æ€æè¿°ä¿¡æ¯ã€å“åº”å¤´éƒ¨ã€å“åº”ä¸»ä½“ã€‚ä¸‹æ–‡ä¼šä¸¾å‡ ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="ä¾‹å­"><a class="anchor" href="#ä¾‹å­">#</a> ä¾‹å­</h3>
<p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åŒæ—¶è®¾ç½®äº† çŠ¶æ€ä»£ç  / çŠ¶æ€æè¿°ä¿¡æ¯ã€å“åº”å¤´éƒ¨ã€å“åº”ä¸»ä½“ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// è®¾ç½®çŠ¶æ€ç ã€çŠ¶æ€æè¿°ä¿¡æ¯ã€å“åº”ä¸»ä½“</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">'ok'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/plain'</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="è®¾ç½®çŠ¶æ€ä»£ç -çŠ¶æ€æè¿°ä¿¡æ¯"><a class="anchor" href="#è®¾ç½®çŠ¶æ€ä»£ç -çŠ¶æ€æè¿°ä¿¡æ¯">#</a> è®¾ç½®çŠ¶æ€ä»£ç ã€çŠ¶æ€æè¿°ä¿¡æ¯</h3>
<p><code>res</code>  æä¾›äº† res.writeHead ()ã€res.statusCode/res.statusMessage æ¥å®ç°è¿™ä¸ªç›®çš„ã€‚</p>
<p>ä¸¾ä¾‹ï¼Œå¦‚æœæƒ³è¦è®¾ç½® 200/ok ï¼Œå¯ä»¥</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>res<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>res<span class="token punctuation">.</span>statusMessage <span class="token operator">=</span> <span class="token string">'ok'</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>ä¸¤è€…å·®ä¸å¤šï¼Œå·®å¼‚ç‚¹åœ¨äº</p>
<ol>
<li>res.writeHead () å¯ä»¥æä¾›é¢å¤–çš„åŠŸèƒ½ï¼Œæ¯”å¦‚è®¾ç½®å“åº”å¤´éƒ¨ã€‚</li>
<li>å½“å“åº”å¤´éƒ¨å‘é€å‡ºå»åï¼Œres.statusCode/res.statusMessage ä¼šè¢«è®¾ç½®æˆå·²å‘é€å‡ºå»çš„ çŠ¶æ€ä»£ç  / çŠ¶æ€æè¿°ä¿¡æ¯ã€‚</li>
</ol>
<h3 id="è®¾ç½®å“åº”å¤´éƒ¨"><a class="anchor" href="#è®¾ç½®å“åº”å¤´éƒ¨">#</a> è®¾ç½®å“åº”å¤´éƒ¨</h3>
<p><code>res</code>  æä¾›äº† res.writeHead ()ã€response.setHeader () æ¥å®ç°å“åº”å¤´éƒ¨çš„è®¾ç½®ã€‚</p>
<p>ä¸¾ä¾‹ï¼Œæ¯”å¦‚æƒ³æŠŠ  <code>Content-Type</code>  è®¾ç½®ä¸º  <code>text-plain</code> ï¼Œé‚£ä¹ˆå¯ä»¥</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// æ–¹æ³•ä¸€</span></pre></td></tr><tr><td data-num="2"></td><td><pre>res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">'ok'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text-plain'</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// æ–¹æ³•äºŒ</span></pre></td></tr><tr><td data-num="7"></td><td><pre>res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text-plain'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>ä¸¤è€…çš„å·®å¼‚ç‚¹åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p>
<ol>
<li>res.writeHead () ä¸å•å•æ˜¯è®¾ç½® headerã€‚</li>
<li>å·²ç»é€šè¿‡ res.setHeader () è®¾ç½®äº† headerï¼Œå½“é€šè¿‡ res.writeHead () è®¾ç½®åŒå headerï¼Œres.writeHead () çš„è®¾ç½®ä¼šè¦†ç›–ä¹‹å‰çš„è®¾ç½®ã€‚</li>
</ol>
<p>å…³äºç¬¬ 2 ç‚¹å·®å¼‚ï¼Œè¿™é‡Œä¸¾ä¸ªä¾‹å­ã€‚ä¸‹é¢ä»£ç ï¼Œæœ€ç»ˆçš„  <code>Content-Type</code>  ä¸º  <code>text/plain</code> ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">'ok'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/plain'</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>è€Œä¸‹é¢çš„ä¾‹å­ï¼Œåˆ™ç›´æ¥æŠ¥é”™ã€‚æŠ¥é”™ä¿¡æ¯ä¸º  <code>Error: Can't set headers after they are sent.</code> ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="4"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">'ok'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/plain'</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="å…¶ä»–å“åº”å¤´éƒ¨æ“ä½œ"><a class="anchor" href="#å…¶ä»–å“åº”å¤´éƒ¨æ“ä½œ">#</a> å…¶ä»–å“åº”å¤´éƒ¨æ“ä½œ</h3>
<p>å¢ã€åˆ ã€æ”¹ã€æŸ¥ æ˜¯é…å¥—çš„ã€‚ä¸‹é¢åˆ†åˆ«ä¸¾ä¾‹è¯´æ˜ä¸‹ï¼Œä¾‹å­å¤ªç®€å•å°±ç›´æ¥ä¸Šä»£ç äº†ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// å¢</span></pre></td></tr><tr><td data-num="2"></td><td><pre>res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/plain'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// åˆ </span></pre></td></tr><tr><td data-num="5"></td><td><pre>res<span class="token punctuation">.</span><span class="token function">removeHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// æ”¹</span></pre></td></tr><tr><td data-num="8"></td><td><pre>res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/plain'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// è¦†ç›–</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// æŸ¥</span></pre></td></tr><tr><td data-num="12"></td><td><pre>res<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">'content-type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>å…¶ä¸­ç•¥æ˜¾ä¸åŒçš„æ˜¯ res.getHeader (name)ï¼Œname ç”¨çš„æ˜¯å°å†™ï¼Œè¿”å›å€¼æ²¡åšç‰¹æ®Šå¤„ç†ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'TEXT/HTML'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> res<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">'content-type'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// TEXT/HTML</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/plain'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> res<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">'content-type'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// text/plain</span></pre></td></tr></table></figure><p>æ­¤å¤–ï¼Œè¿˜æœ‰ä¸é‚£ä¹ˆå¸¸ç”¨çš„ï¼š</p>
<ul>
<li>res.headersSentï¼šheader æ˜¯å¦å·²ç»å‘é€ï¼›</li>
<li>res.sendDateï¼šé»˜è®¤ä¸º trueã€‚ä½†ä¸º true æ—¶ï¼Œä¼šåœ¨ response header é‡Œè‡ªåŠ¨è®¾ç½® Date é¦–éƒ¨ã€‚</li>
</ul>
<h3 id="è®¾ç½®å“åº”ä¸»ä½“"><a class="anchor" href="#è®¾ç½®å“åº”ä¸»ä½“">#</a> è®¾ç½®å“åº”ä¸»ä½“</h3>
<p>ä¸»è¦ç”¨åˆ° res.write () ä»¥åŠ res.end () ä¸¤ä¸ªæ–¹æ³•ã€‚</p>
<p>res.write () API çš„ä¿¡æ¯é‡ç•¥å¤§ï¼Œå»ºè®®çœ‹ä¸‹<span class="exturl" data-url="aHR0cHM6Ly9ub2RlanMub3JnL2FwaS9odHRwLmh0bWwjaHR0cF9yZXNwb25zZV93cml0ZV9jaHVua19lbmNvZGluZ19jYWxsYmFjaw==">å®˜æ–¹æ–‡æ¡£</span>ã€‚</p>
<h4 id="responsewritechunk-encoding-callback"><a class="anchor" href="#responsewritechunk-encoding-callback">#</a> response.write(chunk[, encoding][, callback])</h4>
<ul>
<li>chunkï¼šå“åº”ä¸»ä½“çš„å†…å®¹ï¼Œå¯ä»¥æ˜¯ stringï¼Œä¹Ÿå¯ä»¥æ˜¯ bufferã€‚å½“ä¸º string æ—¶ï¼Œencoding å‚æ•°ç”¨æ¥æŒ‡æ˜ç¼–ç æ–¹å¼ã€‚ï¼ˆé»˜è®¤æ˜¯ utf8ï¼‰</li>
<li>encodingï¼šç¼–ç æ–¹å¼ï¼Œé»˜è®¤æ˜¯ utf8ã€‚</li>
<li>callbackï¼šå½“å“åº”ä½“ flushed æ—¶è§¦å‘ã€‚ï¼ˆTODO è¿™é‡Œæƒ³ä¸‹æ›´å¥½çš„è§£é‡Šã€‚ã€‚ã€‚ï¼‰</li>
</ul>
<p>ä½¿ç”¨ä¸Šæ²¡ä»€ä¹ˆéš¾åº¦ï¼Œåªæ˜¯æœ‰äº›æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>å¦‚æœ res.write () è¢«è°ƒç”¨æ—¶ï¼Œ res.writeHead () è¿˜æ²¡è¢«è°ƒç”¨è¿‡ï¼Œé‚£ä¹ˆï¼Œå°±ä¼šæŠŠ header flush å‡ºå»ã€‚</li>
<li>res.write () å¯ä»¥è¢«è°ƒç”¨å¤šæ¬¡ã€‚</li>
<li>å½“ res.write (chunk) ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨æ—¶ï¼Œnode ä¼šå°† header ä¿¡æ¯ ä»¥åŠ chunk å‘é€åˆ°å®¢æˆ·ç«¯ã€‚ç¬¬äºŒæ¬¡è°ƒç”¨ res.write (chunk) ï¼Œnode ä¼šè®¤ä¸ºä½ æ˜¯è¦ streaming dataï¼ˆWTFï¼Œè¯¥æ€ä¹ˆç¿»è¯‘ï¼‰ã€‚ã€‚ã€‚</li>
</ol>
<blockquote>
<p>Returns true if the entire data was flushed successfully to the kernel buffer. Returns false if all or part of the data was queued in user memory. 'drain' will be emitted when the buffer is free again.</p>
</blockquote>
<h4 id="responseenddata-encoding-callback"><a class="anchor" href="#responseenddata-encoding-callback">#</a> response.end([data][, encoding][, callback])</h4>
<p>æŒæ¡äº† res.write () çš„è¯ï¼Œres.end () å°±å¾ˆç®€å•äº†ã€‚res.end () çš„ç”¨å¤„æ˜¯å‘Šè¯‰ nodejsï¼Œheaderã€body éƒ½ç»™ä½ äº†ï¼Œè¿™æ¬¡å“åº”å°±åˆ°è¿™é‡Œå§ã€‚</p>
<p>æœ‰ç‚¹åƒä¸ªè¯­æ³•ç³–ï¼Œå¯ä»¥çœ‹æˆä¸‹é¢ä¸¤ä¸ªè°ƒç”¨çš„ç»„åˆã€‚è‡³äº callbackï¼Œå½“å“åº”ä¼ é€’ç»“æŸåè§¦å‘ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> encoding<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="è¶…æ—¶å¤„ç†"><a class="anchor" href="#è¶…æ—¶å¤„ç†">#</a> è¶…æ—¶å¤„ç†</h3>
<p>æ¥å£ï¼šresponse.setTimeout (msecs, callback)</p>
<p>å…³äº timeout äº‹ä»¶çš„è¯´æ˜ï¼ŒåŒæ ·æ˜¯è¨€ç®€æ„èµ…ï¼ˆWTFï¼‰ï¼Œè¯å°‘ä¿¡æ¯é‡å¤§ï¼Œæœ€å¥½æ¥ä¸ª demo TODO</p>
<blockquote>
<p>If no 'timeout' listener is added to the request, the response, or the server, then sockets are destroyed when they time out. If you assign a handler on the request, the response, or the server's 'timeout' events, then it is your responsibility to handle timed out sockets.</p>
</blockquote>
<h3 id="äº‹ä»¶-closefinish"><a class="anchor" href="#äº‹ä»¶-closefinish">#</a> äº‹ä»¶ close/finish</h3>
<ul>
<li>closeï¼šresponse.end () è¢«è°ƒç”¨å‰ï¼Œè¿æ¥å°±æ–­å¼€äº†ã€‚æ­¤æ—¶ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ã€‚</li>
<li>finishï¼šå“åº” headerã€body éƒ½å·²ç»å‘é€å‡ºå»ï¼ˆäº¤ç»™æ“ä½œç³»ç»Ÿï¼Œæ’é˜Ÿç­‰å€™ä¼ è¾“ï¼‰ï¼Œä½†å®¢æˆ·ç«¯æ˜¯å¦å®é™…æ”¶åˆ°æ•°æ®ä¸ºæ­¢ã€‚ï¼ˆè¿™ä¸ªäº‹ä»¶åï¼Œres ä¸Šå°±ä¸ä¼šå†æœ‰å…¶ä»–äº‹ä»¶è§¦å‘ï¼‰</li>
</ul>
<h3 id="å…¶ä»–ä¸å¸¸ç”¨å±æ€§æ–¹æ³•"><a class="anchor" href="#å…¶ä»–ä¸å¸¸ç”¨å±æ€§æ–¹æ³•">#</a> å…¶ä»–ä¸å¸¸ç”¨å±æ€§ / æ–¹æ³•</h3>
<ul>
<li>response.finishedï¼šä¸€å¼€å§‹æ˜¯ falseï¼Œå“åº”ç»“æŸåï¼Œè®¾ç½®ä¸º trueã€‚</li>
<li>response.sendDateï¼šé»˜è®¤æ˜¯ trueã€‚æ˜¯å¦è‡ªåŠ¨è®¾ç½® Date å¤´éƒ¨ã€‚ï¼ˆæŒ‰ HTTP åè®®æ˜¯å¿…é¡»è¦çš„ï¼Œé™¤éæ˜¯è°ƒè¯•ç”¨ï¼Œä¸ç„¶ä¸è¦è®¾ç½®ä¸º falseï¼‰</li>
<li>response.headersSentï¼šåªè¯»å±æ€§ã€‚å“åº”å¤´éƒ¨æ˜¯å¦å·²å‘é€ã€‚</li>
<li>response.writeContinue ()ï¼šå‘é€ HTTP/1.1 100 Continue æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ï¼Œæç¤ºè¯´æœåŠ¡ç«¯æ„¿æ„æ¥å—å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œè¯·ç»§ç»­å‘é€è¯·æ±‚æ­£æ–‡ï¼ˆbody)ã€‚ï¼ˆTODO åšä¸ª demo å•¥çš„æ˜¯å¤§å¤§çš„å¥½ï¼‰</li>
</ul>
<h2 id="ç½‘ç»œæœåŠ¡-http-req"><a class="anchor" href="#ç½‘ç»œæœåŠ¡-http-req">#</a> ç½‘ç»œæœåŠ¡ http req</h2>
<h3 id="æ¦‚è§ˆ-2"><a class="anchor" href="#æ¦‚è§ˆ-2">#</a> æ¦‚è§ˆ</h3>
<p>æœ¬æ–‡çš„é‡ç‚¹ä¼šæ”¾åœ¨ <code>req</code>  è¿™ä¸ªå¯¹è±¡ä¸Šã€‚å‰é¢å·²ç»æåˆ°ï¼Œå®ƒå…¶å®æ˜¯ http.IncomingMessage å®ä¾‹ï¼Œåœ¨æœåŠ¡ç«¯ã€å®¢æˆ·ç«¯ä½œç”¨ç•¥å¾®æœ‰å·®å¼‚</p>
<ul>
<li>æœåŠ¡ç«¯å¤„ï¼šè·å–è¯·æ±‚æ–¹çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ request header ç­‰ã€‚</li>
<li>å®¢æˆ·ç«¯å¤„ï¼šè·å–å“åº”æ–¹è¿”å›çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ statusCode ç­‰ã€‚</li>
</ul>
<p>æœåŠ¡ç«¯ä¾‹å­ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// ä¸‹é¢çš„ req</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯ä¾‹å­</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// ä¸‹é¢çš„ res</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://127.0.0.1:3000'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>statusCode<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="å±æ€§æ–¹æ³•äº‹ä»¶-åˆ†ç±»"><a class="anchor" href="#å±æ€§æ–¹æ³•äº‹ä»¶-åˆ†ç±»">#</a> å±æ€§ / æ–¹æ³• / äº‹ä»¶ åˆ†ç±»</h3>
<p>http.IncomingMessage çš„å±æ€§ / æ–¹æ³• / äº‹ä»¶ ä¸æ˜¯ç‰¹åˆ«å¤šï¼ŒæŒ‰ç…§æ˜¯å¦å®¢æˆ·ç«¯ / æœåŠ¡ç«¯ ç‰¹æœ‰çš„ï¼Œä¸‹é¢è¿›è¡Œç®€å•å½’ç±»ã€‚å¯ä»¥çœ‹åˆ°</p>
<ul>
<li>æœåŠ¡ç«¯å¤„ç‰¹æœ‰ï¼šurl</li>
<li>å®¢æˆ·ç«¯å¤„ç‰¹æœ‰ï¼šstatusCodeã€statusMessage</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">ç±»å‹</th>
<th style="text-align:center">åç§°</th>
<th style="text-align:center">æœåŠ¡ç«¯</th>
<th style="text-align:center">å®¢æˆ·ç«¯</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">äº‹ä»¶</td>
<td style="text-align:center">aborted</td>
<td style="text-align:center">âœ“</td>
<td style="text-align:center">âœ“</td>
</tr>
<tr>
<td style="text-align:left">äº‹ä»¶</td>
<td style="text-align:center">close</td>
<td style="text-align:center">âœ“</td>
<td style="text-align:center">âœ“</td>
</tr>
<tr>
<td style="text-align:left">å±æ€§</td>
<td style="text-align:center">headers</td>
<td style="text-align:center">âœ“</td>
<td style="text-align:center">âœ“</td>
</tr>
<tr>
<td style="text-align:left">å±æ€§</td>
<td style="text-align:center">rawHeaders</td>
<td style="text-align:center">âœ“</td>
<td style="text-align:center">âœ“</td>
</tr>
<tr>
<td style="text-align:left">å±æ€§</td>
<td style="text-align:center">statusCode</td>
<td style="text-align:center">âœ•</td>
<td style="text-align:center">âœ“</td>
</tr>
<tr>
<td style="text-align:left">å±æ€§</td>
<td style="text-align:center">statusMessage</td>
<td style="text-align:center">âœ•</td>
<td style="text-align:center">âœ“</td>
</tr>
<tr>
<td style="text-align:left">å±æ€§</td>
<td style="text-align:center">httpVersion</td>
<td style="text-align:center">âœ“</td>
<td style="text-align:center">âœ“</td>
</tr>
<tr>
<td style="text-align:left">å±æ€§</td>
<td style="text-align:center">url</td>
<td style="text-align:center">âœ“</td>
<td style="text-align:center">âœ•</td>
</tr>
<tr>
<td style="text-align:left">å±æ€§</td>
<td style="text-align:center">socket</td>
<td style="text-align:center">âœ“</td>
<td style="text-align:center">âœ“</td>
</tr>
<tr>
<td style="text-align:left">æ–¹æ³•</td>
<td style="text-align:center">.destroy()</td>
<td style="text-align:center">âœ“</td>
<td style="text-align:center">âœ“</td>
</tr>
<tr>
<td style="text-align:left">æ–¹æ³•</td>
<td style="text-align:center">.setTimeout()</td>
<td style="text-align:center">âœ“</td>
<td style="text-align:center">âœ“</td>
</tr>
</tbody>
</table>
<h3 id="æœåŠ¡ç«¯çš„ä¾‹å­"><a class="anchor" href="#æœåŠ¡ç«¯çš„ä¾‹å­">#</a> æœåŠ¡ç«¯çš„ä¾‹å­</h3>
<h4 id="ä¾‹å­ä¸€è·å–httpversionmethodurl"><a class="anchor" href="#ä¾‹å­ä¸€è·å–httpversionmethodurl">#</a> ä¾‹å­ä¸€ï¼šè·å– httpVersion/method/url</h4>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„ HTTP è¯·æ±‚æŠ¥æ–‡ï¼Œé‡Œé¢æœ€é‡è¦çš„å†…å®¹åŒ…æ‹¬ï¼šHTTP ç‰ˆæœ¬ã€è¯·æ±‚æ–¹æ³•ã€è¯·æ±‚åœ°å€ã€è¯·æ±‚å¤´éƒ¨ã€‚</p>
<figure class="highlight http"><figcaption data-lang="HTTP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/hello</span> <span class="token http-version property">HTTP/1.1</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1:3000</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">keep-alive</span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token header"><span class="token header-name keyword">Cache-Control</span><span class="token punctuation">:</span> <span class="token header-value">no-cache</span></span></pre></td></tr></table></figure><p>é‚£ä¹ˆï¼Œå¦‚ä½•è·å–ä¸Šé¢æåˆ°çš„ä¿¡æ¯å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œç›´æ¥ä¸Šä»£ç </p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// getClientInfo.js</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'1ã€å®¢æˆ·ç«¯è¯·æ±‚urlï¼š'</span> <span class="token operator">+</span> req<span class="token punctuation">.</span>url <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'2ã€httpç‰ˆæœ¬ï¼š'</span> <span class="token operator">+</span> req<span class="token punctuation">.</span>httpVersion <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'3ã€httpè¯·æ±‚æ–¹æ³•ï¼š'</span> <span class="token operator">+</span> req<span class="token punctuation">.</span>method <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'4ã€httpè¯·æ±‚å¤´éƒ¨'</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token number">1</span>ã€å®¢æˆ·ç«¯è¯·æ±‚urlï¼š/hello</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">2</span>ã€httpç‰ˆæœ¬ï¼š1.1</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token number">3</span>ã€httpè¯·æ±‚æ–¹æ³•ï¼šGET</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token number">4</span>ã€http headersï¼š<span class="token punctuation">&#123;</span><span class="token string">"host"</span><span class="token builtin class-name">:</span><span class="token string">"127.0.0.1:3000"</span>,<span class="token string">"connection"</span><span class="token builtin class-name">:</span><span class="token string">"keep-alive"</span>,<span class="token string">"cache-control"</span><span class="token builtin class-name">:</span><span class="token string">"no-cache"</span>,"user-age</pre></td></tr></table></figure><h4 id="ä¾‹å­äºŒè·å–getè¯·æ±‚å‚æ•°"><a class="anchor" href="#ä¾‹å­äºŒè·å–getè¯·æ±‚å‚æ•°">#</a> ä¾‹å­äºŒï¼šè·å– get è¯·æ±‚å‚æ•°</h4>
<p>æœåŠ¡ç«¯ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// getClientGetQuery.js</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> querystring <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">var</span> urlObj <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">var</span> query <span class="token operator">=</span> urlObj<span class="token punctuation">.</span>query<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">var</span> queryObj <span class="token operator">=</span> querystring<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    </pre></td></tr><tr><td data-num="11"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>queryObj<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    </pre></td></tr><tr><td data-num="13"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>è®¿é—®åœ°å€ <span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMTozMDAwL2hlbGxvP25pY2s9Y2h5aW5ncCZhbXA7aGVsbG89d29ybGQ=">http://127.0.0.1:3000/hello?nick=chyingp&amp;hello=world</span></p>
<p>æœåŠ¡ç«¯è¾“å‡ºå¦‚ä¸‹</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">&#123;</span><span class="token string">"nick"</span><span class="token builtin class-name">:</span><span class="token string">"chyingp"</span>,<span class="token string">"hello"</span><span class="token builtin class-name">:</span><span class="token string">"world"</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h4 id="ä¾‹å­ä¸‰è·å–postè¯·æ±‚å‚æ•°"><a class="anchor" href="#ä¾‹å­ä¸‰è·å–postè¯·æ±‚å‚æ•°">#</a> ä¾‹å­ä¸‰ï¼šè·å– post è¯·æ±‚å‚æ•°</h4>
<p>æœåŠ¡ç«¯ä»£ç å¦‚ä¸‹</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// getClientPostBody.js</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> querystring <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">var</span> body <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre>    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">thunk</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        body <span class="token operator">+=</span> thunk<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'post body is: '</span> <span class="token operator">+</span> body <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>é€šè¿‡ curl æ„é€  post è¯·æ±‚ï¼š</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">curl</span> <span class="token parameter variable">-d</span> <span class="token string">'nick=casper&amp;hello=world'</span> http://127.0.0.1:3000</pre></td></tr></table></figure><p>æœåŠ¡ç«¯æ‰“å°å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>post body is: <span class="token assign-left variable">nick</span><span class="token operator">=</span>casper<span class="token operator">&amp;</span><span class="token assign-left variable">hello</span><span class="token operator">=</span>world</pre></td></tr></table></figure><p>å¤‡æ³¨ï¼špost è¯·æ±‚ä¸­ï¼Œä¸åŒçš„ <code>Content-type</code> ï¼Œpost body æœ‰ä¸å°å·®å¼‚ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥ç ”ç©¶ä¸‹ã€‚</p>
<p>æœ¬ä¾‹ä¸­çš„ post è¯·æ±‚ï¼ŒHTTP æŠ¥æ–‡å¤§æ¦‚å¦‚ä¸‹</p>
<figure class="highlight http"><figcaption data-lang="HTTP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/</span> <span class="token http-version property">HTTP/1.1</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1:3000</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token header"><span class="token header-name keyword">Cache-Control</span><span class="token punctuation">:</span> <span class="token header-value">no-cache</span></span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>nick=casper&amp;hello=world</pre></td></tr></table></figure><h2 id="ç½‘ç»œæœåŠ¡-https"><a class="anchor" href="#ç½‘ç»œæœåŠ¡-https">#</a> ç½‘ç»œæœåŠ¡ https</h2>
<h3 id="æ¨¡å—æ¦‚è§ˆ"><a class="anchor" href="#æ¨¡å—æ¦‚è§ˆ">#</a> æ¨¡å—æ¦‚è§ˆ</h3>
<p>è¿™ä¸ªæ¨¡å—çš„é‡è¦æ€§ï¼ŒåŸºæœ¬ä¸ç”¨å¼ºè°ƒäº†ã€‚åœ¨ç½‘ç»œå®‰å…¨é—®é¢˜æ—¥ç›Šä¸¥å³»çš„ä»Šå¤©ï¼Œç½‘ç«™é‡‡ç”¨ HTTPS æ˜¯ä¸ªå¿…ç„¶çš„è¶‹åŠ¿ã€‚</p>
<p>åœ¨ nodejs ä¸­ï¼Œæä¾›äº† https è¿™ä¸ªæ¨¡å—æ¥å®Œæˆ HTTPS ç›¸å…³åŠŸèƒ½ã€‚ä»å®˜æ–¹æ–‡æ¡£æ¥çœ‹ï¼Œè·Ÿ http æ¨¡å—ç”¨æ³•éå¸¸ç›¸ä¼¼ã€‚</p>
<p>æœ¬æ–‡ä¸»è¦åŒ…å«ä¸¤éƒ¨åˆ†ï¼š</p>
<ol>
<li>é€šè¿‡å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯çš„ä¾‹å­ï¼Œå¯¹ https æ¨¡å—è¿›è¡Œå…¥é—¨è®²è§£ã€‚</li>
<li>å¦‚ä½•è®¿é—®å®‰å…¨è¯ä¹¦ä¸å—ä¿¡ä»»çš„ç½‘ç«™ã€‚ï¼ˆä»¥ 12306 ä¸ºä¾‹å­ï¼‰</li>
</ol>
<p>ç¯‡å¹…æ‰€é™ï¼Œæœ¬æ–‡æ— æ³•å¯¹ HTTPS åè®® åŠ ç›¸å…³æŠ€æœ¯ä½“ç³» åšè¿‡å¤šè®²è§£ï¼Œæœ‰é—®é¢˜æ¬¢è¿ç•™è¨€äº¤æµã€‚</p>
<h3 id="å®¢æˆ·ç«¯ä¾‹å­"><a class="anchor" href="#å®¢æˆ·ç«¯ä¾‹å­">#</a> å®¢æˆ·ç«¯ä¾‹å­</h3>
<p>è·Ÿ http æ¨¡å—çš„ç”¨æ³•éå¸¸åƒï¼Œåªä¸è¿‡è¯·æ±‚çš„åœ°å€æ˜¯ https åè®®çš„è€Œå·²ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>https<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'https://www.baidu.com'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'status code: '</span> <span class="token operator">+</span> res<span class="token punctuation">.</span>statusCode<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'headers: '</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="æœåŠ¡ç«¯ä¾‹å­"><a class="anchor" href="#æœåŠ¡ç«¯ä¾‹å­">#</a> æœåŠ¡ç«¯ä¾‹å­</h3>
<p>å¯¹å¤–æä¾› HTTPS æœåŠ¡ï¼Œéœ€è¦æœ‰ HTTPS è¯ä¹¦ã€‚å¦‚æœä½ å·²ç»æœ‰äº† HTTPS è¯ä¹¦ï¼Œé‚£ä¹ˆå¯ä»¥è·³è¿‡è¯ä¹¦ç”Ÿæˆçš„ç¯èŠ‚ã€‚å¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹æ­¥éª¤</p>
<h4 id="ç”Ÿæˆè¯ä¹¦"><a class="anchor" href="#ç”Ÿæˆè¯ä¹¦">#</a> ç”Ÿæˆè¯ä¹¦</h4>
<p><strong>1. åˆ›å»ºä¸ªç›®å½•å­˜æ”¾è¯ä¹¦ã€‚</strong></p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">mkdir</span> cert</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token builtin class-name">cd</span> cert</pre></td></tr></table></figure><p><strong>2. ç”Ÿæˆç§é’¥ã€‚</strong></p>
<figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>openssl genrsa -out chyingp-key.pem 2048</pre></td></tr></table></figure><p><strong>3. ç”Ÿæˆè¯ä¹¦ç­¾åè¯·æ±‚ï¼ˆcsr æ˜¯ Certificate Signing Request çš„æ„æ€ï¼‰ã€‚</strong></p>
<figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>openssl req -new \</pre></td></tr><tr><td data-num="2"></td><td><pre>  -sha256</pre></td></tr><tr><td data-num="3"></td><td><pre>  -key chyingp-key.key.pem \</pre></td></tr><tr><td data-num="4"></td><td><pre>  -out chyingp-csr.pem \</pre></td></tr><tr><td data-num="5"></td><td><pre>  -subj "/C=CN/ST=Guandong/L=Shenzhen/O=YH Inc/CN=www.chyingp.com"</pre></td></tr></table></figure><p><strong>4. ç”Ÿæˆè¯ä¹¦ã€‚</strong></p>
<figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>openssl x509 \</pre></td></tr><tr><td data-num="2"></td><td><pre>  -req -in chyingp-csr.pem \</pre></td></tr><tr><td data-num="3"></td><td><pre>  -signkey chyingp-key.pem \</pre></td></tr><tr><td data-num="4"></td><td><pre>  -out chyingp-cert.pem</pre></td></tr></table></figure><h4 id="httpsæœåŠ¡ç«¯"><a class="anchor" href="#httpsæœåŠ¡ç«¯">#</a> HTTPS æœåŠ¡ç«¯</h4>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token literal-property property">key</span><span class="token operator">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./cert/chyingp-key.pem'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// ç§é’¥</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token literal-property property">cert</span><span class="token operator">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./cert/chyingp-cert.pem'</span><span class="token punctuation">)</span> <span class="token comment">// è¯ä¹¦</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">var</span> server <span class="token operator">=</span> https<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'è¿™æ˜¯æ¥è‡ªHTTPSæœåŠ¡å™¨çš„è¿”å›'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>ç”±äºæˆ‘å¹¶æ²¡æœ‰ <span class="exturl" data-url="aHR0cDovL3d3dy5jaHlpbmdwLmNvbQ==">www.chyingp.com</span> è¿™ä¸ªåŸŸåï¼Œäºæ˜¯å…ˆé…ç½®æœ¬åœ° host</p>
<figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>127.0.0.1 www.chyingp.com</pre></td></tr></table></figure><p>å¯åŠ¨æœåŠ¡ï¼Œå¹¶åœ¨æµè§ˆå™¨é‡Œè®¿é—® <span class="exturl" data-url="aHR0cDovL3d3dy5jaHlpbmdwLmNvbTozMDAwLw==">http://www.chyingp.com:3000</span>ã€‚æ³¨æ„ï¼Œæµè§ˆå™¨ä¼šæç¤ºä½ è¯ä¹¦ä¸å¯é ï¼Œç‚¹å‡» ä¿¡ä»»å¹¶ç»§ç»­è®¿é—® å°±è¡Œäº†ã€‚</p>
<h2 id="url-æ¥å£ä»£æ›¿å†…ç½®æ¨¡å—urlä½¿ç”¨"><a class="anchor" href="#url-æ¥å£ä»£æ›¿å†…ç½®æ¨¡å—urlä½¿ç”¨">#</a> URL æ¥å£ (ä»£æ›¿å†…ç½®æ¨¡å— url ä½¿ç”¨)</h2>
<blockquote>
<p>nodejs å†…ç½®æ¨¡å— <code>url</code>  æœ‰äº›æ–¹æ³•è¦è¢«åºŸå¼ƒï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>URLç±»</code> ä»£æ›¿</p>
</blockquote>
<p>æµè§ˆå™¨åŸç”Ÿæä¾› <code>URL()</code>  æ¥å£ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥æ„é€ ã€è§£æå’Œç¼–ç  URLã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé€šè¿‡ <code>window.URL</code>  å¯ä»¥æ‹¿åˆ°è¿™ä¸ªæ„é€ å‡½æ•°ã€‚</p>
<h3 id="71-å¯¹æ¯”urlæ¨¡å—å’Œurlç±»"><a class="anchor" href="#71-å¯¹æ¯”urlæ¨¡å—å’Œurlç±»">#</a> 7.1 å¯¹æ¯” <code>urlæ¨¡å—</code> å’Œ URL ç±»</h3>
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>url æ¨¡å—</th>
<th>URL ç±»</th>
</tr>
</thead>
<tbody>
<tr>
<td>protocol</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>host</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>port</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>hostname</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>search</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>query</td>
<td><code>âœ…</code></td>
<td><code>-</code></td>
</tr>
<tr>
<td>path</td>
<td><code>âœ…</code></td>
<td><code>-</code></td>
</tr>
<tr>
<td>pathname</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>href</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>hash</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>origin</td>
<td>-</td>
<td><code>âœ…</code></td>
</tr>
</tbody>
</table>
<p>å¯ä»¥çœ‹å‡ºæ¥ï¼Œåªæœ‰ä¸‰ä¸ªå­—æ®µä¸åŒï¼Œåˆ†åˆ«æ˜¯ <code>query</code> , <code>path</code> , <code>origin</code></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>æ‰“å°ä¸¤ä¸ªå¯¹è±¡çš„è¾“å‡º</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">//url æ¨¡å—ï¼Œurl.parse ('link')</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token literal-property property">protocol</span><span class="token operator">:</span> <span class="token string">'https:'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token literal-property property">slashes</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token literal-property property">auth</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">'m.shop.com'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token literal-property property">hostname</span><span class="token operator">:</span> <span class="token string">'m.shop.com'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token literal-property property">hash</span><span class="token operator">:</span> <span class="token string">'#detail'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token literal-property property">search</span><span class="token operator">:</span> <span class="token string">'?id=4433&amp;name=%E6%9D%8E%E5%A4%87&amp;directCompanyId=&amp;mobile=18951431099'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token string">'id=4433&amp;name=%E6%9D%8E%E5%A4%87&amp;directCompanyId=&amp;mobile=18951431099'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token literal-property property">pathname</span><span class="token operator">:</span> <span class="token string">'/home/share'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/home/share?id=4433&amp;name=%E6%9D%8E%E5%A4%87&amp;directCompanyId=&amp;mobile=18951431099'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token literal-property property">href</span><span class="token operator">:</span> <span class="token string">'https://m.shop.com/home/share?id=4433&amp;name=%E6%9D%8E%E5%A4%87&amp;directCompanyId=&amp;mobile=18951431099#detail'</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// new URL()</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token literal-property property">href</span><span class="token operator">:</span> <span class="token string">'https://m.shop.com/home/share?id=4433&amp;name=%E6%9D%8E%E5%A4%87&amp;directCompanyId=&amp;mobile=18951431099#detail'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token literal-property property">origin</span><span class="token operator">:</span> <span class="token string">'https://m.shop.com'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token literal-property property">protocol</span><span class="token operator">:</span> <span class="token string">'https:'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">'m.shop.com'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  <span class="token literal-property property">hostname</span><span class="token operator">:</span> <span class="token string">'m.shop.com'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token literal-property property">pathname</span><span class="token operator">:</span> <span class="token string">'/home/share'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="29"></td><td><pre>  <span class="token literal-property property">search</span><span class="token operator">:</span> <span class="token string">'?id=4433&amp;name=%E6%9D%8E%E5%A4%87&amp;directCompanyId=&amp;mobile=18951431099'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token literal-property property">searchParams</span><span class="token operator">:</span> URLSearchParams <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token string">'id'</span> <span class="token operator">=></span> <span class="token string">'4433'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token string">'name'</span> <span class="token operator">=></span> <span class="token string">'æå¤‡'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token string">'directCompanyId'</span> <span class="token operator">=></span> <span class="token string">''</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token string">'mobile'</span> <span class="token operator">=></span> <span class="token string">'18951431099'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="35"></td><td><pre>  <span class="token literal-property property">hash</span><span class="token operator">:</span> <span class="token string">'#detail'</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="æ„é€ å‡½æ•°"><a class="anchor" href="#æ„é€ å‡½æ•°">#</a> æ„é€ å‡½æ•°</h3>
<p><code>URL()</code>  ä½œä¸ºæ„é€ å‡½æ•°ï¼Œå¯ä»¥ç”Ÿæˆ URL å®ä¾‹ã€‚å®ƒæ¥å—ä¸€ä¸ªè¡¨ç¤º URL çš„å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ã€‚å¦‚æœå‚æ•°ä¸æ˜¯åˆæ³•çš„ URLï¼Œä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'http://www.example.com/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>url<span class="token punctuation">.</span>href</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// "http://www.example.com/index.html"</span></pre></td></tr></table></figure><p>ä¸Šé¢ç¤ºä¾‹ç”Ÿæˆäº†ä¸€ä¸ª URL å®ä¾‹ï¼Œç”¨æ¥ä»£è¡¨æŒ‡å®šçš„ç½‘å€ã€‚</p>
<p>é™¤äº†å­—ç¬¦ä¸²ï¼Œ <code>URL()</code>  çš„å‚æ•°ä¹Ÿå¯ä»¥æ˜¯å¦ä¸€ä¸ª URL å®ä¾‹ã€‚è¿™æ—¶ï¼Œ <code>URL()</code>  ä¼šè‡ªåŠ¨è¯»å–è¯¥å®ä¾‹çš„ <code>href</code>  å±æ€§ï¼Œä½œä¸ºå®é™…å‚æ•°ã€‚</p>
<p>å¦‚æœ URL å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œé‚£ä¹ˆéœ€è¦è¡¨ç¤ºç»å¯¹è·¯å¾„çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œä¸ºè®¡ç®—åŸºå‡†ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> url1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> <span class="token string">'http://example.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>url1<span class="token punctuation">.</span>href</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// "http://example.com/index.html"</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">var</span> url2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'page2.html'</span><span class="token punctuation">,</span> <span class="token string">'http://example.com/page1.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>url2<span class="token punctuation">.</span>href</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// "http://example.com/page2.html"</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">var</span> url3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'..'</span><span class="token punctuation">,</span> <span class="token string">'http://example.com/a/b.html'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>url3<span class="token punctuation">.</span>href</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// "http://example.com/"</span></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œè¿”å›çš„ URL å®ä¾‹çš„è·¯å¾„éƒ½æ˜¯åœ¨ç¬¬äºŒä¸ªå‚æ•°çš„åŸºç¡€ä¸Šï¼Œåˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªå‚æ•°å¾—åˆ°çš„ã€‚æœ€åä¸€ä¸ªä¾‹å­é‡Œé¢ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ <code>..</code> ï¼Œè¡¨ç¤ºä¸Šå±‚è·¯å¾„ã€‚</p>
<h3 id="å®ä¾‹å±æ€§"><a class="anchor" href="#å®ä¾‹å±æ€§">#</a> å®ä¾‹å±æ€§</h3>
<p>URL å®ä¾‹çš„å±æ€§ä¸ <code>Location</code>  å¯¹è±¡çš„å±æ€§åŸºæœ¬ä¸€è‡´ï¼Œè¿”å›å½“å‰ URL çš„ä¿¡æ¯ã€‚</p>
<ul>
<li>URL.hrefï¼šè¿”å›æ•´ä¸ª URL</li>
<li>URL.protocolï¼šè¿”å›åè®®ï¼Œä»¥å†’å· <code>:</code>  ç»“å°¾</li>
<li>URL.hostnameï¼šè¿”å›åŸŸå</li>
<li>URL.hostï¼šè¿”å›åŸŸåä¸ç«¯å£ï¼ŒåŒ…å« <code>:</code>  å·ï¼Œé»˜è®¤çš„ 80 å’Œ 443 ç«¯å£ä¼šçœç•¥</li>
<li>URL.portï¼šè¿”å›ç«¯å£</li>
<li>URL.originï¼šè¿”å›åè®®ã€åŸŸåå’Œç«¯å£</li>
<li>URL.pathnameï¼šè¿”å›è·¯å¾„ï¼Œä»¥æ–œæ  <code>/</code>  å¼€å¤´</li>
<li>URL.searchï¼šè¿”å›æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œä»¥é—®å· <code>?</code>  å¼€å¤´</li>
<li>URL.searchParamsï¼šè¿”å›ä¸€ä¸ª <code>URLSearchParams</code>  å®ä¾‹ï¼Œè¯¥å±æ€§æ˜¯ <code>Location</code>  å¯¹è±¡æ²¡æœ‰çš„</li>
<li>URL.hashï¼šè¿”å›ç‰‡æ®µè¯†åˆ«ç¬¦ï¼Œä»¥äº•å· <code>#</code> å¼€å¤´</li>
<li>URL.passwordï¼šè¿”å›åŸŸåå‰é¢çš„å¯†ç </li>
<li>URL.usernameï¼šè¿”å›åŸŸåå‰é¢çš„ç”¨æˆ·å</li>
</ul>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'http://user:passwd@www.example.com:4097/path/a.html?x=111#part1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>url<span class="token punctuation">.</span>href</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// "http://user:passwd@www.example.com:4097/path/a.html?x=111#part1"</span></pre></td></tr><tr><td data-num="5"></td><td><pre>url<span class="token punctuation">.</span>protocol</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// "http:"</span></pre></td></tr><tr><td data-num="7"></td><td><pre>url<span class="token punctuation">.</span>hostname</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">// "www.example.com"</span></pre></td></tr><tr><td data-num="9"></td><td><pre>url<span class="token punctuation">.</span>host</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// "www.example.com:4097"</span></pre></td></tr><tr><td data-num="11"></td><td><pre>url<span class="token punctuation">.</span>port</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// "4097"</span></pre></td></tr><tr><td data-num="13"></td><td><pre>url<span class="token punctuation">.</span>origin</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// "http://www.example.com:4097"</span></pre></td></tr><tr><td data-num="15"></td><td><pre>url<span class="token punctuation">.</span>pathname</pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// "/path/a.html"</span></pre></td></tr><tr><td data-num="17"></td><td><pre>url<span class="token punctuation">.</span>search</pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// "?x=111"</span></pre></td></tr><tr><td data-num="19"></td><td><pre>url<span class="token punctuation">.</span>searchParams</pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">// URLSearchParams &#123;&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>url<span class="token punctuation">.</span>hash</pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">// "#part1"</span></pre></td></tr><tr><td data-num="23"></td><td><pre>url<span class="token punctuation">.</span>password</pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment">// "passwd"</span></pre></td></tr><tr><td data-num="25"></td><td><pre>url<span class="token punctuation">.</span>username</pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">// "user"</span></pre></td></tr></table></figure><p>è¿™äº›å±æ€§é‡Œé¢ï¼Œåªæœ‰ <code>origin</code>  å±æ€§æ˜¯åªè¯»çš„ï¼Œå…¶ä»–å±æ€§éƒ½å¯å†™ï¼Œå¹¶ä¸”ä¼šç«‹å³ç”Ÿæ•ˆã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'http://example.com/index.html#part1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>url<span class="token punctuation">.</span>pathname <span class="token operator">=</span> <span class="token string">'index2.html'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>url<span class="token punctuation">.</span>href <span class="token comment">// "http://example.com/index2.html#part1"</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>url<span class="token punctuation">.</span>hash <span class="token operator">=</span> <span class="token string">'#part2'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>url<span class="token punctuation">.</span>href <span class="token comment">// "http://example.com/index2.html#part2"</span></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ”¹å˜ URL å®ä¾‹çš„ <code>pathname</code>  å±æ€§å’Œ <code>hash</code>  å±æ€§ï¼Œéƒ½ä¼šå®æ—¶åæ˜ åœ¨ URL å®ä¾‹å½“ä¸­ã€‚</p>
<h2 id="urlsearchparams-å¯¹è±¡ä»£æ›¿å†…ç½®æ¨¡å—querystringä½¿ç”¨"><a class="anchor" href="#urlsearchparams-å¯¹è±¡ä»£æ›¿å†…ç½®æ¨¡å—querystringä½¿ç”¨">#</a> URLSearchParams å¯¹è±¡ (ä»£æ›¿å†…ç½®æ¨¡å— querystring ä½¿ç”¨)</h2>
<blockquote>
<ol>
<li>
<p>nodejs å†…ç½®æ¨¡å— <code>querystring</code>  æœ‰äº›æ–¹æ³•è¦è¢«åºŸå¼ƒï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>URLSearchParams API </code> æ„é€ ä»£æ›¿</p>
</li>
<li>
<p>å¦‚æœä½ çš„ nodejs ç‰ˆæœ¬å¤§äº 18ï¼Œå¯ä»¥ä½¿ç”¨ <code>const querystring= require('node:querystring')</code> <br />
``querystring <code>æ¯”</code>  URLSearchParams <code>æ€§èƒ½æ›´é«˜ï¼Œä½†ä¸æ˜¯ æ ‡å‡†åŒ–çš„ APIã€‚ä½¿ç”¨</code>  URLSearchParams` å½“æ€§èƒ½ä¸é‡è¦æˆ– å½“éœ€è¦ä¸æµè§ˆå™¨ä»£ç å…¼å®¹æ—¶ã€‚</p>
</li>
<li>
<p>è¿˜å¯ä»¥å®‰è£… <code>qs</code>  æ¨¡å—ï¼Œä½¿ç”¨æ–¹å¼å’Œ <code>querystring</code>  ä¸€æ ·</p>
</li>
</ol>
</blockquote>
<h3 id="æ¦‚è¿°"><a class="anchor" href="#æ¦‚è¿°">#</a> æ¦‚è¿°</h3>
<p><code>URLSearchParams</code>  å¯¹è±¡æ˜¯æµè§ˆå™¨çš„åŸç”Ÿå¯¹è±¡ï¼Œç”¨æ¥æ„é€ ã€è§£æå’Œå¤„ç† URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆå³ URL é—®å·åé¢çš„éƒ¨åˆ†ï¼‰ã€‚</p>
<p>å®ƒæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥ç”Ÿæˆå®ä¾‹ã€‚å‚æ•°å¯ä»¥ä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œèµ·é¦–çš„é—®å· <code>?</code>  æœ‰æ²¡æœ‰éƒ½è¡Œï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹åº”æŸ¥è¯¢å­—ç¬¦ä¸²çš„æ•°ç»„æˆ–å¯¹è±¡ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// æ–¹æ³•ä¸€ï¼šä¼ å…¥å­—ç¬¦ä¸²</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token string">'?foo=1&amp;bar=2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// ç­‰åŒäº</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// æ–¹æ³•äºŒï¼šä¼ å…¥æ•°ç»„</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// æ–¹æ³•ä¸‰ï¼šä¼ å…¥å¯¹è±¡</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string-property property">'foo'</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">,</span> <span class="token string-property property">'bar'</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>URLSearchParams</code>  ä¼šå¯¹æŸ¥è¯¢å­—ç¬¦ä¸²è‡ªåŠ¨ç¼–ç ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string-property property">'foo'</span><span class="token operator">:</span> <span class="token string">'ä½ å¥½'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>params<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// "foo=%E4%BD%A0%E5%A5%BD"</span></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ <code>foo</code>  çš„å€¼æ˜¯æ±‰å­—ï¼Œ <code>URLSearchParams</code>  å¯¹å…¶è‡ªåŠ¨è¿›è¡Œ URL ç¼–ç ã€‚</p>
<p>æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è¡¨å•æ•°æ®æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>URLSearchParams</code>  å®ä¾‹ä½œä¸ºè¡¨å•æ•°æ®ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">bar</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://example.com/api'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token literal-property property">body</span><span class="token operator">:</span> params</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ <code>fetch</code>  å‘½ä»¤å‘æœåŠ¡å™¨å‘é€å‘½ä»¤æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>URLSearchParams</code>  å®ä¾‹ã€‚</p>
<p><code>URLSearchParams</code>  å¯ä»¥ä¸ <code>URL()</code>  æ¥å£ç»“åˆä½¿ç”¨ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> foo <span class="token operator">=</span> url<span class="token punctuation">.</span>searchParams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">'somedefault'</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼ŒURL å®ä¾‹çš„ <code>searchParams</code>  å±æ€§å°±æ˜¯ä¸€ä¸ª <code>URLSearchParams</code>  å®ä¾‹ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ <code>URLSearchParams</code>  æ¥å£çš„ <code>get</code>  æ–¹æ³•ã€‚</p>
<p><code>URLSearchParams</code>  å®ä¾‹æœ‰éå†å™¨æ¥å£ï¼Œå¯ä»¥ç”¨ <code>for...of</code>  å¾ªç¯éå†ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string-property property">'foo'</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">,</span> <span class="token string-property property">'bar'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> p <span class="token keyword">of</span> params<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">': '</span> <span class="token operator">+</span> p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// foo: 1</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// bar: 2</span></pre></td></tr></table></figure><p><code>URLSearchParams</code>  æ²¡æœ‰å®ä¾‹å±æ€§ï¼Œåªæœ‰å®ä¾‹æ–¹æ³•ã€‚</p>
<h3 id="urlsearchparamstostring"><a class="anchor" href="#urlsearchparamstostring">#</a> URLSearchParams.toString()</h3>
<p><code>toString</code>  æ–¹æ³•è¿”å›å®ä¾‹çš„å­—ç¬¦ä¸²å½¢å¼ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'https://example.com?foo=1&amp;bar=2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span>search<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>params<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// "foo=1&amp;bar=2'</span></pre></td></tr></table></figure><p>é‚£ä¹ˆéœ€è¦å­—ç¬¦ä¸²çš„åœºåˆï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ <code>toString</code>  æ–¹æ³•ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">version</span><span class="token operator">:</span> <span class="token number">2.0</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> location<span class="token punctuation">.</span>pathname <span class="token operator">+</span> <span class="token string">'?'</span> <span class="token operator">+</span> params<span class="token punctuation">;</span></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ <code>location.href</code>  èµ‹å€¼æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>params</code>  å¯¹è±¡ã€‚è¿™æ—¶å°±ä¼šè‡ªåŠ¨è°ƒç”¨ <code>toString</code>  æ–¹æ³•ã€‚</p>
<h3 id="urlsearchparamshas"><a class="anchor" href="#urlsearchparamshas">#</a> URLSearchParams.has()</h3>
<p><code>has()</code>  æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸ¥è¯¢å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æŒ‡å®šçš„é”®åã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string-property property">'foo'</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">,</span> <span class="token string-property property">'bar'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>params<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span> <span class="token comment">// true</span></pre></td></tr><tr><td data-num="3"></td><td><pre>params<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">'baz'</span><span class="token punctuation">)</span> <span class="token comment">// false</span></pre></td></tr></table></figure><h3 id="urlsearchparamsgeturlsearchparamsgetall"><a class="anchor" href="#urlsearchparamsgeturlsearchparamsgetall">#</a> URLSearchParams.get()ï¼ŒURLSearchParams.getAll()</h3>
<p><code>get()</code>  æ–¹æ³•ç”¨æ¥è¯»å–æŸ¥è¯¢å­—ç¬¦ä¸²é‡Œé¢çš„æŒ‡å®šé”®ã€‚å®ƒæ¥å—é”®åä½œä¸ºå‚æ•°ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token string">'?foo=1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span> <span class="token comment">// "1"</span></pre></td></tr><tr><td data-num="3"></td><td><pre>params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">)</span> <span class="token comment">// null</span></pre></td></tr></table></figure><p>ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€‚ç¬¬ä¸€ï¼Œå®ƒè¿”å›çš„æ˜¯å­—ç¬¦ä¸²ï¼Œå¦‚æœåŸå§‹å€¼æ˜¯æ•°å€¼ï¼Œéœ€è¦è½¬ä¸€ä¸‹ç±»å‹ï¼›ç¬¬äºŒï¼Œå¦‚æœæŒ‡å®šçš„é”®åä¸å­˜åœ¨ï¼Œè¿”å›å€¼æ˜¯ <code>null</code> ã€‚</p>
<p>å¦‚æœæœ‰å¤šä¸ªçš„åŒåé”®ï¼Œ <code>get</code>  è¿”å›ä½ç½®æœ€å‰é¢çš„é‚£ä¸ªé”®å€¼ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token string">'?foo=3&amp;foo=2&amp;foo=1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span> <span class="token comment">// "3"</span></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²æœ‰ä¸‰ä¸ª <code>foo</code>  é”®ï¼Œ <code>get</code>  æ–¹æ³•è¿”å›æœ€å‰é¢çš„é”®å€¼ <code>3</code> ã€‚</p>
<p><code>getAll()</code>  æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯æŒ‡å®šé”®çš„æ‰€æœ‰é”®å€¼ã€‚å®ƒæ¥å—é”®åä½œä¸ºå‚æ•°ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token string">'?foo=1&amp;foo=2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>params<span class="token punctuation">.</span><span class="token function">getAll</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span> <span class="token comment">// ["1", "2"]</span></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²æœ‰ä¸¤ä¸ª <code>foo</code>  é”®ï¼Œ <code>getAll</code>  è¿”å›çš„æ•°ç»„å°±æœ‰ä¸¤ä¸ªæˆå‘˜ã€‚</p>
<h3 id="urlsearchparamskeysurlsearchparamsvaluesurlsearchparamsentries"><a class="anchor" href="#urlsearchparamskeysurlsearchparamsvaluesurlsearchparamsentries">#</a> URLSearchParams.keys()ï¼ŒURLSearchParams.values()ï¼ŒURLSearchParams.entries()</h3>
<p>è¿™ä¸‰ä¸ªæ–¹æ³•éƒ½è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä¾› <code>for...of</code>  å¾ªç¯éå†ã€‚å®ƒä»¬çš„åŒºåˆ«åœ¨äºï¼Œ <code>keys</code>  æ–¹æ³•è¿”å›çš„æ˜¯é”®åçš„éå†å™¨ï¼Œ <code>values</code>  æ–¹æ³•è¿”å›çš„æ˜¯é”®å€¼çš„éå†å™¨ï¼Œ <code>entries</code>  è¿”å›çš„æ˜¯é”®å€¼å¯¹çš„éå†å™¨ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token string">'a=1&amp;b=2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> p <span class="token keyword">of</span> params<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// a</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// b</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> p <span class="token keyword">of</span> params<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 1</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">// 2</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> p <span class="token keyword">of</span> params<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// ["a", "1"]</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">// ["b", "2"]</span></pre></td></tr></table></figure><p>å¦‚æœç›´æ¥å¯¹ <code>URLSearchParams</code>  è¿›è¡Œéå†ï¼Œå…¶å®å†…éƒ¨è°ƒç”¨çš„å°±æ˜¯ <code>entries</code>  æ¥å£ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> p <span class="token keyword">of</span> params<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// ç­‰åŒäº</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> p <span class="token keyword">of</span> params<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="qsæ¨¡å—"><a class="anchor" href="#qsæ¨¡å—">#</a> qs æ¨¡å—</h2>
<p>qs æ˜¯ä¸€ä¸ª npm ä»“åº“æ‰€ç®¡ç†çš„åŒ…ï¼Œå¯é€šè¿‡ npm install qs å‘½ä»¤è¿›è¡Œå®‰è£….</p>
<ol>
<li>qs.parse () å°† URL è§£ææˆå¯¹è±¡çš„å½¢å¼</li>
<li>qs.stringify () å°†å¯¹è±¡ åºåˆ—åŒ–æˆ URL çš„å½¢å¼ï¼Œä»¥ &amp; è¿›è¡Œæ‹¼æ¥</li>
</ol>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'qs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token number">1</span><span class="token punctuation">.</span>qs<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token string">"username='admin'&amp;password='123456'"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>qs<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// Object &#123; username: "admin", password: "123456" &#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token number">2</span><span class="token punctuation">.</span>qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">const</span> a <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">'123456'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// username=admin&amp;password=123456</span></pre></td></tr></table></figure><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> å’Œ<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>æœ‰ä»€ä¹ˆåŒºåˆ«<span class="token operator">?</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'hehe'</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>qs<span class="token punctuation">.</span>stringifyåºåˆ—åŒ–ç»“æœå¦‚</pre></td></tr><tr><td data-num="5"></td><td><pre>name<span class="token operator">=</span>hehe<span class="token operator">&amp;</span>age<span class="token operator">=</span><span class="token number">10</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span></pre></td></tr><tr><td data-num="7"></td><td><pre>è€Œ<span class="token constant">JSON</span><span class="token punctuation">.</span>stringifyåºåˆ—åŒ–ç»“æœå¦‚ä¸‹ï¼š</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token string">"&#123;"</span>a<span class="token string">":"</span>hehe<span class="token string">","</span>age<span class="token string">":10&#125;"</span></pre></td></tr></table></figure><h1 id="06-nodejså†…ç½®æ¨¡å—ä¸­"><a class="anchor" href="#06-nodejså†…ç½®æ¨¡å—ä¸­">#</a> 06 ã€nodejs å†…ç½®æ¨¡å—ï¼ˆä¸­ï¼‰ã€‘</h1>
<h2 id="1è·¯åŠ²å¤„ç†æ¨¡å—-path"><a class="anchor" href="#1è·¯åŠ²å¤„ç†æ¨¡å—-path">#</a> 1. è·¯åŠ²å¤„ç†æ¨¡å— path</h2>
<h3 id="11-æ¨¡å—æ¦‚è§ˆ"><a class="anchor" href="#11-æ¨¡å—æ¦‚è§ˆ">#</a> 1.1 æ¨¡å—æ¦‚è§ˆ</h3>
<p>åœ¨ nodejs ä¸­ï¼Œpath æ˜¯ä¸ªä½¿ç”¨é¢‘ç‡å¾ˆé«˜ï¼Œä½†å´è®©äººåˆçˆ±åˆæ¨çš„æ¨¡å—ã€‚éƒ¨åˆ†å› ä¸ºæ–‡æ¡£è¯´çš„ä¸å¤Ÿæ¸…æ™°ï¼Œéƒ¨åˆ†å› ä¸ºæ¥å£çš„å¹³å°å·®å¼‚æ€§ã€‚</p>
<p>å°† path çš„æ¥å£æŒ‰ç…§ç”¨é€”å½’ç±»ï¼Œä»”ç»†ç¢ç£¨ç¢ç£¨ï¼Œä¹Ÿå°±æ²¡é‚£ä¹ˆè´¹è§£äº†ã€‚</p>
<h3 id="12-è·å–è·¯å¾„æ–‡ä»¶åæ‰©å±•å"><a class="anchor" href="#12-è·å–è·¯å¾„æ–‡ä»¶åæ‰©å±•å">#</a> 1.2 è·å–è·¯å¾„ / æ–‡ä»¶å / æ‰©å±•å</h3>
<ul>
<li>è·å–è·¯å¾„ï¼špath.dirname (filepath)</li>
<li>è·å–æ–‡ä»¶åï¼špath.basename (filepath)</li>
<li>è·å–æ‰©å±•åï¼špath.extname (filepath)</li>
</ul>
<h4 id="121-è·å–æ‰€åœ¨è·¯å¾„"><a class="anchor" href="#121-è·å–æ‰€åœ¨è·¯å¾„">#</a> 1.2.1 è·å–æ‰€åœ¨è·¯å¾„</h4>
<p>ä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> filepath <span class="token operator">=</span> <span class="token string">'/tmp/demo/js/test.js'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// è¾“å‡ºï¼š/tmp/demo/js</span></pre></td></tr><tr><td data-num="5"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>filepath<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h4 id="122-è·å–æ–‡ä»¶å"><a class="anchor" href="#122-è·å–æ–‡ä»¶å">#</a> 1.2.2 è·å–æ–‡ä»¶å</h4>
<p>ä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´ï¼Œpath.basename (filepath) åªæ˜¯è¾“å‡ºè·¯å¾„çš„æœ€åä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸ä¼šåˆ¤æ–­æ˜¯å¦æ–‡ä»¶åã€‚</p>
<p>ä½†å¤§éƒ¨åˆ†æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥ä½œä¸ºç®€æ˜“çš„ â€œè·å–æ–‡ä»¶å â€œçš„æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// è¾“å‡ºï¼štest.js</span></pre></td></tr><tr><td data-num="4"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token string">'/tmp/demo/js/test.js'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// è¾“å‡ºï¼štest</span></pre></td></tr><tr><td data-num="7"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token string">'/tmp/demo/js/test/'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// è¾“å‡ºï¼štest</span></pre></td></tr><tr><td data-num="10"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token string">'/tmp/demo/js/test'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>å¦‚æœåªæƒ³è·å–æ–‡ä»¶åï¼Œå•ä¸åŒ…æ‹¬æ–‡ä»¶æ‰©å±•å‘¢ï¼Ÿå¯ä»¥ç”¨ä¸Šç¬¬äºŒä¸ªå‚æ•°ã€‚</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// è¾“å‡ºï¼štest</span></pre></td></tr><tr><td data-num="2"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token string">'/tmp/demo/js/test.js'</span><span class="token punctuation">,</span> <span class="token string">'.js'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h4 id="123-è·å–æ–‡ä»¶æ‰©å±•å"><a class="anchor" href="#123-è·å–æ–‡ä»¶æ‰©å±•å">#</a> 1.2.3 è·å–æ–‡ä»¶æ‰©å±•å</h4>
<p>ç®€å•çš„ä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> filepath <span class="token operator">=</span> <span class="token string">'/tmp/demo/js/test.js'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// è¾“å‡ºï¼š.js</span></pre></td></tr><tr><td data-num="5"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span>filepath<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>æ›´è¯¦ç»†çš„è§„åˆ™æ˜¯å¦‚ä¸‹ï¼šï¼ˆå‡è®¾ path.basename (filepath) === B ï¼‰</p>
<ul>
<li>ä» B çš„æœ€åä¸€ä¸ª <code>.</code>  å¼€å§‹æˆªå–ï¼Œç›´åˆ°æœ€åä¸€ä¸ªå­—ç¬¦ã€‚</li>
<li>å¦‚æœ B ä¸­ä¸å­˜åœ¨ <code>.</code> ï¼Œæˆ–è€… B çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å°±æ˜¯ <code>.</code> ï¼Œé‚£ä¹ˆè¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</li>
</ul>
<p>ç›´æ¥çœ‹<span class="exturl" data-url="aHR0cHM6Ly9ub2RlanMub3JnL2FwaS9wYXRoLmh0bWwjcGF0aF9wYXRoX2V4dG5hbWVfcGF0aA==">å®˜æ–¹æ–‡æ¡£</span>çš„ä¾‹å­</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre>path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// returns '.html'</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span><span class="token string">'index.coffee.md'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// returns '.md'</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span><span class="token string">'index.'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">// returns '.'</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// returns ''</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span><span class="token string">'.index'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// returns ''</span></pre></td></tr></table></figure><h3 id="13-è·¯å¾„ç»„åˆ"><a class="anchor" href="#13-è·¯å¾„ç»„åˆ">#</a> 1.3 è·¯å¾„ç»„åˆ</h3>
<ul>
<li>path.join([...paths])</li>
<li>path.resolve([...paths])</li>
</ul>
<h4 id="131-pathresolve-ç”Ÿæˆå®Œæˆçš„ç»å¯¹è·¯å¾„"><a class="anchor" href="#131-pathresolve-ç”Ÿæˆå®Œæˆçš„ç»å¯¹è·¯å¾„">#</a> 1.3.1 path.resolve () ç”Ÿæˆå®Œæˆçš„ç»å¯¹è·¯å¾„</h4>
<p>è¯­æ³•æ ¼å¼ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>myPaths<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>è§£é‡Šï¼š</p>
<ul>
<li>å°†è·¯å¾„æˆ–è·¯å¾„ç‰‡æ®µçš„åºåˆ—è§£æä¸ºç»å¯¹è·¯å¾„ã€‚</li>
<li>è¿”å›çš„è·¯å¾„æ˜¯<strong>ä»å³å¾€å·¦</strong>å¤„ç†ï¼Œåé¢çš„æ¯ä¸ª myPath è¢«ä¾æ¬¡è§£æï¼Œç›´åˆ°æ„é€ å‡ºä¸€ä¸ªå®Œæ•´çš„ç»å¯¹è·¯å¾„ã€‚</li>
</ul>
<blockquote>
<p>ä½ å¯ä»¥æƒ³è±¡ç°åœ¨ä½ åœ¨ shell ä¸‹é¢ï¼Œä»å·¦åˆ°å³è¿è¡Œä¸€é <code>cd path</code>  å‘½ä»¤ï¼Œæœ€ç»ˆè·å–çš„ç»å¯¹è·¯å¾„ / æ–‡ä»¶åï¼Œå°±æ˜¯è¿™ä¸ªæ¥å£æ‰€è¿”å›çš„ç»“æœäº†ã€‚</p>
</blockquote>
<p>ä»£ç ä¸¾ä¾‹ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">let</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'/foo1/foo2'</span><span class="token punctuation">,</span> <span class="token string">'dselegent'</span><span class="token punctuation">,</span> <span class="token string">'foo3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">let</span> result1 <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token operator">...</span>arr1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°ç»“æœï¼š/foo1/foo2/dselegent/foo3</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">let</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'/foo1/foo2'</span><span class="token punctuation">,</span> <span class="token string">'/dselegent'</span><span class="token punctuation">,</span> <span class="token string">'foo3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">let</span> result2 <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token operator">...</span>arr2<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°ç»“æœï¼š/dselegent/foo3</span></pre></td></tr></table></figure><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// å‡è®¾å½“å‰å·¥ä½œè·¯å¾„æ˜¯ /Users/a/Documents/git-code/nodejs-learning-guide/examples/2016.11.08-node-path</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// è¾“å‡º /Users/a/Documents/git-code/nodejs-learning-guide/examples/2016.11.08-node-path</span></pre></td></tr><tr><td data-num="6"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">// è¾“å‡º /Users/a/Documents/git-code/nodejs-learning-guide/examples/2016.11.08-node-path</span></pre></td></tr><tr><td data-num="9"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// è¾“å‡º /foo/bar/baz</span></pre></td></tr><tr><td data-num="12"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'/foo/bar'</span><span class="token punctuation">,</span> <span class="token string">'./baz'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// è¾“å‡º /foo/bar/baz</span></pre></td></tr><tr><td data-num="15"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'/foo/bar'</span><span class="token punctuation">,</span> <span class="token string">'./baz/'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">// è¾“å‡º /tmp/file</span></pre></td></tr><tr><td data-num="18"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'/foo/bar'</span><span class="token punctuation">,</span> <span class="token string">'/tmp/file/'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">// è¾“å‡º /Users/a/Documents/git-code/nodejs-learning-guide/examples/2016.11.08-node-path/www/js/mod.js</span></pre></td></tr><tr><td data-num="21"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'www'</span><span class="token punctuation">,</span> <span class="token string">'js/upload'</span><span class="token punctuation">,</span> <span class="token string">'../mod.js'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h4 id="132-pathjoin-å°†å¤šä¸ªè·¯å¾„è¿›è¡Œæ‹¼æ¥"><a class="anchor" href="#132-pathjoin-å°†å¤šä¸ªè·¯å¾„è¿›è¡Œæ‹¼æ¥">#</a> 1.3.2 path.join () å°†å¤šä¸ªè·¯å¾„è¿›è¡Œæ‹¼æ¥</h4>
<p>å¦‚æœæ˜¯æˆ‘ä»¬æ‰‹åŠ¨æ‹¼æ¥è·¯å¾„ï¼Œå®¹æ˜“å‡ºé”™ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¯ä»¥åˆ©ç”¨ path.join () æ–¹æ³•å°†è·¯å¾„è¿›è¡Œæ‹¼æ¥ã€‚</p>
<p>è¯­æ³•æ ¼å¼ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>paths<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>è§£é‡Šï¼šä½¿ç”¨å¹³å°ç‰¹å®šçš„åˆ†éš”ç¬¦ä½œä¸ºå®šç•Œç¬¦å°†æ‰€æœ‰ç»™å®šçš„ path ç‰‡æ®µè¿æ¥åœ¨ä¸€èµ·ï¼Œç„¶åè§„èŒƒåŒ–ç”Ÿæˆçš„è·¯å¾„ã€‚</p>
<p>ä»£ç ä¸¾ä¾‹ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> result1 <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./app.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å›ï¼š/Users/smyhvae/dselegent/app.js</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">const</span> result2 <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'/foo1'</span><span class="token punctuation">,</span> <span class="token string">'foo2'</span><span class="token punctuation">,</span> <span class="token string">'./foo3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å›ï¼š/foo1/foo2/foo3</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">const</span> result3 <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'/foo1'</span><span class="token punctuation">,</span> <span class="token string">'foo2'</span><span class="token punctuation">,</span> <span class="token string">'/foo3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å›ï¼š/foo1/foo2/foo3</span></pre></td></tr></table></figure><h4 id="133-pathresolve-å’Œ-pathjoin-åŒºåˆ«"><a class="anchor" href="#133-pathresolve-å’Œ-pathjoin-åŒºåˆ«">#</a> 1.3.3 path.resolve å’Œ path.join åŒºåˆ«</h4>
<p>path.resolve å’Œ path.join éƒ½æ˜¯å±äº path æ ¸å¿ƒæ¨¡å—ä¸‹çš„æ–¹æ³•ï¼Œç”¨æ¥æ‹¼æ¥è·¯å¾„ã€‚</p>
<p>éƒ½å¯ä»¥æ‹¼æ¥æˆä¸€ä¸ªå®Œæ•´è·¯å¾„.</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">var</span> dirname <span class="token operator">=</span> <span class="token string">'/User/Desktop'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> basename <span class="token operator">=</span> <span class="token string">'abc.txt'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> basename<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// /User/Desktop/abc.txt</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> basename<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// /User/Desktop/abc.txt</span></pre></td></tr></table></figure><p>å¦‚æœ dirname æ˜¯ä»¥ ./ ã€../ã€ä¸åŠ  / å¼€å¤´çš„è¯ï¼Œé‚£ä¹ˆ resolve ä¼šæ‰¾åˆ°ç£ç›˜ä¸‹çš„æ ¹ç›®å½•</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">var</span> dirname <span class="token operator">=</span> <span class="token string">'../User/Desktop'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> basename <span class="token operator">=</span> <span class="token string">'abc.txt'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre> </pre></td></tr><tr><td data-num="6"></td><td><pre>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> basename<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ../User/Desktop/abc.txt</span></pre></td></tr><tr><td data-num="7"></td><td><pre> </pre></td></tr><tr><td data-num="8"></td><td><pre>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> basename<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// /Users/Desktop/node/User/Desktop/abc.txt</span></pre></td></tr></table></figure><p>å¦‚æœ basename æ˜¯ä»¥ / å¼€å¤´çš„ï¼Œé‚£ä¹ˆ resolve å°±ä¼šç›´æ¥è¿”å› basename</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">var</span> dirname <span class="token operator">=</span> <span class="token string">'/User/Desktop'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> basename <span class="token operator">=</span> <span class="token string">'/abc.txt'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre> </pre></td></tr><tr><td data-num="6"></td><td><pre>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> basename<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// /User/Desktop/abc.txt</span></pre></td></tr><tr><td data-num="7"></td><td><pre> </pre></td></tr><tr><td data-num="8"></td><td><pre>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> basename<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// /abc.txt</span></pre></td></tr></table></figure><h3 id="14-å‡ ä¸ªå¸¸è§è·¯å¾„"><a class="anchor" href="#14-å‡ ä¸ªå¸¸è§è·¯å¾„">#</a> 1.4 å‡ ä¸ªå¸¸è§è·¯å¾„</h3>
<ul>
<li><code>__dirname</code> ï¼šè¿™æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œè¡¨ç¤ºï¼šå½“å‰æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨<strong>å®Œæ•´ç›®å½•</strong>ã€‚</li>
<li><code>__filename</code> ï¼šè¿™æ˜¯ä¸€ä¸ªå¸¸é‡ã€‚è¡¨ç¤ºï¼šå½“å‰æ‰§è¡Œæ–‡ä»¶çš„<strong>å®Œæ•´ç›®å½• + æ–‡ä»¶å</strong>ã€‚</li>
<li><code>process.cwd</code> ï¼šè·å–å½“å‰æ‰§è¡Œ Node å‘½ä»¤ æ—¶çš„ç›®å½•åã€‚</li>
</ul>
<p>ä»£ç ä¸¾ä¾‹ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__filename<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>$ <span class="token function">node</span> app.js</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>/Users/smyhvae/dselegent</pre></td></tr><tr><td data-num="4"></td><td><pre>/Users/smyhvae/dselegent/app.js</pre></td></tr><tr><td data-num="5"></td><td><pre>/Users/smyhvae/dselegent</pre></td></tr></table></figure><h2 id="2æœ¬åœ°æ–‡ä»¶æ“ä½œæ¨¡å—-fs"><a class="anchor" href="#2æœ¬åœ°æ–‡ä»¶æ“ä½œæ¨¡å—-fs">#</a> 2. æœ¬åœ°æ–‡ä»¶æ“ä½œæ¨¡å— fs</h2>
<blockquote>
<h3 id="nodejs-ä¸­çš„åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«"><a class="anchor" href="#nodejs-ä¸­çš„åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«">#</a> Node.js ä¸­çš„åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«</h3>
<p>fs æ¨¡å—å¯¹æ–‡ä»¶çš„å‡ ä¹æ‰€æœ‰æ“ä½œéƒ½æœ‰åŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§å½¢å¼ã€‚ä¾‹å¦‚ï¼šreadFile () å’Œ readFileSync ()ã€‚</p>
<p>åŒºåˆ«ï¼š</p>
<ul>
<li>åŒæ­¥è°ƒç”¨ä¼šé˜»å¡ä»£ç çš„æ‰§è¡Œï¼Œå¼‚æ­¥åˆ™ä¸ä¼šã€‚</li>
<li>å¼‚æ­¥è°ƒç”¨ä¼šå°† è¯»å–ä»»åŠ¡ ä¸‹è¾¾åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œç›´åˆ°ä»»åŠ¡æ‰§è¡Œå®Œæˆæ‰ä¼šå›è°ƒã€‚</li>
<li>å¼‚å¸¸å¤„ç†æ–¹é¢ï¼šåŒæ­¥å¿…é¡»ä½¿ç”¨ try catch æ–¹å¼ï¼Œå¼‚æ­¥å¯ä»¥é€šè¿‡å›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚ã€é‡è¦ã€‘</li>
</ul>
</blockquote>
<h3 id="21-æ–‡ä»¶è¯»å–"><a class="anchor" href="#21-æ–‡ä»¶è¯»å–">#</a> 2.1 æ–‡ä»¶è¯»å–</h3>
<p><strong>åŒæ­¥è¯»å–</strong></p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">try</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./fileForRead.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ–‡ä»¶å†…å®¹: '</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'è¯»å–æ–‡ä»¶å‡ºé”™: '</span> <span class="token operator">+</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>/usr/local/bin/node readFileSync.js</pre></td></tr><tr><td data-num="2"></td><td><pre>æ–‡ä»¶å†…å®¹: hello world</pre></td></tr></table></figure><p><strong>å¼‚æ­¥è¯»å–</strong></p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./fileForRead.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'è¯»å–æ–‡ä»¶å‡ºé”™: '</span> <span class="token operator">+</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ–‡ä»¶å†…å®¹: '</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>/usr/local/bin/node readFile.js</pre></td></tr><tr><td data-num="2"></td><td><pre>æ–‡ä»¶å†…å®¹: hello world</pre></td></tr></table></figure><blockquote>
<p><strong>fs/promises ä» Node.js 14 å¼€å§‹å¯ç”¨</strong><br />
ä» Node.js 14 å¼€å§‹ï¼Œfs æ¨¡å—æä¾›äº†ä¸¤ç§ä½¿ç”¨åŸºäº promises çš„æ–‡ä»¶ç³»ç»Ÿçš„æ–¹æ³•ã€‚è¿™äº› promises å¯ä»¥é€šè¿‡  <code>require('fs').promises</code>  æˆ–  <code>require('fs/promises') </code> è·å¾—ã€‚</p>
</blockquote>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> readFile <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'fs/promises'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">const</span> contents <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token string">'utf8'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="22-æ–‡ä»¶å†™å…¥"><a class="anchor" href="#22-æ–‡ä»¶å†™å…¥">#</a> 2.2 æ–‡ä»¶å†™å…¥</h3>
<p>å¤‡æ³¨ï¼šä»¥ä¸‹ä»£ç ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–‡ä»¶ï¼›å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œåˆ™è¦†ç›–æ–‡ä»¶å†…å®¹ï¼›</p>
<p><strong>å¼‚æ­¥å†™å…¥</strong></p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'./fileForWrite.txt'</span><span class="token punctuation">,</span> <span class="token string">'hello world'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ–‡ä»¶å†™å…¥æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>åŒæ­¥å†™å…¥</strong></p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">try</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span><span class="token string">'./fileForWrite1.txt'</span><span class="token punctuation">,</span> <span class="token string">'hello world'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ–‡ä»¶å†™å…¥æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">throw</span> err<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>promises</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> writeFile <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'fs/promises'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">const</span> contents <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'message.txt'</span><span class="token punctuation">,</span> <span class="token string">'hello world'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token string">'utf8'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token comment">// When a request is aborted - err is an AbortError</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="23-æ–‡ä»¶æ˜¯å¦å­˜åœ¨"><a class="anchor" href="#23-æ–‡ä»¶æ˜¯å¦å­˜åœ¨">#</a> 2.3 æ–‡ä»¶æ˜¯å¦å­˜åœ¨</h3>
<p><code>fs.exists()</code>  å·²ç»æ˜¯ <code>deprecated</code>  çŠ¶æ€ï¼Œç°åœ¨å¯ä»¥é€šè¿‡ä¸‹é¢ä»£ç åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚</p>
<p><strong>å¼‚æ­¥æœ¬</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨äºå½“å‰ç›®å½•ä¸­</span></pre></td></tr><tr><td data-num="4"></td><td><pre>fs<span class="token punctuation">.</span><span class="token function">access</span><span class="token punctuation">(</span><span class="token string">'package.json'</span><span class="token punctuation">,</span> fs<span class="token punctuation">.</span>constants<span class="token punctuation">.</span><span class="token constant">F_OK</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'package.jsonä¸å­˜åœ¨äºå½“å‰ç›®å½•ä¸­'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">return</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'package.jsonå­˜åœ¨äºå½“å‰ç›®å½•ä¸­'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>fs<span class="token punctuation">.</span><span class="token function">access</span><span class="token punctuation">(</span><span class="token string">'index.js'</span><span class="token punctuation">,</span> fs<span class="token punctuation">.</span>constants<span class="token punctuation">.</span><span class="token constant">F_OK</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'index.jsä¸å­˜åœ¨äºå½“å‰ç›®å½•ä¸­'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">return</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'index.jså­˜åœ¨äºå½“å‰ç›®å½•ä¸­'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><code>fs.access()</code>  é™¤äº†åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰ï¼Œè¿˜å¯ä»¥ç”¨æ¥åˆ¤æ–­æ–‡ä»¶çš„æƒé™ã€‚</p>
<p>å¤‡å¿˜ï¼š <code>fs.constants.F_OK</code>  ç­‰å¸¸é‡æ— æ³•è·å–ï¼ˆnode v6.1ï¼Œmac 10.11.4 ä¸‹ï¼Œ <code>fs.constants</code>  æ˜¯ <code>undefined</code> ï¼‰</p>
<p><strong>åŒæ­¥</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> accessSync<span class="token punctuation">,</span> constants <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'fs'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token function">accessSync</span><span class="token punctuation">(</span><span class="token string">'etc/passwd'</span><span class="token punctuation">,</span> constants<span class="token punctuation">.</span><span class="token constant">R_OK</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'can read'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'no access!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>promises</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> access<span class="token punctuation">,</span> constants <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'node:fs/promises'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">await</span> <span class="token function">access</span><span class="token punctuation">(</span><span class="token string">'/etc/passwd'</span><span class="token punctuation">,</span> constants<span class="token punctuation">.</span><span class="token constant">R_OK</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'can access'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'cannot access'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="24-åˆ é™¤æ–‡ä»¶"><a class="anchor" href="#24-åˆ é™¤æ–‡ä»¶">#</a> 2.4 åˆ é™¤æ–‡ä»¶</h3>
<p><strong>å¼‚æ­¥ç‰ˆæœ¬</strong></p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>fs<span class="token punctuation">.</span><span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string">'./fileForUnlink.txt'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ–‡ä»¶åˆ é™¤æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>åŒæ­¥ç‰ˆæœ¬</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> unlinkSync <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'fs'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token function">unlinkSync</span><span class="token punctuation">(</span><span class="token string">'/tmp/hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'successfully deleted /tmp/hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token comment">// handle the error</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>promises</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> unlink <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'fs/promises'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">await</span> <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string">'/tmp/hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'successfully deleted /tmp/hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token comment">// handle the error</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="25-åˆ›å»ºç›®å½•"><a class="anchor" href="#25-åˆ›å»ºç›®å½•">#</a> 2.5 åˆ›å»ºç›®å½•</h3>
<p><strong>å¼‚æ­¥ç‰ˆæœ¬</strong>ï¼ˆå¦‚æœç›®å½•å·²å­˜åœ¨ï¼Œä¼šæŠ¥é”™ï¼‰</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// fs.mkdir(path[, mode], callback)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>fs<span class="token punctuation">.</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token string">'sub'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'åˆ›å»ºç›®å½•æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>åŒæ­¥ç‰ˆæœ¬</strong></p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// fs.mkdirSync(path[, mode])</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">try</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    fs<span class="token punctuation">.</span><span class="token function">mkdirSync</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'åˆ›å»ºç›®å½•æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">throw</span> e<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>promises</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> mkdir <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'fs/promises'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">const</span> createDir <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">mkdir</span><span class="token punctuation">(</span>projectFolder<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">recursive</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">created </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>createDir<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="26-éå†ç›®å½•"><a class="anchor" href="#26-éå†ç›®å½•">#</a> 2.6 éå†ç›®å½•</h3>
<p>åŒæ­¥ç‰ˆæœ¬ï¼Œæ³¨æ„ï¼š <code>fs.readdirSync()</code>  åªä¼šè¯»ä¸€å±‚ï¼Œæ‰€ä»¥éœ€è¦åˆ¤æ–­æ–‡ä»¶ç±»å‹æ˜¯å¦ç›®å½•ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿›è¡Œé€’å½’éå†ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// fs.readdirSync(path[, options])</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">var</span> <span class="token function-variable function">getFilesInDir</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">var</span> results <span class="token operator">=</span> <span class="token punctuation">[</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">var</span> files <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>dir<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>    files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>        file <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>dir<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">var</span> stats <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            results<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            results <span class="token operator">=</span> results<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span> <span class="token function">getFilesInDir</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">return</span> results<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">var</span> files <span class="token operator">=</span> <span class="token function">getFilesInDir</span><span class="token punctuation">(</span><span class="token string">'../'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="27-è¯»å–ç›®å½•"><a class="anchor" href="#27-è¯»å–ç›®å½•">#</a> 2.7 è¯»å–ç›®å½•</h3>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> readdir <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'fs/promises'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">const</span> files <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readdir</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> file <span class="token keyword">of</span> files<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="28-åˆ é™¤ç›®å½•"><a class="anchor" href="#28-åˆ é™¤ç›®å½•">#</a> 2.8 åˆ é™¤ç›®å½•</h3>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// åˆ é™¤ç›®å½• (å‰ææ²¡æœ‰æ–‡ä»¶åœ¨é‡Œé¢)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>fs<span class="token punctuation">.</span><span class="token function">rmdir</span><span class="token punctuation">(</span><span class="token string">'./avatar'</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token operator">&amp;&amp;</span> err<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">'ENOENT'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ç›®å½•ä¸å­˜åœ¨'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="29-åˆ é™¤æ•´ä¸ªç›®å½•"><a class="anchor" href="#29-åˆ é™¤æ•´ä¸ªç›®å½•">#</a> 2.9 åˆ é™¤æ•´ä¸ªç›®å½•</h3>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//1</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"fs"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>fs<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token string">"./avatar"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment">// console.log(data)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        fs<span class="token punctuation">.</span><span class="token function">unlinkSync</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./avatar/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>item<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>    fs<span class="token punctuation">.</span><span class="token function">rmdir</span><span class="token punctuation">(</span><span class="token string">"./avatar"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">//2</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span><span class="token string">"./avatar"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">unlink</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./avatar/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>item<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    fs<span class="token punctuation">.</span><span class="token function">rmdir</span><span class="token punctuation">(</span><span class="token string">"./avatar"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">//3</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>promises<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span><span class="token string">'./image2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">data</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> fs<span class="token punctuation">.</span><span class="token function">unlink</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./image2/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>item<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>  <span class="token keyword">await</span> fs<span class="token punctuation">.</span><span class="token function">rmdir</span><span class="token punctuation">(</span><span class="token string">'./image2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="210-æ–‡ä»¶é‡å‘½å"><a class="anchor" href="#210-æ–‡ä»¶é‡å‘½å">#</a> 2.10 æ–‡ä»¶é‡å‘½å</h3>
<p><strong>å¼‚æ­¥ç‰ˆæœ¬</strong></p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// fs.rename(oldPath, newPath, callback)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>fs<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span><span class="token string">'./hello'</span><span class="token punctuation">,</span> <span class="token string">'./world'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'é‡å‘½åæˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>åŒæ­¥ç‰ˆæœ¬</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// fs.renameSync(oldPath, newPath)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>fs<span class="token punctuation">.</span><span class="token function">renameSync</span><span class="token punctuation">(</span><span class="token string">'./world'</span><span class="token punctuation">,</span> <span class="token string">'./hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>promises</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> rename <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'fs/promises'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">await</span> <span class="token function">rename</span><span class="token punctuation">(</span><span class="token string">'./world'</span><span class="token punctuation">,</span> <span class="token string">'./hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">rename</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="211-è·å–æ–‡ä»¶çŠ¶æ€"><a class="anchor" href="#211-è·å–æ–‡ä»¶çŠ¶æ€">#</a> 2.11 è·å–æ–‡ä»¶çŠ¶æ€</h3>
<p>1. å¼‚æ­¥ï¼šfs.stat (path,callback):<br />
path æ˜¯ä¸€ä¸ªè¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ä¸²ï¼Œcallback æ¥æ”¶ä¸¤ä¸ªå‚æ•° (err,stats), å…¶ä¸­ stats å°±æ˜¯ fs.stats çš„ä¸€ä¸ªå®ä¾‹ï¼›</p>
<p>2. åŒæ­¥ï¼šfs.statSync (path)<br />
 åªæ¥æ”¶ä¸€ä¸ª path å˜é‡ï¼Œfs.statSync (path) å…¶å®æ˜¯ä¸€ä¸ª fs.stats çš„ä¸€ä¸ªå®ä¾‹ï¼›</p>
<p>æ–¹æ³•</p>
<ul>
<li>stats.isFile () -- æ˜¯å¦æ–‡ä»¶</li>
<li>stats.isDirectory () -- æ˜¯å¦ç›®å½•</li>
</ul>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// Node.js program to demonstrate the </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// fs.statSync() method </span></pre></td></tr><tr><td data-num="3"></td><td><pre>  </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// Import the filesystem module </span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="6"></td><td><pre>  </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// Getting information for a file </span></pre></td></tr><tr><td data-num="8"></td><td><pre>statsObj <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span><span class="token string">"test_file.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="9"></td><td><pre>  </pre></td></tr><tr><td data-num="10"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>statsObj<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Path is file:"</span><span class="token punctuation">,</span> statsObj<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="12"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Path is directory:"</span><span class="token punctuation">,</span> statsObj<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="13"></td><td><pre>  </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// Getting information for a directory </span></pre></td></tr><tr><td data-num="15"></td><td><pre>statsObj <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span><span class="token string">"test_directory"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="16"></td><td><pre>  </pre></td></tr><tr><td data-num="17"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>statsObj<span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="18"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Path is file:"</span><span class="token punctuation">,</span> statsObj<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="19"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Path is directory:"</span><span class="token punctuation">,</span> statsObj<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>Stats <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token literal-property property">dev</span><span class="token operator">:</span><span class="token number">3229478529</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token literal-property property">mode</span><span class="token operator">:</span><span class="token number">33206</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token literal-property property">nlink</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token literal-property property">uid</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token literal-property property">gid</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token literal-property property">rdev</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token literal-property property">blksize</span><span class="token operator">:</span><span class="token number">4096</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token literal-property property">ino</span><span class="token operator">:</span><span class="token number">1970324837039946</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token literal-property property">size</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token literal-property property">blocks</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token literal-property property">atimeMs</span><span class="token operator">:</span><span class="token number">1582306776282</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token literal-property property">mtimeMs</span><span class="token operator">:</span><span class="token number">1582482953967</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token literal-property property">ctimeMs</span><span class="token operator">:</span><span class="token number">1582482953968.2532</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token literal-property property">birthtimeMs</span><span class="token operator">:</span><span class="token number">1582306776282.142</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token literal-property property">atime</span><span class="token operator">:</span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span>21T17<span class="token operator">:</span><span class="token number">39</span><span class="token operator">:</span><span class="token number">36</span><span class="token punctuation">.</span>282Z<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token literal-property property">mtime</span><span class="token operator">:</span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span>23T18<span class="token operator">:</span><span class="token number">35</span><span class="token operator">:</span><span class="token number">53</span><span class="token punctuation">.</span>967Z<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token literal-property property">ctime</span><span class="token operator">:</span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span>23T18<span class="token operator">:</span><span class="token number">35</span><span class="token operator">:</span><span class="token number">53</span><span class="token punctuation">.</span>968Z<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token literal-property property">birthtime</span><span class="token operator">:</span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span>21T17<span class="token operator">:</span><span class="token number">39</span><span class="token operator">:</span><span class="token number">36</span><span class="token punctuation">.</span>282Z</pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>Path is file<span class="token operator">:</span><span class="token boolean">true</span></pre></td></tr><tr><td data-num="22"></td><td><pre>Path is directory<span class="token operator">:</span><span class="token boolean">false</span></pre></td></tr><tr><td data-num="23"></td><td><pre>Stats <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token literal-property property">dev</span><span class="token operator">:</span><span class="token number">3229478529</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token literal-property property">mode</span><span class="token operator">:</span><span class="token number">16822</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  <span class="token literal-property property">nlink</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token literal-property property">uid</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token literal-property property">gid</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="29"></td><td><pre>  <span class="token literal-property property">rdev</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token literal-property property">blksize</span><span class="token operator">:</span><span class="token number">4096</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="31"></td><td><pre>  <span class="token literal-property property">ino</span><span class="token operator">:</span><span class="token number">562949953486669</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  <span class="token literal-property property">size</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre>  <span class="token literal-property property">blocks</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="34"></td><td><pre>  <span class="token literal-property property">atimeMs</span><span class="token operator">:</span><span class="token number">1582482965037.8445</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="35"></td><td><pre>  <span class="token literal-property property">mtimeMs</span><span class="token operator">:</span><span class="token number">1581074249467.7114</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="36"></td><td><pre>  <span class="token literal-property property">ctimeMs</span><span class="token operator">:</span><span class="token number">1582482964979.8303</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="37"></td><td><pre>  <span class="token literal-property property">birthtimeMs</span><span class="token operator">:</span><span class="token number">1582306776288.1958</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="38"></td><td><pre>  <span class="token literal-property property">atime</span><span class="token operator">:</span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span>23T18<span class="token operator">:</span><span class="token number">36</span><span class="token operator">:</span><span class="token number">05</span><span class="token punctuation">.</span>038Z<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="39"></td><td><pre>  <span class="token literal-property property">mtime</span><span class="token operator">:</span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span>07T11<span class="token operator">:</span><span class="token number">17</span><span class="token operator">:</span><span class="token number">29</span><span class="token punctuation">.</span>468Z<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="40"></td><td><pre>  <span class="token literal-property property">ctime</span><span class="token operator">:</span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span>23T18<span class="token operator">:</span><span class="token number">36</span><span class="token operator">:</span><span class="token number">04</span><span class="token punctuation">.</span>980Z<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="41"></td><td><pre>  <span class="token literal-property property">birthtime</span><span class="token operator">:</span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span>21T17<span class="token operator">:</span><span class="token number">39</span><span class="token operator">:</span><span class="token number">36</span><span class="token punctuation">.</span>288Z</pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>Path is file<span class="token operator">:</span><span class="token boolean">false</span></pre></td></tr><tr><td data-num="44"></td><td><pre>Path is directory<span class="token operator">:</span><span class="token boolean">true</span></pre></td></tr></table></figure><h3 id="212-è¿½åŠ æ–‡ä»¶å†…å®¹"><a class="anchor" href="#212-è¿½åŠ æ–‡ä»¶å†…å®¹">#</a> 2.12 è¿½åŠ æ–‡ä»¶å†…å®¹</h3>
<blockquote>
<p>fs.appendFile(file, data[, options], callback)</p>
</blockquote>
<ul>
<li>fileï¼šå¯ä»¥æ˜¯æ–‡ä»¶è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯æ–‡ä»¶å¥æŸ„ã€‚ï¼ˆè¿˜å¯ä»¥æ˜¯ bufferï¼Ÿï¼‰</li>
<li>dataï¼šè¦è¿½åŠ çš„å†…å®¹ã€‚string æˆ–è€… bufferã€‚</li>
<li>options
<ul>
<li>encodingï¼šç¼–ç ï¼Œé»˜è®¤æ˜¯ <code>utf8</code></li>
<li>modeï¼šé»˜è®¤æ˜¯ <code>0o666</code></li>
<li>flagï¼šé»˜è®¤æ˜¯ <code>a</code></li>
</ul>
</li>
</ul>
<p>æ³¨æ„ï¼šå¦‚æœ <code>file</code>  æ˜¯æ–‡ä»¶å¥æŸ„ï¼Œé‚£ä¹ˆ</p>
<ul>
<li>å¼€å§‹è¿½åŠ æ•°æ®å‰ï¼Œfile éœ€è¦å·²ç»æ‰“å¼€ã€‚</li>
<li>file éœ€è¦æ‰‹åŠ¨å…³é—­ã€‚</li>
</ul>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>fs<span class="token punctuation">.</span><span class="token function">appendFile</span><span class="token punctuation">(</span><span class="token string">'./extra/fileForAppend.txt'</span><span class="token punctuation">,</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'appendæˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="3äº‹ä»¶æœºåˆ¶æ¨¡å—-events"><a class="anchor" href="#3äº‹ä»¶æœºåˆ¶æ¨¡å—-events">#</a> 3. äº‹ä»¶æœºåˆ¶æ¨¡å— events</h2>
<p>Node.js æœ‰å¤šä¸ªå†…ç½®çš„äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥ events æ¨¡å—ï¼Œå¹¶é€šè¿‡å®ä¾‹åŒ– EventEmitter ç±»æ¥ç»‘å®šå’Œç›‘å¬äº‹ä»¶ï¼Œå¦‚ä¸‹å®ä¾‹ï¼š</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// å¼•å…¥ events æ¨¡å—</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> EventEmitter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'events'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// åˆ›å»º eventEmitter å¯¹è±¡</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> event <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>ä»¥ä¸‹ç¨‹åºç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åºï¼š</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// ç»‘å®šäº‹ä»¶åŠäº‹ä»¶çš„å¤„ç†ç¨‹åº</span></pre></td></tr><tr><td data-num="2"></td><td><pre>eventEmitter<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'eventName'</span><span class="token punctuation">,</span> eventHandler<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¨‹åºè§¦å‘äº‹ä»¶ï¼š</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// è§¦å‘äº‹ä»¶</span></pre></td></tr><tr><td data-num="2"></td><td><pre>eventEmitter<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'eventName'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>EventEmitter </code> çš„æ¯ä¸ªäº‹ä»¶ç”±ä¸€ä¸ªäº‹ä»¶åå’Œè‹¥å¹²ä¸ªå‚æ•°ç»„æˆï¼Œäº‹ä»¶åæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé€šå¸¸è¡¨è¾¾ä¸€å®šçš„è¯­ä¹‰ã€‚å¯¹äºæ¯ä¸ªäº‹ä»¶ï¼Œ <code>EventEmitter </code> æ”¯æŒ è‹¥å¹²ä¸ªäº‹ä»¶ç›‘å¬å™¨ã€‚</p>
<p>å½“äº‹ä»¶è§¦å‘æ—¶ï¼Œæ³¨å†Œåˆ°è¿™ä¸ªäº‹ä»¶çš„äº‹ä»¶ç›‘å¬å™¨è¢«ä¾æ¬¡è°ƒç”¨ï¼Œäº‹ä»¶å‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°å‚æ•°ä¼ é€’ã€‚</p>
<p>è®©æˆ‘ä»¬ä»¥ä¸‹é¢çš„ä¾‹å­è§£é‡Šè¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// å¼•å…¥ events æ¨¡å—</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> EventEmitter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'events'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// åˆ›å»º eventEmitter å¯¹è±¡</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> event <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>event<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'someEvent'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">arg1<span class="token punctuation">,</span> arg2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="6"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'listener1'</span><span class="token punctuation">,</span> arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="8"></td><td><pre>event<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'someEvent'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">arg1<span class="token punctuation">,</span> arg2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="9"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'listener2'</span><span class="token punctuation">,</span> arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="11"></td><td><pre>event<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'someEvent'</span><span class="token punctuation">,</span> <span class="token string">'arg1 å‚æ•°'</span><span class="token punctuation">,</span> <span class="token string">'arg2 å‚æ•°'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>æ‰§è¡Œä»¥ä¸Šä»£ç ï¼Œè¿è¡Œçš„ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>$ <span class="token function">node</span> event.js </pre></td></tr><tr><td data-num="2"></td><td><pre>listener1 arg1 å‚æ•° arg2 å‚æ•°</pre></td></tr><tr><td data-num="3"></td><td><pre>listener2 arg1 å‚æ•° arg2 å‚æ•°</pre></td></tr></table></figure><p>ä»¥ä¸Šä¾‹å­ä¸­ï¼Œevent ä¸ºäº‹ä»¶ someEvent æ³¨å†Œäº†ä¸¤ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œç„¶åè§¦å‘äº† someEvent äº‹ä»¶ã€‚</p>
<p>è¿è¡Œç»“æœä¸­å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªäº‹ä»¶ç›‘å¬å™¨å›è°ƒå‡½æ•°è¢«å…ˆåè°ƒç”¨ã€‚ è¿™å°±æ˜¯ <code>EventEmitter</code>  æœ€ç®€å•çš„ç”¨æ³•ã€‚</p>
<p><code>EventEmitter </code> æä¾›äº†å¤šä¸ªå±æ€§ï¼Œå¦‚ <strong>on</strong> å’Œ <strong>emit</strong>ã€‚<strong>on</strong> å‡½æ•°ç”¨äºç»‘å®šäº‹ä»¶å‡½æ•°ï¼Œ<strong>emit</strong> å±æ€§ç”¨äºè§¦å‘ä¸€ä¸ªäº‹ä»¶</p>
<h1 id="07-nodejså†…ç½®æ¨¡å—ä¸‹"><a class="anchor" href="#07-nodejså†…ç½®æ¨¡å—ä¸‹">#</a> 07 ã€nodejs å†…ç½®æ¨¡å—ï¼ˆä¸‹ï¼‰ã€‘</h1>
<h2 id="1stream-æ¨¡å—"><a class="anchor" href="#1stream-æ¨¡å—">#</a> 1.stream æ¨¡å—</h2>
<p><code>stream</code>  æ˜¯ Node.js æä¾›çš„åˆä¸€ä¸ªä»…åœ¨æœåŠ¡åŒºç«¯å¯ç”¨çš„æ¨¡å—ï¼Œç›®çš„æ˜¯æ”¯æŒ â€œæµâ€ è¿™ç§æ•°æ®ç»“æ„ã€‚</p>
<p>ä»€ä¹ˆæ˜¯æµï¼Ÿæµæ˜¯ä¸€ç§æŠ½è±¡çš„æ•°æ®ç»“æ„ã€‚æƒ³è±¡æ°´æµï¼Œå½“åœ¨æ°´ç®¡ä¸­æµåŠ¨æ—¶ï¼Œå°±å¯ä»¥ä»æŸä¸ªåœ°æ–¹ï¼ˆä¾‹å¦‚è‡ªæ¥æ°´å‚ï¼‰æºæºä¸æ–­åœ°åˆ°è¾¾å¦ä¸€ä¸ªåœ°æ–¹ï¼ˆæ¯”å¦‚ä½ å®¶çš„æ´—æ‰‹æ± ï¼‰ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠæ•°æ®çœ‹æˆæ˜¯æ•°æ®æµï¼Œæ¯”å¦‚ä½ æ•²é”®ç›˜çš„æ—¶å€™ï¼Œå°±å¯ä»¥æŠŠæ¯ä¸ªå­—ç¬¦ä¾æ¬¡è¿èµ·æ¥ï¼Œçœ‹æˆå­—ç¬¦æµã€‚è¿™ä¸ªæµæ˜¯ä»é”®ç›˜è¾“å…¥åˆ°åº”ç”¨ç¨‹åºï¼Œå®é™…ä¸Šå®ƒè¿˜å¯¹åº”ç€ä¸€ä¸ªåå­—ï¼šæ ‡å‡†è¾“å…¥æµï¼ˆstdinï¼‰ã€‚</p>
<p>å¦‚æœåº”ç”¨ç¨‹åºæŠŠå­—ç¬¦ä¸€ä¸ªä¸€ä¸ªè¾“å‡ºåˆ°æ˜¾ç¤ºå™¨ä¸Šï¼Œè¿™ä¹Ÿå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªæµï¼Œè¿™ä¸ªæµä¹Ÿæœ‰åå­—ï¼šæ ‡å‡†è¾“å‡ºæµï¼ˆstdoutï¼‰ã€‚æµçš„ç‰¹ç‚¹æ˜¯æ•°æ®æ˜¯æœ‰åºçš„ï¼Œè€Œä¸”å¿…é¡»ä¾æ¬¡è¯»å–ï¼Œæˆ–è€…ä¾æ¬¡å†™å…¥ï¼Œä¸èƒ½åƒ Array é‚£æ ·éšæœºå®šä½ã€‚</p>
<p>æœ‰äº›æµç”¨æ¥è¯»å–æ•°æ®ï¼Œæ¯”å¦‚ä»æ–‡ä»¶è¯»å–æ•°æ®æ—¶ï¼Œå¯ä»¥æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æµï¼Œç„¶åä»æ–‡ä»¶æµä¸­ä¸æ–­åœ°è¯»å–æ•°æ®ã€‚æœ‰äº›æµç”¨æ¥å†™å…¥æ•°æ®ï¼Œæ¯”å¦‚å‘æ–‡ä»¶å†™å…¥æ•°æ®æ—¶ï¼Œåªéœ€è¦æŠŠæ•°æ®ä¸æ–­åœ°å¾€æ–‡ä»¶æµä¸­å†™è¿›å»å°±å¯ä»¥äº†ã€‚</p>
<p>åœ¨ Node.js ä¸­ï¼Œæµä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬åªéœ€è¦å“åº”æµçš„äº‹ä»¶å°±å¯ä»¥äº†ï¼š <code>data</code>  äº‹ä»¶è¡¨ç¤ºæµçš„æ•°æ®å·²ç»å¯ä»¥è¯»å–äº†ï¼Œ <code>end</code>  äº‹ä»¶è¡¨ç¤ºè¿™ä¸ªæµå·²ç»åˆ°æœ«å°¾äº†ï¼Œæ²¡æœ‰æ•°æ®å¯ä»¥è¯»å–äº†ï¼Œ <code>error</code>  äº‹ä»¶è¡¨ç¤ºå‡ºé”™äº†ã€‚</p>
<h3 id="11-è¯»å–æµ"><a class="anchor" href="#11-è¯»å–æµ">#</a> 1.1 è¯»å–æµ</h3>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// åˆ›å»ºè¯»å–æµ</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">let</span> rs <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'hello.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'è¯»å–çš„æ–‡ä»¶å·²æ‰“å¼€'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'è¯»å–æµç»“æŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token comment">// æ¯ä¸€æ‰¹æ•°æ®æµå…¥å®Œæˆ</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å•æ‰¹æ•°æ®æµå…¥:'</span> <span class="token operator">+</span> chunk<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>è¦æ³¨æ„ï¼Œ <code>data</code>  äº‹ä»¶å¯èƒ½ä¼šæœ‰å¤šæ¬¡ï¼Œæ¯æ¬¡ä¼ é€’çš„ <code>chunk</code>  æ˜¯æµçš„ä¸€éƒ¨åˆ†æ•°æ®ã€‚</p>
<p><strong>è¯»å–è§†é¢‘</strong></p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// åˆ›å»ºè¯»å–æµ</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">let</span> rs <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'video.mp4'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// æ¯ä¸€æ‰¹æ•°æ®æµå…¥å®Œæˆ</span></pre></td></tr><tr><td data-num="7"></td><td><pre>rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å•æ‰¹æ•°æ®æµå…¥:'</span> <span class="token operator">+</span> chunk<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><img data-src="https://tva1.sinaimg.cn/large/0074UQWJgy1h3eigfl898j31750iztjs.jpg" alt="" /></p>
<h3 id="12-å†™å…¥æµ"><a class="anchor" href="#12-å†™å…¥æµ">#</a> 1.2 å†™å…¥æµ</h3>
<p>è¦ä»¥æµçš„å½¢å¼å†™å…¥æ–‡ä»¶ï¼Œåªéœ€è¦ä¸æ–­è°ƒç”¨ <code>write()</code>  æ–¹æ³•ï¼Œæœ€åä»¥ <code>end()</code>  ç»“æŸï¼š</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// åˆ›å»ºå†™å…¥æµ</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">let</span> ws <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'hello.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// ç›‘å¬æ–‡ä»¶æ‰“å¼€äº‹ä»¶</span></pre></td></tr><tr><td data-num="7"></td><td><pre>ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ–‡ä»¶æ‰“å¼€'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// ç›‘å¬æ–‡ä»¶å…³é—­äº‹ä»¶</span></pre></td></tr><tr><td data-num="12"></td><td><pre>ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ–‡ä»¶å†™å…¥å®Œæˆï¼Œå…³é—­'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// æ–‡ä»¶æµå¼å†™å…¥</span></pre></td></tr><tr><td data-num="17"></td><td><pre>ws<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'helloworld1!'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å†…å®¹1æµå…¥å®Œæˆ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>ws<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'helloworld2!'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å†…å®¹2æµå…¥å®Œæˆ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">// æ–‡ä»¶å†™å…¥å®Œæˆ</span></pre></td></tr><tr><td data-num="33"></td><td><pre>ws<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ–‡ä»¶å†™å…¥å…³é—­'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><code>pipe</code>  å°±åƒå¯ä»¥æŠŠä¸¤ä¸ªæ°´ç®¡ä¸²æˆä¸€ä¸ªæ›´é•¿çš„æ°´ç®¡ä¸€æ ·ï¼Œä¸¤ä¸ªæµä¹Ÿå¯ä»¥ä¸²èµ·æ¥ã€‚ä¸€ä¸ª <code>Readable</code>  æµå’Œä¸€ä¸ª <code>Writable</code>  æµä¸²èµ·æ¥åï¼Œæ‰€æœ‰çš„æ•°æ®è‡ªåŠ¨ä» <code>Readable</code>  æµè¿›å…¥ <code>Writable</code>  æµï¼Œè¿™ç§æ“ä½œå« <code>pipe</code> ã€‚</p>
<p>åœ¨ Node.js ä¸­ï¼Œ <code>Readable</code>  æµæœ‰ä¸€ä¸ª <code>pipe()</code>  æ–¹æ³•ï¼Œå°±æ˜¯ç”¨æ¥å¹²è¿™ä»¶äº‹çš„ã€‚</p>
<p>è®©æˆ‘ä»¬ç”¨ <code>pipe()</code>  æŠŠä¸€ä¸ªæ–‡ä»¶æµå’Œå¦ä¸€ä¸ªæ–‡ä»¶æµä¸²èµ·æ¥ï¼Œè¿™æ ·æºæ–‡ä»¶çš„æ‰€æœ‰æ•°æ®å°±è‡ªåŠ¨å†™å…¥åˆ°ç›®æ ‡æ–‡ä»¶é‡Œäº†ï¼Œæ‰€ä»¥ï¼Œè¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¤åˆ¶æ–‡ä»¶çš„ç¨‹åºï¼š</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// åˆ›å»ºè¯»å–æµ</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">let</span> rs <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'video.mp4'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">let</span> ws <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'b.mp4'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'è¯»å–æµç»“æŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>rs<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>ws<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>pipe åŸç†</strong></p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// åˆ›å»ºè¯»å–æµ</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">let</span> rs <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'video.mp4'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">let</span> ws <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'b.mp4'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  ws<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'è¯»å–æµç»“æŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// æ¯ä¸€æ‰¹æ•°æ®æµå…¥å®Œæˆ</span></pre></td></tr><tr><td data-num="13"></td><td><pre>rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å•æ‰¹æ•°æ®æµå…¥:'</span> <span class="token operator">+</span> chunk<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  ws<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>chunk<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å•æ‰¹è¾“å…¥æµå…¥å®Œæˆ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="2èµ„æºå‹ç¼©æ¨¡å—-zib"><a class="anchor" href="#2èµ„æºå‹ç¼©æ¨¡å—-zib">#</a> 2. èµ„æºå‹ç¼©æ¨¡å— zib</h2>
<h3 id="21-æ¦‚è§ˆ"><a class="anchor" href="#21-æ¦‚è§ˆ">#</a> 2.1 æ¦‚è§ˆ</h3>
<p>åšè¿‡ web æ€§èƒ½ä¼˜åŒ–çš„åŒå­¦ï¼Œå¯¹æ€§èƒ½ä¼˜åŒ–å¤§æ€å™¨<strong> gzip</strong> åº”è¯¥ä¸é™Œç”Ÿã€‚æµè§ˆå™¨å‘æœåŠ¡å™¨å‘èµ·èµ„æºè¯·æ±‚ï¼Œæ¯”å¦‚ä¸‹è½½ä¸€ä¸ª js æ–‡ä»¶ï¼ŒæœåŠ¡å™¨å…ˆå¯¹èµ„æºè¿›è¡Œå‹ç¼©ï¼Œå†è¿”å›ç»™æµè§ˆå™¨ï¼Œä»¥æ­¤èŠ‚çœæµé‡ï¼ŒåŠ å¿«è®¿é—®é€Ÿåº¦ã€‚</p>
<p>æµè§ˆå™¨é€šè¿‡ HTTP è¯·æ±‚å¤´éƒ¨é‡ŒåŠ ä¸Š<strong> Accept-Encoding</strong>ï¼Œå‘Šè¯‰æœåŠ¡å™¨ï¼Œâ€œä½ å¯ä»¥ç”¨ gzipï¼Œæˆ–è€… defalte ç®—æ³•å‹ç¼©èµ„æºâ€ã€‚</p>
<blockquote>
<p>Accept-Encoding:gzip, deflate</p>
</blockquote>
<p>é‚£ä¹ˆï¼Œåœ¨ nodejs é‡Œï¼Œæ˜¯å¦‚ä½•å¯¹èµ„æºè¿›è¡Œå‹ç¼©çš„å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯<strong> Zlib</strong> æ¨¡å—ã€‚=</p>
<h3 id="22-å‹ç¼©çš„ä¾‹å­"><a class="anchor" href="#22-å‹ç¼©çš„ä¾‹å­">#</a> 2.2 å‹ç¼©çš„ä¾‹å­</h3>
<p>éå¸¸ç®€å•çš„å‡ è¡Œä»£ç ï¼Œå°±å®Œæˆäº†æœ¬åœ°æ–‡ä»¶çš„ gzip å‹ç¼©ã€‚</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> zlib <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'zlib'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> gzip <span class="token operator">=</span> zlib<span class="token punctuation">.</span><span class="token function">createGzip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">var</span> readstream <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'./extra/fileForCompress.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">var</span> writestream <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'./extra/fileForCompress.txt.gz'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>readstream<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gzip<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>writestream<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="23-è§£å‹çš„ä¾‹å­"><a class="anchor" href="#23-è§£å‹çš„ä¾‹å­">#</a> 2.3 è§£å‹çš„ä¾‹å­</h3>
<p>åŒæ ·éå¸¸ç®€å•ï¼Œå°±æ˜¯ä¸ªåå‘æ“ä½œã€‚</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> zlib <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'zlib'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> gunzip <span class="token operator">=</span> zlib<span class="token punctuation">.</span><span class="token function">createGunzip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">var</span> readstream  <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'./extra/fileForCompress.txt.gz'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">var</span> writestream  <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'./extra/fileForCompress1.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>readstream<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gunzip<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>writestream<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="24-æœåŠ¡ç«¯gzipå‹ç¼©"><a class="anchor" href="#24-æœåŠ¡ç«¯gzipå‹ç¼©">#</a> 2.4 æœåŠ¡ç«¯ gzip å‹ç¼©</h3>
<p>é¦–å…ˆåˆ¤æ–­ æ˜¯å¦åŒ…å« <strong>accept-encoding</strong> é¦–éƒ¨ï¼Œä¸”å€¼ä¸º<strong> gzip</strong>ã€‚</p>
<ul>
<li>å¦ï¼šè¿”å›æœªå‹ç¼©çš„æ–‡ä»¶ã€‚</li>
<li>æ˜¯ï¼šè¿”å› gzip å‹ç¼©åçš„æ–‡ä»¶ã€‚</li>
</ul>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> zlib <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'zlib'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> filepath <span class="token operator">=</span> <span class="token string">'./extra/fileForGzip.html'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">var</span> acceptEncoding <span class="token operator">=</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'accept-encoding'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">var</span> gzip<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    </pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>acceptEncoding<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'gzip'</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">// åˆ¤æ–­æ˜¯å¦éœ€è¦ gzip å‹ç¼©</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        </pre></td></tr><tr><td data-num="12"></td><td><pre>        gzip <span class="token operator">=</span> zlib<span class="token punctuation">.</span><span class="token function">createGzip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        </pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token comment">// è®°å¾—å“åº” Content-Encodingï¼Œå‘Šè¯‰æµè§ˆå™¨ï¼šæ–‡ä»¶è¢« gzip å‹ç¼©è¿‡</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            <span class="token string-property property">'Content-Encoding'</span><span class="token operator">:</span> <span class="token string">'gzip'</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span>filepath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gzip<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    </pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>        fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span>filepath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">'3000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>å°† js å¤§æ–‡ä»¶è¿”å›</strong></p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> zlib <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'zlib'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è¿™ä¸¤ä¸ªè¦å†™åœ¨ fs æ¨¡å—åé¢</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> gzip <span class="token operator">=</span> zlib<span class="token punctuation">.</span><span class="token function">createGzip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>http</pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">let</span> rs <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'hello.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/x-javascript;charset=utf-8'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token string-property property">'Content-Encoding'</span><span class="token operator">:</span> <span class="token string">'gzip'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    rs<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gzip<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'server start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="25-æœåŠ¡ç«¯å­—ç¬¦ä¸²gzipå‹ç¼©"><a class="anchor" href="#25-æœåŠ¡ç«¯å­—ç¬¦ä¸²gzipå‹ç¼©">#</a> 2.5 æœåŠ¡ç«¯å­—ç¬¦ä¸² gzip å‹ç¼©</h3>
<p>ä»£ç è·Ÿå‰é¢ä¾‹å­å¤§åŒå°å¼‚ã€‚è¿™é‡Œé‡‡ç”¨äº† <strong>zlib.gzipSync(str)</strong> å¯¹å­—ç¬¦ä¸²è¿›è¡Œ gzip å‹ç¼©ã€‚</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> zlib <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'zlib'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> responseText <span class="token operator">=</span> <span class="token string">'hello world'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">var</span> acceptEncoding <span class="token operator">=</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'accept-encoding'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>acceptEncoding<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'gzip'</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>            <span class="token string-property property">'content-encoding'</span><span class="token operator">:</span> <span class="token string">'gzip'</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>zlib<span class="token punctuation">.</span><span class="token function">gzipSync</span><span class="token punctuation">(</span>responseText<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">'3000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="3æ•°æ®åŠ å¯†æ¨¡å—-crypto"><a class="anchor" href="#3æ•°æ®åŠ å¯†æ¨¡å—-crypto">#</a> 3. æ•°æ®åŠ å¯†æ¨¡å— crypto</h2>
<p>crypto æ¨¡å—çš„ç›®çš„æ˜¯ä¸ºäº†æä¾›é€šç”¨çš„åŠ å¯†å’Œå“ˆå¸Œç®—æ³•ã€‚ç”¨çº¯ JavaScript ä»£ç å®ç°è¿™äº›åŠŸèƒ½ä¸æ˜¯ä¸å¯èƒ½ï¼Œä½†é€Ÿåº¦ä¼šéå¸¸æ…¢ã€‚Nodejs ç”¨ C/C++ å®ç°è¿™äº›ç®—æ³•åï¼Œé€šè¿‡ cypto è¿™ä¸ªæ¨¡å—æš´éœ²ä¸º JavaScript æ¥å£ï¼Œè¿™æ ·ç”¨èµ·æ¥æ–¹ä¾¿ï¼Œè¿è¡Œé€Ÿåº¦ä¹Ÿå¿«ã€‚</p>
<h3 id="31-hashä¾‹å­"><a class="anchor" href="#31-hashä¾‹å­">#</a> 3.1 hash ä¾‹å­</h3>
<p>hash.digest ([encoding])ï¼šè®¡ç®—æ‘˜è¦ã€‚encoding å¯ä»¥æ˜¯ <code>hex</code> ã€ <code>latin1</code>  æˆ–è€… <code>base64</code> ã€‚å¦‚æœå£°æ˜äº† encodingï¼Œé‚£ä¹ˆè¿”å›å­—ç¬¦ä¸²ã€‚å¦åˆ™ï¼Œè¿”å› Buffer å®ä¾‹ã€‚æ³¨æ„ï¼Œè°ƒç”¨ hash.digest () åï¼Œhash å¯¹è±¡å°±ä½œåºŸäº†ï¼Œå†æ¬¡è°ƒç”¨å°±ä¼šå‡ºé”™ã€‚</p>
<p>hash.update (data [, input_encoding])ï¼šinput_encoding å¯ä»¥æ˜¯ <code>utf8</code> ã€ <code>ascii</code>  æˆ–è€… <code>latin1</code> ã€‚å¦‚æœ data æ˜¯å­—ç¬¦ä¸²ï¼Œä¸”æ²¡æœ‰æŒ‡å®š input_encodingï¼Œåˆ™é»˜è®¤æ˜¯ <code>utf8</code> ã€‚æ³¨æ„ï¼Œhash.update () æ–¹æ³•å¯ä»¥è°ƒç”¨å¤šæ¬¡ã€‚</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./test.txt'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token string">'utf8'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">var</span> hash <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'sha256'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">var</span> output<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>hash<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>output <span class="token operator">=</span> hash<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">// è¾“å‡ºå†…å®¹ä¸ºï¼š</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9</span></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥è¿™æ ·ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> input <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'./test.txt'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token string">'utf8'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">var</span> hash <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'sha256'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>hash<span class="token punctuation">.</span><span class="token function">setEncoding</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>input<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>hash<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// è¾“å‡ºå†…å®¹ä¸ºï¼š</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9</span></pre></td></tr></table></figure><p>hash.digest () åï¼Œå†æ¬¡è°ƒç”¨ digest () æˆ–è€… update ()</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./test.txt'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token string">'utf8'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">var</span> hash <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'sha256'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">var</span> output<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>hash<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>hash<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// æŠ¥é”™ï¼šError: Digest already called</span></pre></td></tr><tr><td data-num="12"></td><td><pre>hash<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// æŠ¥é”™ï¼šError: Digest already called</span></pre></td></tr><tr><td data-num="15"></td><td><pre>hash<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="32-hmacä¾‹å­"><a class="anchor" href="#32-hmacä¾‹å­">#</a> 3.2 HMAC ä¾‹å­</h3>
<p>HMAC çš„å…¨ç§°æ˜¯ Hash-based Message Authentication Codeï¼Œä¹Ÿå³åœ¨ hash çš„åŠ ç›è¿ç®—ã€‚</p>
<p>å…·ä½“åˆ°ä½¿ç”¨çš„è¯ï¼Œè·Ÿ hash æ¨¡å—å·®ä¸å¤šï¼Œé€‰å®š hash ç®—æ³•ï¼ŒæŒ‡å®š â€œç›â€ å³å¯ã€‚</p>
<p>ä¾‹å­ 1ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> secret <span class="token operator">=</span> <span class="token string">'secret'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">var</span> hmac <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHmac</span><span class="token punctuation">(</span><span class="token string">'sha256'</span><span class="token punctuation">,</span> secret<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">var</span> input <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./test.txt'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token string">'utf8'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>hmac<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> hmac<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// è¾“å‡ºï¼š</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 734cc62f32841568f45715aeb9f4d7891324e6d948e4c6c60c0621cdac48623a</span></pre></td></tr></table></figure><p>ä¾‹å­ 2ï¼š</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> secret <span class="token operator">=</span> <span class="token string">'secret'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">var</span> hmac <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHmac</span><span class="token punctuation">(</span><span class="token string">'sha256'</span><span class="token punctuation">,</span> secret<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">var</span> input <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'./test.txt'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token string">'utf8'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>hmac<span class="token punctuation">.</span><span class="token function">setEncoding</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>input<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>hmac<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// è¾“å‡ºï¼š</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 734cc62f32841568f45715aeb9f4d7891324e6d948e4c6c60c0621cdac48623a</span></pre></td></tr></table></figure><h3 id="33-md5ä¾‹å­"><a class="anchor" href="#33-md5ä¾‹å­">#</a> 3.3 MD5 ä¾‹å­</h3>
<p>MD5ï¼ˆMessage-Digest Algorithmï¼‰æ˜¯è®¡ç®—æœºå®‰å…¨é¢†åŸŸå¹¿æ³›ä½¿ç”¨çš„æ•£åˆ—å‡½æ•°ï¼ˆåˆç§°å“ˆå¸Œç®—æ³•ã€æ‘˜è¦ç®—æ³•ï¼‰ï¼Œä¸»è¦ç”¨æ¥ç¡®ä¿æ¶ˆæ¯çš„å®Œæ•´å’Œä¸€è‡´æ€§ã€‚å¸¸è§çš„åº”ç”¨åœºæ™¯æœ‰å¯†ç ä¿æŠ¤ã€ä¸‹è½½æ–‡ä»¶æ ¡éªŒç­‰ã€‚</p>
<p><strong>ç‰¹ç‚¹</strong></p>
<ol>
<li>è¿ç®—é€Ÿåº¦å¿«ï¼šå¯¹ <code>jquery.js</code>  æ±‚ md5 å€¼ï¼Œ57254 ä¸ªå­—ç¬¦ï¼Œè€—æ—¶ 1.907ms</li>
<li>è¾“å‡ºé•¿åº¦å›ºå®šï¼šè¾“å…¥é•¿åº¦ä¸å›ºå®šï¼Œè¾“å‡ºé•¿åº¦å›ºå®šï¼ˆ128 ä½ï¼‰ã€‚</li>
<li>è¿ç®—ä¸å¯é€†ï¼šå·²çŸ¥è¿ç®—ç»“æœçš„æƒ…å†µä¸‹ï¼Œæ— æ³•é€šè¿‡é€šè¿‡é€†è¿ç®—å¾—åˆ°åŸå§‹å­—ç¬¦ä¸²ã€‚</li>
<li>é«˜åº¦ç¦»æ•£ï¼šè¾“å…¥çš„å¾®å°å˜åŒ–ï¼Œå¯å¯¼è‡´è¿ç®—ç»“æœå·®å¼‚å·¨å¤§ã€‚</li>
<li>å¼±ç¢°æ’æ€§ï¼šä¸åŒè¾“å…¥çš„æ•£åˆ—å€¼å¯èƒ½ç›¸åŒã€‚</li>
</ol>
<p><strong>åº”ç”¨åœºæ™¯</strong></p>
<ol>
<li>æ–‡ä»¶å®Œæ•´æ€§æ ¡éªŒï¼šæ¯”å¦‚ä»ç½‘ä¸Šä¸‹è½½ä¸€ä¸ªè½¯ä»¶ï¼Œä¸€èˆ¬ç½‘ç«™éƒ½ä¼šå°†è½¯ä»¶çš„ md5 å€¼é™„åœ¨ç½‘é¡µä¸Šï¼Œç”¨æˆ·ä¸‹è½½å®Œè½¯ä»¶åï¼Œå¯å¯¹ä¸‹è½½åˆ°æœ¬åœ°çš„è½¯ä»¶è¿›è¡Œ md5 è¿ç®—ï¼Œç„¶åè·Ÿç½‘ç«™ä¸Šçš„ md5 å€¼è¿›è¡Œå¯¹æ¯”ï¼Œç¡®ä¿ä¸‹è½½çš„è½¯ä»¶æ˜¯å®Œæ•´çš„ï¼ˆæˆ–æ­£ç¡®çš„ï¼‰</li>
<li>å¯†ç ä¿æŠ¤ï¼šå°† md5 åçš„å¯†ç ä¿å­˜åˆ°æ•°æ®åº“ï¼Œè€Œä¸æ˜¯ä¿å­˜æ˜æ–‡å¯†ç ï¼Œé¿å…æ‹–åº“ç­‰äº‹ä»¶å‘ç”Ÿåï¼Œæ˜æ–‡å¯†ç å¤–æ³„ã€‚</li>
<li>é˜²ç¯¡æ”¹ï¼šæ¯”å¦‚æ•°å­—è¯ä¹¦çš„é˜²ç¯¡æ”¹ï¼Œå°±ç”¨åˆ°äº†æ‘˜è¦ç®—æ³•ã€‚ï¼ˆå½“ç„¶è¿˜è¦ç»“åˆæ•°å­—ç­¾åç­‰æ‰‹æ®µï¼‰</li>
</ol>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">var</span> md5 <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'md5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">var</span> result <span class="token operator">=</span> md5<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// è¾“å‡ºï¼š0cc175b9c0f1b6a831c399e269772661</span></pre></td></tr><tr><td data-num="7"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="34-ä¾‹å­å¯†ç ä¿æŠ¤"><a class="anchor" href="#34-ä¾‹å­å¯†ç ä¿æŠ¤">#</a> 3.4 ä¾‹å­ï¼šå¯†ç ä¿æŠ¤</h3>
<p>å‰é¢æåˆ°ï¼Œå°†æ˜æ–‡å¯†ç ä¿å­˜åˆ°æ•°æ®åº“æ˜¯å¾ˆä¸å®‰å…¨çš„ï¼Œæœ€ä¸æµä¹Ÿè¦è¿›è¡Œ md5 åè¿›è¡Œä¿å­˜ã€‚æ¯”å¦‚ç”¨æˆ·å¯†ç æ˜¯ <code>123456</code> ï¼Œmd5 è¿è¡Œåï¼Œå¾—åˆ° <code>è¾“å‡ºï¼še10adc3949ba59abbe56e057f20f883e</code> ã€‚</p>
<p>è¿™æ ·è‡³å°‘æœ‰ä¸¤ä¸ªå¥½å¤„ï¼š</p>
<ol>
<li>é˜²å†…éƒ¨æ”»å‡»ï¼šç½‘ç«™ä¸»äººä¹Ÿä¸çŸ¥é“ç”¨æˆ·çš„æ˜æ–‡å¯†ç ï¼Œé¿å…ç½‘ç«™ä¸»äººæ‹¿ç€ç”¨æˆ·æ˜æ–‡å¯†ç å¹²åäº‹ã€‚</li>
<li>é˜²å¤–éƒ¨æ”»å‡»ï¼šå¦‚ç½‘ç«™è¢«é»‘å®¢å…¥ä¾µï¼Œé»‘å®¢ä¹Ÿåªèƒ½æ‹¿åˆ° md5 åçš„å¯†ç ï¼Œè€Œä¸æ˜¯ç”¨æˆ·çš„æ˜æ–‡å¯†ç ã€‚</li>
</ol>
<p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">function</span> <span class="token function">cryptPwd</span><span class="token punctuation">(</span><span class="token parameter">password</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">var</span> md5 <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'md5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">return</span> md5<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">var</span> password <span class="token operator">=</span> <span class="token string">'123456'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">var</span> cryptedPassword <span class="token operator">=</span> <span class="token function">cryptPwd</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cryptedPassword<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// è¾“å‡ºï¼še10adc3949ba59abbe56e057f20f883e</span></pre></td></tr></table></figure><p><strong>å•çº¯å¯¹å¯†ç è¿›è¡Œ md5 ä¸å®‰å…¨</strong></p>
<p>å‰é¢æåˆ°ï¼Œé€šè¿‡å¯¹ç”¨æˆ·å¯†ç è¿›è¡Œ md5 è¿ç®—æ¥æé«˜å®‰å…¨æ€§ã€‚ä½†å®é™…ä¸Šï¼Œè¿™æ ·çš„å®‰å…¨æ€§æ˜¯å¾ˆå·®çš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>ç¨å¾®ä¿®æ”¹ä¸‹ä¸Šé¢çš„ä¾‹å­ï¼Œå¯èƒ½ä½ å°±æ˜ç™½äº†ã€‚ç›¸åŒçš„æ˜æ–‡å¯†ç ï¼Œmd5 å€¼ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">function</span> <span class="token function">cryptPwd</span><span class="token punctuation">(</span><span class="token parameter">password</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">var</span> md5 <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'md5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">return</span> md5<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">var</span> password <span class="token operator">=</span> <span class="token string">'123456'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token function">cryptPwd</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// è¾“å‡ºï¼še10adc3949ba59abbe56e057f20f883e</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token function">cryptPwd</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// è¾“å‡ºï¼še10adc3949ba59abbe56e057f20f883e</span></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æ”»å‡»è€…çŸ¥é“ç®—æ³•æ˜¯ md5ï¼Œä¸”æ•°æ®åº“é‡Œå­˜å‚¨çš„å¯†ç å€¼ä¸º <code>e10adc3949ba59abbe56e057f20f883e</code>  æ—¶ï¼Œç†è®ºä¸Šå¯ä»¥å¯ä»¥çŒœåˆ°ï¼Œç”¨æˆ·çš„æ˜æ–‡å¯†ç å°±æ˜¯ <code>123456</code> ã€‚</p>
<p>äº‹å®ä¸Šï¼Œå½©è™¹è¡¨å°±æ˜¯è¿™ä¹ˆè¿›è¡Œæš´åŠ›ç ´è§£çš„ï¼šäº‹å…ˆå°†å¸¸è§æ˜æ–‡å¯†ç çš„ md5 å€¼è¿ç®—å¥½å­˜èµ·æ¥ï¼Œç„¶åè·Ÿç½‘ç«™æ•°æ®åº“é‡Œå­˜å‚¨çš„å¯†ç è¿›è¡ŒåŒ¹é…ï¼Œå°±èƒ½å¤Ÿå¿«é€Ÿæ‰¾åˆ°ç”¨æˆ·çš„æ˜æ–‡å¯†ç ã€‚ï¼ˆè¿™é‡Œä¸æ¢ç©¶å…·ä½“ç»†èŠ‚ï¼‰</p>
<p>é‚£ä¹ˆï¼Œæœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥è¿›ä¸€æ­¥æå‡å®‰å…¨æ€§å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼šå¯†ç åŠ ç›ã€‚</p>
<p><strong>å¯†ç åŠ ç›</strong></p>
<p>â€œåŠ ç›â€ è¿™ä¸ªè¯çœ‹ä¸Šå»å¾ˆç„ä¹ï¼Œå…¶å®åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨å¯†ç ç‰¹å®šä½ç½®æ’å…¥ç‰¹å®šå­—ç¬¦ä¸²åï¼Œå†å¯¹ä¿®æ”¹åçš„å­—ç¬¦ä¸²è¿›è¡Œ md5 è¿ç®—ã€‚</p>
<p>ä¾‹å­å¦‚ä¸‹ã€‚åŒæ ·çš„å¯†ç ï¼Œå½“ â€œç›â€ å€¼ä¸ä¸€æ ·æ—¶ï¼Œmd5 å€¼çš„å·®å¼‚éå¸¸å¤§ã€‚é€šè¿‡å¯†ç åŠ ç›ï¼Œå¯ä»¥é˜²æ­¢æœ€åˆçº§çš„æš´åŠ›ç ´è§£ï¼Œå¦‚æœæ”»å‡»è€…äº‹å…ˆä¸çŸ¥é“â€ ç› â€œå€¼ï¼Œç ´è§£çš„éš¾åº¦å°±ä¼šéå¸¸å¤§ã€‚</p>
<figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">function</span> <span class="token function">cryptPwd</span><span class="token punctuation">(</span><span class="token parameter">password<span class="token punctuation">,</span> salt</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment">// å¯†ç  â€œåŠ ç›â€</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">var</span> saltPassword <span class="token operator">=</span> password <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> salt<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'åŸå§‹å¯†ç ï¼š%s'</span><span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'åŠ ç›åçš„å¯†ç ï¼š%s'</span><span class="token punctuation">,</span> saltPassword<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token comment">// åŠ ç›å¯†ç çš„ md5 å€¼</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">var</span> md5 <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'md5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">var</span> result <span class="token operator">=</span> md5<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>saltPassword<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'åŠ ç›å¯†ç çš„md5å€¼ï¼š%s'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token function">cryptPwd</span><span class="token punctuation">(</span><span class="token string">'123456'</span><span class="token punctuation">,</span> <span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// è¾“å‡ºï¼š</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">// åŸå§‹å¯†ç ï¼š123456</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// åŠ ç›åçš„å¯†ç ï¼š123456:abc</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">// åŠ ç›å¯†ç çš„ md5 å€¼ï¼š51011af1892f59e74baf61f3d4389092</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token function">cryptPwd</span><span class="token punctuation">(</span><span class="token string">'123456'</span><span class="token punctuation">,</span> <span class="token string">'bcd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">// è¾“å‡ºï¼š</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">// åŸå§‹å¯†ç ï¼š123456</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment">// åŠ ç›åçš„å¯†ç ï¼š123456:bcd</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">// åŠ ç›å¯†ç çš„ md5 å€¼ï¼š55a95bcb6bfbaef6906dbbd264ab4531</span></pre></td></tr></table></figure><h1 id="09-åŸç”Ÿnodejsè·¯ç”±-è·å–å‚æ•°-é™æ€ç›®å½•"><a class="anchor" href="#09-åŸç”Ÿnodejsè·¯ç”±-è·å–å‚æ•°-é™æ€ç›®å½•">#</a> 09 ã€åŸç”Ÿ nodejs è·¯ç”±ã€è·å–å‚æ•°ã€é™æ€ç›®å½•ã€‘</h1>
<h2 id="1è·¯ç”±"><a class="anchor" href="#1è·¯ç”±">#</a> 1. è·¯ç”±</h2>
<p><strong>index.js</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// å¯åŠ¨æœåŠ¡</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./server.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// è·¯ç”±æ¨¡å—</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./route.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">//api</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">const</span> apiRouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./api.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>route<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>apiRouter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>server<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>server.js</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// åˆ›å»ºä¸€ä¸ªå¤§å¯¹è±¡å­˜å‚¨æ‰€æœ‰çš„è·¯ç”±å’Œ api</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// å°†æ‰€æœ‰è·¯ç”±å’Œ api åˆå¹¶çš„å‡½æ•°</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">function</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">routeObj</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>route<span class="token punctuation">,</span> routeObj<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  http</pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token string">'http://127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      route<span class="token punctuation">[</span>url<span class="token punctuation">.</span>pathname<span class="token punctuation">]</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å¯åŠ¨æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  use<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  start<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>route.js</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> path<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>type <span class="token operator">?</span> type <span class="token operator">:</span> <span class="token string">'text/html'</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">;charset=utf8</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token string">'/login'</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token function">render</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">'./static/login.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token string">'/home'</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token function">render</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">'./static/home.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token string">'/favicon.ico'</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token function">render</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">'./static/favicon.ico'</span><span class="token punctuation">,</span> <span class="token string">'image/x-icon'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token string">'/404'</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/html;charset=utf8'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./static/404.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> route<span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>api.js</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> data<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>type <span class="token operator">?</span> type <span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">;charset=utf8</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">const</span> apiRouter <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token string">'/api/login'</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token function">render</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">'&#123; ok: 1 &#125;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> apiRouter<span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="2è·å–å‚æ•°"><a class="anchor" href="#2è·å–å‚æ•°">#</a> 2. è·å–å‚æ•°</h2>
<p><strong>api.js</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> data<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>type <span class="token operator">?</span> type <span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">;charset=utf8</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">const</span> apiRouter <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token comment">//get è¯·æ±‚</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token string">'/api/login'</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token string">'http://127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">let</span> username <span class="token operator">=</span> url<span class="token punctuation">.</span>searchParams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">let</span> password <span class="token operator">=</span> url<span class="token punctuation">.</span>searchParams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">===</span> <span class="token string">'ds'</span> <span class="token operator">&amp;&amp;</span> password <span class="token operator">===</span> <span class="token string">'123'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token literal-property property">ok</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token literal-property property">ok</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="21"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token function">render</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token comment">//post è¯·æ±‚</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  <span class="token string">'/api/loginpost'</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token string">'http://127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token comment">// è¿™é‡Œä½¿ç”¨æœ€åŸå§‹çš„æ–¹æ³•è·å– post è¯·æ±‚å‚æ•°</span></pre></td></tr><tr><td data-num="30"></td><td><pre>      <span class="token comment">// é€šè¿‡ req çš„ data äº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œæ¯å½“æ¥å—åˆ°è¯·æ±‚ä½“çš„æ•°æ®ï¼Œå°±ç´¯åŠ åˆ° post å˜é‡ä¸­</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token parameter">chunk</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>      data <span class="token operator">+=</span> chunk<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>       <span class="token comment">// åœ¨ end äº‹ä»¶è§¦å‘åï¼Œé€šè¿‡ querystring.parse å°† post è§£æä¸ºçœŸæ­£çš„ POST è¯·æ±‚æ ¼å¼ï¼Œç„¶åå‘å®¢æˆ·ç«¯è¿”å›ã€‚</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>      data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>username <span class="token operator">===</span> <span class="token string">'ds'</span> <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span>password <span class="token operator">===</span> <span class="token string">'123'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token function">render</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">ok</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token function">render</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">ok</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> apiRouter<span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>è¯·æ±‚.js</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>login<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>        <span class="token comment">//get è¯·æ±‚</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/login?username=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>username<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&amp;password=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>password<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>          <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  loginpost<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token comment">//post è¯·æ±‚</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/loginpost</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token literal-property property">username</span><span class="token operator">:</span> username<span class="token punctuation">.</span>value<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token literal-property property">password</span><span class="token operator">:</span> password<span class="token punctuation">.</span>value<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="3é™æ€ç›®å½•"><a class="anchor" href="#3é™æ€ç›®å½•">#</a> 3. é™æ€ç›®å½•</h2>
<p><strong>server.js</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">function</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">routeObj</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>route<span class="token punctuation">,</span> routeObj<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">function</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  http</pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token string">'http://127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        route<span class="token punctuation">[</span>url<span class="token punctuation">.</span>pathname<span class="token punctuation">]</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>          <span class="token comment">// ä½¿æ‰€æœ‰åŒ¹é…ä¸åˆ°çš„è·¯å¾„èµ° 404 ç½‘é¡µ</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        route<span class="token punctuation">[</span><span class="token string">'/404'</span><span class="token punctuation">]</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å¯åŠ¨æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  use<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  start<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>route.js</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// æ ¹æ®æ–‡ä»¶åç¼€åè‡ªåŠ¨è·å–å“åº”å¤´ä¸­ content-type</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> mime <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mime'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> path<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>type <span class="token operator">?</span> type <span class="token operator">:</span> <span class="token string">'text/html'</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">;charset=utf8</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token string">'/login'</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token function">render</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">'./static/login.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token string">'/home'</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token function">render</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">'./static/home.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token string">'/404'</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token string">'http://127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>     <span class="token comment">/*</pre></td></tr><tr><td data-num="22"></td><td><pre>     &lt;link href='/css/index.css'>&lt;/link > æ ¹è·¯å¾„è®¿é—®ï¼Œå°±ç­‰äº 127.0.0.1:3000/css/index.cssã€‚</pre></td></tr><tr><td data-num="23"></td><td><pre>     è¿™é‡Œå°†é¡¹ç›®æ–‡ä»¶å¤¹ F:// é¡¹ç›® + static+/css/index.css åˆå¹¶æˆæ–‡ä»¶è·¯å¾„ï¼Œå¦‚æœå­˜åœ¨å°±è¯»å–è¯¥æ–‡ä»¶è¿”å›</pre></td></tr><tr><td data-num="24"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">let</span> pathname <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'static'</span><span class="token punctuation">,</span> url<span class="token punctuation">.</span>pathname<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">readStaticFile</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> pathname<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>      <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/html;charset=utf8'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./static/404.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">function</span> <span class="token function">readStaticFile</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> pathname</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>  <span class="token keyword">let</span> houzhui <span class="token operator">=</span> pathname<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token comment">// å¦‚æœå­˜åœ¨è¿™äº›é™æ€èµ„æºå°±ç”¨ fs çš„å†™å…¥æ–¹æ³•è¿”å›å›å»ï¼Œä¸èµ° 404</span></pre></td></tr><tr><td data-num="38"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>pathname<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>      <span class="token comment">//mime.getType(css)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token function">render</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> pathname<span class="token punctuation">,</span> mime<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span>houzhui<span class="token punctuation">[</span>houzhui<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> route<span class="token punctuation">;</span></pre></td></tr></table></figure>
      <div class="tags">
          <a href="/tags/node-js/" rel="tag"><i class="ic i-tag"></i> node.js</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">æ›´æ–°äº</span>
    <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-07-09 13:16:59" itemprop="dateModified" datetime="2024-07-09T13:16:59+08:00">2024-07-09</time>
  </span>
  <span id="2024/01/02/node.jså†…ç½®æ¨¡å—/" class="item leancloud_visitors" data-flag-title="node.jså†…ç½®æ¨¡å—" title="é˜…è¯»æ¬¡æ•°">
      <span class="icon">
        <i class="ic i-eye"></i>
      </span>
      <span class="text">é˜…è¯»æ¬¡æ•°</span>
      <span class="leancloud-visitors-count"></span>
      <span class="text">æ¬¡</span>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> èµèµ</button>
  <p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="dmq å¾®ä¿¡æ”¯ä»˜">
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="dmq æ”¯ä»˜å®">
        <p>æ”¯ä»˜å®</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>dmq <i class="ic i-at"><em>@</em></i>æœæ˜æ¸…çš„ä¸ªäººåšå®¢
  </li>
  <li class="link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://dmqweb.cn/2024/01/02/node.js%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/" title="node.jså†…ç½®æ¨¡å—">https://dmqweb.cn/2024/01/02/node.jså†…ç½®æ¨¡å—/</a>
  </li>
  <li class="license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2024/01/02/%E7%BC%93%E5%AD%98%E3%80%81%E5%86%85%E5%AD%98%E3%80%81CPU%E7%9F%A5%E8%AF%86%E7%82%B9%E8%A7%A3%E6%9E%90%E7%AC%94%E8%AE%B0/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s3.uuu.ovh&#x2F;imgs&#x2F;2024&#x2F;04&#x2F;04&#x2F;61e9f78d997bc7c9.webp" title="è®¡ç»„çŸ¥è¯†ç‚¹">
  <span class="type">ä¸Šä¸€ç¯‡</span>
  <span class="category"><i class="ic i-flag"></i> è®¡ç®—æœºç»„æˆåŸç†</span>
  <h3>è®¡ç»„çŸ¥è¯†ç‚¹</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2024/01/10/%E6%AD%A3%E5%88%99/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s3.uuu.ovh&#x2F;imgs&#x2F;2024&#x2F;04&#x2F;07&#x2F;6e43985af4997748.jpg" title="æ­£åˆ™ç†å¿µ">
  <span class="type">ä¸‹ä¸€ç¯‡</span>
  <span class="category"><i class="ic i-flag"></i> æ­£åˆ™è¡¨è¾¾å¼</span>
  <h3>æ­£åˆ™ç†å¿µ</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#05-nodejs%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97%E4%B8%8A"><span class="toc-number">1.</span> <span class="toc-text"> 05 ã€nodejs å†…ç½®æ¨¡å—ï¼ˆä¸Šï¼‰ã€‘</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#nodejs-%E7%9A%84%E5%AE%98%E6%96%B9api%E6%96%87%E6%A1%A3"><span class="toc-number">1.1.</span> <span class="toc-text"> nodejs çš„å®˜æ–¹ API æ–‡æ¡£</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nodejs-%E4%B8%AD%E6%A8%A1%E5%9D%97%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">1.2.</span> <span class="toc-text"> nodejs ä¸­æ¨¡å—çš„åˆ†ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97"><span class="toc-number">1.2.1.</span> <span class="toc-text"> å†…ç½®æ¨¡å—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#require-%E5%8A%A0%E8%BD%BD%E7%AC%AC%E4%B8%89%E6%96%B9%E5%8C%85%E7%9A%84%E6%9C%BA%E5%88%B6"><span class="toc-number">1.2.2.</span> <span class="toc-text"> require åŠ è½½ç¬¬ä¸‰æ–¹åŒ…çš„æœºåˆ¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9D%97module"><span class="toc-number">1.2.3.</span> <span class="toc-text"> è‡ªå®šä¹‰æ¨¡å—ï¼ˆmoduleï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1-http"><span class="toc-number">1.3.</span> <span class="toc-text"> ç½‘ç»œæœåŠ¡ http</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#http%E6%A8%A1%E5%9D%97%E6%A6%82%E8%A7%88"><span class="toc-number">1.3.1.</span> <span class="toc-text"> http æ¨¡å—æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-number">1.3.2.</span> <span class="toc-text"> ä¸€ä¸ªç®€å•çš„ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90%E8%A7%A3%E9%87%8A"><span class="toc-number">1.3.3.</span> <span class="toc-text"> ä¾‹å­è§£é‡Š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E4%BA%8Ehttpincomingmessage-httpserverresponse"><span class="toc-number">1.3.4.</span> <span class="toc-text"> å…³äº http.IncomingMessageã€http.ServerResponse</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1-http-res"><span class="toc-number">1.4.</span> <span class="toc-text"> ç½‘ç»œæœåŠ¡ http res</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%A7%88"><span class="toc-number">1.4.1.</span> <span class="toc-text"> æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-number">1.4.2.</span> <span class="toc-text"> ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E7%8A%B6%E6%80%81%E4%BB%A3%E7%A0%81-%E7%8A%B6%E6%80%81%E6%8F%8F%E8%BF%B0%E4%BF%A1%E6%81%AF"><span class="toc-number">1.4.3.</span> <span class="toc-text"> è®¾ç½®çŠ¶æ€ä»£ç ã€çŠ¶æ€æè¿°ä¿¡æ¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8"><span class="toc-number">1.4.4.</span> <span class="toc-text"> è®¾ç½®å“åº”å¤´éƒ¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">1.4.5.</span> <span class="toc-text"> å…¶ä»–å“åº”å¤´éƒ¨æ“ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%93%8D%E5%BA%94%E4%B8%BB%E4%BD%93"><span class="toc-number">1.4.6.</span> <span class="toc-text"> è®¾ç½®å“åº”ä¸»ä½“</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#responsewritechunk-encoding-callback"><span class="toc-number">1.4.6.1.</span> <span class="toc-text"> response.write(chunk[, encoding][, callback])</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#responseenddata-encoding-callback"><span class="toc-number">1.4.6.2.</span> <span class="toc-text"> response.end([data][, encoding][, callback])</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B6%85%E6%97%B6%E5%A4%84%E7%90%86"><span class="toc-number">1.4.7.</span> <span class="toc-text"> è¶…æ—¶å¤„ç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6-closefinish"><span class="toc-number">1.4.8.</span> <span class="toc-text"> äº‹ä»¶ close&#x2F;finish</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E4%B8%8D%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7%E6%96%B9%E6%B3%95"><span class="toc-number">1.4.9.</span> <span class="toc-text"> å…¶ä»–ä¸å¸¸ç”¨å±æ€§ &#x2F; æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1-http-req"><span class="toc-number">1.5.</span> <span class="toc-text"> ç½‘ç»œæœåŠ¡ http req</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%A7%88-2"><span class="toc-number">1.5.1.</span> <span class="toc-text"> æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E6%96%B9%E6%B3%95%E4%BA%8B%E4%BB%B6-%E5%88%86%E7%B1%BB"><span class="toc-number">1.5.2.</span> <span class="toc-text"> å±æ€§ &#x2F; æ–¹æ³• &#x2F; äº‹ä»¶ åˆ†ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-number">1.5.3.</span> <span class="toc-text"> æœåŠ¡ç«¯çš„ä¾‹å­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90%E4%B8%80%E8%8E%B7%E5%8F%96httpversionmethodurl"><span class="toc-number">1.5.3.1.</span> <span class="toc-text"> ä¾‹å­ä¸€ï¼šè·å– httpVersion&#x2F;method&#x2F;url</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90%E4%BA%8C%E8%8E%B7%E5%8F%96get%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="toc-number">1.5.3.2.</span> <span class="toc-text"> ä¾‹å­äºŒï¼šè·å– get è¯·æ±‚å‚æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90%E4%B8%89%E8%8E%B7%E5%8F%96post%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="toc-number">1.5.3.3.</span> <span class="toc-text"> ä¾‹å­ä¸‰ï¼šè·å– post è¯·æ±‚å‚æ•°</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1-https"><span class="toc-number">1.6.</span> <span class="toc-text"> ç½‘ç»œæœåŠ¡ https</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E6%A6%82%E8%A7%88"><span class="toc-number">1.6.1.</span> <span class="toc-text"> æ¨¡å—æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BE%8B%E5%AD%90"><span class="toc-number">1.6.2.</span> <span class="toc-text"> å®¢æˆ·ç«¯ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E4%BE%8B%E5%AD%90"><span class="toc-number">1.6.3.</span> <span class="toc-text"> æœåŠ¡ç«¯ä¾‹å­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E8%AF%81%E4%B9%A6"><span class="toc-number">1.6.3.1.</span> <span class="toc-text"> ç”Ÿæˆè¯ä¹¦</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#https%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-number">1.6.3.2.</span> <span class="toc-text"> HTTPS æœåŠ¡ç«¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#url-%E6%8E%A5%E5%8F%A3%E4%BB%A3%E6%9B%BF%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97url%E4%BD%BF%E7%94%A8"><span class="toc-number">1.7.</span> <span class="toc-text"> URL æ¥å£ (ä»£æ›¿å†…ç½®æ¨¡å— url ä½¿ç”¨)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#71-%E5%AF%B9%E6%AF%94url%E6%A8%A1%E5%9D%97%E5%92%8Curl%E7%B1%BB"><span class="toc-number">1.7.1.</span> <span class="toc-text"> 7.1 å¯¹æ¯” urlæ¨¡å— å’Œ URL ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.2.</span> <span class="toc-text"> æ„é€ å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E5%B1%9E%E6%80%A7"><span class="toc-number">1.7.3.</span> <span class="toc-text"> å®ä¾‹å±æ€§</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#urlsearchparams-%E5%AF%B9%E8%B1%A1%E4%BB%A3%E6%9B%BF%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97querystring%E4%BD%BF%E7%94%A8"><span class="toc-number">1.8.</span> <span class="toc-text"> URLSearchParams å¯¹è±¡ (ä»£æ›¿å†…ç½®æ¨¡å— querystring ä½¿ç”¨)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.8.1.</span> <span class="toc-text"> æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urlsearchparamstostring"><span class="toc-number">1.8.2.</span> <span class="toc-text"> URLSearchParams.toString()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urlsearchparamshas"><span class="toc-number">1.8.3.</span> <span class="toc-text"> URLSearchParams.has()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urlsearchparamsgeturlsearchparamsgetall"><span class="toc-number">1.8.4.</span> <span class="toc-text"> URLSearchParams.get()ï¼ŒURLSearchParams.getAll()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urlsearchparamskeysurlsearchparamsvaluesurlsearchparamsentries"><span class="toc-number">1.8.5.</span> <span class="toc-text"> URLSearchParams.keys()ï¼ŒURLSearchParams.values()ï¼ŒURLSearchParams.entries()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#qs%E6%A8%A1%E5%9D%97"><span class="toc-number">1.9.</span> <span class="toc-text"> qs æ¨¡å—</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#06-nodejs%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97%E4%B8%AD"><span class="toc-number">2.</span> <span class="toc-text"> 06 ã€nodejs å†…ç½®æ¨¡å—ï¼ˆä¸­ï¼‰ã€‘</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E8%B7%AF%E5%8A%B2%E5%A4%84%E7%90%86%E6%A8%A1%E5%9D%97-path"><span class="toc-number">2.1.</span> <span class="toc-text"> 1. è·¯åŠ²å¤„ç†æ¨¡å— path</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E6%A8%A1%E5%9D%97%E6%A6%82%E8%A7%88"><span class="toc-number">2.1.1.</span> <span class="toc-text"> 1.1 æ¨¡å—æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E8%8E%B7%E5%8F%96%E8%B7%AF%E5%BE%84%E6%96%87%E4%BB%B6%E5%90%8D%E6%89%A9%E5%B1%95%E5%90%8D"><span class="toc-number">2.1.2.</span> <span class="toc-text"> 1.2 è·å–è·¯å¾„ &#x2F; æ–‡ä»¶å &#x2F; æ‰©å±•å</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#121-%E8%8E%B7%E5%8F%96%E6%89%80%E5%9C%A8%E8%B7%AF%E5%BE%84"><span class="toc-number">2.1.2.1.</span> <span class="toc-text"> 1.2.1 è·å–æ‰€åœ¨è·¯å¾„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#122-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E5%90%8D"><span class="toc-number">2.1.2.2.</span> <span class="toc-text"> 1.2.2 è·å–æ–‡ä»¶å</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#123-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E6%89%A9%E5%B1%95%E5%90%8D"><span class="toc-number">2.1.2.3.</span> <span class="toc-text"> 1.2.3 è·å–æ–‡ä»¶æ‰©å±•å</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E8%B7%AF%E5%BE%84%E7%BB%84%E5%90%88"><span class="toc-number">2.1.3.</span> <span class="toc-text"> 1.3 è·¯å¾„ç»„åˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#131-pathresolve-%E7%94%9F%E6%88%90%E5%AE%8C%E6%88%90%E7%9A%84%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84"><span class="toc-number">2.1.3.1.</span> <span class="toc-text"> 1.3.1 path.resolve () ç”Ÿæˆå®Œæˆçš„ç»å¯¹è·¯å¾„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#132-pathjoin-%E5%B0%86%E5%A4%9A%E4%B8%AA%E8%B7%AF%E5%BE%84%E8%BF%9B%E8%A1%8C%E6%8B%BC%E6%8E%A5"><span class="toc-number">2.1.3.2.</span> <span class="toc-text"> 1.3.2 path.join () å°†å¤šä¸ªè·¯å¾„è¿›è¡Œæ‹¼æ¥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#133-pathresolve-%E5%92%8C-pathjoin-%E5%8C%BA%E5%88%AB"><span class="toc-number">2.1.3.3.</span> <span class="toc-text"> 1.3.3 path.resolve å’Œ path.join åŒºåˆ«</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-%E5%87%A0%E4%B8%AA%E5%B8%B8%E8%A7%81%E8%B7%AF%E5%BE%84"><span class="toc-number">2.1.4.</span> <span class="toc-text"> 1.4 å‡ ä¸ªå¸¸è§è·¯å¾„</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E6%A8%A1%E5%9D%97-fs"><span class="toc-number">2.2.</span> <span class="toc-text"> 2. æœ¬åœ°æ–‡ä»¶æ“ä½œæ¨¡å— fs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nodejs-%E4%B8%AD%E7%9A%84%E5%90%8C%E6%AD%A5%E5%92%8C%E5%BC%82%E6%AD%A5%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.2.1.</span> <span class="toc-text"> Node.js ä¸­çš„åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-number">2.2.2.</span> <span class="toc-text"> 2.1 æ–‡ä»¶è¯»å–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5"><span class="toc-number">2.2.3.</span> <span class="toc-text"> 2.2 æ–‡ä»¶å†™å…¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23-%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8"><span class="toc-number">2.2.4.</span> <span class="toc-text"> 2.3 æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.5.</span> <span class="toc-text"> 2.4 åˆ é™¤æ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25-%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95"><span class="toc-number">2.2.6.</span> <span class="toc-text"> 2.5 åˆ›å»ºç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26-%E9%81%8D%E5%8E%86%E7%9B%AE%E5%BD%95"><span class="toc-number">2.2.7.</span> <span class="toc-text"> 2.6 éå†ç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27-%E8%AF%BB%E5%8F%96%E7%9B%AE%E5%BD%95"><span class="toc-number">2.2.8.</span> <span class="toc-text"> 2.7 è¯»å–ç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28-%E5%88%A0%E9%99%A4%E7%9B%AE%E5%BD%95"><span class="toc-number">2.2.9.</span> <span class="toc-text"> 2.8 åˆ é™¤ç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#29-%E5%88%A0%E9%99%A4%E6%95%B4%E4%B8%AA%E7%9B%AE%E5%BD%95"><span class="toc-number">2.2.10.</span> <span class="toc-text"> 2.9 åˆ é™¤æ•´ä¸ªç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#210-%E6%96%87%E4%BB%B6%E9%87%8D%E5%91%BD%E5%90%8D"><span class="toc-number">2.2.11.</span> <span class="toc-text"> 2.10 æ–‡ä»¶é‡å‘½å</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#211-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E7%8A%B6%E6%80%81"><span class="toc-number">2.2.12.</span> <span class="toc-text"> 2.11 è·å–æ–‡ä»¶çŠ¶æ€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#212-%E8%BF%BD%E5%8A%A0%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="toc-number">2.2.13.</span> <span class="toc-text"> 2.12 è¿½åŠ æ–‡ä»¶å†…å®¹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6%E6%A8%A1%E5%9D%97-events"><span class="toc-number">2.3.</span> <span class="toc-text"> 3. äº‹ä»¶æœºåˆ¶æ¨¡å— events</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#07-nodejs%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97%E4%B8%8B"><span class="toc-number">3.</span> <span class="toc-text"> 07 ã€nodejs å†…ç½®æ¨¡å—ï¼ˆä¸‹ï¼‰ã€‘</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1stream-%E6%A8%A1%E5%9D%97"><span class="toc-number">3.1.</span> <span class="toc-text"> 1.stream æ¨¡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E8%AF%BB%E5%8F%96%E6%B5%81"><span class="toc-number">3.1.1.</span> <span class="toc-text"> 1.1 è¯»å–æµ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E5%86%99%E5%85%A5%E6%B5%81"><span class="toc-number">3.1.2.</span> <span class="toc-text"> 1.2 å†™å…¥æµ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E8%B5%84%E6%BA%90%E5%8E%8B%E7%BC%A9%E6%A8%A1%E5%9D%97-zib"><span class="toc-number">3.2.</span> <span class="toc-text"> 2. èµ„æºå‹ç¼©æ¨¡å— zib</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#21-%E6%A6%82%E8%A7%88"><span class="toc-number">3.2.1.</span> <span class="toc-text"> 2.1 æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-%E5%8E%8B%E7%BC%A9%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-number">3.2.2.</span> <span class="toc-text"> 2.2 å‹ç¼©çš„ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23-%E8%A7%A3%E5%8E%8B%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-number">3.2.3.</span> <span class="toc-text"> 2.3 è§£å‹çš„ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-%E6%9C%8D%E5%8A%A1%E7%AB%AFgzip%E5%8E%8B%E7%BC%A9"><span class="toc-number">3.2.4.</span> <span class="toc-text"> 2.4 æœåŠ¡ç«¯ gzip å‹ç¼©</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%AD%97%E7%AC%A6%E4%B8%B2gzip%E5%8E%8B%E7%BC%A9"><span class="toc-number">3.2.5.</span> <span class="toc-text"> 2.5 æœåŠ¡ç«¯å­—ç¬¦ä¸² gzip å‹ç¼©</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%AF%86%E6%A8%A1%E5%9D%97-crypto"><span class="toc-number">3.3.</span> <span class="toc-text"> 3. æ•°æ®åŠ å¯†æ¨¡å— crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#31-hash%E4%BE%8B%E5%AD%90"><span class="toc-number">3.3.1.</span> <span class="toc-text"> 3.1 hash ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#32-hmac%E4%BE%8B%E5%AD%90"><span class="toc-number">3.3.2.</span> <span class="toc-text"> 3.2 HMAC ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#33-md5%E4%BE%8B%E5%AD%90"><span class="toc-number">3.3.3.</span> <span class="toc-text"> 3.3 MD5 ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#34-%E4%BE%8B%E5%AD%90%E5%AF%86%E7%A0%81%E4%BF%9D%E6%8A%A4"><span class="toc-number">3.3.4.</span> <span class="toc-text"> 3.4 ä¾‹å­ï¼šå¯†ç ä¿æŠ¤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#09-%E5%8E%9F%E7%94%9Fnodejs%E8%B7%AF%E7%94%B1-%E8%8E%B7%E5%8F%96%E5%8F%82%E6%95%B0-%E9%9D%99%E6%80%81%E7%9B%AE%E5%BD%95"><span class="toc-number">4.</span> <span class="toc-text"> 09 ã€åŸç”Ÿ nodejs è·¯ç”±ã€è·å–å‚æ•°ã€é™æ€ç›®å½•ã€‘</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E8%B7%AF%E7%94%B1"><span class="toc-number">4.1.</span> <span class="toc-text"> 1. è·¯ç”±</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E8%8E%B7%E5%8F%96%E5%8F%82%E6%95%B0"><span class="toc-number">4.2.</span> <span class="toc-text"> 2. è·å–å‚æ•°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E9%9D%99%E6%80%81%E7%9B%AE%E5%BD%95"><span class="toc-number">4.3.</span> <span class="toc-text"> 3. é™æ€ç›®å½•</span></a></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« ">
        <ul>
          <li class="active"><a href="/2024/01/02/node.js%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/" rel="bookmark" title="node.jså†…ç½®æ¨¡å—">node.jså†…ç½®æ¨¡å—</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="dmq"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">dmq</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">79</span>
        <span class="name">æ–‡ç« </span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">61</span>
        <span class="name">åˆ†ç±»</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">98</span>
        <span class="name">æ ‡ç­¾</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RtcTA/dGFiPXJlcG9zaXRvcmllcw==" title="https:&#x2F;&#x2F;github.com&#x2F;dmq0?tab&#x3D;repositories"><i class="ic i-github"></i></span>
      <span class="exturl item npm" data-url="aHR0cHM6Ly93d3cubnBtanMuY29tL35kbXEwMDA=" title="https:&#x2F;&#x2F;www.npmjs.com&#x2F;~dmq000"><i class="ic i-file"></i></span>
      <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9kLTg4LTYxLTgz" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;d-88-61-83"><i class="ic i-zhihu"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTgwMjc4OTk0OTE=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;8027899491"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vdS83NjI1OTAxNzE3" title="https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;7625901717"><i class="ic i-weibo"></i></span>
      <span class="exturl item email" data-url="bWFpbHRvOjMyNjc4MDc1MTRAcXEuY29t" title="mailto:3267807514@qq.com"><i class="ic i-envelope"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>ä»‹ç»</a>
  </li>

    
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a>
  </li>

    
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a>
  </li>

    
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a>
  </li>

    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>å‹é“¾</a>
  </li>

    
  <li class="item">
    <a href="/links/" rel="section"><i class="ic i-magic"></i>å·¥å…·</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2024/01/02/%E7%BC%93%E5%AD%98%E3%80%81%E5%86%85%E5%AD%98%E3%80%81CPU%E7%9F%A5%E8%AF%86%E7%82%B9%E8%A7%A3%E6%9E%90%E7%AC%94%E8%AE%B0/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2024/01/10/%E6%AD%A3%E5%88%99/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>éšæœºæ–‡ç« </h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/vue/" title="åˆ†ç±»äº vue">vue</a>
</div>

    <span><a href="/2023/11/02/vue%E5%8E%9F%E7%90%86/" title="vueæºç è§£è¯»">vueæºç è§£è¯»</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" title="åˆ†ç±»äº è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</a>
</div>

    <span><a href="/2023/06/02/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" title="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%AE%B9%E5%99%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E6%93%8D%E4%BD%9C/" title="åˆ†ç±»äº å®¹å™¨åŒ–è¿ç»´æ“ä½œ">å®¹å™¨åŒ–è¿ç»´æ“ä½œ</a>
</div>

    <span><a href="/2024/02/02/%E5%AE%B9%E5%99%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E6%93%8D%E4%BD%9C/" title="å®¹å™¨åŒ–è¿ç»´æ“ä½œ">å®¹å™¨åŒ–è¿ç»´æ“ä½œ</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E4%B8%9A%E5%8A%A1%E5%A4%84%E7%90%86/" title="åˆ†ç±»äº ä¸šåŠ¡å¤„ç†">ä¸šåŠ¡å¤„ç†</a>
</div>

    <span><a href="/2024/03/29/%E6%9C%AC%E5%9C%B0%E9%A2%84%E8%A7%88%E5%9B%BE%E7%89%87/" title="æœ¬åœ°é¢„è§ˆå›¾ç‰‡">æœ¬åœ°é¢„è§ˆå›¾ç‰‡</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/node-js/" title="åˆ†ç±»äº node.js">node.js</a>
</div>

    <span><a href="/2024/01/02/node.js%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/" title="node.jså†…ç½®æ¨¡å—">node.jså†…ç½®æ¨¡å—</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91/" title="åˆ†ç±»äº è„šæ‰‹æ¶å¼€å‘">è„šæ‰‹æ¶å¼€å‘</a>
</div>

    <span><a href="/2024/04/12/%E8%84%9A%E6%89%8B%E6%9E%B6/" title="è„šæ‰‹æ¶å¼€å‘">è„šæ‰‹æ¶å¼€å‘</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E7%AE%97%E6%B3%95/" title="åˆ†ç±»äº ç®—æ³•">ç®—æ³•</a>
</div>

    <span><a href="/2023/12/02/%E7%AE%97%E6%B3%95/" title="ç®—æ³•ä¸æ•°æ®ç»“æ„">ç®—æ³•ä¸æ•°æ®ç»“æ„</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E4%B8%8E%E9%83%A8%E7%BD%B2/" title="åˆ†ç±»äº æŒç»­é›†æˆä¸éƒ¨ç½²">æŒç»­é›†æˆä¸éƒ¨ç½²</a>
</div>

    <span><a href="/2024/02/03/%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E4%B8%8E%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2/" title="æŒç»­é›†æˆä¸æŒç»­éƒ¨ç½²">æŒç»­é›†æˆä¸æŒç»­éƒ¨ç½²</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%89%8D%E7%AB%AF%E7%9B%91%E6%8E%A7/" title="åˆ†ç±»äº å‰ç«¯ç›‘æ§">å‰ç«¯ç›‘æ§</a>
</div>

    <span><a href="/2024/04/29/%E5%89%8D%E7%AB%AF%E7%9B%91%E6%8E%A7/" title="å‰ç«¯ç›‘æ§">å‰ç«¯ç›‘æ§</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/jQuery/" title="åˆ†ç±»äº jQuery">jQuery</a>
</div>

    <span><a href="/2023/01/02/jQuery%E6%A1%86%E6%9E%B6%E5%BA%94%E7%94%A8/" title="jQuery">jQuery</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>æœ€æ–°è¯„è®º</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2022 â€“ 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">dmq @ Web blog</span>
  </div>
  <div class="count">
    <span class="post-meta-item-icon">
      <i class="ic i-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">811k å­—</span>

    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="ic i-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">12:17</span>
  </div>
  <div class="powered-by">
    åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2024/01/02/node.jså†…ç½®æ¨¡å—/',
    favicon: {
      show: "ç§‘æŠ€å¼•é¢†æœªæ¥",
      hide: "æ¬¢è¿ä¸æˆ‘äº¤æµ"
    },
    search : {
      placeholder: "æ–‡ç« æœç´¢",
      empty: "å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",
      stats: "${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"
    },
    valine: true,fancybox: true,
    copyright: 'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//gcore.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>


  <script data-pjax>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?9ba187659e850a6910681214f0faa16b";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


</body>
</html>
