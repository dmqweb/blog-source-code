



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="æœæ˜æ¸…çš„ä¸ªäººåšå®¢" href="https://dmqweb.cn/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="æœæ˜æ¸…çš„ä¸ªäººåšå®¢" href="https://dmqweb.cn/atom.xml" />
<link rel="alternate" type="application/json" title="æœæ˜æ¸…çš„ä¸ªäººåšå®¢" href="https://dmqweb.cn/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="node.js" />


<link rel="canonical" href="https://dmqweb.cn/2024/01/02/node.js%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/">



  <title>
node.jså†…ç½®æ¨¡å— - node.js |
Web blog = æœæ˜æ¸…çš„ä¸ªäººåšå®¢ = ğŸ‘»æ¬¢è¿ä¸€èµ·äº¤æµå­¦ä¹ ğŸ‘»</title>
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">node.jså†…ç½®æ¨¡å—
  </h1>
  
<div class="meta">
  <span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2024-01-02 02:24:04">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">å‘è¡¨äº</span>
    <time itemprop="dateCreated datePublished" datetime="2024-01-02T02:24:04+08:00">2024-01-02</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Web blog</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/04/eff89867286d822f.webp"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/07/be4bd9184664725b.webp"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/05/d389418a13d92e24.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/06/63e9f1e7097ba6fb.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/28/02824114036dc293.webp"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/13/7056b573eacc540d.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/node-js/" itemprop="item" rel="index" title="åˆ†ç±»äº node.js"><span itemprop="name">node.js</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://dmqweb.cn/2024/01/02/node.js%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="dmq">
    <meta itemprop="description" content="ğŸ‘»æ¬¢è¿ä¸€èµ·äº¤æµå­¦ä¹ ğŸ‘», ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="æœæ˜æ¸…çš„ä¸ªäººåšå®¢">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="05-ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸Šï¼‰ã€‘"><a href="#05-ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸Šï¼‰ã€‘" class="headerlink" title="05 ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸Šï¼‰ã€‘"></a>05 ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸Šï¼‰ã€‘</h1><h2 id="nodejs-çš„å®˜æ–¹APIæ–‡æ¡£"><a href="#nodejs-çš„å®˜æ–¹APIæ–‡æ¡£" class="headerlink" title="nodejs çš„å®˜æ–¹APIæ–‡æ¡£"></a>nodejs çš„å®˜æ–¹APIæ–‡æ¡£</h2><ul>
<li>Node.js çš„APIæ–‡æ¡£ï¼ˆè‹±æ–‡ï¼‰ï¼š <span class="exturl" data-url="aHR0cHM6Ly9ub2RlanMub3JnL2RvY3MvbGF0ZXN0LXY4LngvYXBpL2luZGV4Lmh0bWw=">https://nodejs.org/docs/latest-v8.x/api/index.html</span></li>
<li>Node.js çš„APIæ–‡æ¡£ï¼ˆä¸­æ–‡ï¼‰ï¼š<span class="exturl" data-url="aHR0cDovL25vZGVqcy5jbi9hcGkv">http://nodejs.cn/api/</span></li>
</ul>
<p>å…³äº Node.js çš„å†…ç½®æ¨¡å—å’Œå¸¸è§APIï¼Œå¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚</p>
<p>æŸ¥é˜…æ–‡æ¡£æ—¶ï¼Œç¨³å®šæŒ‡æ•°å¦‚ä¸‹ï¼š</p>
<ul>
<li>çº¢è‰²ï¼šåºŸå¼ƒã€‚</li>
<li>æ©™è‰²ï¼šå®éªŒã€‚è¡¨ç¤ºå½“å‰ç‰ˆæœ¬å¯ç”¨ï¼Œå…¶ä»–ç‰ˆæœ¬ä¸ç¡®å®šã€‚ä¹Ÿè®¸ä¸å‘ä¸‹å…¼å®¹ï¼Œå»ºè®®ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¯¥ç‰¹æ€§ã€‚</li>
<li>ç»¿è‰²ï¼šç¨³å®šã€‚ä¸ npm ç”Ÿæ€ç³»ç»Ÿçš„å…¼å®¹æ€§æ˜¯æœ€é«˜çš„ä¼˜å…ˆçº§ã€‚</li>
</ul>
<h2 id="nodejs-ä¸­æ¨¡å—çš„åˆ†ç±»"><a href="#nodejs-ä¸­æ¨¡å—çš„åˆ†ç±»" class="headerlink" title="nodejs ä¸­æ¨¡å—çš„åˆ†ç±»"></a>nodejs ä¸­æ¨¡å—çš„åˆ†ç±»</h2><p>Node.js åº”ç”¨ç”±æ¨¡å—ç»„æˆï¼Œé‡‡ç”¨ CommonJS æ¨¡å—è§„èŒƒã€‚Node.jsä¸­çš„æ¨¡å—åˆ†ä¸ºä¸‰ç§ï¼š</p>
<ul>
<li>å†…ç½®æ¨¡å—</li>
<li>ç¬¬ä¸‰æ–¹æ¨¡å—</li>
<li>è‡ªå®šä¹‰æ¨¡å—</li>
</ul>
<p>ä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹ã€‚</p>
<h3 id="å†…ç½®æ¨¡å—"><a href="#å†…ç½®æ¨¡å—" class="headerlink" title="å†…ç½®æ¨¡å—"></a>å†…ç½®æ¨¡å—</h3><pre><code class="js">const process = require(&#39;process&#39;);
const path = require(&#39;path&#39;);

console.log(process.version);
console.log(path.resolve(&#39;../&#39;));
</code></pre>
<p>requireæ–¹æ³•ç”¨äºåŠ è½½æ¨¡å—ã€‚</p>
<p>å¸¸è§çš„å†…ç½®æ¨¡å—åŒ…æ‹¬ï¼š</p>
<ul>
<li>FSï¼šæ–‡ä»¶ç³»ç»Ÿæ¨¡å—</li>
<li>pathï¼šè·¯å¾„æ¨¡å—</li>
<li>OSï¼šæ“ä½œç³»ç»Ÿç›¸å…³</li>
<li>netï¼šç½‘ç»œç›¸å…³</li>
<li>http</li>
<li>â€¦</li>
</ul>
<p>ä½ å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼šNode.js è¿™ä¹ˆç‰›å—ï¼Ÿè¿˜èƒ½ç›´æ¥å’Œæ“ä½œç³»ç»Ÿåšäº¤äº’ï¼Ÿ</p>
<p>å¸¦ç€è¿™ä¸ªç–‘é—®ï¼Œæˆ‘ä»¬ä¸å¦¨ç®€å•çœ‹çœ‹ Node.js çš„æºç ï¼Œä»¥ os æ¨¡å—ä¸¾ä¾‹ï¼š</p>
<ul>
<li>æ‰“å¼€osæ¨¡å—çš„æºç ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL25vZGVqcy9ub2RlL2Jsb2IvbWFzdGVyL2xpYi9vcy5qcyVFRiVCQyU4QyVFNyVCRiVCQiVFNSU4OCVCMCVFNiU5QyU4MCVFNSVCQSU5NSVFOSU4MyVBOCVFRiVCQyU4QyVFNiU4OSVCRSVFNSU4OCVCMA==">https://github.com/nodejs/node/blob/master/lib/os.jsï¼Œç¿»åˆ°æœ€åº•éƒ¨ï¼Œæ‰¾åˆ°</span> <code>cpus</code>è¿™ä¸ªæ–¹æ³•</li>
<li>è¿›è€Œæ‰¾åˆ° <code>getCPUs()</code></li>
<li>internalBinding(â€˜osâ€™)ï¼šé€šè¿‡ internalBinding å¯ä»¥è°ƒç”¨ç³»ç»Ÿåº•å±‚çš„æ–¹æ³•ã€‚internalBinding ä¸»è¦æ˜¯ JS è™šæ‹Ÿæœºåœ¨åšçš„äº‹æƒ…ã€‚</li>
<li><code>internalBinding(&#39;os&#39;)</code> çš„å®ç°ï¼Œåœ¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL25vZGVqcy9ub2RlL2Jsb2IvbWFzdGVyL3NyYy9ub2RlX29zLmNj">https://github.com/nodejs/node/blob/master/src/node_os.cc</span> é‡Œï¼Œé‡Œé¢éƒ½æ˜¯ C++ çš„ä»£ç ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ª<code>getCPUs</code>æ–¹æ³•ã€‚</li>
</ul>
<p>ç°åœ¨ä½ çŸ¥é“äº†ï¼ŒJSæœ¬èº«æ˜¯æ²¡æœ‰èƒ½åŠ›è·å–åº•å±‚ç³»ç»Ÿèµ„æºçš„ï¼Œè¿™ä¸€åˆ‡éƒ½æ˜¯ JSè™šæ‹Ÿæœºåœ¨å’Œåº•å±‚åšäº¤äº’ï¼Œç„¶åé€šè¿‡ JS çš„è¡¨ç°å½¢å¼ï¼Œæš´éœ²ç»™åº”ç”¨å±‚ã€‚</p>
<p>å¦å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šåº“ï¼Œæ˜¯ç›´æ¥ä½¿ç”¨C&#x2F;++ç¼–å†™çš„ï¼Œé€šè¿‡ç¼–è¯‘ä¹‹åï¼Œå†æä¾›ç»™ JS åº”ç”¨å±‚è°ƒç”¨ï¼Œæˆ–è€…ç›´æ¥æä¾›ç»™ Node.jså±‚ä½¿ç”¨ã€‚</p>
<p>**æ‰€æœ‰çš„ç¼–ç¨‹è¯­è¨€åº•å±‚éƒ½ä¼šå›å½’C&#x2F;C++**ï¼Œç”šè‡³æ˜¯æ±‡ç¼–è¯­è¨€ã€‚</p>
<h3 id="require-åŠ è½½ç¬¬ä¸‰æ–¹åŒ…çš„æœºåˆ¶"><a href="#require-åŠ è½½ç¬¬ä¸‰æ–¹åŒ…çš„æœºåˆ¶" class="headerlink" title="require åŠ è½½ç¬¬ä¸‰æ–¹åŒ…çš„æœºåˆ¶"></a>require åŠ è½½ç¬¬ä¸‰æ–¹åŒ…çš„æœºåˆ¶</h3><pre><code class="js">const express = require(&#39;express&#39;);
</code></pre>
<p>require åŠ è½½ç¬¬ä¸‰æ–¹åŒ…çš„æœºåˆ¶ï¼š</p>
<p>ï¼ˆ1ï¼‰ç¬¬ä¸‰æ–¹åŒ…å®‰è£…å¥½åï¼Œè¿™ä¸ªåŒ…ä¸€èˆ¬ä¼šå­˜æ”¾åœ¨å½“å‰é¡¹ç›®çš„ node_modules æ–‡ä»¶å¤¹ä¸­ã€‚æˆ‘ä»¬æ‰¾åˆ°è¿™ä¸ªåŒ…çš„ package.json æ–‡ä»¶ï¼Œå¹¶ä¸”æ‰¾åˆ°é‡Œé¢çš„mainå±æ€§å¯¹åº”çš„å…¥å£æ¨¡å—ï¼Œè¿™ä¸ªå…¥å£æ¨¡å—å°±æ˜¯è¿™ä¸ªåŒ…çš„å…¥å£æ–‡ä»¶ã€‚</p>
<p>ï¼ˆ2ï¼‰å¦‚æœç¬¬ä¸‰æ–¹åŒ…ä¸­æ²¡æœ‰æ‰¾åˆ°package.jsonæ–‡ä»¶ï¼Œæˆ–è€…package.jsonæ–‡ä»¶ä¸­æ²¡æœ‰mainå±æ€§ï¼Œåˆ™é»˜è®¤åŠ è½½ç¬¬ä¸‰æ–¹åŒ…ä¸­çš„index.jsæ–‡ä»¶ã€‚</p>
<p>ï¼ˆ3ï¼‰å¦‚æœåœ¨ node_modules æ–‡ä»¶å¤¹ä¸­æ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªåŒ…ï¼Œæˆ–è€…ä»¥ä¸Šæ‰€æœ‰æƒ…å†µéƒ½æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä¼šå‘ä¸Šä¸€çº§çˆ¶çº§ç›®å½•ä¸‹æŸ¥æ‰¾node_modulesæ–‡ä»¶å¤¹ï¼ŒæŸ¥æ‰¾è§„åˆ™å¦‚ä¸Šä¸€è‡´ã€‚</p>
<p>ï¼ˆ4ï¼‰å¦‚æœä¸€ç›´æ‰¾åˆ°è¯¥æ¨¡å—çš„ç£ç›˜æ ¹è·¯å¾„éƒ½æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä¼šæŠ¥é”™ï¼šcan not find module xxxã€‚</p>
<h3 id="è‡ªå®šä¹‰æ¨¡å—ï¼ˆmoduleï¼‰"><a href="#è‡ªå®šä¹‰æ¨¡å—ï¼ˆmoduleï¼‰" class="headerlink" title="è‡ªå®šä¹‰æ¨¡å—ï¼ˆmoduleï¼‰"></a>è‡ªå®šä¹‰æ¨¡å—ï¼ˆmoduleï¼‰</h3><p>æ¯ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œæœ‰è‡ªå·±çš„ä½œç”¨åŸŸã€‚åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢å®šä¹‰çš„å˜é‡ã€å‡½æ•°ã€ç±»ï¼Œéƒ½æ˜¯ç§æœ‰çš„ï¼Œå¯¹å…¶ä»–æ–‡ä»¶ä¸å¯è§ã€‚</p>
<p>ä¸¾ä¾‹ï¼š</p>
<pre><code class="js">var example = require(&#39;./example.js&#39;);
console.log(example.x); // 5
console.log(example.addX(1)); // 6
</code></pre>
<h2 id="ç½‘ç»œæœåŠ¡-http"><a href="#ç½‘ç»œæœåŠ¡-http" class="headerlink" title="ç½‘ç»œæœåŠ¡ http"></a>ç½‘ç»œæœåŠ¡ http</h2><h3 id="httpæ¨¡å—æ¦‚è§ˆ"><a href="#httpæ¨¡å—æ¦‚è§ˆ" class="headerlink" title="httpæ¨¡å—æ¦‚è§ˆ"></a>httpæ¨¡å—æ¦‚è§ˆ</h3><p>å¤§å¤šæ•°nodejså¼€å‘è€…éƒ½æ˜¯å†²ç€å¼€å‘web serverçš„ç›®çš„é€‰æ‹©äº†nodejsã€‚æ­£å¦‚å®˜ç½‘æ‰€å±•ç¤ºçš„ï¼Œå€ŸåŠ©httpæ¨¡å—ï¼Œå¯ä»¥å‡ è¡Œä»£ç å°±æå®šä¸€ä¸ªè¶…è¿·ä½ çš„web serverã€‚</p>
<p>åœ¨nodejsä¸­ï¼Œ<code>http</code>å¯ä»¥è¯´æ˜¯æœ€æ ¸å¿ƒçš„æ¨¡å—ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æ¯”è¾ƒå¤æ‚çš„ä¸€ä¸ªæ¨¡å—ã€‚ä¸Šæ‰‹å¾ˆç®€å•ï¼Œä½†ä¸€æ—¦æ·±å…¥å­¦ä¹ ï¼Œä¸å°‘åˆå­¦è€…å°±ä¼šè§‰å¾—å¤´ç–¼ï¼Œä¸çŸ¥ä»ä½•å…¥æ‰‹ã€‚</p>
<p>æœ¬æ–‡å…ˆä»ä¸€ä¸ªç®€å•çš„ä¾‹å­å‡ºå‘ï¼Œå¼•å‡º<code>http</code>æ¨¡å—æœ€æ ¸å¿ƒçš„å››ä¸ªå®ä¾‹ã€‚çœ‹å®Œæœ¬æ–‡ï¼Œåº”è¯¥å°±èƒ½å¤Ÿå¯¹httpæ¨¡å—æœ‰ä¸ªæ•´ä½“çš„è®¤è¯†ã€‚</p>
<h3 id="ä¸€ä¸ªç®€å•çš„ä¾‹å­"><a href="#ä¸€ä¸ªç®€å•çš„ä¾‹å­" class="headerlink" title="ä¸€ä¸ªç®€å•çš„ä¾‹å­"></a>ä¸€ä¸ªç®€å•çš„ä¾‹å­</h3><p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†1ä¸ªwebæœåŠ¡å™¨ã€1ä¸ªhttpå®¢æˆ·ç«¯</p>
<ul>
<li>æœåŠ¡å™¨serverï¼šæ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶å°†å®¢æˆ·ç«¯è¯·æ±‚çš„åœ°å€è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li>
<li>å®¢æˆ·ç«¯clientï¼šå‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œå¹¶å°†æœåŠ¡å™¨è¿”å›çš„å†…å®¹æ‰“å°åˆ°æ§åˆ¶å°ã€‚</li>
</ul>
<p>ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œåªæœ‰å‡ è¡Œï¼Œä½†åŒ…å«äº†ä¸å°‘ä¿¡æ¯é‡ã€‚ä¸‹ä¸€å°èŠ‚ä¼šè¿›è¡Œç®€å•ä»‹ç»ã€‚</p>
<pre><code class="js">var http = require(&#39;http&#39;);

// http server ä¾‹å­
var server = http.createServer(function(serverReq, serverRes)&#123;
    var url = serverReq.url;
    serverRes.end( &#39;æ‚¨è®¿é—®çš„åœ°å€æ˜¯ï¼š&#39; + url );
&#125;);

server.listen(3000);

// http client ä¾‹å­
var client = http.get(&#39;http://127.0.0.1:3000&#39;, function(clientRes)&#123;
    clientRes.pipe(process.stdout);
&#125;);
</code></pre>
<h3 id="ä¾‹å­è§£é‡Š"><a href="#ä¾‹å­è§£é‡Š" class="headerlink" title="ä¾‹å­è§£é‡Š"></a>ä¾‹å­è§£é‡Š</h3><p>åœ¨ä¸Šé¢è¿™ä¸ªç®€å•çš„ä¾‹å­é‡Œï¼Œæ¶‰åŠäº†4ä¸ªå®ä¾‹ã€‚å¤§éƒ¨åˆ†æ—¶å€™ï¼ŒserverReqã€serverRes æ‰æ˜¯ä¸»è§’ã€‚</p>
<ul>
<li>serverï¼šhttp.Serverå®ä¾‹ï¼Œç”¨æ¥æä¾›æœåŠ¡ï¼Œå¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</li>
<li>clientï¼šhttp.ClientRequeså®ä¾‹ï¼Œç”¨æ¥å‘æœåŠ¡ç«¯å‘èµ·è¯·æ±‚ã€‚</li>
<li>serverReq&#x2F;clientResï¼šå…¶å®éƒ½æ˜¯ http.IncomingMessageå®ä¾‹ã€‚serverReq ç”¨æ¥è·å–å®¢æˆ·ç«¯è¯·æ±‚çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚request headerï¼›è€ŒclientResç”¨æ¥è·å–æœåŠ¡ç«¯è¿”å›çš„ç›¸å…³ä¿¡æ¯ï¼Œæ¯”å¦‚response headerã€‚</li>
<li>serverResï¼šhttp.ServerResponseå®ä¾‹</li>
</ul>
<h3 id="å…³äºhttp-IncomingMessageã€http-ServerResponse"><a href="#å…³äºhttp-IncomingMessageã€http-ServerResponse" class="headerlink" title="å…³äºhttp.IncomingMessageã€http.ServerResponse"></a>å…³äºhttp.IncomingMessageã€http.ServerResponse</h3><p>å…ˆè®²ä¸‹ http.ServerResponse å®ä¾‹ã€‚ä½œç”¨å¾ˆæ˜ç¡®ï¼ŒæœåŠ¡ç«¯é€šè¿‡http.ServerResponse å®ä¾‹ï¼Œæ¥ä¸ªè¯·æ±‚æ–¹å‘é€æ•°æ®ã€‚åŒ…æ‹¬å‘é€å“åº”è¡¨å¤´ï¼Œå‘é€å“åº”ä¸»ä½“ç­‰ã€‚</p>
<p>æ¥ä¸‹æ¥æ˜¯ http.IncomingMessage å®ä¾‹ï¼Œç”±äºåœ¨ serverã€client éƒ½å‡ºç°äº†ï¼Œåˆå­¦è€…éš¾å…æœ‰ç‚¹è¿·èŒ«ã€‚å®ƒçš„ä½œç”¨æ˜¯</p>
<p>åœ¨serverç«¯ï¼šè·å–è¯·æ±‚å‘é€æ–¹çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•ã€è·¯å¾„ã€ä¼ é€’çš„æ•°æ®ç­‰ã€‚ åœ¨clientç«¯ï¼šè·å– server ç«¯å‘é€è¿‡æ¥çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•ã€è·¯å¾„ã€ä¼ é€’çš„æ•°æ®ç­‰ã€‚</p>
<p>http.IncomingMessageå®ä¾‹ æœ‰ä¸‰ä¸ªå±æ€§éœ€è¦æ³¨æ„ï¼šmethodã€statusCodeã€statusMessageã€‚</p>
<ul>
<li>methodï¼šåªåœ¨ server ç«¯çš„å®ä¾‹æœ‰ï¼ˆä¹Ÿå°±æ˜¯ serverReq.methodï¼‰</li>
<li>statusCode&#x2F;statusMessageï¼šåªåœ¨ client ç«¯ çš„å®ä¾‹æœ‰ï¼ˆä¹Ÿå°±æ˜¯ clientRes.methodï¼‰</li>
</ul>
<h2 id="ç½‘ç»œæœåŠ¡-http-res"><a href="#ç½‘ç»œæœåŠ¡-http-res" class="headerlink" title="ç½‘ç»œæœåŠ¡ http res"></a>ç½‘ç»œæœåŠ¡ http res</h2><h3 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h3><p>httpæ¨¡å—å››å‰‘å®¢ä¹‹ä¸€çš„<code>res</code>ï¼Œåº”è¯¥éƒ½ä¸é™Œç”Ÿäº†ã€‚ä¸€ä¸ªwebæœåŠ¡ç¨‹åºï¼Œæ¥å—åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„httpè¯·æ±‚åï¼Œå‘å®¢æˆ·ç«¯è¿”å›æ­£ç¡®çš„å“åº”å†…å®¹ï¼Œè¿™å°±æ˜¯<code>res</code>çš„èŒè´£ã€‚</p>
<p>è¿”å›çš„å†…å®¹åŒ…æ‹¬ï¼šçŠ¶æ€ä»£ç &#x2F;çŠ¶æ€æè¿°ä¿¡æ¯ã€å“åº”å¤´éƒ¨ã€å“åº”ä¸»ä½“ã€‚ä¸‹æ–‡ä¼šä¸¾å‡ ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<pre><code class="js">var http = require(&#39;http&#39;);
var server = http.createServer(function(req, res)&#123;
    res.end(&#39;ok&#39;);
&#125;);
server.listen(3000);
</code></pre>
<h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åŒæ—¶è®¾ç½®äº† çŠ¶æ€ä»£ç &#x2F;çŠ¶æ€æè¿°ä¿¡æ¯ã€å“åº”å¤´éƒ¨ã€å“åº”ä¸»ä½“ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚</p>
<pre><code class="js">var http = require(&#39;http&#39;);

// è®¾ç½®çŠ¶æ€ç ã€çŠ¶æ€æè¿°ä¿¡æ¯ã€å“åº”ä¸»ä½“
var server = http.createServer(function(req, res)&#123;
    res.writeHead(200, &#39;ok&#39;, &#123;
        &#39;Content-Type&#39;: &#39;text/plain&#39;
    &#125;);
    res.end(&#39;hello&#39;);
&#125;);

server.listen(3000);
</code></pre>
<h3 id="è®¾ç½®çŠ¶æ€ä»£ç ã€çŠ¶æ€æè¿°ä¿¡æ¯"><a href="#è®¾ç½®çŠ¶æ€ä»£ç ã€çŠ¶æ€æè¿°ä¿¡æ¯" class="headerlink" title="è®¾ç½®çŠ¶æ€ä»£ç ã€çŠ¶æ€æè¿°ä¿¡æ¯"></a>è®¾ç½®çŠ¶æ€ä»£ç ã€çŠ¶æ€æè¿°ä¿¡æ¯</h3><p><code>res</code>æä¾›äº† res.writeHead()ã€res.statusCode&#x2F;res.statusMessage æ¥å®ç°è¿™ä¸ªç›®çš„ã€‚</p>
<p>ä¸¾ä¾‹ï¼Œå¦‚æœæƒ³è¦è®¾ç½® 200&#x2F;ok ï¼Œå¯ä»¥</p>
<pre><code class="js">res.writeHead(200, &#39;ok&#39;);
</code></pre>
<p>ä¹Ÿå¯ä»¥</p>
<pre><code class="js">res.statusCode = 200;
res.statusMessage = &#39;ok&#39;;
</code></pre>
<p>ä¸¤è€…å·®ä¸å¤šï¼Œå·®å¼‚ç‚¹åœ¨äº</p>
<ol>
<li>res.writeHead() å¯ä»¥æä¾›é¢å¤–çš„åŠŸèƒ½ï¼Œæ¯”å¦‚è®¾ç½®å“åº”å¤´éƒ¨ã€‚</li>
<li>å½“å“åº”å¤´éƒ¨å‘é€å‡ºå»åï¼Œres.statusCode&#x2F;res.statusMessage ä¼šè¢«è®¾ç½®æˆå·²å‘é€å‡ºå»çš„ çŠ¶æ€ä»£ç &#x2F;çŠ¶æ€æè¿°ä¿¡æ¯ã€‚</li>
</ol>
<h3 id="è®¾ç½®å“åº”å¤´éƒ¨"><a href="#è®¾ç½®å“åº”å¤´éƒ¨" class="headerlink" title="è®¾ç½®å“åº”å¤´éƒ¨"></a>è®¾ç½®å“åº”å¤´éƒ¨</h3><p><code>res</code>æä¾›äº† res.writeHead()ã€response.setHeader() æ¥å®ç°å“åº”å¤´éƒ¨çš„è®¾ç½®ã€‚</p>
<p>ä¸¾ä¾‹ï¼Œæ¯”å¦‚æƒ³æŠŠ <code>Content-Type</code> è®¾ç½®ä¸º <code>text-plain</code>ï¼Œé‚£ä¹ˆå¯ä»¥</p>
<pre><code class="js">// æ–¹æ³•ä¸€
res.writeHead(200, &#39;ok&#39;, &#123;
    &#39;Content-Type&#39;: &#39;text-plain&#39;
&#125;);

// æ–¹æ³•äºŒ
res.setHeader(&#39;Content-Type&#39;, &#39;text-plain&#39;);
</code></pre>
<p>ä¸¤è€…çš„å·®å¼‚ç‚¹åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p>
<ol>
<li>res.writeHead() ä¸å•å•æ˜¯è®¾ç½®headerã€‚</li>
<li>å·²ç»é€šè¿‡ res.setHeader() è®¾ç½®äº†headerï¼Œå½“é€šè¿‡ res.writeHead() è®¾ç½®åŒåheaderï¼Œres.writeHead() çš„è®¾ç½®ä¼šè¦†ç›–ä¹‹å‰çš„è®¾ç½®ã€‚</li>
</ol>
<p>å…³äºç¬¬2ç‚¹å·®å¼‚ï¼Œè¿™é‡Œä¸¾ä¸ªä¾‹å­ã€‚ä¸‹é¢ä»£ç ï¼Œæœ€ç»ˆçš„ <code>Content-Type</code> ä¸º <code>text/plain</code>ã€‚</p>
<pre><code class="js">var http = require(&#39;http&#39;);

var server = http.createServer(function(req, res)&#123;
    res.setHeader(&#39;Content-Type&#39;, &#39;text/html&#39;);
    res.writeHead(200, &#39;ok&#39;, &#123;
        &#39;Content-Type&#39;: &#39;text/plain&#39;
    &#125;);
    res.end(&#39;hello&#39;);
&#125;);

server.listen(3000);
</code></pre>
<p>è€Œä¸‹é¢çš„ä¾‹å­ï¼Œåˆ™ç›´æ¥æŠ¥é”™ã€‚æŠ¥é”™ä¿¡æ¯ä¸º <code>Error: Can&#39;t set headers after they are sent.</code>ã€‚</p>
<pre><code class="js">var http = require(&#39;http&#39;);

var server = http.createServer(function(req, res)&#123;    
    res.writeHead(200, &#39;ok&#39;, &#123;
        &#39;Content-Type&#39;: &#39;text/plain&#39;
    &#125;);
    res.setHeader(&#39;Content-Type&#39;, &#39;text/html&#39;);
    res.end(&#39;hello&#39;);
&#125;);

server.listen(3000);
</code></pre>
<h3 id="å…¶ä»–å“åº”å¤´éƒ¨æ“ä½œ"><a href="#å…¶ä»–å“åº”å¤´éƒ¨æ“ä½œ" class="headerlink" title="å…¶ä»–å“åº”å¤´éƒ¨æ“ä½œ"></a>å…¶ä»–å“åº”å¤´éƒ¨æ“ä½œ</h3><p>å¢ã€åˆ ã€æ”¹ã€æŸ¥ æ˜¯é…å¥—çš„ã€‚ä¸‹é¢åˆ†åˆ«ä¸¾ä¾‹è¯´æ˜ä¸‹ï¼Œä¾‹å­å¤ªç®€å•å°±ç›´æ¥ä¸Šä»£ç äº†ã€‚</p>
<pre><code class="js">// å¢
res.setHeader(&#39;Content-Type&#39;, &#39;text/plain&#39;);

// åˆ 
res.removeHeader(&#39;Content-Type&#39;);

// æ”¹
res.setHeader(&#39;Content-Type&#39;, &#39;text/plain&#39;);
res.setHeader(&#39;Content-Type&#39;, &#39;text/html&#39;);  // è¦†ç›–

// æŸ¥
res.getHeader(&#39;content-type&#39;);
</code></pre>
<p>å…¶ä¸­ç•¥æ˜¾ä¸åŒçš„æ˜¯ res.getHeader(name)ï¼Œname ç”¨çš„æ˜¯å°å†™ï¼Œè¿”å›å€¼æ²¡åšç‰¹æ®Šå¤„ç†ã€‚</p>
<pre><code class="js">res.setHeader(&#39;Content-Type&#39;, &#39;TEXT/HTML&#39;);
console.log( res.getHeader(&#39;content-type&#39;) );  // TEXT/HTML

res.setHeader(&#39;Content-Type&#39;, &#39;text/plain&#39;);
console.log( res.getHeader(&#39;content-type&#39;) );  // text/plain
</code></pre>
<p>æ­¤å¤–ï¼Œè¿˜æœ‰ä¸é‚£ä¹ˆå¸¸ç”¨çš„ï¼š</p>
<ul>
<li>res.headersSentï¼šheaderæ˜¯å¦å·²ç»å‘é€ï¼›</li>
<li>res.sendDateï¼šé»˜è®¤ä¸ºtrueã€‚ä½†ä¸ºtrueæ—¶ï¼Œä¼šåœ¨response headeré‡Œè‡ªåŠ¨è®¾ç½®Dateé¦–éƒ¨ã€‚</li>
</ul>
<h3 id="è®¾ç½®å“åº”ä¸»ä½“"><a href="#è®¾ç½®å“åº”ä¸»ä½“" class="headerlink" title="è®¾ç½®å“åº”ä¸»ä½“"></a>è®¾ç½®å“åº”ä¸»ä½“</h3><p>ä¸»è¦ç”¨åˆ° res.write() ä»¥åŠ res.end() ä¸¤ä¸ªæ–¹æ³•ã€‚</p>
<p>res.write() APIçš„ä¿¡æ¯é‡ç•¥å¤§ï¼Œå»ºè®®çœ‹ä¸‹<span class="exturl" data-url="aHR0cHM6Ly9ub2RlanMub3JnL2FwaS9odHRwLmh0bWwjaHR0cF9yZXNwb25zZV93cml0ZV9jaHVua19lbmNvZGluZ19jYWxsYmFjaw==">å®˜æ–¹æ–‡æ¡£</span>ã€‚</p>
<h4 id="response-write-chunk-encoding-callback"><a href="#response-write-chunk-encoding-callback" class="headerlink" title="response.write(chunk[, encoding][, callback])"></a>response.write(chunk[, encoding][, callback])</h4><ul>
<li>chunkï¼šå“åº”ä¸»ä½“çš„å†…å®¹ï¼Œå¯ä»¥æ˜¯stringï¼Œä¹Ÿå¯ä»¥æ˜¯bufferã€‚å½“ä¸ºstringæ—¶ï¼Œencodingå‚æ•°ç”¨æ¥æŒ‡æ˜ç¼–ç æ–¹å¼ã€‚ï¼ˆé»˜è®¤æ˜¯utf8ï¼‰</li>
<li>encodingï¼šç¼–ç æ–¹å¼ï¼Œé»˜è®¤æ˜¯ utf8ã€‚</li>
<li>callbackï¼šå½“å“åº”ä½“flushedæ—¶è§¦å‘ã€‚ï¼ˆTODO è¿™é‡Œæƒ³ä¸‹æ›´å¥½çš„è§£é‡Šã€‚ã€‚ã€‚ï¼‰</li>
</ul>
<p>ä½¿ç”¨ä¸Šæ²¡ä»€ä¹ˆéš¾åº¦ï¼Œåªæ˜¯æœ‰äº›æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>å¦‚æœ res.write() è¢«è°ƒç”¨æ—¶ï¼Œ res.writeHead() è¿˜æ²¡è¢«è°ƒç”¨è¿‡ï¼Œé‚£ä¹ˆï¼Œå°±ä¼šæŠŠheader flushå‡ºå»ã€‚</li>
<li>res.write() å¯ä»¥è¢«è°ƒç”¨å¤šæ¬¡ã€‚</li>
<li>å½“ res.write(chunk) ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨æ—¶ï¼Œnode ä¼šå°† header ä¿¡æ¯ ä»¥åŠ chunk å‘é€åˆ°å®¢æˆ·ç«¯ã€‚ç¬¬äºŒæ¬¡è°ƒç”¨ res.write(chunk) ï¼Œnode ä¼šè®¤ä¸ºä½ æ˜¯è¦streaming dataï¼ˆWTFï¼Œè¯¥æ€ä¹ˆç¿»è¯‘ï¼‰ã€‚ã€‚ã€‚</li>
</ol>
<blockquote>
<p>Returns true if the entire data was flushed successfully to the kernel buffer. Returns false if all or part of the data was queued in user memory. â€˜drainâ€™ will be emitted when the buffer is free again.</p>
</blockquote>
<h4 id="response-end-data-encoding-callback"><a href="#response-end-data-encoding-callback" class="headerlink" title="response.end([data][, encoding][, callback])"></a>response.end([data][, encoding][, callback])</h4><p>æŒæ¡äº† res.write() çš„è¯ï¼Œres.end() å°±å¾ˆç®€å•äº†ã€‚res.end() çš„ç”¨å¤„æ˜¯å‘Šè¯‰nodejsï¼Œheaderã€bodyéƒ½ç»™ä½ äº†ï¼Œè¿™æ¬¡å“åº”å°±åˆ°è¿™é‡Œå§ã€‚</p>
<p>æœ‰ç‚¹åƒä¸ªè¯­æ³•ç³–ï¼Œå¯ä»¥çœ‹æˆä¸‹é¢ä¸¤ä¸ªè°ƒç”¨çš„ç»„åˆã€‚è‡³äºcallbackï¼Œå½“å“åº”ä¼ é€’ç»“æŸåè§¦å‘ã€‚</p>
<pre><code class="js">res.write(data, encoding);
res.end()
</code></pre>
<h3 id="è¶…æ—¶å¤„ç†"><a href="#è¶…æ—¶å¤„ç†" class="headerlink" title="è¶…æ—¶å¤„ç†"></a>è¶…æ—¶å¤„ç†</h3><p>æ¥å£ï¼šresponse.setTimeout(msecs, callback)</p>
<p>å…³äº timeout äº‹ä»¶çš„è¯´æ˜ï¼ŒåŒæ ·æ˜¯è¨€ç®€æ„èµ…ï¼ˆWTFï¼‰ï¼Œè¯å°‘ä¿¡æ¯é‡å¤§ï¼Œæœ€å¥½æ¥ä¸ªdemo TODO</p>
<blockquote>
<p>If no â€˜timeoutâ€™ listener is added to the request, the response, or the server, then sockets are destroyed when they time out. If you assign a handler on the request, the response, or the serverâ€™s â€˜timeoutâ€™ events, then it is your responsibility to handle timed out sockets.</p>
</blockquote>
<h3 id="äº‹ä»¶-close-x2F-finish"><a href="#äº‹ä»¶-close-x2F-finish" class="headerlink" title="äº‹ä»¶ close&#x2F;finish"></a>äº‹ä»¶ close&#x2F;finish</h3><ul>
<li>closeï¼šresponse.end() è¢«è°ƒç”¨å‰ï¼Œè¿æ¥å°±æ–­å¼€äº†ã€‚æ­¤æ—¶ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ã€‚</li>
<li>finishï¼šå“åº”headerã€bodyéƒ½å·²ç»å‘é€å‡ºå»ï¼ˆäº¤ç»™æ“ä½œç³»ç»Ÿï¼Œæ’é˜Ÿç­‰å€™ä¼ è¾“ï¼‰ï¼Œä½†å®¢æˆ·ç«¯æ˜¯å¦å®é™…æ”¶åˆ°æ•°æ®ä¸ºæ­¢ã€‚ï¼ˆè¿™ä¸ªäº‹ä»¶åï¼Œres ä¸Šå°±ä¸ä¼šå†æœ‰å…¶ä»–äº‹ä»¶è§¦å‘ï¼‰</li>
</ul>
<h3 id="å…¶ä»–ä¸å¸¸ç”¨å±æ€§-x2F-æ–¹æ³•"><a href="#å…¶ä»–ä¸å¸¸ç”¨å±æ€§-x2F-æ–¹æ³•" class="headerlink" title="å…¶ä»–ä¸å¸¸ç”¨å±æ€§&#x2F;æ–¹æ³•"></a>å…¶ä»–ä¸å¸¸ç”¨å±æ€§&#x2F;æ–¹æ³•</h3><ul>
<li>response.finishedï¼šä¸€å¼€å§‹æ˜¯falseï¼Œå“åº”ç»“æŸåï¼Œè®¾ç½®ä¸ºtrueã€‚</li>
<li>response.sendDateï¼šé»˜è®¤æ˜¯trueã€‚æ˜¯å¦è‡ªåŠ¨è®¾ç½®Dateå¤´éƒ¨ã€‚ï¼ˆæŒ‰HTTPåè®®æ˜¯å¿…é¡»è¦çš„ï¼Œé™¤éæ˜¯è°ƒè¯•ç”¨ï¼Œä¸ç„¶ä¸è¦è®¾ç½®ä¸ºfalseï¼‰</li>
<li>response.headersSentï¼šåªè¯»å±æ€§ã€‚å“åº”å¤´éƒ¨æ˜¯å¦å·²å‘é€ã€‚</li>
<li>response.writeContinue()ï¼šå‘é€ HTTP&#x2F;1.1 100 Continue æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ï¼Œæç¤ºè¯´æœåŠ¡ç«¯æ„¿æ„æ¥å—å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œè¯·ç»§ç»­å‘é€è¯·æ±‚æ­£æ–‡ï¼ˆbody)ã€‚ï¼ˆTODO åšä¸ªdemoå•¥çš„æ˜¯å¤§å¤§çš„å¥½ï¼‰</li>
</ul>
<h2 id="ç½‘ç»œæœåŠ¡-http-req"><a href="#ç½‘ç»œæœåŠ¡-http-req" class="headerlink" title="ç½‘ç»œæœåŠ¡ http req"></a>ç½‘ç»œæœåŠ¡ http req</h2><h3 id="æ¦‚è§ˆ-1"><a href="#æ¦‚è§ˆ-1" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h3><p>æœ¬æ–‡çš„é‡ç‚¹ä¼šæ”¾åœ¨<code>req</code>è¿™ä¸ªå¯¹è±¡ä¸Šã€‚å‰é¢å·²ç»æåˆ°ï¼Œå®ƒå…¶å®æ˜¯http.IncomingMessageå®ä¾‹ï¼Œåœ¨æœåŠ¡ç«¯ã€å®¢æˆ·ç«¯ä½œç”¨ç•¥å¾®æœ‰å·®å¼‚</p>
<ul>
<li>æœåŠ¡ç«¯å¤„ï¼šè·å–è¯·æ±‚æ–¹çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚request headerç­‰ã€‚</li>
<li>å®¢æˆ·ç«¯å¤„ï¼šè·å–å“åº”æ–¹è¿”å›çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚statusCodeç­‰ã€‚</li>
</ul>
<p>æœåŠ¡ç«¯ä¾‹å­ï¼š</p>
<pre><code class="js">// ä¸‹é¢çš„ req
var http = require(&#39;http&#39;);
var server = http.createServer(function(req, res)&#123;
    console.log(req.headers);
    res.end(&#39;ok&#39;);
&#125;);
server.listen(3000);
</code></pre>
<p>å®¢æˆ·ç«¯ä¾‹å­</p>
<pre><code class="js">// ä¸‹é¢çš„res
var http = require(&#39;http&#39;);
http.get(&#39;http://127.0.0.1:3000&#39;, function(res)&#123;
    console.log(res.statusCode);
&#125;);
</code></pre>
<h3 id="å±æ€§-x2F-æ–¹æ³•-x2F-äº‹ä»¶-åˆ†ç±»"><a href="#å±æ€§-x2F-æ–¹æ³•-x2F-äº‹ä»¶-åˆ†ç±»" class="headerlink" title="å±æ€§&#x2F;æ–¹æ³•&#x2F;äº‹ä»¶ åˆ†ç±»"></a>å±æ€§&#x2F;æ–¹æ³•&#x2F;äº‹ä»¶ åˆ†ç±»</h3><p>http.IncomingMessageçš„å±æ€§&#x2F;æ–¹æ³•&#x2F;äº‹ä»¶ ä¸æ˜¯ç‰¹åˆ«å¤šï¼ŒæŒ‰ç…§æ˜¯å¦å®¢æˆ·ç«¯&#x2F;æœåŠ¡ç«¯ ç‰¹æœ‰çš„ï¼Œä¸‹é¢è¿›è¡Œç®€å•å½’ç±»ã€‚å¯ä»¥çœ‹åˆ°</p>
<ul>
<li>æœåŠ¡ç«¯å¤„ç‰¹æœ‰ï¼šurl</li>
<li>å®¢æˆ·ç«¯å¤„ç‰¹æœ‰ï¼šstatusCodeã€statusMessage</li>
</ul>
<table>
<thead>
<tr>
<th align="left">ç±»å‹</th>
<th align="center">åç§°</th>
<th align="center">æœåŠ¡ç«¯</th>
<th align="center">å®¢æˆ·ç«¯</th>
</tr>
</thead>
<tbody><tr>
<td align="left">äº‹ä»¶</td>
<td align="center">aborted</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
</tr>
<tr>
<td align="left">äº‹ä»¶</td>
<td align="center">close</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
</tr>
<tr>
<td align="left">å±æ€§</td>
<td align="center">headers</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
</tr>
<tr>
<td align="left">å±æ€§</td>
<td align="center">rawHeaders</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
</tr>
<tr>
<td align="left">å±æ€§</td>
<td align="center">statusCode</td>
<td align="center">âœ•</td>
<td align="center">âœ“</td>
</tr>
<tr>
<td align="left">å±æ€§</td>
<td align="center">statusMessage</td>
<td align="center">âœ•</td>
<td align="center">âœ“</td>
</tr>
<tr>
<td align="left">å±æ€§</td>
<td align="center">httpVersion</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
</tr>
<tr>
<td align="left">å±æ€§</td>
<td align="center">url</td>
<td align="center">âœ“</td>
<td align="center">âœ•</td>
</tr>
<tr>
<td align="left">å±æ€§</td>
<td align="center">socket</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
</tr>
<tr>
<td align="left">æ–¹æ³•</td>
<td align="center">.destroy()</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
</tr>
<tr>
<td align="left">æ–¹æ³•</td>
<td align="center">.setTimeout()</td>
<td align="center">âœ“</td>
<td align="center">âœ“</td>
</tr>
</tbody></table>
<h3 id="æœåŠ¡ç«¯çš„ä¾‹å­"><a href="#æœåŠ¡ç«¯çš„ä¾‹å­" class="headerlink" title="æœåŠ¡ç«¯çš„ä¾‹å­"></a>æœåŠ¡ç«¯çš„ä¾‹å­</h3><h4 id="ä¾‹å­ä¸€ï¼šè·å–httpVersion-x2F-method-x2F-url"><a href="#ä¾‹å­ä¸€ï¼šè·å–httpVersion-x2F-method-x2F-url" class="headerlink" title="ä¾‹å­ä¸€ï¼šè·å–httpVersion&#x2F;method&#x2F;url"></a>ä¾‹å­ä¸€ï¼šè·å–httpVersion&#x2F;method&#x2F;url</h4><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„HTTPè¯·æ±‚æŠ¥æ–‡ï¼Œé‡Œé¢æœ€é‡è¦çš„å†…å®¹åŒ…æ‹¬ï¼šHTTPç‰ˆæœ¬ã€è¯·æ±‚æ–¹æ³•ã€è¯·æ±‚åœ°å€ã€è¯·æ±‚å¤´éƒ¨ã€‚</p>
<pre><code class="http">GET /hello HTTP/1.1
Host: 127.0.0.1:3000
Connection: keep-alive
Cache-Control: no-cache
</code></pre>
<p>é‚£ä¹ˆï¼Œå¦‚ä½•è·å–ä¸Šé¢æåˆ°çš„ä¿¡æ¯å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œç›´æ¥ä¸Šä»£ç </p>
<pre><code class="js">// getClientInfo.js
var http = require(&#39;http&#39;);

var server = http.createServer(function(req, res)&#123;
    console.log( &#39;1ã€å®¢æˆ·ç«¯è¯·æ±‚urlï¼š&#39; + req.url );
    console.log( &#39;2ã€httpç‰ˆæœ¬ï¼š&#39; + req.httpVersion );
    console.log( &#39;3ã€httpè¯·æ±‚æ–¹æ³•ï¼š&#39; + req.method );
    console.log( &#39;4ã€httpè¯·æ±‚å¤´éƒ¨&#39; + JSON.stringify(req.headers) );

    res.end(&#39;ok&#39;);
&#125;);

server.listen(3000);
</code></pre>
<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<pre><code class="bash">1ã€å®¢æˆ·ç«¯è¯·æ±‚urlï¼š/hello
2ã€httpç‰ˆæœ¬ï¼š1.1
3ã€httpè¯·æ±‚æ–¹æ³•ï¼šGET
4ã€http headersï¼š&#123;&quot;host&quot;:&quot;127.0.0.1:3000&quot;,&quot;connection&quot;:&quot;keep-alive&quot;,&quot;cache-control&quot;:&quot;no-cache&quot;,&quot;user-age
</code></pre>
<h4 id="ä¾‹å­äºŒï¼šè·å–getè¯·æ±‚å‚æ•°"><a href="#ä¾‹å­äºŒï¼šè·å–getè¯·æ±‚å‚æ•°" class="headerlink" title="ä¾‹å­äºŒï¼šè·å–getè¯·æ±‚å‚æ•°"></a>ä¾‹å­äºŒï¼šè·å–getè¯·æ±‚å‚æ•°</h4><p>æœåŠ¡ç«¯ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="js">// getClientGetQuery.js
var http = require(&#39;http&#39;);
var url = require(&#39;url&#39;);
var querystring = require(&#39;querystring&#39;);

var server = http.createServer(function(req, res)&#123;
    var urlObj = url.parse(req.url);
    var query = urlObj.query;
    var queryObj = querystring.parse(query);
    
    console.log( JSON.stringify(queryObj) );
    
    res.end(&#39;ok&#39;);
&#125;);

server.listen(3000);
</code></pre>
<p>è®¿é—®åœ°å€ <span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMTozMDAwL2hlbGxvP25pY2s9Y2h5aW5ncCZoZWxsbz13b3JsZA==">http://127.0.0.1:3000/hello?nick=chyingp&amp;hello=world</span></p>
<p>æœåŠ¡ç«¯è¾“å‡ºå¦‚ä¸‹</p>
<pre><code class="bash">&#123;&quot;nick&quot;:&quot;chyingp&quot;,&quot;hello&quot;:&quot;world&quot;&#125;
</code></pre>
<h4 id="ä¾‹å­ä¸‰ï¼šè·å–postè¯·æ±‚å‚æ•°"><a href="#ä¾‹å­ä¸‰ï¼šè·å–postè¯·æ±‚å‚æ•°" class="headerlink" title="ä¾‹å­ä¸‰ï¼šè·å–postè¯·æ±‚å‚æ•°"></a>ä¾‹å­ä¸‰ï¼šè·å–postè¯·æ±‚å‚æ•°</h4><p>æœåŠ¡ç«¯ä»£ç å¦‚ä¸‹</p>
<pre><code class="js">// getClientPostBody.js
var http = require(&#39;http&#39;);
var url = require(&#39;url&#39;);
var querystring = require(&#39;querystring&#39;);

var server = http.createServer(function(req, res)&#123;
    
    var body = &#39;&#39;;  
    req.on(&#39;data&#39;, function(thunk)&#123;
        body += thunk;
    &#125;);

    req.on(&#39;end&#39;, function()&#123;
        console.log( &#39;post body is: &#39; + body );
        res.end(&#39;ok&#39;);
    &#125;); 
&#125;);

server.listen(3000);
</code></pre>
<p>é€šè¿‡curlæ„é€ postè¯·æ±‚ï¼š</p>
<pre><code class="bash">curl -d &#39;nick=casper&amp;hello=world&#39; http://127.0.0.1:3000
</code></pre>
<p>æœåŠ¡ç«¯æ‰“å°å¦‚ä¸‹ï¼š</p>
<pre><code class="bash">post body is: nick=casper&amp;hello=world
</code></pre>
<p>å¤‡æ³¨ï¼špostè¯·æ±‚ä¸­ï¼Œä¸åŒçš„<code>Content-type</code>ï¼Œpost bodyæœ‰ä¸å°å·®å¼‚ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥ç ”ç©¶ä¸‹ã€‚</p>
<p>æœ¬ä¾‹ä¸­çš„postè¯·æ±‚ï¼ŒHTTPæŠ¥æ–‡å¤§æ¦‚å¦‚ä¸‹</p>
<pre><code class="http">POST / HTTP/1.1
Host: 127.0.0.1:3000
Content-Type: application/x-www-form-urlencoded
Cache-Control: no-cache

nick=casper&amp;hello=world
</code></pre>
<h2 id="ç½‘ç»œæœåŠ¡-https"><a href="#ç½‘ç»œæœåŠ¡-https" class="headerlink" title="ç½‘ç»œæœåŠ¡ https"></a>ç½‘ç»œæœåŠ¡ https</h2><h3 id="æ¨¡å—æ¦‚è§ˆ"><a href="#æ¨¡å—æ¦‚è§ˆ" class="headerlink" title="æ¨¡å—æ¦‚è§ˆ"></a>æ¨¡å—æ¦‚è§ˆ</h3><p>è¿™ä¸ªæ¨¡å—çš„é‡è¦æ€§ï¼ŒåŸºæœ¬ä¸ç”¨å¼ºè°ƒäº†ã€‚åœ¨ç½‘ç»œå®‰å…¨é—®é¢˜æ—¥ç›Šä¸¥å³»çš„ä»Šå¤©ï¼Œç½‘ç«™é‡‡ç”¨HTTPSæ˜¯ä¸ªå¿…ç„¶çš„è¶‹åŠ¿ã€‚</p>
<p>åœ¨nodejsä¸­ï¼Œæä¾›äº† https è¿™ä¸ªæ¨¡å—æ¥å®Œæˆ HTTPS ç›¸å…³åŠŸèƒ½ã€‚ä»å®˜æ–¹æ–‡æ¡£æ¥çœ‹ï¼Œè·Ÿ http æ¨¡å—ç”¨æ³•éå¸¸ç›¸ä¼¼ã€‚</p>
<p>æœ¬æ–‡ä¸»è¦åŒ…å«ä¸¤éƒ¨åˆ†ï¼š</p>
<ol>
<li>é€šè¿‡å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯çš„ä¾‹å­ï¼Œå¯¹httpsæ¨¡å—è¿›è¡Œå…¥é—¨è®²è§£ã€‚</li>
<li>å¦‚ä½•è®¿é—®å®‰å…¨è¯ä¹¦ä¸å—ä¿¡ä»»çš„ç½‘ç«™ã€‚ï¼ˆä»¥ 12306 ä¸ºä¾‹å­ï¼‰</li>
</ol>
<p>ç¯‡å¹…æ‰€é™ï¼Œæœ¬æ–‡æ— æ³•å¯¹ HTTPSåè®® åŠ ç›¸å…³æŠ€æœ¯ä½“ç³» åšè¿‡å¤šè®²è§£ï¼Œæœ‰é—®é¢˜æ¬¢è¿ç•™è¨€äº¤æµã€‚</p>
<h3 id="å®¢æˆ·ç«¯ä¾‹å­"><a href="#å®¢æˆ·ç«¯ä¾‹å­" class="headerlink" title="å®¢æˆ·ç«¯ä¾‹å­"></a>å®¢æˆ·ç«¯ä¾‹å­</h3><p>è·Ÿhttpæ¨¡å—çš„ç”¨æ³•éå¸¸åƒï¼Œåªä¸è¿‡è¯·æ±‚çš„åœ°å€æ˜¯httpsåè®®çš„è€Œå·²ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="js">var https = require(&#39;https&#39;);

https.get(&#39;https://www.baidu.com&#39;, function(res)&#123;
    console.log(&#39;status code: &#39; + res.statusCode);
    console.log(&#39;headers: &#39; + JSON.stringify(res.headers));

    res.on(&#39;data&#39;, function(data)&#123;
        process.stdout.write(data);
    &#125;);
&#125;).on(&#39;error&#39;, function(err)&#123;
    console.error(err);
&#125;);
</code></pre>
<h3 id="æœåŠ¡ç«¯ä¾‹å­"><a href="#æœåŠ¡ç«¯ä¾‹å­" class="headerlink" title="æœåŠ¡ç«¯ä¾‹å­"></a>æœåŠ¡ç«¯ä¾‹å­</h3><p>å¯¹å¤–æä¾›HTTPSæœåŠ¡ï¼Œéœ€è¦æœ‰HTTPSè¯ä¹¦ã€‚å¦‚æœä½ å·²ç»æœ‰äº†HTTPSè¯ä¹¦ï¼Œé‚£ä¹ˆå¯ä»¥è·³è¿‡è¯ä¹¦ç”Ÿæˆçš„ç¯èŠ‚ã€‚å¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹æ­¥éª¤</p>
<h4 id="ç”Ÿæˆè¯ä¹¦"><a href="#ç”Ÿæˆè¯ä¹¦" class="headerlink" title="ç”Ÿæˆè¯ä¹¦"></a>ç”Ÿæˆè¯ä¹¦</h4><p><strong>1.åˆ›å»ºä¸ªç›®å½•å­˜æ”¾è¯ä¹¦ã€‚</strong></p>
<pre><code class="bash">mkdir cert
cd cert
</code></pre>
<p><strong>2.ç”Ÿæˆç§é’¥ã€‚</strong></p>
<pre><code class="text">openssl genrsa -out chyingp-key.pem 2048
</code></pre>
<p><strong>3.ç”Ÿæˆè¯ä¹¦ç­¾åè¯·æ±‚ï¼ˆcsræ˜¯ Certificate Signing Requestçš„æ„æ€ï¼‰ã€‚</strong></p>
<pre><code class="text">openssl req -new \
  -sha256
  -key chyingp-key.key.pem \
  -out chyingp-csr.pem \
  -subj &quot;/C=CN/ST=Guandong/L=Shenzhen/O=YH Inc/CN=www.chyingp.com&quot;
</code></pre>
<p><strong>4.ç”Ÿæˆè¯ä¹¦ã€‚</strong></p>
<pre><code class="text">openssl x509 \
  -req -in chyingp-csr.pem \
  -signkey chyingp-key.pem \
  -out chyingp-cert.pem
</code></pre>
<h4 id="HTTPSæœåŠ¡ç«¯"><a href="#HTTPSæœåŠ¡ç«¯" class="headerlink" title="HTTPSæœåŠ¡ç«¯"></a>HTTPSæœåŠ¡ç«¯</h4><p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="js">var https = require(&#39;https&#39;);
var fs = require(&#39;fs&#39;);

var options = &#123;
    key: fs.readFileSync(&#39;./cert/chyingp-key.pem&#39;), // ç§é’¥
    cert: fs.readFileSync(&#39;./cert/chyingp-cert.pem&#39;) // è¯ä¹¦
&#125;;

var server = https.createServer(options, function(req, res)&#123;
    res.end(&#39;è¿™æ˜¯æ¥è‡ªHTTPSæœåŠ¡å™¨çš„è¿”å›&#39;);
&#125;);

server.listen(3000);
</code></pre>
<p>ç”±äºæˆ‘å¹¶æ²¡æœ‰ <span class="exturl" data-url="aHR0cDovL3d3dy5jaHlpbmdwLmNvbS8=">www.chyingp.com</span> è¿™ä¸ªåŸŸåï¼Œäºæ˜¯å…ˆé…ç½®æœ¬åœ°host</p>
<pre><code class="text">127.0.0.1 www.chyingp.com
</code></pre>
<p>å¯åŠ¨æœåŠ¡ï¼Œå¹¶åœ¨æµè§ˆå™¨é‡Œè®¿é—® <span class="exturl" data-url="aHR0cDovL3d3dy5jaHlpbmdwLmNvbTozMDAwLw==">http://www.chyingp.com:3000</span>ã€‚æ³¨æ„ï¼Œæµè§ˆå™¨ä¼šæç¤ºä½ è¯ä¹¦ä¸å¯é ï¼Œç‚¹å‡» ä¿¡ä»»å¹¶ç»§ç»­è®¿é—® å°±è¡Œäº†ã€‚</p>
<h2 id="URL-æ¥å£-ä»£æ›¿å†…ç½®æ¨¡å—urlä½¿ç”¨"><a href="#URL-æ¥å£-ä»£æ›¿å†…ç½®æ¨¡å—urlä½¿ç”¨" class="headerlink" title="URL æ¥å£(ä»£æ›¿å†…ç½®æ¨¡å—urlä½¿ç”¨)"></a>URL æ¥å£(ä»£æ›¿å†…ç½®æ¨¡å—urlä½¿ç”¨)</h2><blockquote>
<p>nodejså†…ç½®æ¨¡å—<code>url</code>æœ‰äº›æ–¹æ³•è¦è¢«åºŸå¼ƒï¼Œæˆ‘ä»¬ä½¿ç”¨<code>URLç±»</code>ä»£æ›¿</p>
</blockquote>
<p>æµè§ˆå™¨åŸç”Ÿæä¾›<code>URL()</code>æ¥å£ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥æ„é€ ã€è§£æå’Œç¼–ç  URLã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé€šè¿‡<code>window.URL</code>å¯ä»¥æ‹¿åˆ°è¿™ä¸ªæ„é€ å‡½æ•°ã€‚</p>
<h3 id="7-1-å¯¹æ¯”urlæ¨¡å—å’ŒURLç±»"><a href="#7-1-å¯¹æ¯”urlæ¨¡å—å’ŒURLç±»" class="headerlink" title="7.1 å¯¹æ¯”urlæ¨¡å—å’ŒURLç±»"></a>7.1 å¯¹æ¯”<code>urlæ¨¡å—</code>å’ŒURLç±»</h3><table>
<thead>
<tr>
<th>å±æ€§</th>
<th>urlæ¨¡å—</th>
<th>URLç±»</th>
</tr>
</thead>
<tbody><tr>
<td>protocol</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>host</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>port</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>hostname</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>search</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>query</td>
<td><code>âœ…</code></td>
<td><code>-</code></td>
</tr>
<tr>
<td>path</td>
<td><code>âœ…</code></td>
<td><code>-</code></td>
</tr>
<tr>
<td>pathname</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>href</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>hash</td>
<td><code>âœ…</code></td>
<td><code>âœ…</code></td>
</tr>
<tr>
<td>origin</td>
<td>-</td>
<td><code>âœ…</code></td>
</tr>
</tbody></table>
<p>å¯ä»¥çœ‹å‡ºæ¥ï¼Œåªæœ‰ä¸‰ä¸ªå­—æ®µä¸åŒï¼Œåˆ†åˆ«æ˜¯<code>query</code>,<code>path</code>,<code>origin</code></p>
<pre><code class="js">æ‰“å°ä¸¤ä¸ªå¯¹è±¡çš„è¾“å‡º

// urlæ¨¡å—ï¼Œurl.parse(&#39;link&#39;)
&#123;
  protocol: &#39;https:&#39;,
  slashes: true,
  auth: null,
  host: &#39;m.shop.com&#39;,
  port: null,
  hostname: &#39;m.shop.com&#39;,
  hash: &#39;#detail&#39;,
  search: &#39;?id=4433&amp;name=%E6%9D%8E%E5%A4%87&amp;directCompanyId=&amp;mobile=18951431099&#39;,
  query: &#39;id=4433&amp;name=%E6%9D%8E%E5%A4%87&amp;directCompanyId=&amp;mobile=18951431099&#39;,
  pathname: &#39;/home/share&#39;,
  path: &#39;/home/share?id=4433&amp;name=%E6%9D%8E%E5%A4%87&amp;directCompanyId=&amp;mobile=18951431099&#39;,
  href: &#39;https://m.shop.com/home/share?id=4433&amp;name=%E6%9D%8E%E5%A4%87&amp;directCompanyId=&amp;mobile=18951431099#detail&#39;
&#125;
// new URL()
&#123;
  href: &#39;https://m.shop.com/home/share?id=4433&amp;name=%E6%9D%8E%E5%A4%87&amp;directCompanyId=&amp;mobile=18951431099#detail&#39;,
  origin: &#39;https://m.shop.com&#39;,
  protocol: &#39;https:&#39;,
  username: &#39;&#39;,
  password: &#39;&#39;,
  host: &#39;m.shop.com&#39;,
  hostname: &#39;m.shop.com&#39;,
  port: &#39;&#39;,
  pathname: &#39;/home/share&#39;,
  search: &#39;?id=4433&amp;name=%E6%9D%8E%E5%A4%87&amp;directCompanyId=&amp;mobile=18951431099&#39;,
  searchParams: URLSearchParams &#123;
    &#39;id&#39; =&gt; &#39;4433&#39;,
    &#39;name&#39; =&gt; &#39;æå¤‡&#39;,
    &#39;directCompanyId&#39; =&gt; &#39;&#39;,
    &#39;mobile&#39; =&gt; &#39;18951431099&#39; &#125;,
  hash: &#39;#detail&#39;
&#125;
</code></pre>
<h3 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h3><p><code>URL()</code>ä½œä¸ºæ„é€ å‡½æ•°ï¼Œå¯ä»¥ç”Ÿæˆ URL å®ä¾‹ã€‚å®ƒæ¥å—ä¸€ä¸ªè¡¨ç¤º URL çš„å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ã€‚å¦‚æœå‚æ•°ä¸æ˜¯åˆæ³•çš„ URLï¼Œä¼šæŠ¥é”™ã€‚</p>
<pre><code class="js">var url = new URL(&#39;http://www.example.com/index.html&#39;);
url.href
// &quot;http://www.example.com/index.html&quot;
</code></pre>
<p>ä¸Šé¢ç¤ºä¾‹ç”Ÿæˆäº†ä¸€ä¸ª URL å®ä¾‹ï¼Œç”¨æ¥ä»£è¡¨æŒ‡å®šçš„ç½‘å€ã€‚</p>
<p>é™¤äº†å­—ç¬¦ä¸²ï¼Œ<code>URL()</code>çš„å‚æ•°ä¹Ÿå¯ä»¥æ˜¯å¦ä¸€ä¸ª URL å®ä¾‹ã€‚è¿™æ—¶ï¼Œ<code>URL()</code>ä¼šè‡ªåŠ¨è¯»å–è¯¥å®ä¾‹çš„<code>href</code>å±æ€§ï¼Œä½œä¸ºå®é™…å‚æ•°ã€‚</p>
<p>å¦‚æœ URL å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œé‚£ä¹ˆéœ€è¦è¡¨ç¤ºç»å¯¹è·¯å¾„çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œä¸ºè®¡ç®—åŸºå‡†ã€‚</p>
<pre><code class="js">var url1 = new URL(&#39;index.html&#39;, &#39;http://example.com&#39;);
url1.href
// &quot;http://example.com/index.html&quot;

var url2 = new URL(&#39;page2.html&#39;, &#39;http://example.com/page1.html&#39;);
url2.href
// &quot;http://example.com/page2.html&quot;

var url3 = new URL(&#39;..&#39;, &#39;http://example.com/a/b.html&#39;)
url3.href
// &quot;http://example.com/&quot;
</code></pre>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè¿”å›çš„ URL å®ä¾‹çš„è·¯å¾„éƒ½æ˜¯åœ¨ç¬¬äºŒä¸ªå‚æ•°çš„åŸºç¡€ä¸Šï¼Œåˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªå‚æ•°å¾—åˆ°çš„ã€‚æœ€åä¸€ä¸ªä¾‹å­é‡Œé¢ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<code>..</code>ï¼Œè¡¨ç¤ºä¸Šå±‚è·¯å¾„ã€‚</p>
<h3 id="å®ä¾‹å±æ€§"><a href="#å®ä¾‹å±æ€§" class="headerlink" title="å®ä¾‹å±æ€§"></a>å®ä¾‹å±æ€§</h3><p>URL å®ä¾‹çš„å±æ€§ä¸<code>Location</code>å¯¹è±¡çš„å±æ€§åŸºæœ¬ä¸€è‡´ï¼Œè¿”å›å½“å‰ URL çš„ä¿¡æ¯ã€‚</p>
<ul>
<li>URL.hrefï¼šè¿”å›æ•´ä¸ª URL</li>
<li>URL.protocolï¼šè¿”å›åè®®ï¼Œä»¥å†’å·<code>:</code>ç»“å°¾</li>
<li>URL.hostnameï¼šè¿”å›åŸŸå</li>
<li>URL.hostï¼šè¿”å›åŸŸåä¸ç«¯å£ï¼ŒåŒ…å«<code>:</code>å·ï¼Œé»˜è®¤çš„80å’Œ443ç«¯å£ä¼šçœç•¥</li>
<li>URL.portï¼šè¿”å›ç«¯å£</li>
<li>URL.originï¼šè¿”å›åè®®ã€åŸŸåå’Œç«¯å£</li>
<li>URL.pathnameï¼šè¿”å›è·¯å¾„ï¼Œä»¥æ–œæ <code>/</code>å¼€å¤´</li>
<li>URL.searchï¼šè¿”å›æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œä»¥é—®å·<code>?</code>å¼€å¤´</li>
<li>URL.searchParamsï¼šè¿”å›ä¸€ä¸ª<code>URLSearchParams</code>å®ä¾‹ï¼Œè¯¥å±æ€§æ˜¯<code>Location</code>å¯¹è±¡æ²¡æœ‰çš„</li>
<li>URL.hashï¼šè¿”å›ç‰‡æ®µè¯†åˆ«ç¬¦ï¼Œä»¥äº•å·<code>#</code>å¼€å¤´</li>
<li>URL.passwordï¼šè¿”å›åŸŸåå‰é¢çš„å¯†ç </li>
<li>URL.usernameï¼šè¿”å›åŸŸåå‰é¢çš„ç”¨æˆ·å</li>
</ul>
<pre><code class="js">var url = new URL(&#39;http://user:passwd@www.example.com:4097/path/a.html?x=111#part1&#39;);

url.href
// &quot;http://user:passwd@www.example.com:4097/path/a.html?x=111#part1&quot;
url.protocol
// &quot;http:&quot;
url.hostname
// &quot;www.example.com&quot;
url.host
// &quot;www.example.com:4097&quot;
url.port
// &quot;4097&quot;
url.origin
// &quot;http://www.example.com:4097&quot;
url.pathname
// &quot;/path/a.html&quot;
url.search
// &quot;?x=111&quot;
url.searchParams
// URLSearchParams &#123;&#125;
url.hash
// &quot;#part1&quot;
url.password
// &quot;passwd&quot;
url.username
// &quot;user&quot;
</code></pre>
<p>è¿™äº›å±æ€§é‡Œé¢ï¼Œåªæœ‰<code>origin</code>å±æ€§æ˜¯åªè¯»çš„ï¼Œå…¶ä»–å±æ€§éƒ½å¯å†™ï¼Œå¹¶ä¸”ä¼šç«‹å³ç”Ÿæ•ˆã€‚</p>
<pre><code class="js">var url = new URL(&#39;http://example.com/index.html#part1&#39;);

url.pathname = &#39;index2.html&#39;;
url.href // &quot;http://example.com/index2.html#part1&quot;

url.hash = &#39;#part2&#39;;
url.href // &quot;http://example.com/index2.html#part2&quot;
</code></pre>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ”¹å˜ URL å®ä¾‹çš„<code>pathname</code>å±æ€§å’Œ<code>hash</code>å±æ€§ï¼Œéƒ½ä¼šå®æ—¶åæ˜ åœ¨ URL å®ä¾‹å½“ä¸­ã€‚</p>
<h2 id="URLSearchParams-å¯¹è±¡-ä»£æ›¿å†…ç½®æ¨¡å—querystringä½¿ç”¨"><a href="#URLSearchParams-å¯¹è±¡-ä»£æ›¿å†…ç½®æ¨¡å—querystringä½¿ç”¨" class="headerlink" title="URLSearchParams å¯¹è±¡(ä»£æ›¿å†…ç½®æ¨¡å—querystringä½¿ç”¨)"></a>URLSearchParams å¯¹è±¡(ä»£æ›¿å†…ç½®æ¨¡å—querystringä½¿ç”¨)</h2><blockquote>
<ol>
<li><p>nodejså†…ç½®æ¨¡å—<code>querystring</code>æœ‰äº›æ–¹æ³•è¦è¢«åºŸå¼ƒï¼Œæˆ‘ä»¬ä½¿ç”¨<code>URLSearchParams API </code>æ„é€ ä»£æ›¿</p>
</li>
<li><p>å¦‚æœä½ çš„nodejsç‰ˆæœ¬å¤§äº18ï¼Œå¯ä»¥ä½¿ç”¨<code>const querystring= require(&#39;node:querystring&#39;)</code><br>&#96;&#96;querystring<code>æ¯”</code>URLSearchParams<code>æ€§èƒ½æ›´é«˜ï¼Œä½†ä¸æ˜¯ æ ‡å‡†åŒ–çš„ APIã€‚ä½¿ç”¨</code>URLSearchParams&#96;å½“æ€§èƒ½ä¸é‡è¦æˆ– å½“éœ€è¦ä¸æµè§ˆå™¨ä»£ç å…¼å®¹æ—¶ã€‚</p>
</li>
<li><p>è¿˜å¯ä»¥å®‰è£…<code>qs</code>æ¨¡å—ï¼Œä½¿ç”¨æ–¹å¼å’Œ<code>querystring</code>ä¸€æ ·</p>
</li>
</ol>
</blockquote>
<h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p><code>URLSearchParams</code>å¯¹è±¡æ˜¯æµè§ˆå™¨çš„åŸç”Ÿå¯¹è±¡ï¼Œç”¨æ¥æ„é€ ã€è§£æå’Œå¤„ç† URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆå³ URL é—®å·åé¢çš„éƒ¨åˆ†ï¼‰ã€‚</p>
<p>å®ƒæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥ç”Ÿæˆå®ä¾‹ã€‚å‚æ•°å¯ä»¥ä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œèµ·é¦–çš„é—®å·<code>?</code>æœ‰æ²¡æœ‰éƒ½è¡Œï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹åº”æŸ¥è¯¢å­—ç¬¦ä¸²çš„æ•°ç»„æˆ–å¯¹è±¡ã€‚</p>
<pre><code class="js">// æ–¹æ³•ä¸€ï¼šä¼ å…¥å­—ç¬¦ä¸²
var params = new URLSearchParams(&#39;?foo=1&amp;bar=2&#39;);
// ç­‰åŒäº
var params = new URLSearchParams(document.location.search);

// æ–¹æ³•äºŒï¼šä¼ å…¥æ•°ç»„
var params = new URLSearchParams([[&#39;foo&#39;, 1], [&#39;bar&#39;, 2]]);

// æ–¹æ³•ä¸‰ï¼šä¼ å…¥å¯¹è±¡
var params = new URLSearchParams(&#123;&#39;foo&#39; : 1 , &#39;bar&#39; : 2&#125;);
</code></pre>
<p><code>URLSearchParams</code>ä¼šå¯¹æŸ¥è¯¢å­—ç¬¦ä¸²è‡ªåŠ¨ç¼–ç ã€‚</p>
<pre><code class="js">var params = new URLSearchParams(&#123;&#39;foo&#39;: &#39;ä½ å¥½&#39;&#125;);
params.toString() // &quot;foo=%E4%BD%A0%E5%A5%BD&quot;
</code></pre>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>foo</code>çš„å€¼æ˜¯æ±‰å­—ï¼Œ<code>URLSearchParams</code>å¯¹å…¶è‡ªåŠ¨è¿›è¡Œ URL ç¼–ç ã€‚</p>
<p>æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è¡¨å•æ•°æ®æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨<code>URLSearchParams</code>å®ä¾‹ä½œä¸ºè¡¨å•æ•°æ®ã€‚</p>
<pre><code class="js">const params = new URLSearchParams(&#123;foo: 1, bar: 2&#125;);
fetch(&#39;https://example.com/api&#39;, &#123;
  method: &#39;POST&#39;,
  body: params
&#125;).then(...)
</code></pre>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>fetch</code>å‘½ä»¤å‘æœåŠ¡å™¨å‘é€å‘½ä»¤æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨<code>URLSearchParams</code>å®ä¾‹ã€‚</p>
<p><code>URLSearchParams</code>å¯ä»¥ä¸<code>URL()</code>æ¥å£ç»“åˆä½¿ç”¨ã€‚</p>
<pre><code class="js">var url = new URL(window.location);
var foo = url.searchParams.get(&#39;foo&#39;) || &#39;somedefault&#39;;
</code></pre>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒURL å®ä¾‹çš„<code>searchParams</code>å±æ€§å°±æ˜¯ä¸€ä¸ª<code>URLSearchParams</code>å®ä¾‹ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨<code>URLSearchParams</code>æ¥å£çš„<code>get</code>æ–¹æ³•ã€‚</p>
<p><code>URLSearchParams</code>å®ä¾‹æœ‰éå†å™¨æ¥å£ï¼Œå¯ä»¥ç”¨<code>for...of</code>å¾ªç¯éå†ã€‚</p>
<pre><code class="js">var params = new URLSearchParams(&#123;&#39;foo&#39;: 1 , &#39;bar&#39;: 2&#125;);

for (var p of params) &#123;
  console.log(p[0] + &#39;: &#39; + p[1]);
&#125;
// foo: 1
// bar: 2
</code></pre>
<p><code>URLSearchParams</code>æ²¡æœ‰å®ä¾‹å±æ€§ï¼Œåªæœ‰å®ä¾‹æ–¹æ³•ã€‚</p>
<h3 id="URLSearchParams-toString"><a href="#URLSearchParams-toString" class="headerlink" title="URLSearchParams.toString()"></a>URLSearchParams.toString()</h3><p><code>toString</code>æ–¹æ³•è¿”å›å®ä¾‹çš„å­—ç¬¦ä¸²å½¢å¼ã€‚</p>
<pre><code class="js">var url = new URL(&#39;https://example.com?foo=1&amp;bar=2&#39;);
var params = new URLSearchParams(url.search);

params.toString() // &quot;foo=1&amp;bar=2&#39;
</code></pre>
<p>é‚£ä¹ˆéœ€è¦å­—ç¬¦ä¸²çš„åœºåˆï¼Œä¼šè‡ªåŠ¨è°ƒç”¨<code>toString</code>æ–¹æ³•ã€‚</p>
<pre><code class="js">var params = new URLSearchParams(&#123;version: 2.0&#125;);
window.location.href = location.pathname + &#39;?&#39; + params;
</code></pre>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>location.href</code>èµ‹å€¼æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨<code>params</code>å¯¹è±¡ã€‚è¿™æ—¶å°±ä¼šè‡ªåŠ¨è°ƒç”¨<code>toString</code>æ–¹æ³•ã€‚</p>
<h3 id="URLSearchParams-has"><a href="#URLSearchParams-has" class="headerlink" title="URLSearchParams.has()"></a>URLSearchParams.has()</h3><p><code>has()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸ¥è¯¢å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æŒ‡å®šçš„é”®åã€‚</p>
<pre><code class="js">var params = new URLSearchParams(&#123;&#39;foo&#39;: 1 , &#39;bar&#39;: 2&#125;);
params.has(&#39;bar&#39;) // true
params.has(&#39;baz&#39;) // false
</code></pre>
<h3 id="URLSearchParams-get-ï¼ŒURLSearchParams-getAll"><a href="#URLSearchParams-get-ï¼ŒURLSearchParams-getAll" class="headerlink" title="URLSearchParams.get()ï¼ŒURLSearchParams.getAll()"></a>URLSearchParams.get()ï¼ŒURLSearchParams.getAll()</h3><p><code>get()</code>æ–¹æ³•ç”¨æ¥è¯»å–æŸ¥è¯¢å­—ç¬¦ä¸²é‡Œé¢çš„æŒ‡å®šé”®ã€‚å®ƒæ¥å—é”®åä½œä¸ºå‚æ•°ã€‚</p>
<pre><code class="js">var params = new URLSearchParams(&#39;?foo=1&#39;);
params.get(&#39;foo&#39;) // &quot;1&quot;
params.get(&#39;bar&#39;) // null
</code></pre>
<p>ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€‚ç¬¬ä¸€ï¼Œå®ƒè¿”å›çš„æ˜¯å­—ç¬¦ä¸²ï¼Œå¦‚æœåŸå§‹å€¼æ˜¯æ•°å€¼ï¼Œéœ€è¦è½¬ä¸€ä¸‹ç±»å‹ï¼›ç¬¬äºŒï¼Œå¦‚æœæŒ‡å®šçš„é”®åä¸å­˜åœ¨ï¼Œè¿”å›å€¼æ˜¯<code>null</code>ã€‚</p>
<p>å¦‚æœæœ‰å¤šä¸ªçš„åŒåé”®ï¼Œ<code>get</code>è¿”å›ä½ç½®æœ€å‰é¢çš„é‚£ä¸ªé”®å€¼ã€‚</p>
<pre><code class="js">var params = new URLSearchParams(&#39;?foo=3&amp;foo=2&amp;foo=1&#39;);
params.get(&#39;foo&#39;) // &quot;3&quot;
</code></pre>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²æœ‰ä¸‰ä¸ª<code>foo</code>é”®ï¼Œ<code>get</code>æ–¹æ³•è¿”å›æœ€å‰é¢çš„é”®å€¼<code>3</code>ã€‚</p>
<p><code>getAll()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯æŒ‡å®šé”®çš„æ‰€æœ‰é”®å€¼ã€‚å®ƒæ¥å—é”®åä½œä¸ºå‚æ•°ã€‚</p>
<pre><code class="js">var params = new URLSearchParams(&#39;?foo=1&amp;foo=2&#39;);
params.getAll(&#39;foo&#39;) // [&quot;1&quot;, &quot;2&quot;]
</code></pre>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²æœ‰ä¸¤ä¸ª<code>foo</code>é”®ï¼Œ<code>getAll</code>è¿”å›çš„æ•°ç»„å°±æœ‰ä¸¤ä¸ªæˆå‘˜ã€‚</p>
<h3 id="URLSearchParams-keys-ï¼ŒURLSearchParams-values-ï¼ŒURLSearchParams-entries"><a href="#URLSearchParams-keys-ï¼ŒURLSearchParams-values-ï¼ŒURLSearchParams-entries" class="headerlink" title="URLSearchParams.keys()ï¼ŒURLSearchParams.values()ï¼ŒURLSearchParams.entries()"></a>URLSearchParams.keys()ï¼ŒURLSearchParams.values()ï¼ŒURLSearchParams.entries()</h3><p>è¿™ä¸‰ä¸ªæ–¹æ³•éƒ½è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä¾›<code>for...of</code>å¾ªç¯éå†ã€‚å®ƒä»¬çš„åŒºåˆ«åœ¨äºï¼Œ<code>keys</code>æ–¹æ³•è¿”å›çš„æ˜¯é”®åçš„éå†å™¨ï¼Œ<code>values</code>æ–¹æ³•è¿”å›çš„æ˜¯é”®å€¼çš„éå†å™¨ï¼Œ<code>entries</code>è¿”å›çš„æ˜¯é”®å€¼å¯¹çš„éå†å™¨ã€‚</p>
<pre><code class="js">var params = new URLSearchParams(&#39;a=1&amp;b=2&#39;);

for(var p of params.keys()) &#123;
  console.log(p);
&#125;
// a
// b

for(var p of params.values()) &#123;
  console.log(p);
&#125;
// 1
// 2

for(var p of params.entries()) &#123;
  console.log(p);
&#125;
// [&quot;a&quot;, &quot;1&quot;]
// [&quot;b&quot;, &quot;2&quot;]
</code></pre>
<p>å¦‚æœç›´æ¥å¯¹<code>URLSearchParams</code>è¿›è¡Œéå†ï¼Œå…¶å®å†…éƒ¨è°ƒç”¨çš„å°±æ˜¯<code>entries</code>æ¥å£ã€‚</p>
<pre><code class="js">for (var p of params) &#123;&#125;
// ç­‰åŒäº
for (var p of params.entries()) &#123;&#125;
</code></pre>
<h2 id="qsæ¨¡å—"><a href="#qsæ¨¡å—" class="headerlink" title="qsæ¨¡å—"></a>qsæ¨¡å—</h2><p>qsæ˜¯ä¸€ä¸ªnpmä»“åº“æ‰€ç®¡ç†çš„åŒ…,å¯é€šè¿‡npm install qså‘½ä»¤è¿›è¡Œå®‰è£….</p>
<ol>
<li>qs.parse()å°†URLè§£ææˆå¯¹è±¡çš„å½¢å¼</li>
<li>qs.stringify()å°†å¯¹è±¡ åºåˆ—åŒ–æˆURLçš„å½¢å¼ï¼Œä»¥&amp;è¿›è¡Œæ‹¼æ¥</li>
</ol>
<pre><code class="javascript">const qs = require(&#39;qs&#39;);

1.qs.parse()
const str = &quot;username=&#39;admin&#39;&amp;password=&#39;123456&#39;&quot;;
console.log(qs.parse(str)); 
// Object &#123; username: &quot;admin&quot;, password: &quot;123456&quot; &#125;

2.qs.stringify()
const a = qs.stringify(&#123; username: &#39;admin&#39;, password: &#39;123456&#39; &#125;);
console.log(a); 
// username=admin&amp;password=123456
</code></pre>
<pre><code class="js">qs.stringify() å’ŒJSON.stringify()æœ‰ä»€ä¹ˆåŒºåˆ«?

var a = &#123;name:&#39;hehe&#39;,age:10&#125;;
qs.stringifyåºåˆ—åŒ–ç»“æœå¦‚
name=hehe&amp;age=10
--------------------
è€ŒJSON.stringifyåºåˆ—åŒ–ç»“æœå¦‚ä¸‹ï¼š
&quot;&#123;&quot;a&quot;:&quot;hehe&quot;,&quot;age&quot;:10&#125;&quot;
</code></pre>
<h1 id="06-ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸­ï¼‰ã€‘"><a href="#06-ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸­ï¼‰ã€‘" class="headerlink" title="06 ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸­ï¼‰ã€‘"></a>06 ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸­ï¼‰ã€‘</h1><h2 id="1-è·¯åŠ²å¤„ç†æ¨¡å—-path"><a href="#1-è·¯åŠ²å¤„ç†æ¨¡å—-path" class="headerlink" title="1.è·¯åŠ²å¤„ç†æ¨¡å— path"></a>1.è·¯åŠ²å¤„ç†æ¨¡å— path</h2><h3 id="1-1-æ¨¡å—æ¦‚è§ˆ"><a href="#1-1-æ¨¡å—æ¦‚è§ˆ" class="headerlink" title="1.1 æ¨¡å—æ¦‚è§ˆ"></a>1.1 æ¨¡å—æ¦‚è§ˆ</h3><p>åœ¨nodejsä¸­ï¼Œpathæ˜¯ä¸ªä½¿ç”¨é¢‘ç‡å¾ˆé«˜ï¼Œä½†å´è®©äººåˆçˆ±åˆæ¨çš„æ¨¡å—ã€‚éƒ¨åˆ†å› ä¸ºæ–‡æ¡£è¯´çš„ä¸å¤Ÿæ¸…æ™°ï¼Œéƒ¨åˆ†å› ä¸ºæ¥å£çš„å¹³å°å·®å¼‚æ€§ã€‚</p>
<p>å°†pathçš„æ¥å£æŒ‰ç…§ç”¨é€”å½’ç±»ï¼Œä»”ç»†ç¢ç£¨ç¢ç£¨ï¼Œä¹Ÿå°±æ²¡é‚£ä¹ˆè´¹è§£äº†ã€‚</p>
<h3 id="1-2-è·å–è·¯å¾„-x2F-æ–‡ä»¶å-x2F-æ‰©å±•å"><a href="#1-2-è·å–è·¯å¾„-x2F-æ–‡ä»¶å-x2F-æ‰©å±•å" class="headerlink" title="1.2 è·å–è·¯å¾„&#x2F;æ–‡ä»¶å&#x2F;æ‰©å±•å"></a>1.2 è·å–è·¯å¾„&#x2F;æ–‡ä»¶å&#x2F;æ‰©å±•å</h3><ul>
<li>è·å–è·¯å¾„ï¼špath.dirname(filepath)</li>
<li>è·å–æ–‡ä»¶åï¼špath.basename(filepath)</li>
<li>è·å–æ‰©å±•åï¼špath.extname(filepath)</li>
</ul>
<h4 id="1-2-1-è·å–æ‰€åœ¨è·¯å¾„"><a href="#1-2-1-è·å–æ‰€åœ¨è·¯å¾„" class="headerlink" title="1.2.1 è·å–æ‰€åœ¨è·¯å¾„"></a>1.2.1 è·å–æ‰€åœ¨è·¯å¾„</h4><p>ä¾‹å­å¦‚ä¸‹ï¼š</p>
<pre><code class="javascript">var path = require(&#39;path&#39;);
var filepath = &#39;/tmp/demo/js/test.js&#39;;

// è¾“å‡ºï¼š/tmp/demo/js
console.log( path.dirname(filepath) );
</code></pre>
<h4 id="1-2-2-è·å–æ–‡ä»¶å"><a href="#1-2-2-è·å–æ–‡ä»¶å" class="headerlink" title="1.2.2 è·å–æ–‡ä»¶å"></a>1.2.2 è·å–æ–‡ä»¶å</h4><p>ä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´ï¼Œpath.basename(filepath) åªæ˜¯è¾“å‡ºè·¯å¾„çš„æœ€åä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸ä¼šåˆ¤æ–­æ˜¯å¦æ–‡ä»¶åã€‚</p>
<p>ä½†å¤§éƒ¨åˆ†æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥ä½œä¸ºç®€æ˜“çš„â€œè·å–æ–‡ä»¶åâ€œçš„æ–¹æ³•ã€‚</p>
<pre><code class="javascript">var path = require(&#39;path&#39;);

// è¾“å‡ºï¼štest.js
console.log( path.basename(&#39;/tmp/demo/js/test.js&#39;) );

// è¾“å‡ºï¼štest
console.log( path.basename(&#39;/tmp/demo/js/test/&#39;) );

// è¾“å‡ºï¼štest
console.log( path.basename(&#39;/tmp/demo/js/test&#39;) );
</code></pre>
<p>å¦‚æœåªæƒ³è·å–æ–‡ä»¶åï¼Œå•ä¸åŒ…æ‹¬æ–‡ä»¶æ‰©å±•å‘¢ï¼Ÿå¯ä»¥ç”¨ä¸Šç¬¬äºŒä¸ªå‚æ•°ã€‚</p>
<pre><code class="javascript">// è¾“å‡ºï¼štest
console.log( path.basename(&#39;/tmp/demo/js/test.js&#39;, &#39;.js&#39;) );
</code></pre>
<h4 id="1-2-3-è·å–æ–‡ä»¶æ‰©å±•å"><a href="#1-2-3-è·å–æ–‡ä»¶æ‰©å±•å" class="headerlink" title="1.2.3 è·å–æ–‡ä»¶æ‰©å±•å"></a>1.2.3 è·å–æ–‡ä»¶æ‰©å±•å</h4><p>ç®€å•çš„ä¾‹å­å¦‚ä¸‹ï¼š</p>
<pre><code class="javascript">var path = require(&#39;path&#39;);
var filepath = &#39;/tmp/demo/js/test.js&#39;;

// è¾“å‡ºï¼š.js
console.log( path.extname(filepath) );
</code></pre>
<p>æ›´è¯¦ç»†çš„è§„åˆ™æ˜¯å¦‚ä¸‹ï¼šï¼ˆå‡è®¾ path.basename(filepath) &#x3D;&#x3D;&#x3D; B ï¼‰</p>
<ul>
<li>ä»Bçš„æœ€åä¸€ä¸ª<code>.</code>å¼€å§‹æˆªå–ï¼Œç›´åˆ°æœ€åä¸€ä¸ªå­—ç¬¦ã€‚</li>
<li>å¦‚æœBä¸­ä¸å­˜åœ¨<code>.</code>ï¼Œæˆ–è€…Bçš„ç¬¬ä¸€ä¸ªå­—ç¬¦å°±æ˜¯<code>.</code>ï¼Œé‚£ä¹ˆè¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</li>
</ul>
<p>ç›´æ¥çœ‹<span class="exturl" data-url="aHR0cHM6Ly9ub2RlanMub3JnL2FwaS9wYXRoLmh0bWwjcGF0aF9wYXRoX2V4dG5hbWVfcGF0aA==">å®˜æ–¹æ–‡æ¡£</span>çš„ä¾‹å­</p>
<pre><code class="javascript">path.extname(&#39;index.html&#39;)
// returns &#39;.html&#39;

path.extname(&#39;index.coffee.md&#39;)
// returns &#39;.md&#39;

path.extname(&#39;index.&#39;)
// returns &#39;.&#39;

path.extname(&#39;index&#39;)
// returns &#39;&#39;

path.extname(&#39;.index&#39;)
// returns &#39;&#39;
</code></pre>
<h3 id="1-3-è·¯å¾„ç»„åˆ"><a href="#1-3-è·¯å¾„ç»„åˆ" class="headerlink" title="1.3 è·¯å¾„ç»„åˆ"></a>1.3 è·¯å¾„ç»„åˆ</h3><ul>
<li>path.join([â€¦paths])</li>
<li>path.resolve([â€¦paths])</li>
</ul>
<h4 id="1-3-1-path-resolve-ç”Ÿæˆå®Œæˆçš„ç»å¯¹è·¯å¾„"><a href="#1-3-1-path-resolve-ç”Ÿæˆå®Œæˆçš„ç»å¯¹è·¯å¾„" class="headerlink" title="1.3.1 path.resolve() ç”Ÿæˆå®Œæˆçš„ç»å¯¹è·¯å¾„"></a>1.3.1 path.resolve() ç”Ÿæˆå®Œæˆçš„ç»å¯¹è·¯å¾„</h4><p>è¯­æ³•æ ¼å¼ï¼š</p>
<pre><code class="js">path.resolve([...myPaths])
</code></pre>
<p>è§£é‡Šï¼š</p>
<ul>
<li>å°†è·¯å¾„æˆ–è·¯å¾„ç‰‡æ®µçš„åºåˆ—è§£æä¸ºç»å¯¹è·¯å¾„ã€‚</li>
<li>è¿”å›çš„è·¯å¾„æ˜¯<strong>ä»å³å¾€å·¦</strong>å¤„ç†ï¼Œåé¢çš„æ¯ä¸ª myPath è¢«ä¾æ¬¡è§£æï¼Œç›´åˆ°æ„é€ å‡ºä¸€ä¸ªå®Œæ•´çš„ç»å¯¹è·¯å¾„ã€‚</li>
</ul>
<blockquote>
<p>ä½ å¯ä»¥æƒ³è±¡ç°åœ¨ä½ åœ¨shellä¸‹é¢ï¼Œä»å·¦åˆ°å³è¿è¡Œä¸€é<code>cd path</code>å‘½ä»¤ï¼Œæœ€ç»ˆè·å–çš„ç»å¯¹è·¯å¾„&#x2F;æ–‡ä»¶åï¼Œå°±æ˜¯è¿™ä¸ªæ¥å£æ‰€è¿”å›çš„ç»“æœäº†ã€‚</p>
</blockquote>
<p>ä»£ç ä¸¾ä¾‹ï¼š</p>
<pre><code class="js">const path = require(&#39;path&#39;);

let arr1 = [&#39;/foo1/foo2&#39;, &#39;dselegent&#39;, &#39;foo3&#39;];
let result1 = path.resolve(...arr1);
console.log(result1); // æ‰“å°ç»“æœï¼š/foo1/foo2/dselegent/foo3

let arr2 = [&#39;/foo1/foo2&#39;, &#39;/dselegent&#39;, &#39;foo3&#39;];
let result2 = path.resolve(...arr2);
console.log(result2); // æ‰“å°ç»“æœï¼š/dselegent/foo3
</code></pre>
<pre><code class="javascript">const path = require(&#39;path&#39;);

// å‡è®¾å½“å‰å·¥ä½œè·¯å¾„æ˜¯ /Users/a/Documents/git-code/nodejs-learning-guide/examples/2016.11.08-node-path

// è¾“å‡º /Users/a/Documents/git-code/nodejs-learning-guide/examples/2016.11.08-node-path
console.log( path.resolve(&#39;&#39;) )

// è¾“å‡º /Users/a/Documents/git-code/nodejs-learning-guide/examples/2016.11.08-node-path
console.log( path.resolve(&#39;.&#39;) )

// è¾“å‡º /foo/bar/baz
console.log( path.resolve(&#39;/foo/bar&#39;, &#39;./baz&#39;) );

// è¾“å‡º /foo/bar/baz
console.log( path.resolve(&#39;/foo/bar&#39;, &#39;./baz/&#39;) );

// è¾“å‡º /tmp/file
console.log( path.resolve(&#39;/foo/bar&#39;, &#39;/tmp/file/&#39;) );

// è¾“å‡º /Users/a/Documents/git-code/nodejs-learning-guide/examples/2016.11.08-node-path/www/js/mod.js
console.log( path.resolve(&#39;www&#39;, &#39;js/upload&#39;, &#39;../mod.js&#39;) );
</code></pre>
<h4 id="1-3-2-path-join-å°†å¤šä¸ªè·¯å¾„è¿›è¡Œæ‹¼æ¥"><a href="#1-3-2-path-join-å°†å¤šä¸ªè·¯å¾„è¿›è¡Œæ‹¼æ¥" class="headerlink" title="1.3.2 path.join() å°†å¤šä¸ªè·¯å¾„è¿›è¡Œæ‹¼æ¥"></a>1.3.2 path.join() å°†å¤šä¸ªè·¯å¾„è¿›è¡Œæ‹¼æ¥</h4><p>å¦‚æœæ˜¯æˆ‘ä»¬æ‰‹åŠ¨æ‹¼æ¥è·¯å¾„ï¼Œå®¹æ˜“å‡ºé”™ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¯ä»¥åˆ©ç”¨ path.join() æ–¹æ³•å°†è·¯å¾„è¿›è¡Œæ‹¼æ¥ã€‚</p>
<p>è¯­æ³•æ ¼å¼ï¼š</p>
<pre><code class="js">path.join([...paths]);
</code></pre>
<p>è§£é‡Šï¼šä½¿ç”¨å¹³å°ç‰¹å®šçš„åˆ†éš”ç¬¦ä½œä¸ºå®šç•Œç¬¦å°†æ‰€æœ‰ç»™å®šçš„ path ç‰‡æ®µè¿æ¥åœ¨ä¸€èµ·ï¼Œç„¶åè§„èŒƒåŒ–ç”Ÿæˆçš„è·¯å¾„ã€‚</p>
<p>ä»£ç ä¸¾ä¾‹ï¼š</p>
<pre><code class="js">const path = require(&#39;path&#39;);

const result1 = path.join(__dirname, &#39;./app.js&#39;);
console.log(result1); // è¿”å›ï¼š/Users/smyhvae/dselegent/app.js

const result2 = path.join(&#39;/foo1&#39;, &#39;foo2&#39;, &#39;./foo3&#39;);
console.log(result2); // è¿”å›ï¼š/foo1/foo2/foo3

const result3 = path.join(&#39;/foo1&#39;, &#39;foo2&#39;, &#39;/foo3&#39;);
console.log(result3); // è¿”å›ï¼š/foo1/foo2/foo3
</code></pre>
<h4 id="1-3-3-path-resolve-å’Œ-path-join-åŒºåˆ«"><a href="#1-3-3-path-resolve-å’Œ-path-join-åŒºåˆ«" class="headerlink" title="1.3.3 path.resolve å’Œ path.join åŒºåˆ«"></a>1.3.3 path.resolve å’Œ path.join åŒºåˆ«</h4><p>path.resolve å’Œ path.join éƒ½æ˜¯å±äº path æ ¸å¿ƒæ¨¡å—ä¸‹çš„æ–¹æ³•ï¼Œç”¨æ¥æ‹¼æ¥è·¯å¾„ã€‚</p>
<p>éƒ½å¯ä»¥æ‹¼æ¥æˆä¸€ä¸ªå®Œæ•´è·¯å¾„.</p>
<pre><code class="js">const path = require(&quot;path&quot;);

var dirname = &#39;/User/Desktop&#39;;
var basename = &#39;abc.txt&#39;;

path.join(dirname, basename);  // /User/Desktop/abc.txt

path.resolve(dirname, basename);  // /User/Desktop/abc.txt
</code></pre>
<p>å¦‚æœ dirname æ˜¯ä»¥ .&#x2F; ã€..&#x2F;ã€ä¸åŠ  &#x2F; å¼€å¤´çš„è¯ï¼Œé‚£ä¹ˆ resolve ä¼šæ‰¾åˆ°ç£ç›˜ä¸‹çš„æ ¹ç›®å½•</p>
<pre><code class="javascript">const path = require(&quot;path&quot;);
 
var dirname = &#39;../User/Desktop&#39;;
var basename = &#39;abc.txt&#39;;
 
path.join(dirname, basename);  // ../User/Desktop/abc.txt
 
path.resolve(dirname, basename);  // /Users/Desktop/node/User/Desktop/abc.txt
</code></pre>
<p>å¦‚æœ basename æ˜¯ä»¥ &#x2F; å¼€å¤´çš„ï¼Œé‚£ä¹ˆ resolve å°±ä¼šç›´æ¥è¿”å› basename </p>
<pre><code class="javascript">const path = require(&quot;path&quot;);
 
var dirname = &#39;/User/Desktop&#39;;
var basename = &#39;/abc.txt&#39;;
 
path.join(dirname, basename);  // /User/Desktop/abc.txt
 
path.resolve(dirname, basename);  // /abc.txt
</code></pre>
<h3 id="1-4-å‡ ä¸ªå¸¸è§è·¯å¾„"><a href="#1-4-å‡ ä¸ªå¸¸è§è·¯å¾„" class="headerlink" title="1.4 å‡ ä¸ªå¸¸è§è·¯å¾„"></a>1.4 å‡ ä¸ªå¸¸è§è·¯å¾„</h3><ul>
<li><code>__dirname</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œè¡¨ç¤ºï¼šå½“å‰æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨<strong>å®Œæ•´ç›®å½•</strong>ã€‚</li>
<li><code>__filename</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¸¸é‡ã€‚è¡¨ç¤ºï¼šå½“å‰æ‰§è¡Œæ–‡ä»¶çš„<strong>å®Œæ•´ç›®å½• + æ–‡ä»¶å</strong>ã€‚</li>
<li><code>process.cwd</code>ï¼šè·å–å½“å‰æ‰§è¡Œ Nodeå‘½ä»¤ æ—¶çš„ç›®å½•åã€‚</li>
</ul>
<p>ä»£ç ä¸¾ä¾‹ï¼š</p>
<pre><code class="js">console.log(__dirname);

console.log(__filename);

console.log(process.cwd());
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<pre><code class="bash">$ node app.js

/Users/smyhvae/dselegent
/Users/smyhvae/dselegent/app.js
/Users/smyhvae/dselegent
</code></pre>
<h2 id="2-æœ¬åœ°æ–‡ä»¶æ“ä½œæ¨¡å—-fs"><a href="#2-æœ¬åœ°æ–‡ä»¶æ“ä½œæ¨¡å—-fs" class="headerlink" title="2.æœ¬åœ°æ–‡ä»¶æ“ä½œæ¨¡å— fs"></a>2.æœ¬åœ°æ–‡ä»¶æ“ä½œæ¨¡å— fs</h2><blockquote>
<h3 id="Node-js-ä¸­çš„åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«"><a href="#Node-js-ä¸­çš„åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«" class="headerlink" title="Node.js ä¸­çš„åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«"></a>Node.js ä¸­çš„åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«</h3><p>fsæ¨¡å—å¯¹æ–‡ä»¶çš„å‡ ä¹æ‰€æœ‰æ“ä½œéƒ½æœ‰åŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§å½¢å¼ã€‚ä¾‹å¦‚ï¼šreadFile() å’Œ readFileSync()ã€‚</p>
<p>åŒºåˆ«ï¼š</p>
<ul>
<li>åŒæ­¥è°ƒç”¨ä¼šé˜»å¡ä»£ç çš„æ‰§è¡Œï¼Œå¼‚æ­¥åˆ™ä¸ä¼šã€‚</li>
<li>å¼‚æ­¥è°ƒç”¨ä¼šå°† è¯»å–ä»»åŠ¡ ä¸‹è¾¾åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œç›´åˆ°ä»»åŠ¡æ‰§è¡Œå®Œæˆæ‰ä¼šå›è°ƒã€‚</li>
<li>å¼‚å¸¸å¤„ç†æ–¹é¢ï¼šåŒæ­¥å¿…é¡»ä½¿ç”¨ try catch æ–¹å¼ï¼Œå¼‚æ­¥å¯ä»¥é€šè¿‡å›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚ã€é‡è¦ã€‘</li>
</ul>
</blockquote>
<h3 id="2-1-æ–‡ä»¶è¯»å–"><a href="#2-1-æ–‡ä»¶è¯»å–" class="headerlink" title="2.1 æ–‡ä»¶è¯»å–"></a>2.1 æ–‡ä»¶è¯»å–</h3><p><strong>åŒæ­¥è¯»å–</strong></p>
<pre><code class="javascript">var fs = require(&#39;fs&#39;);
var data;

try&#123;
    data = fs.readFileSync(&#39;./fileForRead.txt&#39;, &#39;utf8&#39;);
    console.log(&#39;æ–‡ä»¶å†…å®¹: &#39; + data);
&#125;catch(err)&#123;
    console.error(&#39;è¯»å–æ–‡ä»¶å‡ºé”™: &#39; + err.message);
&#125;
</code></pre>
<p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre><code class="bash">/usr/local/bin/node readFileSync.js
æ–‡ä»¶å†…å®¹: hello world
</code></pre>
<p><strong>å¼‚æ­¥è¯»å–</strong></p>
<pre><code class="javascript">var fs = require(&#39;fs&#39;);

fs.readFile(&#39;./fileForRead.txt&#39;, &#39;utf8&#39;, function(err, data)&#123;
    if(err)&#123;
        return console.error(&#39;è¯»å–æ–‡ä»¶å‡ºé”™: &#39; + err.message);
    &#125;
    console.log(&#39;æ–‡ä»¶å†…å®¹: &#39; + data);
&#125;);
</code></pre>
<p>è¾“å‡ºå¦‚ä¸‹</p>
<pre><code class="bash">/usr/local/bin/node readFile.js
æ–‡ä»¶å†…å®¹: hello world
</code></pre>
<blockquote>
<p><strong>fs&#x2F;promises ä» Node.js 14 å¼€å§‹å¯ç”¨</strong><br>ä» Node.js 14 å¼€å§‹ï¼Œfs æ¨¡å—æä¾›äº†ä¸¤ç§ä½¿ç”¨åŸºäº promises çš„æ–‡ä»¶ç³»ç»Ÿçš„æ–¹æ³•ã€‚è¿™äº› promises å¯ä»¥é€šè¿‡ <code>require(&#39;fs&#39;).promises</code> æˆ– <code>require(&#39;fs/promises&#39;) </code>è·å¾—ã€‚</p>
</blockquote>
<pre><code class="js">import &#123; readFile &#125; from &#39;fs/promises&#39;;

try &#123;
  const contents = await readFile(filePath, &#123; encoding: &#39;utf8&#39; &#125;);
  console.log(contents);
&#125; catch (err) &#123;
  console.error(err.message);
&#125;
</code></pre>
<h3 id="2-2-æ–‡ä»¶å†™å…¥"><a href="#2-2-æ–‡ä»¶å†™å…¥" class="headerlink" title="2.2 æ–‡ä»¶å†™å…¥"></a>2.2 æ–‡ä»¶å†™å…¥</h3><p>å¤‡æ³¨ï¼šä»¥ä¸‹ä»£ç ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–‡ä»¶ï¼›å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œåˆ™è¦†ç›–æ–‡ä»¶å†…å®¹ï¼›</p>
<p><strong>å¼‚æ­¥å†™å…¥</strong></p>
<pre><code class="javascript">var fs = require(&#39;fs&#39;);

fs.writeFile(&#39;./fileForWrite.txt&#39;, &#39;hello world&#39;, &#39;utf8&#39;, function(err)&#123;
    if(err) throw err;
    console.log(&#39;æ–‡ä»¶å†™å…¥æˆåŠŸ&#39;);
&#125;);
</code></pre>
<p><strong>åŒæ­¥å†™å…¥</strong></p>
<pre><code class="javascript">var fs = require(&#39;fs&#39;);

try&#123;
    fs.writeFileSync(&#39;./fileForWrite1.txt&#39;, &#39;hello world&#39;, &#39;utf8&#39;);
    console.log(&#39;æ–‡ä»¶å†™å…¥æˆåŠŸ&#39;);
&#125;catch(err)&#123;
    throw err;
&#125;
</code></pre>
<p><strong>promises</strong></p>
<pre><code class="js">import &#123; writeFile &#125; from &#39;fs/promises&#39;;

try &#123;
  const contents = await writeFile(&#39;message.txt&#39;, &#39;hello world&#39;, &#123; encoding: &#39;utf8&#39; &#125;);
  console.log(contents);
&#125; catch (err) &#123;
  // When a request is aborted - err is an AbortError
  console.error(err);
&#125;
</code></pre>
<h3 id="2-3-æ–‡ä»¶æ˜¯å¦å­˜åœ¨"><a href="#2-3-æ–‡ä»¶æ˜¯å¦å­˜åœ¨" class="headerlink" title="2.3 æ–‡ä»¶æ˜¯å¦å­˜åœ¨"></a>2.3 æ–‡ä»¶æ˜¯å¦å­˜åœ¨</h3><p><code>fs.exists()</code>å·²ç»æ˜¯<code>deprecated</code>çŠ¶æ€ï¼Œç°åœ¨å¯ä»¥é€šè¿‡ä¸‹é¢ä»£ç åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚</p>
<p><strong>å¼‚æ­¥æœ¬</strong></p>
<pre><code class="js">const fs = require(&#39;fs&#39;)

//æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨äºå½“å‰ç›®å½•ä¸­
fs.access(&#39;package.json&#39;, fs.constants.F_OK, err =&gt; &#123;
    if(err) &#123;
        console.log(&#39;package.jsonä¸å­˜åœ¨äºå½“å‰ç›®å½•ä¸­&#39;)
        return
    &#125;
    console.log(&#39;package.jsonå­˜åœ¨äºå½“å‰ç›®å½•ä¸­&#39;)
&#125;)

fs.access(&#39;index.js&#39;, fs.constants.F_OK, err =&gt; &#123;
    if(err) &#123;
        console.log(&#39;index.jsä¸å­˜åœ¨äºå½“å‰ç›®å½•ä¸­&#39;)
        return
    &#125;
    console.log(&#39;index.jså­˜åœ¨äºå½“å‰ç›®å½•ä¸­&#39;)
&#125;)
</code></pre>
<p><code>fs.access()</code>é™¤äº†åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰ï¼Œè¿˜å¯ä»¥ç”¨æ¥åˆ¤æ–­æ–‡ä»¶çš„æƒé™ã€‚</p>
<p>å¤‡å¿˜ï¼š<code>fs.constants.F_OK</code>ç­‰å¸¸é‡æ— æ³•è·å–ï¼ˆnode v6.1ï¼Œmac 10.11.4ä¸‹ï¼Œ<code>fs.constants</code>æ˜¯<code>undefined</code>ï¼‰</p>
<p><strong>åŒæ­¥</strong></p>
<pre><code class="js">import &#123; accessSync, constants &#125; from &#39;fs&#39;;

try &#123;
  accessSync(&#39;etc/passwd&#39;, constants.R_OK );
  console.log(&#39;can read&#39;);
&#125; catch (err) &#123;
  console.error(&#39;no access!&#39;);
&#125;
</code></pre>
<p><strong>promises</strong></p>
<pre><code class="js">import &#123; access, constants &#125; from &#39;node:fs/promises&#39;;

try &#123;
  await access(&#39;/etc/passwd&#39;, constants.R_OK);
  console.log(&#39;can access&#39;);
&#125; catch &#123;
  console.error(&#39;cannot access&#39;);
&#125;
</code></pre>
<h3 id="2-4-åˆ é™¤æ–‡ä»¶"><a href="#2-4-åˆ é™¤æ–‡ä»¶" class="headerlink" title="2.4 åˆ é™¤æ–‡ä»¶"></a>2.4 åˆ é™¤æ–‡ä»¶</h3><p><strong>å¼‚æ­¥ç‰ˆæœ¬</strong></p>
<pre><code class="javascript">var fs = require(&#39;fs&#39;);

fs.unlink(&#39;./fileForUnlink.txt&#39;, function(err)&#123;
    if(err) throw err;
    console.log(&#39;æ–‡ä»¶åˆ é™¤æˆåŠŸ&#39;);
&#125;);
</code></pre>
<p><strong>åŒæ­¥ç‰ˆæœ¬</strong></p>
<pre><code class="js">import &#123; unlinkSync &#125; from &#39;fs&#39;;

try &#123;
  unlinkSync(&#39;/tmp/hello&#39;);
  console.log(&#39;successfully deleted /tmp/hello&#39;);
&#125; catch (err) &#123;
  // handle the error
&#125;
</code></pre>
<p><strong>promises</strong></p>
<pre><code class="js">import &#123; unlink &#125; from &#39;fs/promises&#39;;

try &#123;
  await unlink(&#39;/tmp/hello&#39;);
  console.log(&#39;successfully deleted /tmp/hello&#39;);
&#125; catch (err) &#123;
  // handle the error
&#125;
</code></pre>
<h3 id="2-5-åˆ›å»ºç›®å½•"><a href="#2-5-åˆ›å»ºç›®å½•" class="headerlink" title="2.5 åˆ›å»ºç›®å½•"></a>2.5 åˆ›å»ºç›®å½•</h3><p><strong>å¼‚æ­¥ç‰ˆæœ¬</strong>ï¼ˆå¦‚æœç›®å½•å·²å­˜åœ¨ï¼Œä¼šæŠ¥é”™ï¼‰</p>
<pre><code class="javascript">// fs.mkdir(path[, mode], callback)
var fs = require(&#39;fs&#39;);

fs.mkdir(&#39;sub&#39;, function(err)&#123;
    if(err) throw err;
    console.log(&#39;åˆ›å»ºç›®å½•æˆåŠŸ&#39;);
&#125;);
</code></pre>
<p><strong>åŒæ­¥ç‰ˆæœ¬</strong></p>
<pre><code class="javascript">// fs.mkdirSync(path[, mode])
var fs = require(&#39;fs&#39;);

try&#123;
    fs.mkdirSync(&#39;hello&#39;);
    console.log(&#39;åˆ›å»ºç›®å½•æˆåŠŸ&#39;);
&#125;catch(e)&#123;
    throw e;
&#125;
</code></pre>
<p><strong>promises</strong></p>
<pre><code class="js">import &#123; mkdir &#125; from &#39;fs/promises&#39;;

try &#123;
  const createDir = await mkdir(projectFolder, &#123; recursive: true &#125;);
  console.log(`created $&#123;createDir&#125;`);
&#125; catch (err) &#123;
  console.error(err.message);
&#125;
</code></pre>
<h3 id="2-6-éå†ç›®å½•"><a href="#2-6-éå†ç›®å½•" class="headerlink" title="2.6 éå†ç›®å½•"></a>2.6 éå†ç›®å½•</h3><p>åŒæ­¥ç‰ˆæœ¬ï¼Œæ³¨æ„ï¼š<code>fs.readdirSync()</code>åªä¼šè¯»ä¸€å±‚ï¼Œæ‰€ä»¥éœ€è¦åˆ¤æ–­æ–‡ä»¶ç±»å‹æ˜¯å¦ç›®å½•ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿›è¡Œé€’å½’éå†ã€‚</p>
<pre><code class="js">// fs.readdirSync(path[, options])

var fs = require(&#39;fs&#39;);
var path = require(&#39;path&#39;);

var getFilesInDir = function(dir)&#123;

    var results = [ path.resolve(dir) ];
    var files = fs.readdirSync(dir, &#39;utf8&#39;);

    files.forEach(function(file)&#123;

        file = path.resolve(dir, file);

        var stats = fs.statSync(file);

        if(stats.isFile())&#123;
            results.push(file);
        &#125;else if(stats.isDirectory())&#123;
            results = results.concat( getFilesInDir(file) );
        &#125;
    &#125;);

    return results;
&#125;;

var files = getFilesInDir(&#39;../&#39;);
console.log(files);
</code></pre>
<h3 id="2-7-è¯»å–ç›®å½•"><a href="#2-7-è¯»å–ç›®å½•" class="headerlink" title="2.7 è¯»å–ç›®å½•"></a>2.7 è¯»å–ç›®å½•</h3><pre><code class="js">import &#123; readdir &#125; from &#39;fs/promises&#39;;

try &#123;
  const files = await readdir(path);
  for (const file of files)
    console.log(file);
&#125; catch (err) &#123;
  console.error(err);
&#125;
</code></pre>
<h3 id="2-8-åˆ é™¤ç›®å½•"><a href="#2-8-åˆ é™¤ç›®å½•" class="headerlink" title="2.8 åˆ é™¤ç›®å½•"></a>2.8 åˆ é™¤ç›®å½•</h3><pre><code class="js">// åˆ é™¤ç›®å½•(å‰ææ²¡æœ‰æ–‡ä»¶åœ¨é‡Œé¢)
fs.rmdir(&#39;./avatar&#39;, err =&gt; &#123;
  if (err &amp;&amp; err.code === &#39;ENOENT&#39;) &#123;
    console.log(&#39;ç›®å½•ä¸å­˜åœ¨&#39;);
  &#125;
&#125;);
</code></pre>
<h3 id="2-9-åˆ é™¤æ•´ä¸ªç›®å½•"><a href="#2-9-åˆ é™¤æ•´ä¸ªç›®å½•" class="headerlink" title="2.9 åˆ é™¤æ•´ä¸ªç›®å½•"></a>2.9 åˆ é™¤æ•´ä¸ªç›®å½•</h3><pre><code class="js">//1
const fs = require(&quot;fs&quot;)
fs.(&quot;./avatar&quot;,(err,data)=&gt;&#123;
    // console.log(data)
    data.forEach(item=&gt;&#123;
        fs.unlinkSync(`./avatar/$&#123;item&#125;`)
    &#125;)

    fs.rmdir(&quot;./avatar&quot;,(err)=&gt;&#123;
        console.log(err)
    &#125;)
&#125;)

//2
const fs = require(&#39;fs&#39;)
fs.readdir(&quot;./avatar&quot;).then(async (data)=&gt;&#123;
    let arr = []
    data.forEach(item=&gt;&#123;
        arr.push(fs.unlink(`./avatar/$&#123;item&#125;`))
    &#125;)
    await Promise.all(arr)
    fs.rmdir(&quot;./avatar&quot;)
&#125;)

//3
const fs = require(&#39;fs&#39;).promises;
fs.readdir(&#39;./image2&#39;).then(async data =&gt; &#123;
  await Promise.all(data.map(item =&gt; fs.unlink(`./image2/$&#123;item&#125;`)));
  await fs.rmdir(&#39;./image2&#39;);
&#125;);
</code></pre>
<h3 id="2-10-æ–‡ä»¶é‡å‘½å"><a href="#2-10-æ–‡ä»¶é‡å‘½å" class="headerlink" title="2.10 æ–‡ä»¶é‡å‘½å"></a>2.10 æ–‡ä»¶é‡å‘½å</h3><p><strong>å¼‚æ­¥ç‰ˆæœ¬</strong></p>
<pre><code class="javascript">// fs.rename(oldPath, newPath, callback)
var fs = require(&#39;fs&#39;);

fs.rename(&#39;./hello&#39;, &#39;./world&#39;, function(err)&#123;
    if(err) throw err;
    console.log(&#39;é‡å‘½åæˆåŠŸ&#39;);
&#125;);
</code></pre>
<p><strong>åŒæ­¥ç‰ˆæœ¬</strong></p>
<pre><code class="js">// fs.renameSync(oldPath, newPath)
var fs = require(&#39;fs&#39;);

fs.renameSync(&#39;./world&#39;, &#39;./hello&#39;);
</code></pre>
<p><strong>promises</strong></p>
<pre><code class="js">import &#123; rename &#125; from &#39;fs/promises&#39;;

try &#123;
  await rename(&#39;./world&#39;, &#39;./hello&#39;);
  console.log(`rename`);
&#125; catch (err) &#123;
  console.error(err.message);
&#125;
</code></pre>
<h3 id="2-11-è·å–æ–‡ä»¶çŠ¶æ€"><a href="#2-11-è·å–æ–‡ä»¶çŠ¶æ€" class="headerlink" title="2.11 è·å–æ–‡ä»¶çŠ¶æ€"></a>2.11 è·å–æ–‡ä»¶çŠ¶æ€</h3><p>1.å¼‚æ­¥ï¼šfs.stat(path,callback):<br>  pathæ˜¯ä¸€ä¸ªè¡¨ç¤ºè·¯å¾„çš„å­—ç¬¦ä¸²,callbackæ¥æ”¶ä¸¤ä¸ªå‚æ•°(err,stats),å…¶ä¸­statså°±æ˜¯fs.statsçš„ä¸€ä¸ªå®ä¾‹ï¼›</p>
<p>2.åŒæ­¥ï¼šfs.statSync(path)<br>  åªæ¥æ”¶ä¸€ä¸ªpathå˜é‡ï¼Œfs.statSync(path)å…¶å®æ˜¯ä¸€ä¸ªfs.statsçš„ä¸€ä¸ªå®ä¾‹ï¼›</p>
<p>æ–¹æ³•</p>
<ul>
<li>stats.isFile() â€“ æ˜¯å¦æ–‡ä»¶</li>
<li>stats.isDirectory() â€“ æ˜¯å¦ç›®å½•</li>
</ul>
<pre><code class="js">// Node.js program to demonstrate the 
// fs.statSync() method 
  
// Import the filesystem module 
const fs = require(&#39;fs&#39;); 
  
// Getting information for a file 
statsObj = fs.statSync(&quot;test_file.txt&quot;); 
  
console.log(statsObj);  
console.log(&quot;Path is file:&quot;, statsObj.isFile()); 
console.log(&quot;Path is directory:&quot;, statsObj.isDirectory()); 
  
// Getting information for a directory 
statsObj = fs.statSync(&quot;test_directory&quot;); 
  
console.log(statsObj); 
console.log(&quot;Path is file:&quot;, statsObj.isFile()); 
console.log(&quot;Path is directory:&quot;, statsObj.isDirectory());
</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="js">Stats &#123;
  dev:3229478529,
  mode:33206,
  nlink:1,
  uid:0,
  gid:0,
  rdev:0,
  blksize:4096,
  ino:1970324837039946,
  size:0,
  blocks:0,
  atimeMs:1582306776282,
  mtimeMs:1582482953967,
  ctimeMs:1582482953968.2532,
  birthtimeMs:1582306776282.142,
  atime:2020-02-21T17:39:36.282Z,
  mtime:2020-02-23T18:35:53.967Z,
  ctime:2020-02-23T18:35:53.968Z,
  birthtime:2020-02-21T17:39:36.282Z
&#125;
Path is file:true
Path is directory:false
Stats &#123;
  dev:3229478529,
  mode:16822,
  nlink:1,
  uid:0,
  gid:0,
  rdev:0,
  blksize:4096,
  ino:562949953486669,
  size:0,
  blocks:0,
  atimeMs:1582482965037.8445,
  mtimeMs:1581074249467.7114,
  ctimeMs:1582482964979.8303,
  birthtimeMs:1582306776288.1958,
  atime:2020-02-23T18:36:05.038Z,
  mtime:2020-02-07T11:17:29.468Z,
  ctime:2020-02-23T18:36:04.980Z,
  birthtime:2020-02-21T17:39:36.288Z
&#125;
Path is file:false
Path is directory:true
</code></pre>
<h3 id="2-12-è¿½åŠ æ–‡ä»¶å†…å®¹"><a href="#2-12-è¿½åŠ æ–‡ä»¶å†…å®¹" class="headerlink" title="2.12 è¿½åŠ æ–‡ä»¶å†…å®¹"></a>2.12 è¿½åŠ æ–‡ä»¶å†…å®¹</h3><blockquote>
<p>fs.appendFile(file, data[, options], callback)</p>
</blockquote>
<ul>
<li>fileï¼šå¯ä»¥æ˜¯æ–‡ä»¶è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯æ–‡ä»¶å¥æŸ„ã€‚ï¼ˆè¿˜å¯ä»¥æ˜¯bufferï¼Ÿï¼‰</li>
<li>dataï¼šè¦è¿½åŠ çš„å†…å®¹ã€‚stringæˆ–è€…bufferã€‚</li>
<li>options<ul>
<li>encodingï¼šç¼–ç ï¼Œé»˜è®¤æ˜¯<code>utf8</code></li>
<li>modeï¼šé»˜è®¤æ˜¯<code>0o666</code></li>
<li>flagï¼šé»˜è®¤æ˜¯<code>a</code></li>
</ul>
</li>
</ul>
<p>æ³¨æ„ï¼šå¦‚æœ<code>file</code>æ˜¯æ–‡ä»¶å¥æŸ„ï¼Œé‚£ä¹ˆ</p>
<ul>
<li>å¼€å§‹è¿½åŠ æ•°æ®å‰ï¼Œfileéœ€è¦å·²ç»æ‰“å¼€ã€‚</li>
<li>fileéœ€è¦æ‰‹åŠ¨å…³é—­ã€‚</li>
</ul>
<pre><code class="javascript">var fs = require(&#39;fs&#39;);

fs.appendFile(&#39;./extra/fileForAppend.txt&#39;, &#39;hello&#39;, &#39;utf8&#39;, function(err)&#123;
    if(err) throw err;
    console.log(&#39;appendæˆåŠŸ&#39;);
&#125;);
</code></pre>
<h2 id="3-äº‹ä»¶æœºåˆ¶æ¨¡å—-events"><a href="#3-äº‹ä»¶æœºåˆ¶æ¨¡å—-events" class="headerlink" title="3.äº‹ä»¶æœºåˆ¶æ¨¡å— events"></a>3.äº‹ä»¶æœºåˆ¶æ¨¡å— events</h2><p>Node.js æœ‰å¤šä¸ªå†…ç½®çš„äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥ events æ¨¡å—ï¼Œå¹¶é€šè¿‡å®ä¾‹åŒ– EventEmitter ç±»æ¥ç»‘å®šå’Œç›‘å¬äº‹ä»¶ï¼Œå¦‚ä¸‹å®ä¾‹ï¼š</p>
<pre><code class="javascript">// å¼•å…¥ events æ¨¡å—
var EventEmitter = require(&#39;events&#39;);
// åˆ›å»º eventEmitter å¯¹è±¡
var event = new EventEmitter();
</code></pre>
<p>ä»¥ä¸‹ç¨‹åºç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åºï¼š</p>
<pre><code class="javascript">// ç»‘å®šäº‹ä»¶åŠäº‹ä»¶çš„å¤„ç†ç¨‹åº
eventEmitter.on(&#39;eventName&#39;, eventHandler);
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¨‹åºè§¦å‘äº‹ä»¶ï¼š</p>
<pre><code class="javascript">// è§¦å‘äº‹ä»¶
eventEmitter.emit(&#39;eventName&#39;);
</code></pre>
<p><code>EventEmitter </code>çš„æ¯ä¸ªäº‹ä»¶ç”±ä¸€ä¸ªäº‹ä»¶åå’Œè‹¥å¹²ä¸ªå‚æ•°ç»„æˆï¼Œäº‹ä»¶åæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé€šå¸¸è¡¨è¾¾ä¸€å®šçš„è¯­ä¹‰ã€‚å¯¹äºæ¯ä¸ªäº‹ä»¶ï¼Œ<code>EventEmitter </code>æ”¯æŒ è‹¥å¹²ä¸ªäº‹ä»¶ç›‘å¬å™¨ã€‚</p>
<p>å½“äº‹ä»¶è§¦å‘æ—¶ï¼Œæ³¨å†Œåˆ°è¿™ä¸ªäº‹ä»¶çš„äº‹ä»¶ç›‘å¬å™¨è¢«ä¾æ¬¡è°ƒç”¨ï¼Œäº‹ä»¶å‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°å‚æ•°ä¼ é€’ã€‚</p>
<p>è®©æˆ‘ä»¬ä»¥ä¸‹é¢çš„ä¾‹å­è§£é‡Šè¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<pre><code class="javascript">// å¼•å…¥ events æ¨¡å—
var EventEmitter = require(&#39;events&#39;);
// åˆ›å»º eventEmitter å¯¹è±¡
var event = new EventEmitter();
event.on(&#39;someEvent&#39;, function(arg1, arg2) &#123; 
    console.log(&#39;listener1&#39;, arg1, arg2); 
&#125;); 
event.on(&#39;someEvent&#39;, function(arg1, arg2) &#123; 
    console.log(&#39;listener2&#39;, arg1, arg2); 
&#125;); 
event.emit(&#39;someEvent&#39;, &#39;arg1 å‚æ•°&#39;, &#39;arg2 å‚æ•°&#39;); 
</code></pre>
<p>æ‰§è¡Œä»¥ä¸Šä»£ç ï¼Œè¿è¡Œçš„ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="bash">$ node event.js 
listener1 arg1 å‚æ•° arg2 å‚æ•°
listener2 arg1 å‚æ•° arg2 å‚æ•°
</code></pre>
<p>ä»¥ä¸Šä¾‹å­ä¸­ï¼Œevent ä¸ºäº‹ä»¶ someEvent æ³¨å†Œäº†ä¸¤ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œç„¶åè§¦å‘äº† someEvent äº‹ä»¶ã€‚</p>
<p>è¿è¡Œç»“æœä¸­å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªäº‹ä»¶ç›‘å¬å™¨å›è°ƒå‡½æ•°è¢«å…ˆåè°ƒç”¨ã€‚ è¿™å°±æ˜¯<code>EventEmitter</code>æœ€ç®€å•çš„ç”¨æ³•ã€‚</p>
<p><code>EventEmitter </code>æä¾›äº†å¤šä¸ªå±æ€§ï¼Œå¦‚ <strong>on</strong> å’Œ <strong>emit</strong>ã€‚<strong>on</strong> å‡½æ•°ç”¨äºç»‘å®šäº‹ä»¶å‡½æ•°ï¼Œ<strong>emit</strong> å±æ€§ç”¨äºè§¦å‘ä¸€ä¸ªäº‹ä»¶</p>
<h1 id="07-ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸‹ï¼‰ã€‘"><a href="#07-ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸‹ï¼‰ã€‘" class="headerlink" title="07 ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸‹ï¼‰ã€‘"></a>07 ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸‹ï¼‰ã€‘</h1><h2 id="1-stream-æ¨¡å—"><a href="#1-stream-æ¨¡å—" class="headerlink" title="1.stream æ¨¡å—"></a>1.stream æ¨¡å—</h2><p><code>stream</code>æ˜¯Node.jsæä¾›çš„åˆä¸€ä¸ªä»…åœ¨æœåŠ¡åŒºç«¯å¯ç”¨çš„æ¨¡å—ï¼Œç›®çš„æ˜¯æ”¯æŒâ€œæµâ€è¿™ç§æ•°æ®ç»“æ„ã€‚</p>
<p>ä»€ä¹ˆæ˜¯æµï¼Ÿæµæ˜¯ä¸€ç§æŠ½è±¡çš„æ•°æ®ç»“æ„ã€‚æƒ³è±¡æ°´æµï¼Œå½“åœ¨æ°´ç®¡ä¸­æµåŠ¨æ—¶ï¼Œå°±å¯ä»¥ä»æŸä¸ªåœ°æ–¹ï¼ˆä¾‹å¦‚è‡ªæ¥æ°´å‚ï¼‰æºæºä¸æ–­åœ°åˆ°è¾¾å¦ä¸€ä¸ªåœ°æ–¹ï¼ˆæ¯”å¦‚ä½ å®¶çš„æ´—æ‰‹æ± ï¼‰ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠæ•°æ®çœ‹æˆæ˜¯æ•°æ®æµï¼Œæ¯”å¦‚ä½ æ•²é”®ç›˜çš„æ—¶å€™ï¼Œå°±å¯ä»¥æŠŠæ¯ä¸ªå­—ç¬¦ä¾æ¬¡è¿èµ·æ¥ï¼Œçœ‹æˆå­—ç¬¦æµã€‚è¿™ä¸ªæµæ˜¯ä»é”®ç›˜è¾“å…¥åˆ°åº”ç”¨ç¨‹åºï¼Œå®é™…ä¸Šå®ƒè¿˜å¯¹åº”ç€ä¸€ä¸ªåå­—ï¼šæ ‡å‡†è¾“å…¥æµï¼ˆstdinï¼‰ã€‚</p>
<p>å¦‚æœåº”ç”¨ç¨‹åºæŠŠå­—ç¬¦ä¸€ä¸ªä¸€ä¸ªè¾“å‡ºåˆ°æ˜¾ç¤ºå™¨ä¸Šï¼Œè¿™ä¹Ÿå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªæµï¼Œè¿™ä¸ªæµä¹Ÿæœ‰åå­—ï¼šæ ‡å‡†è¾“å‡ºæµï¼ˆstdoutï¼‰ã€‚æµçš„ç‰¹ç‚¹æ˜¯æ•°æ®æ˜¯æœ‰åºçš„ï¼Œè€Œä¸”å¿…é¡»ä¾æ¬¡è¯»å–ï¼Œæˆ–è€…ä¾æ¬¡å†™å…¥ï¼Œä¸èƒ½åƒArrayé‚£æ ·éšæœºå®šä½ã€‚</p>
<p>æœ‰äº›æµç”¨æ¥è¯»å–æ•°æ®ï¼Œæ¯”å¦‚ä»æ–‡ä»¶è¯»å–æ•°æ®æ—¶ï¼Œå¯ä»¥æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æµï¼Œç„¶åä»æ–‡ä»¶æµä¸­ä¸æ–­åœ°è¯»å–æ•°æ®ã€‚æœ‰äº›æµç”¨æ¥å†™å…¥æ•°æ®ï¼Œæ¯”å¦‚å‘æ–‡ä»¶å†™å…¥æ•°æ®æ—¶ï¼Œåªéœ€è¦æŠŠæ•°æ®ä¸æ–­åœ°å¾€æ–‡ä»¶æµä¸­å†™è¿›å»å°±å¯ä»¥äº†ã€‚</p>
<p>åœ¨Node.jsä¸­ï¼Œæµä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬åªéœ€è¦å“åº”æµçš„äº‹ä»¶å°±å¯ä»¥äº†ï¼š<code>data</code>äº‹ä»¶è¡¨ç¤ºæµçš„æ•°æ®å·²ç»å¯ä»¥è¯»å–äº†ï¼Œ<code>end</code>äº‹ä»¶è¡¨ç¤ºè¿™ä¸ªæµå·²ç»åˆ°æœ«å°¾äº†ï¼Œæ²¡æœ‰æ•°æ®å¯ä»¥è¯»å–äº†ï¼Œ<code>error</code>äº‹ä»¶è¡¨ç¤ºå‡ºé”™äº†ã€‚</p>
<h3 id="1-1-è¯»å–æµ"><a href="#1-1-è¯»å–æµ" class="headerlink" title="1.1 è¯»å–æµ"></a>1.1 è¯»å–æµ</h3><pre><code class="javascript">const fs = require(&#39;fs&#39;);

//åˆ›å»ºè¯»å–æµ
let rs = fs.createReadStream(&#39;hello.txt&#39;, &#39;utf-8&#39;);

rs.on(&#39;open&#39;, function () &#123;
  console.log(&#39;è¯»å–çš„æ–‡ä»¶å·²æ‰“å¼€&#39;);
&#125;).on(&#39;close&#39;, function () &#123;
  console.log(&#39;è¯»å–æµç»“æŸ&#39;);
&#125;).on(&#39;error&#39;, err =&gt; &#123;
  console.log(err);
&#125;).on(&#39;data&#39;, function (chunk) &#123;
  //æ¯ä¸€æ‰¹æ•°æ®æµå…¥å®Œæˆ
  console.log(&#39;å•æ‰¹æ•°æ®æµå…¥:&#39; + chunk.length);
  console.log(chunk);
&#125;);
</code></pre>
<p>è¦æ³¨æ„ï¼Œ<code>data</code>äº‹ä»¶å¯èƒ½ä¼šæœ‰å¤šæ¬¡ï¼Œæ¯æ¬¡ä¼ é€’çš„<code>chunk</code>æ˜¯æµçš„ä¸€éƒ¨åˆ†æ•°æ®ã€‚</p>
<p><strong>è¯»å–è§†é¢‘</strong></p>
<pre><code class="javascript">const fs = require(&#39;fs&#39;);

//åˆ›å»ºè¯»å–æµ
let rs = fs.createReadStream(&#39;video.mp4&#39;);

//æ¯ä¸€æ‰¹æ•°æ®æµå…¥å®Œæˆ
rs.on(&#39;data&#39;, function (chunk) &#123;
  console.log(&#39;å•æ‰¹æ•°æ®æµå…¥:&#39; + chunk.length);
  console.log(chunk);
&#125;);
</code></pre>
<p><img data-src="https://tva1.sinaimg.cn/large/0074UQWJgy1h3eigfl898j31750iztjs.jpg"></p>
<h3 id="1-2-å†™å…¥æµ"><a href="#1-2-å†™å…¥æµ" class="headerlink" title="1.2 å†™å…¥æµ"></a>1.2 å†™å…¥æµ</h3><p>è¦ä»¥æµçš„å½¢å¼å†™å…¥æ–‡ä»¶ï¼Œåªéœ€è¦ä¸æ–­è°ƒç”¨<code>write()</code>æ–¹æ³•ï¼Œæœ€åä»¥<code>end()</code>ç»“æŸï¼š</p>
<pre><code class="javascript">const fs = require(&#39;fs&#39;);

//åˆ›å»ºå†™å…¥æµ
let ws = fs.createWriteStream(&#39;hello.txt&#39;, &#39;utf-8&#39;);

//ç›‘å¬æ–‡ä»¶æ‰“å¼€äº‹ä»¶
ws.on(&#39;open&#39;, function () &#123;
  console.log(&#39;æ–‡ä»¶æ‰“å¼€&#39;);
&#125;);

//ç›‘å¬æ–‡ä»¶å…³é—­äº‹ä»¶
ws.on(&#39;close&#39;, function () &#123;
  console.log(&#39;æ–‡ä»¶å†™å…¥å®Œæˆï¼Œå…³é—­&#39;);
&#125;);

//æ–‡ä»¶æµå¼å†™å…¥
ws.write(&#39;helloworld1!&#39;, function (err) &#123;
  if (err) &#123;
    console.log(err);
  &#125; else &#123;
    console.log(&#39;å†…å®¹1æµå…¥å®Œæˆ&#39;);
  &#125;
&#125;);
ws.write(&#39;helloworld2!&#39;, function (err) &#123;
  if (err) &#123;
    console.log(err);
  &#125; else &#123;
    console.log(&#39;å†…å®¹2æµå…¥å®Œæˆ&#39;);
  &#125;
&#125;);

//æ–‡ä»¶å†™å…¥å®Œæˆ
ws.end(function () &#123;
  console.log(&#39;æ–‡ä»¶å†™å…¥å…³é—­&#39;);
&#125;);
</code></pre>
<p><code>pipe</code> å°±åƒå¯ä»¥æŠŠä¸¤ä¸ªæ°´ç®¡ä¸²æˆä¸€ä¸ªæ›´é•¿çš„æ°´ç®¡ä¸€æ ·ï¼Œä¸¤ä¸ªæµä¹Ÿå¯ä»¥ä¸²èµ·æ¥ã€‚ä¸€ä¸ª<code>Readable</code>æµå’Œä¸€ä¸ª<code>Writable</code>æµä¸²èµ·æ¥åï¼Œæ‰€æœ‰çš„æ•°æ®è‡ªåŠ¨ä»<code>Readable</code>æµè¿›å…¥<code>Writable</code>æµï¼Œè¿™ç§æ“ä½œå«<code>pipe</code>ã€‚</p>
<p>åœ¨Node.jsä¸­ï¼Œ<code>Readable</code>æµæœ‰ä¸€ä¸ª<code>pipe()</code>æ–¹æ³•ï¼Œå°±æ˜¯ç”¨æ¥å¹²è¿™ä»¶äº‹çš„ã€‚</p>
<p>è®©æˆ‘ä»¬ç”¨<code>pipe()</code>æŠŠä¸€ä¸ªæ–‡ä»¶æµå’Œå¦ä¸€ä¸ªæ–‡ä»¶æµä¸²èµ·æ¥ï¼Œè¿™æ ·æºæ–‡ä»¶çš„æ‰€æœ‰æ•°æ®å°±è‡ªåŠ¨å†™å…¥åˆ°ç›®æ ‡æ–‡ä»¶é‡Œäº†ï¼Œæ‰€ä»¥ï¼Œè¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¤åˆ¶æ–‡ä»¶çš„ç¨‹åºï¼š</p>
<pre><code class="javascript">const fs = require(&#39;fs&#39;);

//åˆ›å»ºè¯»å–æµ
let rs = fs.createReadStream(&#39;video.mp4&#39;);
let ws = fs.createWriteStream(&#39;b.mp4&#39;);

rs.on(&#39;close&#39;, function () &#123;
  console.log(&#39;è¯»å–æµç»“æŸ&#39;);
&#125;);

rs.pipe(ws);
</code></pre>
<p><strong>pipeåŸç†</strong></p>
<pre><code class="javascript">const fs = require(&#39;fs&#39;);

//åˆ›å»ºè¯»å–æµ
let rs = fs.createReadStream(&#39;video.mp4&#39;);
let ws = fs.createWriteStream(&#39;b.mp4&#39;);

rs.on(&#39;close&#39;, function () &#123;
  ws.end();
  console.log(&#39;è¯»å–æµç»“æŸ&#39;);
&#125;);

//æ¯ä¸€æ‰¹æ•°æ®æµå…¥å®Œæˆ
rs.on(&#39;data&#39;, function (chunk) &#123;
  console.log(&#39;å•æ‰¹æ•°æ®æµå…¥:&#39; + chunk.length);
  ws.write(chunk, () =&gt; &#123;
    console.log(&#39;å•æ‰¹è¾“å…¥æµå…¥å®Œæˆ&#39;);
  &#125;);
&#125;);
</code></pre>
<h2 id="2-èµ„æºå‹ç¼©æ¨¡å—-zib"><a href="#2-èµ„æºå‹ç¼©æ¨¡å—-zib" class="headerlink" title="2.èµ„æºå‹ç¼©æ¨¡å— zib"></a>2.èµ„æºå‹ç¼©æ¨¡å— zib</h2><h3 id="2-1-æ¦‚è§ˆ"><a href="#2-1-æ¦‚è§ˆ" class="headerlink" title="2.1 æ¦‚è§ˆ"></a>2.1 æ¦‚è§ˆ</h3><p>åšè¿‡webæ€§èƒ½ä¼˜åŒ–çš„åŒå­¦ï¼Œå¯¹æ€§èƒ½ä¼˜åŒ–å¤§æ€å™¨<strong>gzip</strong>åº”è¯¥ä¸é™Œç”Ÿã€‚æµè§ˆå™¨å‘æœåŠ¡å™¨å‘èµ·èµ„æºè¯·æ±‚ï¼Œæ¯”å¦‚ä¸‹è½½ä¸€ä¸ªjsæ–‡ä»¶ï¼ŒæœåŠ¡å™¨å…ˆå¯¹èµ„æºè¿›è¡Œå‹ç¼©ï¼Œå†è¿”å›ç»™æµè§ˆå™¨ï¼Œä»¥æ­¤èŠ‚çœæµé‡ï¼ŒåŠ å¿«è®¿é—®é€Ÿåº¦ã€‚</p>
<p>æµè§ˆå™¨é€šè¿‡HTTPè¯·æ±‚å¤´éƒ¨é‡ŒåŠ ä¸Š<strong>Accept-Encoding</strong>ï¼Œå‘Šè¯‰æœåŠ¡å™¨ï¼Œâ€œä½ å¯ä»¥ç”¨gzipï¼Œæˆ–è€…defalteç®—æ³•å‹ç¼©èµ„æºâ€ã€‚</p>
<blockquote>
<p>Accept-Encoding:gzip, deflate</p>
</blockquote>
<p>é‚£ä¹ˆï¼Œåœ¨nodejsé‡Œï¼Œæ˜¯å¦‚ä½•å¯¹èµ„æºè¿›è¡Œå‹ç¼©çš„å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯<strong>Zlib</strong>æ¨¡å—ã€‚&#x3D;</p>
<h3 id="2-2-å‹ç¼©çš„ä¾‹å­"><a href="#2-2-å‹ç¼©çš„ä¾‹å­" class="headerlink" title="2.2 å‹ç¼©çš„ä¾‹å­"></a>2.2 å‹ç¼©çš„ä¾‹å­</h3><p>éå¸¸ç®€å•çš„å‡ è¡Œä»£ç ï¼Œå°±å®Œæˆäº†æœ¬åœ°æ–‡ä»¶çš„gzipå‹ç¼©ã€‚</p>
<pre><code class="javascript">var fs = require(&#39;fs&#39;);
var zlib = require(&#39;zlib&#39;);

var gzip = zlib.createGzip();

var readstream = fs.createReadStream(&#39;./extra/fileForCompress.txt&#39;);
var writestream = fs.createWriteStream(&#39;./extra/fileForCompress.txt.gz&#39;);

readstream.pipe(gzip).pipe(writestream);
</code></pre>
<h3 id="2-3-è§£å‹çš„ä¾‹å­"><a href="#2-3-è§£å‹çš„ä¾‹å­" class="headerlink" title="2.3 è§£å‹çš„ä¾‹å­"></a>2.3 è§£å‹çš„ä¾‹å­</h3><p>åŒæ ·éå¸¸ç®€å•ï¼Œå°±æ˜¯ä¸ªåå‘æ“ä½œã€‚</p>
<pre><code class="javascript">var fs = require(&#39;fs&#39;);
var zlib = require(&#39;zlib&#39;);

var gunzip = zlib.createGunzip();

var readstream  = fs.createReadStream(&#39;./extra/fileForCompress.txt.gz&#39;);
var writestream  = fs.createWriteStream(&#39;./extra/fileForCompress1.txt&#39;);

readstream.pipe(gunzip).pipe(writestream);
</code></pre>
<h3 id="2-4-æœåŠ¡ç«¯gzipå‹ç¼©"><a href="#2-4-æœåŠ¡ç«¯gzipå‹ç¼©" class="headerlink" title="2.4 æœåŠ¡ç«¯gzipå‹ç¼©"></a>2.4 æœåŠ¡ç«¯gzipå‹ç¼©</h3><p>é¦–å…ˆåˆ¤æ–­ æ˜¯å¦åŒ…å« <strong>accept-encoding</strong> é¦–éƒ¨ï¼Œä¸”å€¼ä¸º<strong>gzip</strong>ã€‚</p>
<ul>
<li>å¦ï¼šè¿”å›æœªå‹ç¼©çš„æ–‡ä»¶ã€‚</li>
<li>æ˜¯ï¼šè¿”å›gzipå‹ç¼©åçš„æ–‡ä»¶ã€‚</li>
</ul>
<pre><code class="js">var http = require(&#39;http&#39;);
var zlib = require(&#39;zlib&#39;);
var fs = require(&#39;fs&#39;);
var filepath = &#39;./extra/fileForGzip.html&#39;;

var server = http.createServer(function(req, res)&#123;
    var acceptEncoding = req.headers[&#39;accept-encoding&#39;];
    var gzip;
    
    if(acceptEncoding.indexOf(&#39;gzip&#39;)!=-1)&#123; // åˆ¤æ–­æ˜¯å¦éœ€è¦gzipå‹ç¼©
        
        gzip = zlib.createGzip();
        
        // è®°å¾—å“åº” Content-Encodingï¼Œå‘Šè¯‰æµè§ˆå™¨ï¼šæ–‡ä»¶è¢« gzip å‹ç¼©è¿‡
        res.writeHead(200, &#123;
            &#39;Content-Encoding&#39;: &#39;gzip&#39;
        &#125;);
        fs.createReadStream(filepath).pipe(gzip).pipe(res);
    
    &#125;else&#123;

        fs.createReadStream(filepath).pipe(res);
    &#125;

&#125;);

server.listen(&#39;3000&#39;);
</code></pre>
<p><strong>å°†jså¤§æ–‡ä»¶è¿”å›</strong></p>
<pre><code class="javascript">const fs = require(&#39;fs&#39;);
const zlib = require(&#39;zlib&#39;);//è¿™ä¸¤ä¸ªè¦å†™åœ¨fsæ¨¡å—åé¢
const gzip = zlib.createGzip();
const http = require(&#39;http&#39;);

http
  .createServer((req, res) =&gt; &#123;
    let rs = fs.createReadStream(&#39;hello.js&#39;);
    res.writeHead(200, &#123;
      &#39;Content-Type&#39;: &#39;application/x-javascript;charset=utf-8&#39;,
      &#39;Content-Encoding&#39;: &#39;gzip&#39;,
    &#125;);
    rs.pipe(gzip).pipe(res);
  &#125;)
  .listen(3000, () =&gt; &#123;
    console.log(&#39;server start&#39;);
  &#125;);
</code></pre>
<h3 id="2-5-æœåŠ¡ç«¯å­—ç¬¦ä¸²gzipå‹ç¼©"><a href="#2-5-æœåŠ¡ç«¯å­—ç¬¦ä¸²gzipå‹ç¼©" class="headerlink" title="2.5 æœåŠ¡ç«¯å­—ç¬¦ä¸²gzipå‹ç¼©"></a>2.5 æœåŠ¡ç«¯å­—ç¬¦ä¸²gzipå‹ç¼©</h3><p>ä»£ç è·Ÿå‰é¢ä¾‹å­å¤§åŒå°å¼‚ã€‚è¿™é‡Œé‡‡ç”¨äº† <strong>zlib.gzipSync(str)</strong> å¯¹å­—ç¬¦ä¸²è¿›è¡Œgzipå‹ç¼©ã€‚</p>
<pre><code class="javascript">var http = require(&#39;http&#39;);
var zlib = require(&#39;zlib&#39;);

var responseText = &#39;hello world&#39;;

var server = http.createServer(function(req, res)&#123;
    var acceptEncoding = req.headers[&#39;accept-encoding&#39;];
    if(acceptEncoding.indexOf(&#39;gzip&#39;)!=-1)&#123;
        res.writeHead(200, &#123;
            &#39;content-encoding&#39;: &#39;gzip&#39;
        &#125;);
        res.end(zlib.gzipSync(responseText) );
    &#125;else&#123;
        res.end(responseText);
    &#125;

&#125;);

server.listen(&#39;3000&#39;);
</code></pre>
<h2 id="3-æ•°æ®åŠ å¯†æ¨¡å—-crypto"><a href="#3-æ•°æ®åŠ å¯†æ¨¡å—-crypto" class="headerlink" title="3.æ•°æ®åŠ å¯†æ¨¡å— crypto"></a>3.æ•°æ®åŠ å¯†æ¨¡å— crypto</h2><p>cryptoæ¨¡å—çš„ç›®çš„æ˜¯ä¸ºäº†æä¾›é€šç”¨çš„åŠ å¯†å’Œå“ˆå¸Œç®—æ³•ã€‚ç”¨çº¯JavaScriptä»£ç å®ç°è¿™äº›åŠŸèƒ½ä¸æ˜¯ä¸å¯èƒ½ï¼Œä½†é€Ÿåº¦ä¼šéå¸¸æ…¢ã€‚Nodejsç”¨C&#x2F;C++å®ç°è¿™äº›ç®—æ³•åï¼Œé€šè¿‡cyptoè¿™ä¸ªæ¨¡å—æš´éœ²ä¸ºJavaScriptæ¥å£ï¼Œè¿™æ ·ç”¨èµ·æ¥æ–¹ä¾¿ï¼Œè¿è¡Œé€Ÿåº¦ä¹Ÿå¿«ã€‚</p>
<h3 id="3-1-hashä¾‹å­"><a href="#3-1-hashä¾‹å­" class="headerlink" title="3.1 hashä¾‹å­"></a>3.1 hashä¾‹å­</h3><p>hash.digest([encoding])ï¼šè®¡ç®—æ‘˜è¦ã€‚encodingå¯ä»¥æ˜¯<code>hex</code>ã€<code>latin1</code>æˆ–è€…<code>base64</code>ã€‚å¦‚æœå£°æ˜äº†encodingï¼Œé‚£ä¹ˆè¿”å›å­—ç¬¦ä¸²ã€‚å¦åˆ™ï¼Œè¿”å›Bufferå®ä¾‹ã€‚æ³¨æ„ï¼Œè°ƒç”¨hash.digest()åï¼Œhashå¯¹è±¡å°±ä½œåºŸäº†ï¼Œå†æ¬¡è°ƒç”¨å°±ä¼šå‡ºé”™ã€‚</p>
<p>hash.update(data[, input_encoding])ï¼šinput_encodingå¯ä»¥æ˜¯<code>utf8</code>ã€<code>ascii</code>æˆ–è€…<code>latin1</code>ã€‚å¦‚æœdataæ˜¯å­—ç¬¦ä¸²ï¼Œä¸”æ²¡æœ‰æŒ‡å®š input_encodingï¼Œåˆ™é»˜è®¤æ˜¯<code>utf8</code>ã€‚æ³¨æ„ï¼Œhash.update()æ–¹æ³•å¯ä»¥è°ƒç”¨å¤šæ¬¡ã€‚</p>
<pre><code class="js">var crypto = require(&#39;crypto&#39;);
var fs = require(&#39;fs&#39;);

var content = fs.readFileSync(&#39;./test.txt&#39;, &#123;encoding: &#39;utf8&#39;&#125;);
var hash = crypto.createHash(&#39;sha256&#39;);
var output;

hash.update(content);

output = hash.digest(&#39;hex&#39;); 

console.log(output);
// è¾“å‡ºå†…å®¹ä¸ºï¼š
// b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9
</code></pre>
<p>ä¹Ÿå¯ä»¥è¿™æ ·ï¼š</p>
<pre><code class="js">var crypto = require(&#39;crypto&#39;);
var fs = require(&#39;fs&#39;);

var input = fs.createReadStream(&#39;./test.txt&#39;, &#123;encoding: &#39;utf8&#39;&#125;);
var hash = crypto.createHash(&#39;sha256&#39;);

hash.setEncoding(&#39;hex&#39;);

input.pipe(hash).pipe(process.stdout)

// è¾“å‡ºå†…å®¹ä¸ºï¼š
// b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9
</code></pre>
<p>hash.digest()åï¼Œå†æ¬¡è°ƒç”¨digest()æˆ–è€…update()</p>
<pre><code class="js">var crypto = require(&#39;crypto&#39;);
var fs = require(&#39;fs&#39;);

var content = fs.readFileSync(&#39;./test.txt&#39;, &#123;encoding: &#39;utf8&#39;&#125;);
var hash = crypto.createHash(&#39;sha256&#39;);
var output;

hash.update(content);
hash.digest(&#39;hex&#39;); 

// æŠ¥é”™ï¼šError: Digest already called
hash.update(content);

// æŠ¥é”™ï¼šError: Digest already called
hash.digest(&#39;hex&#39;);
</code></pre>
<h3 id="3-2-HMACä¾‹å­"><a href="#3-2-HMACä¾‹å­" class="headerlink" title="3.2 HMACä¾‹å­"></a>3.2 HMACä¾‹å­</h3><p>HMACçš„å…¨ç§°æ˜¯Hash-based Message Authentication Codeï¼Œä¹Ÿå³åœ¨hashçš„åŠ ç›è¿ç®—ã€‚</p>
<p>å…·ä½“åˆ°ä½¿ç”¨çš„è¯ï¼Œè·Ÿhashæ¨¡å—å·®ä¸å¤šï¼Œé€‰å®šhashç®—æ³•ï¼ŒæŒ‡å®šâ€œç›â€å³å¯ã€‚</p>
<p>ä¾‹å­1ï¼š</p>
<pre><code class="js">var crypto = require(&#39;crypto&#39;);
var fs = require(&#39;fs&#39;);

var secret = &#39;secret&#39;;
var hmac = crypto.createHmac(&#39;sha256&#39;, secret);
var input = fs.readFileSync(&#39;./test.txt&#39;, &#123;encoding: &#39;utf8&#39;&#125;);

hmac.update(input);

console.log( hmac.digest(&#39;hex&#39;) );
// è¾“å‡ºï¼š
// 734cc62f32841568f45715aeb9f4d7891324e6d948e4c6c60c0621cdac48623a
</code></pre>
<p>ä¾‹å­2ï¼š</p>
<pre><code class="js">var crypto = require(&#39;crypto&#39;);
var fs = require(&#39;fs&#39;);

var secret = &#39;secret&#39;;
var hmac = crypto.createHmac(&#39;sha256&#39;, secret);
var input = fs.createReadStream(&#39;./test.txt&#39;, &#123;encoding: &#39;utf8&#39;&#125;);

hmac.setEncoding(&#39;hex&#39;);

input.pipe(hmac).pipe(process.stdout)
// è¾“å‡ºï¼š
// 734cc62f32841568f45715aeb9f4d7891324e6d948e4c6c60c0621cdac48623a
</code></pre>
<h3 id="3-3-MD5ä¾‹å­"><a href="#3-3-MD5ä¾‹å­" class="headerlink" title="3.3 MD5ä¾‹å­"></a>3.3 MD5ä¾‹å­</h3><p>MD5ï¼ˆMessage-Digest Algorithmï¼‰æ˜¯è®¡ç®—æœºå®‰å…¨é¢†åŸŸå¹¿æ³›ä½¿ç”¨çš„æ•£åˆ—å‡½æ•°ï¼ˆåˆç§°å“ˆå¸Œç®—æ³•ã€æ‘˜è¦ç®—æ³•ï¼‰ï¼Œä¸»è¦ç”¨æ¥ç¡®ä¿æ¶ˆæ¯çš„å®Œæ•´å’Œä¸€è‡´æ€§ã€‚å¸¸è§çš„åº”ç”¨åœºæ™¯æœ‰å¯†ç ä¿æŠ¤ã€ä¸‹è½½æ–‡ä»¶æ ¡éªŒç­‰ã€‚</p>
<p><strong>ç‰¹ç‚¹</strong></p>
<ol>
<li>è¿ç®—é€Ÿåº¦å¿«ï¼šå¯¹<code>jquery.js</code>æ±‚md5å€¼ï¼Œ57254ä¸ªå­—ç¬¦ï¼Œè€—æ—¶1.907ms</li>
<li>è¾“å‡ºé•¿åº¦å›ºå®šï¼šè¾“å…¥é•¿åº¦ä¸å›ºå®šï¼Œè¾“å‡ºé•¿åº¦å›ºå®šï¼ˆ128ä½ï¼‰ã€‚</li>
<li>è¿ç®—ä¸å¯é€†ï¼šå·²çŸ¥è¿ç®—ç»“æœçš„æƒ…å†µä¸‹ï¼Œæ— æ³•é€šè¿‡é€šè¿‡é€†è¿ç®—å¾—åˆ°åŸå§‹å­—ç¬¦ä¸²ã€‚</li>
<li>é«˜åº¦ç¦»æ•£ï¼šè¾“å…¥çš„å¾®å°å˜åŒ–ï¼Œå¯å¯¼è‡´è¿ç®—ç»“æœå·®å¼‚å·¨å¤§ã€‚</li>
<li>å¼±ç¢°æ’æ€§ï¼šä¸åŒè¾“å…¥çš„æ•£åˆ—å€¼å¯èƒ½ç›¸åŒã€‚</li>
</ol>
<p><strong>åº”ç”¨åœºæ™¯</strong></p>
<ol>
<li>æ–‡ä»¶å®Œæ•´æ€§æ ¡éªŒï¼šæ¯”å¦‚ä»ç½‘ä¸Šä¸‹è½½ä¸€ä¸ªè½¯ä»¶ï¼Œä¸€èˆ¬ç½‘ç«™éƒ½ä¼šå°†è½¯ä»¶çš„md5å€¼é™„åœ¨ç½‘é¡µä¸Šï¼Œç”¨æˆ·ä¸‹è½½å®Œè½¯ä»¶åï¼Œå¯å¯¹ä¸‹è½½åˆ°æœ¬åœ°çš„è½¯ä»¶è¿›è¡Œmd5è¿ç®—ï¼Œç„¶åè·Ÿç½‘ç«™ä¸Šçš„md5å€¼è¿›è¡Œå¯¹æ¯”ï¼Œç¡®ä¿ä¸‹è½½çš„è½¯ä»¶æ˜¯å®Œæ•´çš„ï¼ˆæˆ–æ­£ç¡®çš„ï¼‰</li>
<li>å¯†ç ä¿æŠ¤ï¼šå°†md5åçš„å¯†ç ä¿å­˜åˆ°æ•°æ®åº“ï¼Œè€Œä¸æ˜¯ä¿å­˜æ˜æ–‡å¯†ç ï¼Œé¿å…æ‹–åº“ç­‰äº‹ä»¶å‘ç”Ÿåï¼Œæ˜æ–‡å¯†ç å¤–æ³„ã€‚</li>
<li>é˜²ç¯¡æ”¹ï¼šæ¯”å¦‚æ•°å­—è¯ä¹¦çš„é˜²ç¯¡æ”¹ï¼Œå°±ç”¨åˆ°äº†æ‘˜è¦ç®—æ³•ã€‚ï¼ˆå½“ç„¶è¿˜è¦ç»“åˆæ•°å­—ç­¾åç­‰æ‰‹æ®µï¼‰</li>
</ol>
<pre><code class="javascript">var crypto = require(&#39;crypto&#39;);
var md5 = crypto.createHash(&#39;md5&#39;);

var result = md5.update(&#39;a&#39;).digest(&#39;hex&#39;);

// è¾“å‡ºï¼š0cc175b9c0f1b6a831c399e269772661
console.log(result);
</code></pre>
<h3 id="3-4-ä¾‹å­ï¼šå¯†ç ä¿æŠ¤"><a href="#3-4-ä¾‹å­ï¼šå¯†ç ä¿æŠ¤" class="headerlink" title="3.4 ä¾‹å­ï¼šå¯†ç ä¿æŠ¤"></a>3.4 ä¾‹å­ï¼šå¯†ç ä¿æŠ¤</h3><p>å‰é¢æåˆ°ï¼Œå°†æ˜æ–‡å¯†ç ä¿å­˜åˆ°æ•°æ®åº“æ˜¯å¾ˆä¸å®‰å…¨çš„ï¼Œæœ€ä¸æµä¹Ÿè¦è¿›è¡Œmd5åè¿›è¡Œä¿å­˜ã€‚æ¯”å¦‚ç”¨æˆ·å¯†ç æ˜¯<code>123456</code>ï¼Œmd5è¿è¡Œåï¼Œå¾—åˆ°<code>è¾“å‡ºï¼še10adc3949ba59abbe56e057f20f883e</code>ã€‚</p>
<p>è¿™æ ·è‡³å°‘æœ‰ä¸¤ä¸ªå¥½å¤„ï¼š</p>
<ol>
<li>é˜²å†…éƒ¨æ”»å‡»ï¼šç½‘ç«™ä¸»äººä¹Ÿä¸çŸ¥é“ç”¨æˆ·çš„æ˜æ–‡å¯†ç ï¼Œé¿å…ç½‘ç«™ä¸»äººæ‹¿ç€ç”¨æˆ·æ˜æ–‡å¯†ç å¹²åäº‹ã€‚</li>
<li>é˜²å¤–éƒ¨æ”»å‡»ï¼šå¦‚ç½‘ç«™è¢«é»‘å®¢å…¥ä¾µï¼Œé»‘å®¢ä¹Ÿåªèƒ½æ‹¿åˆ°md5åçš„å¯†ç ï¼Œè€Œä¸æ˜¯ç”¨æˆ·çš„æ˜æ–‡å¯†ç ã€‚</li>
</ol>
<p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="javascript">var crypto = require(&#39;crypto&#39;);

function cryptPwd(password) &#123;
    var md5 = crypto.createHash(&#39;md5&#39;);
    return md5.update(password).digest(&#39;hex&#39;);
&#125;

var password = &#39;123456&#39;;
var cryptedPassword = cryptPwd(password);

console.log(cryptedPassword);
// è¾“å‡ºï¼še10adc3949ba59abbe56e057f20f883e
</code></pre>
<p><strong>å•çº¯å¯¹å¯†ç è¿›è¡Œmd5ä¸å®‰å…¨</strong></p>
<p>å‰é¢æåˆ°ï¼Œé€šè¿‡å¯¹ç”¨æˆ·å¯†ç è¿›è¡Œmd5è¿ç®—æ¥æé«˜å®‰å…¨æ€§ã€‚ä½†å®é™…ä¸Šï¼Œè¿™æ ·çš„å®‰å…¨æ€§æ˜¯å¾ˆå·®çš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>ç¨å¾®ä¿®æ”¹ä¸‹ä¸Šé¢çš„ä¾‹å­ï¼Œå¯èƒ½ä½ å°±æ˜ç™½äº†ã€‚ç›¸åŒçš„æ˜æ–‡å¯†ç ï¼Œmd5å€¼ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚</p>
<pre><code class="javascript">var crypto = require(&#39;crypto&#39;);

function cryptPwd(password) &#123;
    var md5 = crypto.createHash(&#39;md5&#39;);
    return md5.update(password).digest(&#39;hex&#39;);
&#125;

var password = &#39;123456&#39;;

console.log( cryptPwd(password) );
// è¾“å‡ºï¼še10adc3949ba59abbe56e057f20f883e

console.log( cryptPwd(password) );
// è¾“å‡ºï¼še10adc3949ba59abbe56e057f20f883e
</code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æ”»å‡»è€…çŸ¥é“ç®—æ³•æ˜¯md5ï¼Œä¸”æ•°æ®åº“é‡Œå­˜å‚¨çš„å¯†ç å€¼ä¸º<code>e10adc3949ba59abbe56e057f20f883e</code>æ—¶ï¼Œç†è®ºä¸Šå¯ä»¥å¯ä»¥çŒœåˆ°ï¼Œç”¨æˆ·çš„æ˜æ–‡å¯†ç å°±æ˜¯<code>123456</code>ã€‚</p>
<p>äº‹å®ä¸Šï¼Œå½©è™¹è¡¨å°±æ˜¯è¿™ä¹ˆè¿›è¡Œæš´åŠ›ç ´è§£çš„ï¼šäº‹å…ˆå°†å¸¸è§æ˜æ–‡å¯†ç çš„md5å€¼è¿ç®—å¥½å­˜èµ·æ¥ï¼Œç„¶åè·Ÿç½‘ç«™æ•°æ®åº“é‡Œå­˜å‚¨çš„å¯†ç è¿›è¡ŒåŒ¹é…ï¼Œå°±èƒ½å¤Ÿå¿«é€Ÿæ‰¾åˆ°ç”¨æˆ·çš„æ˜æ–‡å¯†ç ã€‚ï¼ˆè¿™é‡Œä¸æ¢ç©¶å…·ä½“ç»†èŠ‚ï¼‰</p>
<p>é‚£ä¹ˆï¼Œæœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥è¿›ä¸€æ­¥æå‡å®‰å…¨æ€§å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼šå¯†ç åŠ ç›ã€‚</p>
<p><strong>å¯†ç åŠ ç›</strong></p>
<p>â€œåŠ ç›â€è¿™ä¸ªè¯çœ‹ä¸Šå»å¾ˆç„ä¹ï¼Œå…¶å®åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨å¯†ç ç‰¹å®šä½ç½®æ’å…¥ç‰¹å®šå­—ç¬¦ä¸²åï¼Œå†å¯¹ä¿®æ”¹åçš„å­—ç¬¦ä¸²è¿›è¡Œmd5è¿ç®—ã€‚</p>
<p>ä¾‹å­å¦‚ä¸‹ã€‚åŒæ ·çš„å¯†ç ï¼Œå½“â€œç›â€å€¼ä¸ä¸€æ ·æ—¶ï¼Œmd5å€¼çš„å·®å¼‚éå¸¸å¤§ã€‚é€šè¿‡å¯†ç åŠ ç›ï¼Œå¯ä»¥é˜²æ­¢æœ€åˆçº§çš„æš´åŠ›ç ´è§£ï¼Œå¦‚æœæ”»å‡»è€…äº‹å…ˆä¸çŸ¥é“â€ç›â€œå€¼ï¼Œç ´è§£çš„éš¾åº¦å°±ä¼šéå¸¸å¤§ã€‚</p>
<pre><code class="javascript">var crypto = require(&#39;crypto&#39;);

function cryptPwd(password, salt) &#123;
    // å¯†ç â€œåŠ ç›â€
    var saltPassword = password + &#39;:&#39; + salt;
    console.log(&#39;åŸå§‹å¯†ç ï¼š%s&#39;, password);
    console.log(&#39;åŠ ç›åçš„å¯†ç ï¼š%s&#39;, saltPassword);

    // åŠ ç›å¯†ç çš„md5å€¼
    var md5 = crypto.createHash(&#39;md5&#39;);
    var result = md5.update(saltPassword).digest(&#39;hex&#39;);
    console.log(&#39;åŠ ç›å¯†ç çš„md5å€¼ï¼š%s&#39;, result);
&#125;

cryptPwd(&#39;123456&#39;, &#39;abc&#39;);
// è¾“å‡ºï¼š
// åŸå§‹å¯†ç ï¼š123456
// åŠ ç›åçš„å¯†ç ï¼š123456:abc
// åŠ ç›å¯†ç çš„md5å€¼ï¼š51011af1892f59e74baf61f3d4389092

cryptPwd(&#39;123456&#39;, &#39;bcd&#39;);
// è¾“å‡ºï¼š
// åŸå§‹å¯†ç ï¼š123456
// åŠ ç›åçš„å¯†ç ï¼š123456:bcd
// åŠ ç›å¯†ç çš„md5å€¼ï¼š55a95bcb6bfbaef6906dbbd264ab4531
</code></pre>
<h1 id="09-ã€åŸç”Ÿnodejsè·¯ç”±ã€è·å–å‚æ•°ã€é™æ€ç›®å½•ã€‘"><a href="#09-ã€åŸç”Ÿnodejsè·¯ç”±ã€è·å–å‚æ•°ã€é™æ€ç›®å½•ã€‘" class="headerlink" title="09 ã€åŸç”Ÿnodejsè·¯ç”±ã€è·å–å‚æ•°ã€é™æ€ç›®å½•ã€‘"></a>09 ã€åŸç”Ÿnodejsè·¯ç”±ã€è·å–å‚æ•°ã€é™æ€ç›®å½•ã€‘</h1><h2 id="1-è·¯ç”±"><a href="#1-è·¯ç”±" class="headerlink" title="1.è·¯ç”±"></a>1.è·¯ç”±</h2><p><strong>index.js</strong></p>
<pre><code class="js">// å¯åŠ¨æœåŠ¡
const server = require(&#39;./server.js&#39;);
//è·¯ç”±æ¨¡å—
const route = require(&#39;./route.js&#39;);
//api
const apiRouter = require(&#39;./api.js&#39;);

server.use(route);
server.use(apiRouter);
server.start();
</code></pre>
<p><strong>server.js</strong></p>
<pre><code class="js">const http = require(&#39;http&#39;);

//åˆ›å»ºä¸€ä¸ªå¤§å¯¹è±¡å­˜å‚¨æ‰€æœ‰çš„è·¯ç”±å’Œapi
const route = &#123;&#125;;

// å°†æ‰€æœ‰è·¯ç”±å’Œapiåˆå¹¶çš„å‡½æ•°
function use(routeObj) &#123;
  Object.assign(route, routeObj);
&#125;

function start() &#123;
  http
    .createServer(async (req, res) =&gt; &#123;
      const url = new URL(req.url, &#39;http://127.0.0.1&#39;);
      route[url.pathname](res);
    &#125;)
    .listen(3000, () =&gt; &#123;
      console.log(&#39;å¯åŠ¨æˆåŠŸ&#39;);
    &#125;);
&#125;

module.exports = &#123;
  use,
  start,
&#125;;
</code></pre>
<p><strong>route.js</strong></p>
<pre><code class="js">const fs = require(&#39;fs&#39;);

function render(res, path, type = &#39;&#39;) &#123;
  res.writeHead(200, &#123; &#39;Content-Type&#39;: `$&#123;type ? type : &#39;text/html&#39;&#125;;charset=utf8` &#125;);
  res.write(fs.readFileSync(path), &#39;utf-8&#39;);
  res.end();
&#125;

const route = &#123;
  &#39;/login&#39;(res) &#123;
    render(res, &#39;./static/login.html&#39;);
  &#125;,
  &#39;/home&#39;(res) &#123;
    render(res, &#39;./static/home.html&#39;);
  &#125;,
  &#39;/favicon.ico&#39;(res) &#123;
    render(res, &#39;./static/favicon.ico&#39;, &#39;image/x-icon&#39;);
  &#125;,
  &#39;/404&#39;(res) &#123;
    res.writeHead(404, &#123; &#39;Content-Type&#39;: &#39;text/html;charset=utf8&#39; &#125;);
    res.write(fs.readFileSync(&#39;./static/404.html&#39;), &#39;utf-8&#39;);
    res.end();
  &#125;,
&#125;;

module.exports = route;
</code></pre>
<p><strong>api.js</strong></p>
<pre><code class="js">function render(res, data, type = &#39;&#39;) &#123;
  res.writeHead(200, &#123; &#39;Content-Type&#39;: `$&#123;type ? type : &#39;application/json&#39;&#125;;charset=utf8` &#125;);
  res.write(data);
  res.end();
&#125;

const apiRouter = &#123;
  &#39;/api/login&#39;(res) &#123;
    render(res, &#39;&#123; ok: 1 &#125;&#39;);
  &#125;,
&#125;;

module.exports = apiRouter;
</code></pre>
<h2 id="2-è·å–å‚æ•°"><a href="#2-è·å–å‚æ•°" class="headerlink" title="2.è·å–å‚æ•°"></a>2.è·å–å‚æ•°</h2><p><strong>api.js</strong></p>
<pre><code class="js">function render(res, data, type = &#39;&#39;) &#123;
  res.writeHead(200, &#123; &#39;Content-Type&#39;: `$&#123;type ? type : &#39;application/json&#39;&#125;;charset=utf8` &#125;);
  res.write(data);
  res.end();
&#125;

const apiRouter = &#123;
    //getè¯·æ±‚
  &#39;/api/login&#39;(req, res) &#123;
    const url = new URL(req.url, &#39;http://127.0.0.1&#39;);
    const data = &#123;&#125;;
    let username = url.searchParams.get(&#39;username&#39;);
    let password = url.searchParams.get(&#39;password&#39;);
    if (username === &#39;ds&#39; &amp;&amp; password === &#39;123&#39;) &#123;
      Object.assign(data, &#123;
        ok: 1,
      &#125;);
    &#125; else &#123;
      Object.assign(data, &#123;
        ok: 0,
      &#125;);
    &#125;
    render(res, JSON.stringify(data));
  &#125;,
    //postè¯·æ±‚
  &#39;/api/loginpost&#39;(req, res) &#123;
    const url = new URL(req.url, &#39;http://127.0.0.1&#39;);
    let data = &#39;&#39;;
      //è¿™é‡Œä½¿ç”¨æœ€åŸå§‹çš„æ–¹æ³•è·å–postè¯·æ±‚å‚æ•°
      // é€šè¿‡reqçš„dataäº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œæ¯å½“æ¥å—åˆ°è¯·æ±‚ä½“çš„æ•°æ®ï¼Œå°±ç´¯åŠ åˆ°postå˜é‡ä¸­
    req.on(&#39;data&#39;, chunk =&gt; &#123;
      data += chunk;
    &#125;);
       // åœ¨endäº‹ä»¶è§¦å‘åï¼Œé€šè¿‡querystring.parseå°†postè§£æä¸ºçœŸæ­£çš„POSTè¯·æ±‚æ ¼å¼ï¼Œç„¶åå‘å®¢æˆ·ç«¯è¿”å›ã€‚
    req.on(&#39;end&#39;, () =&gt; &#123;
      data = JSON.parse(data);
      if (data.username === &#39;ds&#39; &amp;&amp; data.password === &#39;123&#39;) &#123;
        render(res, JSON.stringify(&#123; ok: 1 &#125;));
      &#125; else &#123;
        render(res, JSON.stringify(&#123; ok: 0 &#125;));
      &#125;
    &#125;);
  &#125;,
&#125;;

module.exports = apiRouter;
</code></pre>
<p><strong>è¯·æ±‚.js</strong></p>
<pre><code class="js"> login.onclick = () =&gt; &#123;
        //getè¯·æ±‚
        fetch(`/api/login?username=$&#123;username.value&#125;&amp;password=$&#123;password.value&#125;`)
          .then(res =&gt; res.text())
          .then(res =&gt; &#123;
            console.log(res);
          &#125;);
      &#125;;
  loginpost.onclick = () =&gt; &#123;
    //postè¯·æ±‚
    fetch(`/api/loginpost`, &#123;
      method: &#39;POST&#39;,
      body: JSON.stringify(&#123;
        username: username.value,
        password: password.value,
      &#125;),
      headers: &#123;
        &#39;Content-Type&#39;: &#39;application/json&#39;,
      &#125;,
    &#125;)
      .then(res =&gt; res.text())
      .then(res =&gt; &#123;
        console.log(res);
      &#125;);
</code></pre>
<h2 id="3-é™æ€ç›®å½•"><a href="#3-é™æ€ç›®å½•" class="headerlink" title="3.é™æ€ç›®å½•"></a>3.é™æ€ç›®å½•</h2><p><strong>server.js</strong></p>
<pre><code class="js">const http = require(&#39;http&#39;);

const route = &#123;&#125;;

function use(routeObj) &#123;
  Object.assign(route, routeObj);
&#125;

function start() &#123;
  http
    .createServer(async (req, res) =&gt; &#123;
      const url = new URL(req.url, &#39;http://127.0.0.1&#39;);
      try &#123;
        route[url.pathname](req, res);
          //ä½¿æ‰€æœ‰åŒ¹é…ä¸åˆ°çš„è·¯å¾„èµ°404ç½‘é¡µ
      &#125; catch (err) &#123;
        route[&#39;/404&#39;](req, res);
      &#125;
    &#125;)
    .listen(3000, () =&gt; &#123;
      console.log(&#39;å¯åŠ¨æˆåŠŸ&#39;);
    &#125;);
&#125;

module.exports = &#123;
  use,
  start,
&#125;;
</code></pre>
<p><strong>route.js</strong></p>
<pre><code class="js">const fs = require(&#39;fs&#39;);
const path = require(&#39;path&#39;);
//æ ¹æ®æ–‡ä»¶åç¼€åè‡ªåŠ¨è·å–å“åº”å¤´ä¸­content-type
const mime = require(&#39;mime&#39;);

function render(res, path, type = &#39;&#39;) &#123;
  res.writeHead(200, &#123; &#39;Content-Type&#39;: `$&#123;type ? type : &#39;text/html&#39;&#125;;charset=utf8` &#125;);
  res.write(fs.readFileSync(path), &#39;utf-8&#39;);
  res.end();
&#125;

const route = &#123;
  &#39;/login&#39;(req, res) &#123;
    render(res, &#39;./static/login.html&#39;);
  &#125;,
  &#39;/home&#39;(req, res) &#123;
    render(res, &#39;./static/home.html&#39;);
  &#125;,
  &#39;/404&#39;(req, res) &#123;
    const url = new URL(req.url, &#39;http://127.0.0.1&#39;);
     /*
     &lt;link href=&#39;/css/index.css&#39;&gt;&lt;/link&gt;æ ¹è·¯å¾„è®¿é—®ï¼Œå°±ç­‰äº127.0.0.1:3000/css/index.cssã€‚
     è¿™é‡Œå°†é¡¹ç›®æ–‡ä»¶å¤¹F://é¡¹ç›®+static+/css/index.cssåˆå¹¶æˆæ–‡ä»¶è·¯å¾„ï¼Œå¦‚æœå­˜åœ¨å°±è¯»å–è¯¥æ–‡ä»¶è¿”å›
     */
    let pathname = path.join(__dirname, &#39;static&#39;, url.pathname);
    if (readStaticFile(res, pathname)) &#123;
      return;
    &#125;
    res.writeHead(404, &#123; &#39;Content-Type&#39;: &#39;text/html;charset=utf8&#39; &#125;);
    res.write(fs.readFileSync(&#39;./static/404.html&#39;), &#39;utf-8&#39;);
    res.end();
  &#125;,
&#125;;

function readStaticFile(res, pathname) &#123;
  let houzhui = pathname.split(&#39;.&#39;);
    //å¦‚æœå­˜åœ¨è¿™äº›é™æ€èµ„æºå°±ç”¨fsçš„å†™å…¥æ–¹æ³•è¿”å›å›å»ï¼Œä¸èµ°404
  if (fs.existsSync(pathname)) &#123;
      //mime.getType(css)
    render(res, pathname, mime.getType(houzhui[houzhui.length - 1]));
    return true;
  &#125; else &#123;
    return false;
  &#125;
&#125;

module.exports = route;
</code></pre>

      <div class="tags">
          <a href="/tags/node-js/" rel="tag"><i class="ic i-tag"></i> node.js</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">æ›´æ–°äº</span>
    <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-05-20 09:02:34" itemprop="dateModified" datetime="2024-05-20T09:02:34+08:00">2024-05-20</time>
  </span>
  <span id="2024/01/02/node.jså†…ç½®æ¨¡å—/" class="item leancloud_visitors" data-flag-title="node.jså†…ç½®æ¨¡å—" title="é˜…è¯»æ¬¡æ•°">
      <span class="icon">
        <i class="ic i-eye"></i>
      </span>
      <span class="text">é˜…è¯»æ¬¡æ•°</span>
      <span class="leancloud-visitors-count"></span>
      <span class="text">æ¬¡</span>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> èµèµ</button>
  <p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="dmq å¾®ä¿¡æ”¯ä»˜">
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="dmq æ”¯ä»˜å®">
        <p>æ”¯ä»˜å®</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>dmq <i class="ic i-at"><em>@</em></i>æœæ˜æ¸…çš„ä¸ªäººåšå®¢
  </li>
  <li class="link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://dmqweb.cn/2024/01/02/node.js%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/" title="node.jså†…ç½®æ¨¡å—">https://dmqweb.cn/2024/01/02/node.jså†…ç½®æ¨¡å—/</a>
  </li>
  <li class="license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2023/12/21/%E6%9C%80%E5%A4%A7%E5%AE%89%E5%85%A8%E6%95%B0/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s3.uuu.ovh&#x2F;imgs&#x2F;2024&#x2F;04&#x2F;12&#x2F;4508f1e9b6c8e047.jpg" title="æœ€å¤§å®‰å…¨æ•°ä¸æœ€å¤§å®‰å…¨æ•´æ•°">
  <span class="type">ä¸Šä¸€ç¯‡</span>
  <span class="category"><i class="ic i-flag"></i> JS</span>
  <h3>æœ€å¤§å®‰å…¨æ•°ä¸æœ€å¤§å®‰å…¨æ•´æ•°</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2024/01/02/%E9%A1%B9%E7%9B%AE%E8%B4%A8%E9%87%8F%E6%A3%80%E6%B5%8B/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s3.uuu.ovh&#x2F;imgs&#x2F;2024&#x2F;04&#x2F;15&#x2F;66e62db68b7b65eb.webp" title="é¡¹ç›®è´¨é‡æ£€æµ‹">
  <span class="type">ä¸‹ä¸€ç¯‡</span>
  <span class="category"><i class="ic i-flag"></i> é¡¹ç›®è´¨é‡æ£€æµ‹</span>
  <h3>é¡¹ç›®è´¨é‡æ£€æµ‹</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#05-%E3%80%90nodejs%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97%EF%BC%88%E4%B8%8A%EF%BC%89%E3%80%91"><span class="toc-number">1.</span> <span class="toc-text">05 ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸Šï¼‰ã€‘</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#nodejs-%E7%9A%84%E5%AE%98%E6%96%B9API%E6%96%87%E6%A1%A3"><span class="toc-number">1.1.</span> <span class="toc-text">nodejs çš„å®˜æ–¹APIæ–‡æ¡£</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nodejs-%E4%B8%AD%E6%A8%A1%E5%9D%97%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">1.2.</span> <span class="toc-text">nodejs ä¸­æ¨¡å—çš„åˆ†ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97"><span class="toc-number">1.2.1.</span> <span class="toc-text">å†…ç½®æ¨¡å—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#require-%E5%8A%A0%E8%BD%BD%E7%AC%AC%E4%B8%89%E6%96%B9%E5%8C%85%E7%9A%84%E6%9C%BA%E5%88%B6"><span class="toc-number">1.2.2.</span> <span class="toc-text">require åŠ è½½ç¬¬ä¸‰æ–¹åŒ…çš„æœºåˆ¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9D%97%EF%BC%88module%EF%BC%89"><span class="toc-number">1.2.3.</span> <span class="toc-text">è‡ªå®šä¹‰æ¨¡å—ï¼ˆmoduleï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1-http"><span class="toc-number">1.3.</span> <span class="toc-text">ç½‘ç»œæœåŠ¡ http</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#http%E6%A8%A1%E5%9D%97%E6%A6%82%E8%A7%88"><span class="toc-number">1.3.1.</span> <span class="toc-text">httpæ¨¡å—æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-number">1.3.2.</span> <span class="toc-text">ä¸€ä¸ªç®€å•çš„ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90%E8%A7%A3%E9%87%8A"><span class="toc-number">1.3.3.</span> <span class="toc-text">ä¾‹å­è§£é‡Š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E4%BA%8Ehttp-IncomingMessage%E3%80%81http-ServerResponse"><span class="toc-number">1.3.4.</span> <span class="toc-text">å…³äºhttp.IncomingMessageã€http.ServerResponse</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1-http-res"><span class="toc-number">1.4.</span> <span class="toc-text">ç½‘ç»œæœåŠ¡ http res</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%A7%88"><span class="toc-number">1.4.1.</span> <span class="toc-text">æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-number">1.4.2.</span> <span class="toc-text">ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E7%8A%B6%E6%80%81%E4%BB%A3%E7%A0%81%E3%80%81%E7%8A%B6%E6%80%81%E6%8F%8F%E8%BF%B0%E4%BF%A1%E6%81%AF"><span class="toc-number">1.4.3.</span> <span class="toc-text">è®¾ç½®çŠ¶æ€ä»£ç ã€çŠ¶æ€æè¿°ä¿¡æ¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8"><span class="toc-number">1.4.4.</span> <span class="toc-text">è®¾ç½®å“åº”å¤´éƒ¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">1.4.5.</span> <span class="toc-text">å…¶ä»–å“åº”å¤´éƒ¨æ“ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%93%8D%E5%BA%94%E4%B8%BB%E4%BD%93"><span class="toc-number">1.4.6.</span> <span class="toc-text">è®¾ç½®å“åº”ä¸»ä½“</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#response-write-chunk-encoding-callback"><span class="toc-number">1.4.6.1.</span> <span class="toc-text">response.write(chunk[, encoding][, callback])</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#response-end-data-encoding-callback"><span class="toc-number">1.4.6.2.</span> <span class="toc-text">response.end([data][, encoding][, callback])</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B6%85%E6%97%B6%E5%A4%84%E7%90%86"><span class="toc-number">1.4.7.</span> <span class="toc-text">è¶…æ—¶å¤„ç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6-close-x2F-finish"><span class="toc-number">1.4.8.</span> <span class="toc-text">äº‹ä»¶ close&#x2F;finish</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E4%B8%8D%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7-x2F-%E6%96%B9%E6%B3%95"><span class="toc-number">1.4.9.</span> <span class="toc-text">å…¶ä»–ä¸å¸¸ç”¨å±æ€§&#x2F;æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1-http-req"><span class="toc-number">1.5.</span> <span class="toc-text">ç½‘ç»œæœåŠ¡ http req</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%A7%88-1"><span class="toc-number">1.5.1.</span> <span class="toc-text">æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7-x2F-%E6%96%B9%E6%B3%95-x2F-%E4%BA%8B%E4%BB%B6-%E5%88%86%E7%B1%BB"><span class="toc-number">1.5.2.</span> <span class="toc-text">å±æ€§&#x2F;æ–¹æ³•&#x2F;äº‹ä»¶ åˆ†ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-number">1.5.3.</span> <span class="toc-text">æœåŠ¡ç«¯çš„ä¾‹å­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90%E4%B8%80%EF%BC%9A%E8%8E%B7%E5%8F%96httpVersion-x2F-method-x2F-url"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">ä¾‹å­ä¸€ï¼šè·å–httpVersion&#x2F;method&#x2F;url</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90%E4%BA%8C%EF%BC%9A%E8%8E%B7%E5%8F%96get%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">ä¾‹å­äºŒï¼šè·å–getè¯·æ±‚å‚æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90%E4%B8%89%EF%BC%9A%E8%8E%B7%E5%8F%96post%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="toc-number">1.5.3.3.</span> <span class="toc-text">ä¾‹å­ä¸‰ï¼šè·å–postè¯·æ±‚å‚æ•°</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1-https"><span class="toc-number">1.6.</span> <span class="toc-text">ç½‘ç»œæœåŠ¡ https</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E6%A6%82%E8%A7%88"><span class="toc-number">1.6.1.</span> <span class="toc-text">æ¨¡å—æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BE%8B%E5%AD%90"><span class="toc-number">1.6.2.</span> <span class="toc-text">å®¢æˆ·ç«¯ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E4%BE%8B%E5%AD%90"><span class="toc-number">1.6.3.</span> <span class="toc-text">æœåŠ¡ç«¯ä¾‹å­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E8%AF%81%E4%B9%A6"><span class="toc-number">1.6.3.1.</span> <span class="toc-text">ç”Ÿæˆè¯ä¹¦</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTPS%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-number">1.6.3.2.</span> <span class="toc-text">HTTPSæœåŠ¡ç«¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#URL-%E6%8E%A5%E5%8F%A3-%E4%BB%A3%E6%9B%BF%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97url%E4%BD%BF%E7%94%A8"><span class="toc-number">1.7.</span> <span class="toc-text">URL æ¥å£(ä»£æ›¿å†…ç½®æ¨¡å—urlä½¿ç”¨)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E5%AF%B9%E6%AF%94url%E6%A8%A1%E5%9D%97%E5%92%8CURL%E7%B1%BB"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 å¯¹æ¯”urlæ¨¡å—å’ŒURLç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.2.</span> <span class="toc-text">æ„é€ å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E5%B1%9E%E6%80%A7"><span class="toc-number">1.7.3.</span> <span class="toc-text">å®ä¾‹å±æ€§</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#URLSearchParams-%E5%AF%B9%E8%B1%A1-%E4%BB%A3%E6%9B%BF%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97querystring%E4%BD%BF%E7%94%A8"><span class="toc-number">1.8.</span> <span class="toc-text">URLSearchParams å¯¹è±¡(ä»£æ›¿å†…ç½®æ¨¡å—querystringä½¿ç”¨)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.8.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URLSearchParams-toString"><span class="toc-number">1.8.2.</span> <span class="toc-text">URLSearchParams.toString()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URLSearchParams-has"><span class="toc-number">1.8.3.</span> <span class="toc-text">URLSearchParams.has()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URLSearchParams-get-%EF%BC%8CURLSearchParams-getAll"><span class="toc-number">1.8.4.</span> <span class="toc-text">URLSearchParams.get()ï¼ŒURLSearchParams.getAll()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URLSearchParams-keys-%EF%BC%8CURLSearchParams-values-%EF%BC%8CURLSearchParams-entries"><span class="toc-number">1.8.5.</span> <span class="toc-text">URLSearchParams.keys()ï¼ŒURLSearchParams.values()ï¼ŒURLSearchParams.entries()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#qs%E6%A8%A1%E5%9D%97"><span class="toc-number">1.9.</span> <span class="toc-text">qsæ¨¡å—</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#06-%E3%80%90nodejs%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97%EF%BC%88%E4%B8%AD%EF%BC%89%E3%80%91"><span class="toc-number">2.</span> <span class="toc-text">06 ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸­ï¼‰ã€‘</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E8%B7%AF%E5%8A%B2%E5%A4%84%E7%90%86%E6%A8%A1%E5%9D%97-path"><span class="toc-number">2.1.</span> <span class="toc-text">1.è·¯åŠ²å¤„ç†æ¨¡å— path</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%A8%A1%E5%9D%97%E6%A6%82%E8%A7%88"><span class="toc-number">2.1.1.</span> <span class="toc-text">1.1 æ¨¡å—æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E8%8E%B7%E5%8F%96%E8%B7%AF%E5%BE%84-x2F-%E6%96%87%E4%BB%B6%E5%90%8D-x2F-%E6%89%A9%E5%B1%95%E5%90%8D"><span class="toc-number">2.1.2.</span> <span class="toc-text">1.2 è·å–è·¯å¾„&#x2F;æ–‡ä»¶å&#x2F;æ‰©å±•å</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-%E8%8E%B7%E5%8F%96%E6%89%80%E5%9C%A8%E8%B7%AF%E5%BE%84"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">1.2.1 è·å–æ‰€åœ¨è·¯å¾„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E5%90%8D"><span class="toc-number">2.1.2.2.</span> <span class="toc-text">1.2.2 è·å–æ–‡ä»¶å</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-3-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E6%89%A9%E5%B1%95%E5%90%8D"><span class="toc-number">2.1.2.3.</span> <span class="toc-text">1.2.3 è·å–æ–‡ä»¶æ‰©å±•å</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E8%B7%AF%E5%BE%84%E7%BB%84%E5%90%88"><span class="toc-number">2.1.3.</span> <span class="toc-text">1.3 è·¯å¾„ç»„åˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-1-path-resolve-%E7%94%9F%E6%88%90%E5%AE%8C%E6%88%90%E7%9A%84%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">1.3.1 path.resolve() ç”Ÿæˆå®Œæˆçš„ç»å¯¹è·¯å¾„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-2-path-join-%E5%B0%86%E5%A4%9A%E4%B8%AA%E8%B7%AF%E5%BE%84%E8%BF%9B%E8%A1%8C%E6%8B%BC%E6%8E%A5"><span class="toc-number">2.1.3.2.</span> <span class="toc-text">1.3.2 path.join() å°†å¤šä¸ªè·¯å¾„è¿›è¡Œæ‹¼æ¥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-3-path-resolve-%E5%92%8C-path-join-%E5%8C%BA%E5%88%AB"><span class="toc-number">2.1.3.3.</span> <span class="toc-text">1.3.3 path.resolve å’Œ path.join åŒºåˆ«</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E5%87%A0%E4%B8%AA%E5%B8%B8%E8%A7%81%E8%B7%AF%E5%BE%84"><span class="toc-number">2.1.4.</span> <span class="toc-text">1.4 å‡ ä¸ªå¸¸è§è·¯å¾„</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E6%A8%A1%E5%9D%97-fs"><span class="toc-number">2.2.</span> <span class="toc-text">2.æœ¬åœ°æ–‡ä»¶æ“ä½œæ¨¡å— fs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Node-js-%E4%B8%AD%E7%9A%84%E5%90%8C%E6%AD%A5%E5%92%8C%E5%BC%82%E6%AD%A5%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.2.1.</span> <span class="toc-text">Node.js ä¸­çš„åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.1 æ–‡ä»¶è¯»å–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5"><span class="toc-number">2.2.3.</span> <span class="toc-text">2.2 æ–‡ä»¶å†™å…¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8"><span class="toc-number">2.2.4.</span> <span class="toc-text">2.3 æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.5.</span> <span class="toc-text">2.4 åˆ é™¤æ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95"><span class="toc-number">2.2.6.</span> <span class="toc-text">2.5 åˆ›å»ºç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-%E9%81%8D%E5%8E%86%E7%9B%AE%E5%BD%95"><span class="toc-number">2.2.7.</span> <span class="toc-text">2.6 éå†ç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-%E8%AF%BB%E5%8F%96%E7%9B%AE%E5%BD%95"><span class="toc-number">2.2.8.</span> <span class="toc-text">2.7 è¯»å–ç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-8-%E5%88%A0%E9%99%A4%E7%9B%AE%E5%BD%95"><span class="toc-number">2.2.9.</span> <span class="toc-text">2.8 åˆ é™¤ç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-9-%E5%88%A0%E9%99%A4%E6%95%B4%E4%B8%AA%E7%9B%AE%E5%BD%95"><span class="toc-number">2.2.10.</span> <span class="toc-text">2.9 åˆ é™¤æ•´ä¸ªç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-%E6%96%87%E4%BB%B6%E9%87%8D%E5%91%BD%E5%90%8D"><span class="toc-number">2.2.11.</span> <span class="toc-text">2.10 æ–‡ä»¶é‡å‘½å</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-11-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E7%8A%B6%E6%80%81"><span class="toc-number">2.2.12.</span> <span class="toc-text">2.11 è·å–æ–‡ä»¶çŠ¶æ€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-12-%E8%BF%BD%E5%8A%A0%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="toc-number">2.2.13.</span> <span class="toc-text">2.12 è¿½åŠ æ–‡ä»¶å†…å®¹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6%E6%A8%A1%E5%9D%97-events"><span class="toc-number">2.3.</span> <span class="toc-text">3.äº‹ä»¶æœºåˆ¶æ¨¡å— events</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#07-%E3%80%90nodejs%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97%EF%BC%88%E4%B8%8B%EF%BC%89%E3%80%91"><span class="toc-number">3.</span> <span class="toc-text">07 ã€nodejså†…ç½®æ¨¡å—ï¼ˆä¸‹ï¼‰ã€‘</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-stream-%E6%A8%A1%E5%9D%97"><span class="toc-number">3.1.</span> <span class="toc-text">1.stream æ¨¡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E8%AF%BB%E5%8F%96%E6%B5%81"><span class="toc-number">3.1.1.</span> <span class="toc-text">1.1 è¯»å–æµ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%86%99%E5%85%A5%E6%B5%81"><span class="toc-number">3.1.2.</span> <span class="toc-text">1.2 å†™å…¥æµ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%B5%84%E6%BA%90%E5%8E%8B%E7%BC%A9%E6%A8%A1%E5%9D%97-zib"><span class="toc-number">3.2.</span> <span class="toc-text">2.èµ„æºå‹ç¼©æ¨¡å— zib</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%A6%82%E8%A7%88"><span class="toc-number">3.2.1.</span> <span class="toc-text">2.1 æ¦‚è§ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%8E%8B%E7%BC%A9%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-number">3.2.2.</span> <span class="toc-text">2.2 å‹ç¼©çš„ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E8%A7%A3%E5%8E%8B%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-number">3.2.3.</span> <span class="toc-text">2.3 è§£å‹çš„ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E6%9C%8D%E5%8A%A1%E7%AB%AFgzip%E5%8E%8B%E7%BC%A9"><span class="toc-number">3.2.4.</span> <span class="toc-text">2.4 æœåŠ¡ç«¯gzipå‹ç¼©</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%AD%97%E7%AC%A6%E4%B8%B2gzip%E5%8E%8B%E7%BC%A9"><span class="toc-number">3.2.5.</span> <span class="toc-text">2.5 æœåŠ¡ç«¯å­—ç¬¦ä¸²gzipå‹ç¼©</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%AF%86%E6%A8%A1%E5%9D%97-crypto"><span class="toc-number">3.3.</span> <span class="toc-text">3.æ•°æ®åŠ å¯†æ¨¡å— crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-hash%E4%BE%8B%E5%AD%90"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.1 hashä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-HMAC%E4%BE%8B%E5%AD%90"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.2 HMACä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-MD5%E4%BE%8B%E5%AD%90"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.3 MD5ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E4%BE%8B%E5%AD%90%EF%BC%9A%E5%AF%86%E7%A0%81%E4%BF%9D%E6%8A%A4"><span class="toc-number">3.3.4.</span> <span class="toc-text">3.4 ä¾‹å­ï¼šå¯†ç ä¿æŠ¤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#09-%E3%80%90%E5%8E%9F%E7%94%9Fnodejs%E8%B7%AF%E7%94%B1%E3%80%81%E8%8E%B7%E5%8F%96%E5%8F%82%E6%95%B0%E3%80%81%E9%9D%99%E6%80%81%E7%9B%AE%E5%BD%95%E3%80%91"><span class="toc-number">4.</span> <span class="toc-text">09 ã€åŸç”Ÿnodejsè·¯ç”±ã€è·å–å‚æ•°ã€é™æ€ç›®å½•ã€‘</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E8%B7%AF%E7%94%B1"><span class="toc-number">4.1.</span> <span class="toc-text">1.è·¯ç”±</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%8E%B7%E5%8F%96%E5%8F%82%E6%95%B0"><span class="toc-number">4.2.</span> <span class="toc-text">2.è·å–å‚æ•°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E9%9D%99%E6%80%81%E7%9B%AE%E5%BD%95"><span class="toc-number">4.3.</span> <span class="toc-text">3.é™æ€ç›®å½•</span></a></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« ">
        <ul>
          <li class="active"><a href="/2024/01/02/node.js%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/" rel="bookmark" title="node.jså†…ç½®æ¨¡å—">node.jså†…ç½®æ¨¡å—</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="dmq"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">dmq</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">74</span>
        <span class="name">æ–‡ç« </span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">56</span>
        <span class="name">åˆ†ç±»</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">96</span>
        <span class="name">æ ‡ç­¾</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RtcTA/dGFiPXJlcG9zaXRvcmllcw==" title="https:&#x2F;&#x2F;github.com&#x2F;dmq0?tab&#x3D;repositories"><i class="ic i-github"></i></span>
      <span class="exturl item npm" data-url="aHR0cHM6Ly93d3cubnBtanMuY29tL35kbXEwMDA=" title="https:&#x2F;&#x2F;www.npmjs.com&#x2F;~dmq000"><i class="ic i-file"></i></span>
      <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9kLTg4LTYxLTgz" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;d-88-61-83"><i class="ic i-zhihu"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTgwMjc4OTk0OTE=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;8027899491"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vdS83NjI1OTAxNzE3" title="https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;7625901717"><i class="ic i-weibo"></i></span>
      <span class="exturl item email" data-url="bWFpbHRvOjMyNjc4MDc1MTRAcXEuY29t" title="mailto:3267807514@qq.com"><i class="ic i-envelope"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>ä»‹ç»</a>
  </li>

    
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a>
  </li>

    
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a>
  </li>

    
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a>
  </li>

    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>å‹é“¾</a>
  </li>

    
  <li class="item">
    <a href="/links/" rel="section"><i class="ic i-magic"></i>å·¥å…·</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2023/12/21/%E6%9C%80%E5%A4%A7%E5%AE%89%E5%85%A8%E6%95%B0/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2024/01/02/%E9%A1%B9%E7%9B%AE%E8%B4%A8%E9%87%8F%E6%A3%80%E6%B5%8B/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>éšæœºæ–‡ç« </h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E4%B8%89%E6%96%B9%E5%BA%93/" title="åˆ†ç±»äº ä¸‰æ–¹åº“">ä¸‰æ–¹åº“</a>
</div>

    <span><a href="/2024/04/16/%E4%B8%89%E6%96%B9%E5%8C%85/" title="ä¸‰æ–¹åº“">ä¸‰æ–¹åº“</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/JS/" title="åˆ†ç±»äº JS">JS</a>
</div>

    <span><a href="/2023/12/08/NaN/" title="NaNå†å²é—ç•™é—®é¢˜">NaNå†å²é—ç•™é—®é¢˜</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Vue/" title="åˆ†ç±»äº Vue">Vue</a>
</div>

    <span><a href="/2023/01/12/Vue%E6%9D%82%E8%AE%B0/" title="Vueä½¿ç”¨ç¬”è®°">Vueä½¿ç”¨ç¬”è®°</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/esbuild/" title="åˆ†ç±»äº esbuild">esbuild</a>
</div>

    <span><a href="/2024/05/17/esbuild/" title="esbuild">esbuild</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="åˆ†ç±»äº æ­£åˆ™è¡¨è¾¾å¼">æ­£åˆ™è¡¨è¾¾å¼</a>
</div>

    <span><a href="/2023/02/12/%E4%B8%AD%E5%89%8D%E5%8F%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" title="æ­£åˆ™è¡¨è¾¾å¼">æ­£åˆ™è¡¨è¾¾å¼</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" title="åˆ†ç±»äº ç½‘ç»œå®‰å…¨">ç½‘ç»œå®‰å…¨</a>
</div>

    <span><a href="/2024/05/23/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" title="ç½‘ç»œå®‰å…¨">ç½‘ç»œå®‰å…¨</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%89%8D%E7%AB%AF%E7%9B%91%E6%8E%A7/" title="åˆ†ç±»äº å‰ç«¯ç›‘æ§">å‰ç«¯ç›‘æ§</a>
</div>

    <span><a href="/2024/04/29/%E5%89%8D%E7%AB%AF%E7%9B%91%E6%8E%A7/" title="å‰ç«¯ç›‘æ§">å‰ç«¯ç›‘æ§</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/JS/" title="åˆ†ç±»äº JS">JS</a>
</div>

    <span><a href="/2024/01/11/webworker/" title="webWorker">webWorker</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="åˆ†ç±»äº æ€§èƒ½ä¼˜åŒ–">æ€§èƒ½ä¼˜åŒ–</a>
</div>

    <span><a href="/2024/05/11/%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87/" title="æ€§èƒ½æŒ‡æ ‡">æ€§èƒ½æŒ‡æ ‡</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/JS%E5%BA%95%E5%B1%82/" title="åˆ†ç±»äº JSåº•å±‚">JSåº•å±‚</a>
</div>

    <span><a href="/2023/06/02/new%E5%85%B3%E9%94%AE%E5%AD%97/" title="newå…³é”®å­—çš„å®ç°">newå…³é”®å­—çš„å®ç°</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>æœ€æ–°è¯„è®º</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 â€“ 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">dmq @ Web blog</span>
  </div>
  <div class="powered-by">
    åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2024/01/02/node.jså†…ç½®æ¨¡å—/',
    favicon: {
      show: "ç§‘æŠ€å¼•é¢†æœªæ¥",
      hide: "æ¬¢è¿ä¸æˆ‘äº¤æµ"
    },
    search : {
      placeholder: "æ–‡ç« æœç´¢",
      empty: "å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",
      stats: "${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"
    },
    valine: true,fancybox: true,
    copyright: 'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//gcore.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>


  <script data-pjax>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?9ba187659e850a6910681214f0faa16b";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


</body>
</html>
