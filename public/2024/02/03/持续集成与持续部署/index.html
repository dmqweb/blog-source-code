



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="杜明清的个人博客" href="https://dmqweb.cn/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="杜明清的个人博客" href="https://dmqweb.cn/atom.xml" />
<link rel="alternate" type="application/json" title="杜明清的个人博客" href="https://dmqweb.cn/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="持续集成,持续部署" />


<link rel="canonical" href="https://dmqweb.cn/2024/02/03/%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E4%B8%8E%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2/">



  <title>
持续集成与持续部署 - 持续集成与部署 |
Web blog = 杜明清的个人博客 = 👻欢迎一起交流学习👻</title>
  <meta name="keywords" content="前端开发, HTML, CSS, JavaScript, 博客">
  <meta name="description" content="探索前端开发的无限可能。本博客提供最新的前端知识库，以及实用的开发技巧和最佳实践。加入我们的社区，共同成长。">
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">持续集成与持续部署
  </h1>
  
<div class="meta">
  <span class="item" title="创建时间：2024-02-03 14:04:09">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">发表于</span>
    <time itemprop="dateCreated datePublished" datetime="2024-02-03T14:04:09+08:00">2024-02-03</time>
  </span>
  <span class="item" title="本文字数">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">本文字数</span>
    <span>27k</span>
    <span class="text">字</span>
  </span>
  <span class="item" title="阅读时长">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">阅读时长</span>
    <span>24 分钟</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="切换导航栏">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Web blog</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/07/6e43985af4997748.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/06/63e9f1e7097ba6fb.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/25/37c45c250c8e6e2b.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/05/8c79eda29fb3b505.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/05/921096d78816dacc.jpg"></li>
          <li class="item" data-background-image="https://s3.uuu.ovh/imgs/2024/04/12/35b09cafcea9fd29.webp"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">首页</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E4%B8%8E%E9%83%A8%E7%BD%B2/" itemprop="item" rel="index" title="分类于 持续集成与部署"><span itemprop="name">持续集成与部署</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://dmqweb.cn/2024/02/03/%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E4%B8%8E%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="dmq">
    <meta itemprop="description" content="👻欢迎一起交流学习👻, ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="杜明清的个人博客">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="5-4-持续集成与持续部署"><a href="#5-4-持续集成与持续部署" class="headerlink" title="5-4 持续集成与持续部署"></a>5-4 持续集成与持续部署</h1><p><strong>传统的开发过程中的坑：</strong></p>
<ul>
<li>BUG 总是在最后才发现</li>
<li>越到项目后期，加班越严重</li>
<li>交付无法保障</li>
<li>变更频繁导致效率低下</li>
<li>无效的等待多，用户满足度低</li>
</ul>
<p><img data-src="/images/1460000014924499.png" alt="img"></p>
<p><strong>你有没有想过&#x2F;用过？当你哪一天…</strong></p>
<ul>
<li>不用为开发&#x2F;测试环境不一致而苦恼</li>
<li>不用麻烦运维人员帮忙调试环境</li>
<li>不用手动进行测试，模拟环境中进行自测</li>
<li>不用手动发布、部署，自动化实现发布部署</li>
<li>不用管开发&#x2F;测试环境，只用专注代码的开发？</li>
</ul>
<p><strong>持续集成解决了什么问题？</strong></p>
<ul>
<li>提高软件质量</li>
<li>效率迭代</li>
<li>便捷部署</li>
<li>快速交付、便于管理</li>
</ul>
<p><strong>介绍：</strong></p>
<ul>
<li><p>什么是 CI&#x2F;CD</p>
</li>
<li><p>介绍 CI&#x2F;CD 流程</p>
</li>
<li><p>前端项目：结合 CI&#x2F;CD 流程，实现快速迭代</p>
</li>
<li><p>Docker 的使用，Jenkins+gitlab+nodejs 自动化项目</p>
</li>
<li><p>持续集成工具介绍：Jenkins、Travis CI、Circle CI</p>
</li>
</ul>
<p><strong>环境准备：</strong></p>
<ul>
<li>Linux 服务器(Centos 7.6&#x2F;Ubuntu 16.04LTS)</li>
<li>VSCode+插件 Dockerfile</li>
<li>注册 github 账号</li>
</ul>
<h2 id="持续集成"><a href="#持续集成" class="headerlink" title="持续集成"></a>持续集成</h2><h3 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h3><p><strong>集成，就是一些孤立的事物或元素通过某种方式集中在一起，产生联系，从而构成一个有机整体的过程</strong>。知识经济的社会，集成已经成了很重要的一个名词。各行各业基本都会用到集成。比如汽车行业，那么复杂的一台跑车愣是通过一大堆零件组装起来。对于这些传统行业，它们在研发成功以后，可以通过流水线的方法批量生产进行集成。而在软件行业中，集成并不是一个简单的“搬箱子”的过程。因为软件工业是一个知识生产活动，其内在逻辑非常复杂，需求又很难一次性确定，完成的产品与最初的设计往往相差很远。敏捷宣言中就有一条是说响应变化重于遵循计划。而且由于软件行业的迅猛发展，软件变的越来越复杂，单靠个人是根本无法完成。大型软件为了重用及解耦，往往还需要分成好几个模块，这样集成就成了软件开发中不可或缺的一部分。</p>
<p>持续，不言而喻，就是指<strong>长期的对项目代码进行集成。</strong></p>
<h4 id="持续集成-1"><a href="#持续集成-1" class="headerlink" title="持续集成"></a>持续集成</h4><p>持续集成（英文：Continuous Integration，简称 CI）</p>
<p>在软件工程中，持续集成是指将所有开发者工作副本每天多次合并到主干的做法。</p>
<blockquote>
<p>Grady Booch 在 1991 年的 Booch method 中首次命名并提出了 CI 的概念，尽管在当时他并不主张每天多次集成。而 XP（Extreme programming，极限编程）采用了 CI 的概念，并提倡每天不止一次集成。</p>
<p>在《持续集成》一书中，对持续集成的定义如下：<code>持续集成</code>是一种软件开发实践。在持续集成中，团队成员频繁集成他们的工作成果，一般每人每天至少集成一次,也可以多次。每次集成会经过自动构建(包括自动测试)的检验，以尽快发现集成错误。自从在团队中引入这样的实践之后，<code>Martin Fowler</code>发现这种方法可以显著减少集成引起的问题，并可以加快团队合作软件开发的速度。</p>
</blockquote>
<p><img data-src="/images/c5c8e6f40c7c133e22402c00bb7e1a25_hd.jpg" alt="img"></p>
<p>持续集成强调开发人员提交了新代码之后，立刻进行构建、（单元）测试。根据测试结果，我们可以确定新代码和原有代码能否正确地集成在一起。</p>
<p>对于一天需要集成多少次数，并没有一个明确的定义。一般就是按照自己项目的实际需要来设置一定的频率，少则可能几次，多则可能达几十次。可以设置按照代码的变更来触发集成，或者设置一个固定时间周期来集成，也可以手工点击集成的按钮来“一键集成”。</p>
<h4 id="持续交付"><a href="#持续交付" class="headerlink" title="持续交付"></a>持续交付</h4><p>持续交付（英文：Continuous Delivery，简称 CD）</p>
<p>完成 CI 中构建及单元测试和集成测试的自动化流程后，持续交付可自动将已验证的代码发布到存储库。为了实现高效的持续交付流程，务必要确保 CI 已内置于开发管道。持续交付的目标是拥有一个可随时部署到生产环境的代码库。</p>
<p><img data-src="/images/db7198e3c39e4656e18efcb4bd1b20b1_hd.jpg" alt="img"></p>
<p>在持续交付中，每个阶段（从代码更改的合并，到生产就绪型构建版本的交付）都涉及测试自动化和代码发布自动化。在流程结束时，运维团队可以快速、轻松地将应用部署到生产环境中。</p>
<p>比如，我们完成单元测试后，可以把代码部署到连接数据库的 Staging 环境中更多的测试。如果代码没有问题，可以继续<code>手动</code>部署到生产环境中。</p>
<h4 id="持续部署"><a href="#持续部署" class="headerlink" title="持续部署"></a>持续部署</h4><p>持续部署（英文：Continuous Deployment，简称 CD）</p>
<p>对于一个成熟的 CI&#x2F;CD 管道来说，最后的阶段是持续部署。作为持续交付——自动将生产就绪型构建版本发布到代码存储库——的延伸，持续部署可以自动将应用发布到生产环境。由于在生产之前的管道阶段没有手动门控，因此持续部署在很大程度上都得依赖精心设计的测试自动化。</p>
<p><img data-src="/images/f96f19e4d567aad5006d841963a86e41_hd.jpg" alt="img"></p>
<p>实际上，持续部署意味着开发人员对应用的更改在编写后的几分钟内就能生效（假设它通过了自动化测试）。这更加便于持续接收和整合用户反馈。总而言之，所有这些 CI&#x2F;CD 的关联步骤都有助于降低应用的部署风险，因此更便于以小件的方式（而非一次性）发布对应用的更改。不过，由于还需要编写自动化测试以适应 CI&#x2F;CD 管道中的各种测试和发布阶段，因此前期投资还是会很大。</p>
<p>持续部署则是在持续交付的基础上，把部署到生产环境的过程<code>自动化</code>。</p>
<h3 id="持续集成组成要素"><a href="#持续集成组成要素" class="headerlink" title="持续集成组成要素"></a>持续集成组成要素</h3><p><strong>一个最小化的持续集成系统需要包含以下几个要素：</strong></p>
<ol>
<li><strong>版本管理系统：</strong>项目的源代码需要托管到适合的版本管理系统中，一般我们使用 git 作为版本控制库，版本管理软件可以使用 github、<code>gitlab</code>、stash 等。</li>
<li><strong>构建脚本&amp;工具：</strong>每个项目都需要有构建脚本来实现对整个项目的自动化构建。比如 Java 的项目就可以使用 gradle 作为构建工具。通过构建工具实现对编译、静态扫描、运行测试、样式检查、打包、发布等活动串起来，可以通过命令行自动执行。</li>
<li><strong>CI 服务器：</strong>CI 服务器可以检测项目中的代码变动，并及时的通过构建机器运行构建脚本，并将集成结果通过某种方式反馈给团队成员。</li>
</ol>
<h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><ul>
<li><p>打包平台</p>
<p>常见的打包，Java 应用（Gradle&#x2F;Maven）、Nodejs 前端应用(npm&#x2F;yarn)</p>
<p>移动端打包：Android&#x2F;iOS</p>
</li>
<li><p>测试平台</p>
<p>接口测试</p>
<p>自动化测试 Robotium、Testlink</p>
<p>单元测试 junit</p>
<p>性能测试 Jmeter</p>
</li>
<li><p>自动部署</p>
<p>FTP</p>
<p>Shell</p>
<p>Tomcat&#x2F;Dokcer</p>
<p>Kubernetes&#x2F;Rancher&#x2F;Cluster</p>
</li>
<li><p>持续集成</p>
<p>Git: gitlab github gitee 等</p>
<p>Jenkins&#x2F;TravisCi&#x2F;CircleCI</p>
<p>Docker</p>
</li>
</ul>
<h3 id="工作流"><a href="#工作流" class="headerlink" title="工作流"></a>工作流</h3><h4 id="传统的工作流"><a href="#传统的工作流" class="headerlink" title="传统的工作流"></a>传统的工作流</h4><p>参与人员：开发、项目经理、测试</p>
<p>主要流程：</p>
<ul>
<li>项目一开始是先划分好模块，<code>分配模块</code>给相应的开发人员；</li>
<li>开发人员<code>开发好</code>一个模块就进行<code>单元测试</code>；</li>
<li>等所有的模块都开发完成之后，由项目经理对<code>所有代码进行集成</code>；</li>
<li>集成后的项目由项目经理<code>部署到测试服务器</code>上，被交由测试人员进行集成测试；</li>
<li>测试过程中出现 Bug 就提把问题<code>记录</code>进行 <code>Bug</code> 列表中；</li>
<li><code>项目经理分配 Bug</code> 给相应的责任人进行修改；</li>
<li>修改完成后，项目经理<code>再次</code>对项目进行集成，并<code>部署</code>到测试服务器上；</li>
<li>测试人员在下一次的集成测试中进行<code>回归测试</code>；</li>
<li>通过通过之后就<code>部署到生产环境</code>中；</li>
<li>如果测试不通过，则重复上述“分配 Bug -&gt; 修改 Bug -&gt; 集成代码 -&gt; 部署到测试服务器上 -&gt; 集成测试”工作。</li>
</ul>
<blockquote>
<p>这也是传统的瀑布式开发模型，请参考：<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vLU9ZSy9hcmNoaXZlLzIwMTIvMTAvMDgvMjcxNDY2OS5odG1s">软件开发模式对比(瀑布、迭代、螺旋、敏捷)</span></p>
</blockquote>
<p>带来的问题：</p>
<ol>
<li><p><strong>重复性劳动，无效的等待变多</strong></p>
<p>重复的进行发布部署。</p>
<p>流程上：有可能开发在等集成其他人的模块；测试人员在等待开发人员修复 Bug；产品经理在等待新版本上线好给客户做演示；项目经理在等待其他人提交代码。不管怎么样，等待意味低效。</p>
<p>自动化部署工作可以解放了集成、测试、部署等重复性劳动，而且机器集成的频率明显可以比手工的高很多。</p>
</li>
<li><p><strong>很晚才发现缺陷，并且难以修复</strong>。</p>
<p>实践证明，缺陷发现的越晚，需要修复的时间和精力也就越大。从上一个可工作的软件到发现缺陷之间可能存在很多次提交，而要从这些提交中找出问题并修复的成本会很大，因为开发人员需要回忆每个提交的上下文来评估影响点。</p>
</li>
<li><p><strong>低品质的软件，软件交付时机无法保障</strong></p>
<p>由于集成时每次包含的代码很多，所以大家的关注点主要都是如何保证编译通过、自动化测试通过，而往往很容易忽略代码是否遵守了编码规范、是否包含有重复代码、是否有重构的空间等问题。而这些问题又反过来会影响今后的开发和集成，久而久之集成变得越来越困难，软件的质量可想而知。</p>
</li>
<li><p><strong>项目缺少可见性</strong></p>
<p>某些项目，程序会经常需要变更，特别是敏捷开发的实践者。由于产品经理在与客户交流过程中，往往实际的软件就是最好的原型，所以软件会被当作原型作为跟客户交流的工具。当然，客户最希望的当然是客户的想法能够马上反映到原型上，这会导致程序会经常被修改的。那么也就意味着“分配 Bug -&gt; 修改 Bug -&gt; 集成代码 -&gt; 部署到测试服务器上 -&gt; 集成测试”工作无形又爆增了。</p>
</li>
</ol>
<h4 id="常见的工作流"><a href="#常见的工作流" class="headerlink" title="常见的工作流"></a>常见的工作流</h4><p><img data-src="/images/DevOps.png" alt="DevOps"></p>
<p>该系统的各个组成部分是按如下顺序来发挥作用的：</p>
<ol>
<li><p>开发者检入代码到源代码仓库。</p>
</li>
<li><p>CI 系统会为每一个项目创建了一个单独的工作区。当预设或请求一次新的构建时，它将把源代码仓库的源码存放到对应的工作区。</p>
</li>
<li><p>CI 系统会在对应的工作区内执行构建过程。</p>
</li>
<li><p>配置如果存在）构建完成后，CI 系统会在一个新的构件中执行定义的一套测试。完成后触发通知(Email,RSS 等等)给相关的当事人。</p>
</li>
<li><p>配置如果存在）如果构建成功，这个构件会被打包并转移到一个部署目标(如应用服务器)或存储为软件仓库中的一个新版本。软件仓库可以是 CI 系统的一部分，也可以是一个外部的仓库，诸如一个文件服务器或者像 Java.net、SourceForge 之类的网站。</p>
</li>
<li><p>CI 系统通常会根据请求发起相应的操作，诸如即时构建、生成报告，或者检索一些构建好的构件。</p>
</li>
</ol>
<blockquote>
<p>“You build it, you run it”，这是 Amazon 一年可以完成 5000 万次部署，平均每个工程师每天部署超过 50 次的核心秘籍。</p>
</blockquote>
<h4 id="解决的问题"><a href="#解决的问题" class="headerlink" title="解决的问题"></a>解决的问题</h4><ul>
<li><p>高效率</p>
<p>高效率的发布，避免了重复性的劳动；</p>
<p>更快的修复 BUG，更快的交付成果，减少了等待时间。</p>
</li>
<li><p>高质量</p>
<p>只有在完成集成测试、系统测试后，才能得到可用的软件，整个过程中只有最后时刻才能拿到可运行软件。集成活动不一定在一个标准的构建机器上生成，而是在某个开发人员的机器上构建的，那么可能存在在其他机器上无法运行的问题。</p>
<p>人与机器的一个最大的区别是，在重复性动作上，人容易犯错，而机器犯错的几率几乎为零。所以，当我们搭建完成集成服务器后，以后的事就交给集成服务器来打理吧。</p>
</li>
<li><p>高产出</p>
<p>快速开发和上市一个新产品，并快速取得预期的投资回报是每个企业孜孜以求的目标。</p>
<p>便捷的部署+项目的可预期，使得团队的开发变成了一种开心的事情。</p>
<p>持续集成可以让你在任何时间发布可以部署的软件。在外界看来，这是持续集成最明显的好处，对客户来说，可以部署的软件产品是最实际的资产。利用持续集成，你可以经常对源代码进行一些小改动，并将这些改动和其他代码进行集成。</p>
</li>
</ul>
<h4 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h4><ol>
<li><p>思维转变后，新技术抵触</p>
<ul>
<li>无法接受新事物：不管怎么样，求稳心态的人还是多。总是有人认为老的技术代表稳定，新的事物往往会带来问题。</li>
<li>认为手工集成也没有多少工作量：不是所有的人都参与到了整个持续集成的环节，所以没有办法认识到问题全貌。</li>
</ul>
<p><strong>针对这个问题，可以通过设置一定的持续集成技术培训、宣讲得到改观</strong></p>
</li>
<li><p>管理层的抵触</p>
<ul>
<li>培训持续集成需要投入资金啊，没钱。</li>
<li>持续集成服务器要增加软硬件成本啊，没钱。</li>
<li>开发人员领了那么高的工资，多干活多加班应该啊。</li>
</ul>
<p><strong>针对这一点，可以从开发人员的成本和持续集成的投入（软硬件）的成本上两者做下估算。</strong></p>
<blockquote>
<p>硬件参考：</p>
<p>Jenkins 主服务器一般 2C4G，slave 服务器根据生产需要进行选购。</p>
<p>git 服务器一般 2C4G(10 人团队)</p>
<p>Docker 服务器 8C32G(Rancher + harbor)</p>
</blockquote>
</li>
<li><p>生产环境的复杂</p>
<ul>
<li>比如部署的生成环境是在政务外网，无法从互联网直接访问等。</li>
<li>构建效率低下，任务多</li>
</ul>
<p>目前，这个是最麻烦的，还在研究中。初步设想是让政务外网开辟一个白名单，给持续集成服务器设置一个单独的通道。只是思路，未验证。</p>
</li>
</ol>
<h4 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h4><p>实施持续集成的开发人员可以尽早并经常提交。这允许他们尽早发现冲突。并且，如果存在任何问题，则使用较小的提交可以更轻松地对代码进行故障排除。每天或甚至更频繁地提交软件对于持续集成是必要的，但还不够。</p>
<p>要成功使用持续集成，团队必须：</p>
<ul>
<li><p>使测试成为开发过程中不可或缺的一部分。应该在创建代码时编写测试。</p>
<p>公司成功持续整合所需的最重要因素是严格的测试文化。为了将新代码自信地集成到主线中，团队需要确信代码是健全的。这是通过测试来实现的，这应该定期进行。工程师应该在开发每个功能时编写测试。</p>
</li>
<li><p>确保测试环境反映生产一致。</p>
<p>为了支持您严格的测试文化，测试环境必须反映生产环境。否则，您无法保证您正在测试的内容将在生产中起作用。这意味着测试环境应使用相同版本的数据库，Web 服务器配置，工件等。</p>
</li>
<li><p>使用编码最佳实践，例如结对编程。</p>
<p>软件开发的另一个最佳实践是在编码期间进行配对。对于更复杂的功能，团队在编写单行代码之前讨论体系结构方法。在将任何代码合并到生产环境之前，其他开发人员始终会检查代码。这有助于确保使用编码最佳实践，代码不会与其他开发人员正在处理的现有代码或代码冲突，并且新功能是可扩展的。</p>
<blockquote>
<p><strong>Pair programming</strong> is an <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQWdpbGVfc29mdHdhcmVfZGV2ZWxvcG1lbnQ=">agile software development</span> technique in which two <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ29tcHV0ZXJfcHJvZ3JhbW1lcg==">programmers</span> work together at one workstation. One, the <em>driver</em>, writes <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU291cmNlX2NvZGU=">code</span> while the other, the <em>observer</em> or <em>navigator</em>,[<span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUGFpcl9wcm9ncmFtbWluZyNjaXRlX25vdGUtMQ==">1]</span> <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ29kZV9yZXZpZXc=">reviews</span> each line of code as it is typed in. The two programmers switch roles frequently.</p>
<p>While reviewing, the observer also considers the “strategic” direction of the work, coming up with ideas for improvements and likely future problems to address. This is intended to free the driver to focus all of their attention on the “tactical” aspects of completing the current task, using the observer as a safety net and guide.</p>
</blockquote>
</li>
<li><p>自动化部署工作流程。</p>
<p>最后，为确保整个软件开发流程快速高效，构建需要快速，部署工作流程应自动化。代码构建的每一分钟都浪费了一分钟。通过自动化部署工作流程，团队可以更快地将完成的代码生成。因为，毕竟，如果没有接触到客户，那么快速开发软件有什么意义呢？</p>
</li>
</ul>
<h3 id="效率工具对比"><a href="#效率工具对比" class="headerlink" title="效率工具对比"></a>效率工具对比</h3><p>![img](&#x2F;Users&#x2F;Shared&#x2F;Target&#x2F;5-4 持续集成与持续部署&#x2F;resource&#x2F;assets&#x2F;CICD-resource.png)</p>
<p><a href="#%E5%A4%8D%E6%9D%82%E7%9A%84DevOps%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7">点击查看</a>效率工具</p>
<p><strong>1. Jenkins</strong></p>
<blockquote>
<p>Jenkins，原名 Hudson，2011 年改为现在的名字，它 是一个开源的实现持续集成的软件工具。官方网站：<span class="exturl" data-url="aHR0cDovL2plbmtpbnMtY2kub3JnLw==">http://jenkins-ci.org/</span>。</p>
<p>Jenkins 能实时<strong>监控集成中存在的错误</strong>，提供<strong>详细的日志文件和提醒</strong>功能，还能用图表的形式形象地展示<strong>项目构建的趋势和稳定性</strong>。</p>
</blockquote>
<p><strong>Jenkins 特点:</strong></p>
<ul>
<li><strong>易安装</strong>：Jenkins 是一个独立的基于 Java 的程序，随时可以运行，包含 Windows，Mac OS X 和其他类 Unix 操作系统的软件包。仅仅一个 java -jar jenkins.war，从官网下载该文件后，直接运行，无需额外的安装，更无需安装数据库；</li>
<li><strong>易配置</strong>：提供友好的 GUI 配置界面；</li>
<li><strong>变更支持</strong>：Jenkins 能从代码仓库（Subversion&#x2F;CVS）中获取并产生代码更新列表并输出到编译输出信息中；</li>
<li><strong>支持永久链接</strong>：用户是通过 web 来访问 Jenkins 的，而这些 web 页面的链接地址都是永久链接地址，因此，你可以在各种文档中直接使用该链接；</li>
<li><strong>集成 E-Mail&#x2F;RSS&#x2F;IM：</strong>当完成一次集成时，可通过这些工具实时告诉你集成结果（据我所知，构建一次集成需要花费一定时间，有了这个功能，你就可以在等待结果过程中，干别的事情）；</li>
<li><strong>JUnit&#x2F;TestNG 测试报告</strong>：也就是用以图表等形式提供详细的测试报表功能；</li>
<li><strong>支持分布式构建</strong>：Jenkins 可以把<strong>集成构建等工作分发到多台计算机中完成</strong>；</li>
<li><strong>文件指纹信息</strong>：Jenkins 会保存哪次集成构建产生了哪些 jars 文件，哪一次集成构建使用了哪个版本的 jars 文件等构建记录；</li>
<li><strong>支持第三方插件</strong>：使得 Jenkins 变得越来越强大；凭借更新中心中的数百个插件，Jenkins 几乎集成了持续集成和持续交付工具链中的所有工具。</li>
<li><strong>Rest API</strong> - 可以访问控制您获取的数据量，获取&#x2F;更新 config.xml，删除作业，检索所有构建，获取&#x2F;更新作业说明，执行构建，禁用&#x2F;启用作业</li>
</ul>
<p><strong>Jenkins 优点：</strong></p>
<ul>
<li>价格（免费）</li>
<li>定制</li>
<li>插件系统</li>
<li>完全控制系统</li>
</ul>
<p><strong>Jenkins 缺点：</strong></p>
<ul>
<li>需要专用服务器（或多个服务器）。这导致额外的费用。对于服务器本身，DevOps 等…</li>
<li>配置&#x2F;定制所需的时间</li>
</ul>
<p><strong>2. Travis CI</strong></p>
<p><strong>Travis CI</strong>是一个托管的持续集成服务，用于构建和测试在 GitHub 上托管的软件项目。</p>
<blockquote>
<p><strong>Travis CI</strong> is a hosted continuous integration service used to build and test software projects hosted at GitHub</p>
</blockquote>
<p><strong>Travis CI 的特点：</strong></p>
<ul>
<li><p>基于云：TravisCI 是一个<strong>基于云</strong>的系统 - 不需要专用服务器，您无需管理它。</p>
</li>
<li><p>支持 Docker 运行测试</p>
</li>
<li><p>使用 YAML 文件进行配置</p>
</li>
<li><p>可选择 Linux 和 Mac OSX 上同时运行测试</p>
</li>
<li><p>开箱即用的支持的语言</p>
<p>Android，C，C＃，C ++，Clojure，Crystal，D，Dart，Erlang，Elixir，F＃，Go，Groovy，Haskell，Haxe，Java，JavaScript（使用 Node.js），Julia，Objective-C，Perl，Perl6， PHP，Python，R，Ruby，Rust，Scala，Smalltalk，Visual Basic</p>
</li>
<li><p><strong>支持多环境构建矩阵</strong>：如 Python 2.7 , 3.4, 3.5 + Django 1.8, 1.9, 1.10</p>
<p>构建矩阵是一种工具，可以使用不同版本的语言和包运行测试。您可以以不同的方式自定义它。例如，某些环境的失败可以触发通知但不会使所有构建失败（这对包的开发版本有帮助）</p>
</li>
</ul>
<p><strong>Travis CI 优点：</strong></p>
<ul>
<li>开箱即用构建矩阵</li>
<li>快速启动</li>
<li>轻量级 YAML 配置</li>
<li>开源项目的免费计划</li>
<li>无需专用服务器</li>
</ul>
<p><strong>Travis CI 缺点：</strong></p>
<ul>
<li>与 CircleCI 相比，价格更高，没有免费的企业计划</li>
<li>定制（对于某些你需要第三方的东西）</li>
</ul>
<p><strong>3. Circle CI</strong></p>
<p>在 GitHub 或 Bitbucket 上的软件存储库被授权并作为项目添加到<span class="exturl" data-url="aHR0cHM6Ly9jaXJjbGVjaS5jb20v">circleci.com 之后</span>，每个代码更改都会在干净的容器或 VM 中触发自动化测试。</p>
<p>CircleCI 在 2017 年被 Forrester 评为持续集成领导者，并被命名为多个最佳 DevOps 工具列表。CircleCI 成立于 2011 年，总部位于旧金山，拥有全球性的远程员工队伍，由 Scale Venture Partners，DFJ，Baseline Ventures，Top Tier Capital，Industry Ventures，Heavybit 和 Harrison Metal Capital 提供风险投资。</p>
<p><strong>Circle CI 的特点：</strong></p>
<ul>
<li><strong>云&amp;本地化</strong>：CircleCI 是一个<strong>基于云</strong>的系统 - 不需要专用服务器，您无需管理它。 但是，它还<strong>提供了一个本地解决方案</strong>，允许您在私有云或数据中心中运行它。</li>
<li><strong>商业&amp;免费</strong>：即使是商业帐户，它也<strong>有免费计划</strong></li>
<li><strong>Rest API</strong> - 您可以访问项目，构建和工件（artifacts）。构建的结果将是工件或工件组。 工件可以是已编译的应用程序或可执行文件（例如，android APK）或元数据（例如，关于测试&#96;成功的信息）</li>
<li><strong>按需安装</strong>：CircleCI 缓存<strong>必要的安装</strong>（requirements installation）。 它会检查第三方依赖项，而不是持续安装所需的环境</li>
<li><strong>SSH 模式</strong>：您可以触发<strong>SSH 模式</strong>访问容器并进行自己的调查（如果出现任何问题）</li>
<li><strong>最小化配置</strong>：这是一个完整的开箱即用解决方案，需要<strong>最少的配置\调整</strong></li>
</ul>
<p><strong>CircleCI 优点：</strong></p>
<ul>
<li>快速启动</li>
<li>CircleCI 有一个免费的企业项目计划</li>
<li>这很容易，也很快开始</li>
<li>轻量级，易读的 YAML 配置</li>
<li>您不需要任何专用服务器来运行 CircleCI</li>
</ul>
<p><strong>CircleCI 缺点：</strong></p>
<ul>
<li><p>CircleCI 仅支持 2 个版本的 Ubuntu 免费（12.04 和 14.04）和 MacOS 作为付费部分</p>
</li>
<li><p>尽管 CircleCI 可以使用并运行所有语言，但 tt 仅支持“开箱即用”的以下编程语言：Go（Golang），Haskell，Java，PHP，Python，Ruby &#x2F; Rails，Scala</p>
</li>
<li><p>如果您想进行自定义，可能会出现一些问题：您可能需要一些第三方软件来进行这些调整</p>
</li>
<li><p>此外，虽然作为基于云的系统是一方的优势，它也可以停止支持任何软件，你将无法阻止</p>
</li>
</ul>
<p>总结一下：</p>
<table>
<thead>
<tr>
<th>分类</th>
<th>Jenkins</th>
<th>Travis CI</th>
<th>Circle CI</th>
</tr>
</thead>
<tbody><tr>
<td>本地部署</td>
<td>支持</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>REST API</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td>配置</td>
<td>复杂，高度可配置</td>
<td>YAML 文件</td>
<td>YAML 文件</td>
</tr>
<tr>
<td>按需安装</td>
<td>是</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>跨平台支持</td>
<td>是</td>
<td>Linux + MacOS</td>
<td>Linux + MacOS(付费)</td>
</tr>
<tr>
<td>多服务器</td>
<td>是</td>
<td>按需</td>
<td>否</td>
</tr>
<tr>
<td>快速构建</td>
<td>手动配置复杂</td>
<td>快(需要写配置文件)</td>
<td>最快</td>
</tr>
<tr>
<td>基本环境</td>
<td>Java</td>
<td>云环境</td>
<td>云环境</td>
</tr>
<tr>
<td>费用</td>
<td>免费</td>
<td>特定免费(69$&#x2F;c)</td>
<td>特定免费(50$&#x2F;c)</td>
</tr>
</tbody></table>
<p>Travis CI 的价格（非常感人）：</p>
<p><img data-src="/images/image-20190611100501785.png" alt="/images/image-20190611100501785"></p>
<p>CirCle CI 的价格：</p>
<p><img data-src="/images/image-20190611100534676.png" alt="/images/image-20190611100534676"></p>
<p>其他的一些持续集成的工具：CruiseControl，TeamCity，Continuum 等</p>
<ul>
<li>AnthillPro：商业的构建管理服务器，提供 C 功能</li>
<li>Bamboo：商业的 CI 服务器，对于开源项目免费</li>
<li>Build Forge：多功能商业构建管理工具，特点：高性能、分布式构建</li>
<li>Cruise Control：基于 java 实现的持续集成构建工具</li>
<li>CruiseControl.NET：基于 C#实现的持续集成构建工具</li>
<li>Lunt build：开源的自动化构建工具</li>
<li>Para Build：商业的自动化软件构建管理服务器</li>
</ul>
<h2 id="Jenkins"><a href="#Jenkins" class="headerlink" title="Jenkins"></a>Jenkins</h2><h3 id="使用简介"><a href="#使用简介" class="headerlink" title="使用简介"></a>使用简介</h3><p>Jenkins 是开源 CI&amp;CD 软件领导者， 提供超过 1000 个插件来支持构建、部署、自动化， 满足任何项目的需要。</p>
<p><img data-src="/images/image-20190611103941326.png" alt="/images/image-20190611103941326"></p>
<p>相关概念：</p>
<ul>
<li><p>流水线：<strong>Jenkins Pipeline</strong>（或简称为 “Pipeline”）是一套插件，将持续交付的实现和实施集成到 Jenkins 中。</p>
<p>Jenkins Pipeline 提供了一套可扩展的工具，用于将“简单到复杂”的交付流程实现为“持续交付即代码”。Jenkins Pipeline 的定义通常被写入到一个文本文件（称为 <code>Jenkinsfile</code> ）中，该文件可以被放入项目的源代码控制库中。</p>
</li>
<li><p>节点：节点是一个机器，主要用于执行 jenkins 任务</p>
</li>
<li><p>阶段：定义不同的执行任务，比如：构建、测试、发布(部署)</p>
</li>
<li><p>步骤：相当于告诉 Jenkins 现在要做些什么，比如 shell 命令。</p>
</li>
</ul>
<p><img data-src="/images/image-20190611163108298.png" alt="/images/image-20190611163108298"></p>
<p>Jenkins 的界面</p>
<p><img data-src="/images/image-20190611163727975.png" alt="/images/image-20190611163727975"></p>
<p>任务详情页面</p>
<p><img data-src="/images/image-20190611163855257.png" alt="/images/image-20190611163855257"></p>
<p>Jenkins 任务日志</p>
<h3 id="安装方式"><a href="#安装方式" class="headerlink" title="安装方式"></a>安装方式</h3><ol>
<li><p>环境要求</p>
<ul>
<li>机器要求：<ul>
<li>256 MB 内存，建议大于 512 MB</li>
<li>10 GB 的硬盘空间（用于 Jenkins 和 Docker 镜像）</li>
</ul>
</li>
<li>需要安装以下软件：<ul>
<li>Java 8 ( JRE 或者 JDK 都可以)</li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZG9ja2VyLmNvbS8=">Docker</span> （导航到网站顶部的 Get Docker 链接以访问适合您平台的 Docker 下载）</li>
</ul>
</li>
</ul>
</li>
<li><p>常规安装</p>
<ul>
<li><p>安装 JDK</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cub3JhY2xlLmNvbS90ZWNobmV0d29yay9qYXZhL2phdmFzZS9kb3dubG9hZHMvamRrOC1kb3dubG9hZHMtMjEzMzE1MS5odG1s">官方地址</span></p>
<p>下载对应的操作系统的 JDK，然后解压进行安装。以 Linux 为例：</p>
<p>下载最新版本，上传到 Linux 服务器</p>
<pre><code class="bash"># 上传到 /opt/jdk8目录下

# tar解压JDK安装包
mkdir -p /opt/jdk8
tar zxvf jdk-8u211-linux-x64.tar.gz -C /opt/jdk8 --strip-components 1

# vi /etc/profile
export JAVA_HOME=/opt/jdk8
export JRE_HOME=$&#123;JAVA_HOME&#125;/jre
export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib
export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH
</code></pre>
</li>
<li><p>安装 Jenkins</p>
<p>下载 Jenkins 最新的 war 包：<span class="exturl" data-url="aHR0cDovL21pcnJvcnMuamVua2lucy5pby93YXItc3RhYmxlL2xhdGVzdC9qZW5raW5zLndhcg==">Latest</span></p>
<pre><code class="bash">mkdir -p /opt/jenkins &amp;&amp; cd /opt/jenkins

wget -O /opt/jenkins/jenkins.war http://mirrors.jenkins.io/war-stable/latest/jenkins.war

java -jar jenkins.war --httpPort=8080
</code></pre>
<p>就嗯可以打开，<span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDgwLw==">http://localhost:8080</span> 了</p>
<p>注意一段这样的话：</p>
<pre><code class="bash">*************************************************************
*************************************************************
*************************************************************

Jenkins initial setup is required. An admin user has been created and a password generated.
Please use the following password to proceed to installation:

63196690ae7d47c49506480ee0e1af4a

This may also be found at: /root/.jenkins/secrets/initialAdminPassword

*************************************************************
*************************************************************
*************************************************************
</code></pre>
<p>这里的<code>63196690ae7d47c49506480ee0e1af4a</code>就是初始的安装的管理员密码。</p>
</li>
</ul>
</li>
<li><p>使用 Docker 安装</p>
<ul>
<li><p>安装 Docker</p>
<pre><code class="bash"># From https://get.docker.com:
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh

#From https://test.docker.com:
curl -fsSL https://test.docker.com -o test-docker.sh
sh test-docker.sh

# From the source repo (This will install latest from the test channel):
sh install.sh
</code></pre>
</li>
<li><p>配置 Docker 镜像加速，使用阿里云<span class="exturl" data-url="aHR0cHM6Ly9jci5jb25zb2xlLmFsaXl1bi5jb20vP3NwbT1hMmM0ZS4xMTE1Mzk0MC5ibG9nY29udDI5OTQxLjkuNTIwMjdlMjl3Mmp2OVA=">容器加速服务</span></p>
<p>左侧的加速器帮助页面就会显示为你独立分配的加速地址</p>
<pre><code class="bash">例如：
公网Mirror：[系统分配前缀].mirror.aliyuncs.com
</code></pre>
<p>使用配置文件 <code>/etc/docker/daemon.json</code>（没有时新建该文件）</p>
<pre><code class="bash">&#123;
    &quot;registry-mirrors&quot;: [&quot;&lt;your accelerate address&gt;&quot;]
&#125;
</code></pre>
<p>重启 Docker Daemon 就可以了</p>
<pre><code class="bash">systemctl daemon-reload
systemctl restart docker
</code></pre>
<p><code>docker ps</code> 查看容器运行状态</p>
<p><code>docker logs 容器ID/容器名称</code> 查看管理员初始密码</p>
</li>
<li><p>安装 Docker-compose.yml 文件(可选)</p>
<p><strong>安装方法：</strong></p>
<pre><code class="bash">#下载
sudo curl -L https://github.com/docker/compose/releases/download/1.20.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose
#安装
chmod +x /usr/local/bin/docker-compose
#查看版本
docker-compose --version
</code></pre>
</li>
<li><p>安装 Jenkins</p>
<p><strong>版本选择：</strong></p>
<p>Jenkins: <span class="exturl" data-url="aHR0cHM6Ly9odWIuZG9ja2VyLmNvbS9yL2plbmtpbnMvamVua2lucy8=">https://hub.docker.com/r/jenkins/jenkins/</span></p>
<p>Jenkins with Blue Ocean: <span class="exturl" data-url="aHR0cHM6Ly9odWIuZG9ja2VyLmNvbS9yL2plbmtpbnNjaS9ibHVlb2NlYW4=">https://hub.docker.com/r/jenkinsci/blueocean</span></p>
<blockquote>
<p>Blue Ocean 重新思考 Jenkins 的用户体验，从头开始设计<span class="exturl" data-url="aHR0cHM6Ly9qZW5raW5zLmlvL3poL2RvYy9ib29rL3BpcGVsaW5lLw==">Jenkins Pipeline</span>, 但仍然与自由式作业兼容，Blue Ocean 减少了混乱而且进一步明确了团队中每个成员 Blue Ocean 的主要特性包括：</p>
<ul>
<li>持续交付(CD)Pipeline 的 <strong>复杂可视化</strong> ，可以让您快速直观地理解管道状态。</li>
<li><strong>Pipeline 编辑器</strong> - 引导用户通过直观的、可视化的过程来创建 Pipeline，从而使 Pipeline 的创建变得平易近人。</li>
<li><strong>个性化</strong> 以适应团队中每个成员不同角色的需求。</li>
<li>在需要干预和&#x2F;或出现问题时 <strong>精确定位</strong> 。 Blue Ocean 展示 Pipeline 中需要关注的地方， 简化异常处理，提高生产力</li>
<li><strong>本地集成分支和合并请求</strong>, 在与 GitHub 和 Bitbucket 中的其他人协作编码时实现最大程度的开发人员生产力。****</li>
</ul>
</blockquote>
<p><strong>安装命令：</strong></p>
<pre><code class="bash"># Jenkins
docker run \
  -itd \
  -u root \
  -p 8080:8080 \
  -v jenkins-data:/var/jenkins_home \
  -v /var/run/docker.sock:/var/run/docker.sock \
  -v /usr/bin/docker:/usr/bin/docker \
  --name jenkins-master \
  jenkins/jenkins

# Jenkins blueocean
docker run \
  -itd \
  -u root \
  -p 8080:8080 \
  -v jenkins-data:/var/jenkins_home \
  -v /var/run/docker.sock:/var/run/docker.sock \
  -v /usr/bin/docker:/usr/bin/docker \
  --name jenkins-master \
  jenkinsci/blueocean
</code></pre>
</li>
</ul>
</li>
<li><p>配置 Jenkins 插件加速</p>
<p>进入 jenkins 系统管理-&gt;插件管理中-&gt;高级选项卡-&gt;升级站点，使用清华源：</p>
<pre><code class="html">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/current/update-center.json
</code></pre>
<p><img data-src="/images/70.png" alt="ç³»ç»ç®¡ç"></p>
<p><img data-src="/images/70-20190611152837311.png" alt="æä»¶ç®¡ç"></p>
<p>关于官方所有的镜像列表：</p>
<p><span class="exturl" data-url="aHR0cDovL21pcnJvcnMuamVua2lucy1jaS5vcmcvc3RhdHVzLmh0bWw=">http://mirrors.jenkins-ci.org/status.html</span></p>
</li>
<li><p>环境配置</p>
<ul>
<li>Jenkins 的 URL 路径</li>
<li>全局工具的配置：Docker, JDK(JAVA)…</li>
</ul>
</li>
<li><p>用户权限配置</p>
<ul>
<li>矩阵权限的配置</li>
<li>添加管理员用户所有的权限</li>
<li>添加<span class="exturl" data-url="aHR0cHM6Ly93aWtpLmplbmtpbnMtY2kub3JnL2Rpc3BsYXkvSkVOS0lOUy9BdXRob3JpemUrUHJvamVjdCtwbHVnaW4=">Authorize Project</span>插件，并且在系统管理中进行配置。配置逻辑，就给用户当前项目的矩阵权限！</li>
</ul>
</li>
<li><p>与 gitlab 进行联接</p>
<ul>
<li>设置一个 SSH Key，方便 Jenkins 去拉取 Gitlab 中的项目</li>
<li>GItlab 项目中去配置 SSH Key 的 Deploy 权限。<code>Settings -&gt; Repository -&gt; Deploy keys -&gt; Public Deploy Keys</code></li>
<li>Jenkins 添加 SSH 的私钥</li>
</ul>
<p>这样就完成了 Jenkins 可以访问 gitlab 的联接的过程。</p>
<p>Jenkins 层面，需要去安装 Gitlab 相关插件。</p>
</li>
</ol>
<h3 id="插件介绍"><a href="#插件介绍" class="headerlink" title="插件介绍"></a>插件介绍</h3><ul>
<li><p>Publish over SSH</p>
<p>这个是一个远程 Shell 工具，可以远程去执行一些 shell 命令</p>
</li>
<li><p>HTTP Request Plugin</p>
<p>跨平台调用，在构建前后可以通过该插件以 http 形式调用各种 api 接口实现和内部系统的联动</p>
</li>
<li><p>Publish Over FTP</p>
<p>用于远程使用 FTP 发布，比较合适于静态资源的发布。</p>
<p><img data-src="/images/20181225153134962.jpeg" alt="img"></p>
</li>
<li><p>Performance Plugin</p>
</li>
</ul>
<p>​ 该插件可以读取和解析测试框架输出的报告，并且在 Jenkins 上绘制性能和稳定性相关的图表。Performance Plugin 支持的测试框架有 JUnit、JMeter, Twitter 的 Lago 和 Taurus。下图是该插件输出的示例图：</p>
<p><img data-src="/images/3dee2f58ccdf7cf25fa86074c5485184a9f.jpg" alt="img"></p>
<p>​ <span class="exturl" data-url="aHR0cHM6Ly9wbHVnaW5zLmplbmtpbnMuaW8vcGVyZm9ybWFuY2U=">https://plugins.jenkins.io/performance</span></p>
<ul>
<li>Gitlab Merge Request Builder Plugin</li>
</ul>
<p>​ Gitlab Merge Request Builder Plugin 可以方便的自动发起代码审查，它在创建 pull request 的时候，会自动带上关联任务的运行结果，以方便代码审查着确认改动的正确性。</p>
<p>​ 同时，这款插件还支持自动合并，既在代码审查通过后自动合并该 pull request 内容。</p>
<p>​ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RpbW9scy9qZW5raW5zLWdpdGxhYi1tZXJnZS1yZXF1ZXN0LWJ1aWxkZXItcGx1Z2lu">https://github.com/timols/jenkins-gitlab-merge-request-builder-plugin</span></p>
<ul>
<li>JIRA Plugin</li>
</ul>
<p>​ JIRA Plugin 可以让 Jenkins 任务和 JIRA 集成起来，这样项目管理者可以通过 JIRA 了解项目进度，开发者也可以通过该插件直接更改 JIRA 上的 issue 状态。</p>
<p>​ <span class="exturl" data-url="aHR0cHM6Ly9wbHVnaW5zLmplbmtpbnMuaW8vamlyYQ==">https://plugins.jenkins.io/jira</span></p>
<ul>
<li>Kubernetes Plugin</li>
</ul>
<p>​ 和最近大热的容器编排框架 Kubernetes 集成当然不能落下了。另外，Jenkins 对执行机的管理一直比较弱，无法做到快速的扩容和缩容。Kubernetes Plugin 通过引入 Kubernetes 的容器编排能力，让 Jenkins 执行机运行在 Kubernetes 环境中。</p>
<p>​ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2plbmtpbnNjaS9rdWJlcm5ldGVzLXBsdWdpbg==">https://github.com/jenkinsci/kubernetes-plugin</span></p>
<ul>
<li>Build Pipeline plugin</li>
</ul>
<p>​ 对一个系统的持续集成会包含很多个方面，如果将它们都杂糅在一个 Jenkins 任务中，会提高排查成本，也不利于整个持续集成的运作。Build Pipeline plugin 可以让项目管理员针对系统持续集成步骤设置一系列关联的任务，任务之间可以设置不同的触发条件，以确认何时需要人工介入。该插件可以让整个持续集成流程变得非常直观：</p>
<p><img data-src="https://oscimg.oschina.net/oscnet/abf7ec185c847b72cd61181562f940557a2.jpg" alt="img"></p>
<p>​ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2plbmtpbnNjaS9idWlsZC1waXBlbGluZS1wbHVnaW4=">https://github.com/jenkinsci/build-pipeline-plugin</span></p>
<h3 id="配置自动化任务"><a href="#配置自动化任务" class="headerlink" title="配置自动化任务"></a>配置自动化任务</h3><p>两种执行方法：</p>
<ol>
<li>配置自由风格的项目</li>
<li>配置 Pipeline 使用 Jenkinsfile</li>
</ol>
<p>需要注意的地方</p>
<ul>
<li><p>SSH 插件：</p>
<p>SSH</p>
<p>SSH Agent</p>
<p>SSH Pipeline Steps</p>
<p>Publish Over SSH</p>
</li>
<li><p>git 相关插件：</p>
<p>Gitlab</p>
<p>Github</p>
</li>
<li><p>管理员界面配置：</p>
<p><code>Settings -&gt; network -&gt; Outbound requests</code></p>
<p>Allow requests to the local network from hooks and services 进行勾选</p>
</li>
</ul>
<p>其他的一些用法：</p>
<ul>
<li>使用 Jenkins 配合 Docker Hub，把前端代码打包成镜像，再远程部署</li>
<li>Jenkins 配合自建 Docker 容器服务，把前端代码打包，使用 Kubernetes 进行发布。</li>
<li>使用 Docker 进行远程发布(远程服务器上有 Docker 服务，并且设置了远程连接)</li>
</ul>
<h2 id="TravisCI"><a href="#TravisCI" class="headerlink" title="TravisCI"></a>TravisCI</h2><h3 id="使用简介-1"><a href="#使用简介-1" class="headerlink" title="使用简介"></a>使用简介</h3><p>Travis CI 只支持 Github，不支持其他代码托管服务。这意味着，你必须满足以下条件，才能使用 Travis CI。</p>
<blockquote>
<ul>
<li>拥有 GitHub 帐号</li>
<li>该帐号下面有一个项目</li>
<li>该项目里面有可运行的代码</li>
<li>该项目还包含构建或测试脚本</li>
</ul>
</blockquote>
<p>Travis 简单的使用步骤:</p>
<ul>
<li>github 授权及面板</li>
<li>获取 github 的 Tokens</li>
<li>配置项目.travis.yml<ul>
<li>Node 项目</li>
<li>Script 脚本</li>
<li>部署到 github pages</li>
<li>钩子用法</li>
</ul>
</li>
<li>其他</li>
</ul>
<p><strong>github 授权及面板</strong></p>
<p>首先，访问官方网站 <span class="exturl" data-url="aHR0cHM6Ly90cmF2aXMtY2kub3JnLw==">travis-ci.org</span>，点击右上角的个人头像，使用 Github 账户登入 Travis CI。</p>
<p>会进入到授权页面，这里跟微博、QQ 是一回事，主要是读取你的用户信息。</p>
<p><img data-src="/images/image-20190612205411602.png" alt="/images/image-20190612205411602"></p>
<p>这里第二步在，<code>Dashboard</code>这个选项卡中，点击<code>Activate</code>这个按钮</p>
<p><img data-src="/images/image-20190612212459194.png" alt="/images/image-20190612212459194"></p>
<p>完了之后，Dashboard 会列出所有 Github 中有<code>.travis.yml</code>配置文件的仓库：</p>
<p><img data-src="/images/image-20190612212731186.png" alt="/images/image-20190612212731186"></p>
<p>Travis 会列出 Github 上面你的所有仓库，以及你所属于的组织。此时，选择你需要 Travis 帮你构建的仓库，打开仓库旁边的开关。一旦激活了一个仓库，Travis 会监听这个仓库的所有变化。</p>
<p><img data-src="/images/image-20190612213022380.png" alt="/images/image-20190612213022380"></p>
<ul>
<li><p><code>Settings</code>中用于配置项目的构建条件</p>
<p><img data-src="/images/image-20190612214434173.png" alt="/images/image-20190612214434173"></p>
</li>
<li><p><code>Requests</code>可以查看构建记录</p>
<p><img data-src="/images/image-20190612214519926.png" alt="/images/image-20190612214519926"></p>
</li>
<li><p><code>Caches</code>主要是缓存文件</p>
</li>
<li><p><code>Trigger build</code>手动触发构建</p>
</li>
</ul>
<p><strong>获取 github 的 token</strong></p>
<p>在 settings-&gt;Developer settings-&gt;Personal access tokens-&gt;Generate new token</p>
<p><img data-src="/images/image-20190612225000955.png" alt="/images/image-20190612225000955"></p>
<p><strong>配置项目的.travis.yml 文件</strong></p>
<ul>
<li><p>设置项目语言</p>
<pre><code class="yaml">language: node_js
node_js:
  - &quot;10&quot;
</code></pre>
</li>
<li><p>Script 脚本</p>
<p>Travis 的运行流程很简单，任何项目都会经过两个阶段。</p>
<blockquote>
<ul>
<li>install 阶段：安装依赖</li>
<li>script 阶段：运行脚本</li>
</ul>
</blockquote>
<p>配置文件：</p>
<pre><code class="yaml"># S: Build Lifecycle
install:
  - yarn install

// 钩子方法
before_script:

# 无其他依赖项所以执行npm run build 构建就行了
script:
  - npm run build
</code></pre>
<p>如果不需要安装，即跳过安装阶段，就直接设为<code>true</code>。</p>
<pre><code class="javascript">install: true;
</code></pre>
<p><code>script</code>字段用来指定构建或测试脚本。</p>
<pre><code class="javascript">script: bundle exec thor build
</code></pre>
<p>如果有多个脚本，可以写成下面的形式。</p>
<pre><code class="javascript">script: -command1 - command2;
</code></pre>
</li>
<li><p>部署到 github pages</p>
<pre><code class="yaml">deploy:
    # 其他的一些配置项，可以参考：https://docs.travis-ci.com/user/deployment/pages/
  provider: pages
  skip_cleanup: true
  local_dir: dist/
  github_token: $GITHUB_TOKEN # Set in the settings page of your repository, as a secure variable
  keep_history: false
  on:
    branch: master
</code></pre>
</li>
<li><p>钩子用法</p>
<p>Travis 为上面这些阶段提供了 7 个钩子。</p>
<ul>
<li>before_install：install 阶段之前执行</li>
<li>before_script：script 阶段之前执行</li>
<li>after_failure：script 阶段失败时执行</li>
<li>after_success：script 阶段成功时执行</li>
<li>before_deploy：deploy 步骤之前执行</li>
<li>after_deploy：deploy 步骤之后执行</li>
<li>after_script：script 阶段之后执行</li>
</ul>
<p>完整的生命周期，从开始到结束是下面的流程。</p>
<ol>
<li>before_install</li>
<li>install</li>
<li>before_script</li>
<li>script</li>
<li>after<em>success or after</em>failure</li>
<li>[OPTIONAL] before_deploy</li>
<li>[OPTIONAL] deploy</li>
<li>[OPTIONAL] after_deploy</li>
<li>after_script</li>
</ol>
</li>
</ul>
<p>参考资料：</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vZG9tZW5pYy9lYzhiMGZjOGFiNDVmMzk0MDNkZA==">Auto-deploying built products to gh-pages with Travis</span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9vbmNsZXRvbS5pby8yMDE2L3RyYXZpcy1zc2gtZGVwbG95Lw==">SSH deploys with Travis CI</span></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5ydWFueWlmZW5nLmNvbS9ibG9nLzIwMTcvMTIvdHJhdmlzX2NpX3R1dG9yaWFsLmh0bWw=">持续集成服务 Travis CI 教程</span></li>
</ul>
<h3 id="配置-Node-js-应用"><a href="#配置-Node-js-应用" class="headerlink" title="配置 Node.js 应用"></a>配置 Node.js 应用</h3><p>配置一个 Vue 实例并发布到 github pages</p>
<p>.travis.yml 文件：</p>
<pre><code class="yaml">language: node_js
node_js:
  - &quot;10&quot;

# Travis-CI Caching
cache:
  directories:
    - node_modules

# S: Build Lifecycle
install:
  - yarn install

before_script:

# 无其他依赖项所以执行npm run build 构建就行了
script:
  - npm run build

deploy:
    # 其他的一些配置项，可以参考：https://docs.travis-ci.com/user/deployment/pages/
  provider: pages
  skip_cleanup: true
  local_dir: dist/
  github_token: $GITHUB_TOKEN # Set in the settings page of your repository, as a secure variable
  keep_history: false
  on:
    branch: master
</code></pre>
<h2 id="CircleCI"><a href="#CircleCI" class="headerlink" title="CircleCI"></a>CircleCI</h2><h3 id="使用简介-2"><a href="#使用简介-2" class="headerlink" title="使用简介"></a>使用简介</h3><ol>
<li><p>注册 CircleCI</p>
<p>打开 <span class="exturl" data-url="aHR0cHM6Ly9jaXJjbGVjaS5jb20v">CircleCI</span> 官方网站，使用您的 GitHub 帐户登录。</p>
<p><img data-src="/images/image-20190613093550553.png" alt="/images/image-20190613093550553"></p>
<p>进行授权：</p>
<p><img data-src="/images/image-20190613093732415.png" alt="/images/image-20190613093732415"></p>
</li>
<li><p>启动存储库</p>
</li>
</ol>
<p>检查要在 CircleCI 上管理的存储库的开关按钮。</p>
<p><img data-src="/images/image-20190613094115350.png" alt="/images/image-20190613094115350"></p>
<ol start="3">
<li><p>编写 config.yml</p>
<pre><code class="yaml">version: 2
jobs:
  build:
    docker:
      ...
    branches:
      ...
    steps:
      ...
        environment:
            ...
</code></pre>
<p>官方参考文档：<span class="exturl" data-url="aHR0cHM6Ly9jaXJjbGVjaS5jb20vZG9jcy8yLjAvY29uZmlndXJhdGlvbi1yZWZlcmVuY2UvI3ZlcnNpb24=">https://circleci.com/docs/2.0/configuration-reference/#version</span></p>
<p>来看一个完事版的配置</p>
<pre><code class="yaml">version: 2
jobs:
  build:
    docker:
      - image: ubuntu:14.04

      - image: mongo:2.6.8
        command: [mongod, --smallfiles]

      - image: postgres:9.4.1
        # some containers require setting environment variables
        environment:
          POSTGRES_USER: root

      - image: redis@sha256:54057dd7e125ca41afe526a877e8bd35ec2cdd33b9217e022ed37bdcf7d09673

      - image: rabbitmq:3.5.4

    environment:
      TEST_REPORTS: /tmp/test-reports

    working_directory: ~/my-project

    steps:
      - checkout

      - run:
          command: echo 127.0.0.1 devhost | sudo tee -a /etc/hosts

      # Create Postgres users and database
      # Note the YAML heredoc &#39;|&#39; for nicer formatting
      - run: |
          sudo -u root createuser -h localhost --superuser ubuntu &amp;&amp;
          sudo createdb -h localhost test_db

      - restore_cache:
          keys:
            - v1-my-project-&#123;&#123; checksum "project.clj" &#125;&#125;
            - v1-my-project-

      - run:
          environment:
            SSH_TARGET: &quot;localhost&quot;
            TEST_ENV: &quot;linux&quot;
          command: |
            set -xu
            mkdir -p $&#123;TEST_REPORTS&#125;
            run-tests.sh
            cp out/tests/*.xml $&#123;TEST_REPORTS&#125;

      - run: |
          set -xu
          mkdir -p /tmp/artifacts
          create_jars.sh $&#123;CIRCLE_BUILD_NUM&#125;
          cp *.jar /tmp/artifacts

      - save_cache:
          key: v1-my-project-&#123;&#123; checksum "project.clj" &#125;&#125;
          paths:
            - ~/.m2

      # Save artifacts
      - store_artifacts:
          path: /tmp/artifacts
          destination: build

      # Upload test results
      - store_test_results:
          path: /tmp/test-reports

  deploy-stage:
    docker:
      - image: ubuntu:14.04
    working_directory: /tmp/my-project
    steps:
      - run:
          name: Deploy if tests pass and branch is Staging
          command: ansible-playbook site.yml -i staging

  deploy-prod:
    docker:
      - image: ubuntu:14.04
    working_directory: /tmp/my-project
    steps:
      - run:
          name: Deploy if tests pass and branch is Master
          command: ansible-playbook site.yml -i production

workflows:
  version: 2
  build-deploy:
    jobs:
      - build:
          filters:
            branches:
              ignore:
                - develop
                - /feature-.*/
      - deploy-stage:
          requires:
            - build
          filters:
            branches:
              only: staging
      - deploy-prod:
          requires:
            - build
          filters:
            branches:
              only: master
</code></pre>
</li>
<li><p>设置&#x2F;查看任务</p>
<p><img data-src="/images/image-20190613093327981.png" alt="/images/image-20190613093327981"></p>
</li>
</ol>
<h3 id="配置-Node-js-应用-1"><a href="#配置-Node-js-应用-1" class="headerlink" title="配置 Node.js 应用"></a>配置 Node.js 应用</h3><p><code>.circleci/config.yml</code>配置文件</p>
<pre><code class="yaml">version: 2
jobs:
  build:
    docker:
      - image: circleci/node:10
    branches:
      only:
        - master
    steps:
      - add_ssh_keys:
          fingerprints:
            - &quot;c5:20:8e:79:81:19:fd:c1:6c:c4:fb:41:58:92:9d:4f&quot;
      - checkout
      - restore_cache:
          keys:
            # fallback to using the latest cache if no exact match is found
            - dependencies-
      - run:
          name: Install
          command: yarn install
      - save_cache:
          paths:
            - node_modules
          key: dependencies-
      - run:
          name: build github pages
          command: yarn build
      - run:
          name: Prepare shell commands
          command: chmod +x scripts/deploy.sh
      - run:
          name: Run deploy scripts
          command: ./scripts/deploy.sh
</code></pre>
<p>这里以发布到 github page 为示例：</p>
<p>deploy.sh 文件的内容：</p>
<pre><code class="bash">#!/bin/sh
# ideas used from https://gist.github.com/motemen/8595451

# Based on https://github.com/eldarlabs/ghpages-deploy-script/blob/master/scripts/deploy-ghpages.sh
# Used with their MIT license https://github.com/eldarlabs/ghpages-deploy-script/blob/master/LICENSE

# abort the script if there is a non-zero error
set -e

# show where we are on the machine
pwd
remote=$(git config remote.origin.url)

echo &#39;remote is: &#39;$remote

# make a directory to put the gp-pages branch
mkdir gh-pages-branch
cd gh-pages-branch
# now lets setup a new repo so we can update the gh-pages branch
git config --global user.email &quot;$GH_EMAIL&quot; &gt; /dev/null 2&gt;&amp;1
git config --global user.name &quot;$GH_NAME&quot; &gt; /dev/null 2&gt;&amp;1
git init
git remote add --fetch origin &quot;$remote&quot;

echo &#39;email is: &#39;$GH_EMAIL
echo &#39;name is: &#39;$GH_NAME
echo &#39;sitesource is: &#39;$siteSource

# switch into the the gh-pages branch
if git rev-parse --verify origin/gh-pages &gt; /dev/null 2&gt;&amp;1
then
    git checkout gh-pages
    # delete any old site as we are going to replace it
    # Note: this explodes if there aren&#39;t any, so moving it here for now
    git rm -rf .
else
    git checkout --orphan gh-pages
fi

# copy over or recompile the new site
cp -a &quot;../$&#123;siteSource&#125;/.&quot; .

ls -la

# stage any changes and new files
git add -A
# now commit, ignoring branch gh-pages doesn&#39;t seem to work, so trying skip
git commit --allow-empty -m &quot;Deploy to GitHub pages [ci skip]&quot;
# and push, but send any output to /dev/null to hide anything sensitive
git push --force --quiet origin gh-pages
# go back to where we started and remove the gh-pages git repo we made and used
# for deployment
cd ..
rm -rf gh-pages-branch

echo &quot;Finished Deployment!&quot;
</code></pre>
<p>说明：</p>
<p><strong>&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1 的含义</strong></p>
<p><strong>文件描述符</strong></p>
<p>当执行 shell 命令时，会默认打开 3 个文件，每个文件有对应的文件描述符来方便我们使用：</p>
<table>
<thead>
<tr>
<th align="left">类型</th>
<th align="left">文件描述符</th>
<th align="left">默认情况</th>
<th align="left">对应文件句柄位置</th>
</tr>
</thead>
<tbody><tr>
<td align="left">标准输入（standard input）</td>
<td align="left">0</td>
<td align="left">从键盘获得输入</td>
<td align="left">&#x2F;proc&#x2F;slef&#x2F;fd&#x2F;0</td>
</tr>
<tr>
<td align="left">标准输出（standard output）</td>
<td align="left">1</td>
<td align="left">输出到屏幕（即控制台）</td>
<td align="left">&#x2F;proc&#x2F;slef&#x2F;fd&#x2F;1</td>
</tr>
<tr>
<td align="left">错误输出（error output）</td>
<td align="left">2</td>
<td align="left">输出到屏幕（即控制台）</td>
<td align="left">&#x2F;proc&#x2F;slef&#x2F;fd&#x2F;2</td>
</tr>
</tbody></table>
<p><code>&gt;</code> 代表重定向到哪里?</p>
<p>例如：<code>echo &quot;123&quot; &gt; /home/123.txt</code><br><code>1</code> 表示<code>stdout</code>标准输出，系统默认值是<code>1</code>，所以<code>&gt;/dev/null</code>等同于<code>1&gt;/dev/null</code><br><code>2</code> 表示<code>stderr</code>标准错误<br><code>&amp;</code> 表示等同于的意思，<code>2&gt;&amp;1</code>，表示<code>2</code>的输出重定向等同于<code>1</code></p>
<p>参考资料：</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vdGlueXdhbi9wLzYwMjU0NjguaHRtbA==">Shell 脚本———— &#x2F;dev&#x2F;null 2&gt;&amp;1 详解</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2phY2t5ZWNoaW5hL2FydGljbGUvZGV0YWlscy81NDU4MjE0Ng==">shell 中&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2l0aG9tZXIvYXJ0aWNsZS9kZXRhaWxzLzkyODgzNTM=">Linux Shell 1&gt;&#x2F;dev&#x2F;null 2&gt;&amp;1 含义</span></p>
<h2 id="扩展知识"><a href="#扩展知识" class="headerlink" title="扩展知识"></a>扩展知识</h2><h3 id="自动化流程的发展趋势"><a href="#自动化流程的发展趋势" class="headerlink" title="自动化流程的发展趋势"></a>自动化流程的发展趋势</h3><ol>
<li><p>集中化</p>
<p>以集群为基础，服务采用 Saas 方式进行交付。所有折构建、测试、发布全集中进行管理。</p>
</li>
<li><p>微服务+无服务的应用模式</p>
<p>应用程序执行环境的管理被新的编程模型和平台取代后，团队的交付生产率得到了进一步的提升。一方面它免去了很多环境管理的工作，包括设备、网络、主机以及对应的软件和配置工作，使得软件运行时环境更加稳定。另一方面，它大大降低了团队采用 DevOps 的技术门槛。</p>
<p><strong>无服务器风格的架构（Serverless architecture）</strong>把 DevOps 技术在微服务领域的应用推向极致。当应用程序执行环境的管理被新的编程模型和平台取代后，团队的交付生产率得到了进一步的提升。一方面它免去了很多环境管理的工作，包括设备、网络、主机以及对应的软件和配置工作，使得软件运行时环境更加稳定。另一方面，它大大降低了团队采用 DevOps 的技术门槛。</p>
<p>在微服务端到端交付流程上，Netflix 开源了自家的<span class="exturl" data-url="aHR0cDovL3d3dy5zcGlubmFrZXIuaW8v">Spinnaker</span>，Netflix 作为微服务实践的先锋，不断推出新的开源工具来弥补社区中微服务技术和最佳实践的缺失。而<span class="exturl" data-url="aHR0cDovL3Byb2plY3RzLnNwcmluZy5pby9zcHJpbmctY2xvdWQv">Spring Cloud</span>则为开发者提供了一系列工具，以便他们在所熟悉的 Spring 技术栈下使用这些服务协调技术(coordination techniques)，如服务发现、负载均衡、熔断和健康检查。</p>
</li>
<li><p>人工智能领域的应用</p>
<p>DevOps 的最早实践来自于互联网企业的 Web 应用，相应的思想被引入企业级应用并促进了一系列工具的发展。在人工智能领域，<span class="exturl" data-url="aHR0cHM6Ly93d3cudGVuc29yZmxvdy5vcmcv">TensorFlow</span>就是这样一个例子，它可以有多种 DevOps 友好的安装和部署方式 ，例如采用 Docker 进行部署。</p>
<p>随着 Python 在大数据、人工智能、区块链、微服务以及 Docker 中的发展，可以预见 Python 在日后的领域仍然会发挥重要的作用。</p>
</li>
<li><p>安全推动 DevOps 的发展</p>
<p>全是 DevOps 永远绕不开的话题，也往往是新技术在传统行业（例如金融和电信）应用中的最大阻碍。一方面，组织结构的转型迫使企业要打破原先的部门墙，这意味着很多原先的控制流程不再适用。另一方面，由于大量的 DevOps 技术来源于开源社区，缺乏强大技术实力的企业在应用相关技术时不免会有所担忧。</p>
</li>
<li><p>Windows 平台下.net 的技术潜力巨大</p>
<p>长期以来，Windows 和.NET 平台下的 DevOps 一直都是一个被低估的领域。一方面，社区缺乏对 Windows Server 平台的兴趣。另一方面，<span class="exturl" data-url="aHR0cHM6Ly9jb21tdW5pdHkuc3BpY2V3b3Jrcy5jb20vbmV0d29ya2luZy9hcnRpY2xlcy8yNDYyLXNlcnZlci12aXJ0dWFsaXphdGlvbi1hbmQtb3MtdHJlbmRz">Windows Server 却有接近 90%的市场占用率</span>，在 Web 服务器领域则有<span class="exturl" data-url="aHR0cHM6Ly93M3RlY2hzLmNvbS90ZWNobm9sb2dpZXMvb3ZlcnZpZXcvb3BlcmF0aW5nX3N5c3RlbS9hbGw=">33.5%的市场占有率</span>。</p>
</li>
<li><p>非功能性自动化测试工具逐渐完善</p>
<p>自动化测试水平往往是衡量 DevOps 技术能力高低的重要指标，尤其是针对生产环境应用程序的非功能性自动化测试工具。一直以来，技术雷达都在尝试从不同的角度宣扬自动化测试的重要性，从软件的开发阶段延展到了整个应用生命周期甚至整体 IT 资产的管理上。</p>
</li>
</ol>
<h3 id="复杂的-DevOps-相关工具"><a href="#复杂的-DevOps-相关工具" class="headerlink" title="复杂的 DevOps 相关工具"></a>复杂的 DevOps 相关工具</h3><p><img data-src="/images/devops-hero-1-87966cfbc9c5713ae047551c7b22985c.png" alt="DevOps"></p>
<h3 id="Jenkins-的一些应用场景"><a href="#Jenkins-的一些应用场景" class="headerlink" title="Jenkins 的一些应用场景"></a>Jenkins 的一些应用场景</h3><p>打包平台：</p>
<p>使用 Jenkins 搭建 iOS&#x2F;Android</p>
<p>测试平台：</p>
<p>jenkins + python + selenium</p>
<p>Jmeter+maven+Jenkins 构建云性能测试平台</p>
<p>Jenkins+PMD 构建自动化静态代码检测</p>
<p>使用 jenkins+Emma 统计</p>
<p>客户端单元测试覆盖率</p>
<p>Jenkins+Ant+Java+Junit+SVN 执行 junit 单元测试</p>
<p>jenkins+ant+jmeter 搭建持续集成的接口测试平台</p>
<p>自动部署：</p>
<p>Jenkins+GitLab+蒲公英+FTP</p>
<p>jenkins 结合 ansible 用 shell 实现自动化部署和回滚</p>
<p>持续集成：</p>
<p>Tomcat+Sonar 搭建持续集成环境</p>
<p>Maven+Nexus+Jenkins+git&#x2F;SVN</p>
<h3 id="Jenkins-的-Docker-compose-yml-创建文件"><a href="#Jenkins-的-Docker-compose-yml-创建文件" class="headerlink" title="Jenkins 的 Docker-compose.yml 创建文件"></a>Jenkins 的 Docker-compose.yml 创建文件</h3><pre><code class="bash">version: &#39;3&#39;
services:
  jenkins:
    container_name: &#39;jenkins&#39;
    image: jenkins/jenkins
    restart: always
    user: jenkins:&lt;这里填Docker用户组的ID，见下面&gt;
    ports:
    - &quot;8080:8080&quot;
    - &quot;50000:50000&quot;
    volumes:
    - /home/jenkins/data:/var/jenkins_home
    - /usr/bin/docker:/usr/bin/docker
    - /var/run/docker.sock:/var/run/docker.sock
</code></pre>
<p>上面的脚本使用注意：</p>
<ol>
<li><p>创建本地 jenkins 数据目录</p>
<pre><code class="bash">mkdir -p /home/jenkins
</code></pre>
</li>
<li><p>查看 docker 用户组的 ID</p>
<pre><code class="bash">cat /etc/group |grep docker
</code></pre>
</li>
<li><p>执行<code>docker-compose up -d</code></p>
</li>
</ol>
<h3 id="gitlab-的-docker-启动配置文件"><a href="#gitlab-的-docker-启动配置文件" class="headerlink" title="gitlab 的 docker 启动配置文件"></a>gitlab 的 docker 启动配置文件</h3><p>项目地址：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NhbWVlcnNibi9kb2NrZXItZ2l0bGFi">https://github.com/sameersbn/docker-gitlab</span></p>
<pre><code class="yaml">version: &quot;2&quot;

services:
  redis:
    restart: always
    image: sameersbn/redis:4.0.9-1
    command:
      - --loglevel warning
    volumes:
      - /srv/docker/gitlab/redis:/var/lib/redis:Z

  postgresql:
    restart: always
    image: sameersbn/postgresql:10
    volumes:
      - /srv/docker/gitlab/postgresql:/var/lib/postgresql:Z
    environment:
      - DB_USER=gitlab
      - DB_PASS=password
      - DB_NAME=gitlabhq_production
      - DB_EXTENSION=pg_trgm

  gitlab:
    restart: always
    image: sameersbn/gitlab:11.11.2
    depends_on:
      - redis
      - postgresql
    ports:
      - &quot;10080:80&quot;
      - &quot;10022:22&quot;
    volumes:
      - /srv/docker/gitlab/gitlab:/home/git/data:Z
    environment:
      - DEBUG=false

      - DB_ADAPTER=postgresql
      - DB_HOST=postgresql
      - DB_PORT=5432
      - DB_USER=gitlab
      - DB_PASS=password
      - DB_NAME=gitlabhq_production

      - REDIS_HOST=redis
      - REDIS_PORT=6379

      - TZ=Asia/Kolkata
      - GITLAB_TIMEZONE=Kolkata

      - GITLAB_HTTPS=false
      - SSL_SELF_SIGNED=false

      # 这里修改成服务器的IP或者域名
      - GITLAB_HOST=localhost
      - GITLAB_PORT=10080
      - GITLAB_SSH_PORT=10022
      - GITLAB_RELATIVE_URL_ROOT=
      - GITLAB_SECRETS_DB_KEY_BASE=long-and-random-alphanumeric-string
      - GITLAB_SECRETS_SECRET_KEY_BASE=long-and-random-alphanumeric-string
      - GITLAB_SECRETS_OTP_KEY_BASE=long-and-random-alphanumeric-string

      # 这里给一个长度大于8的密码
      - GITLAB_ROOT_PASSWORD=12345678
      - GITLAB_ROOT_EMAIL=itheima@itcast.cn

      - GITLAB_NOTIFY_ON_BROKEN_BUILDS=true
      - GITLAB_NOTIFY_PUSHER=false

      - GITLAB_EMAIL=notifications@example.com
      - GITLAB_EMAIL_REPLY_TO=noreply@example.com
      - GITLAB_INCOMING_EMAIL_ADDRESS=reply@example.com

      - GITLAB_BACKUP_SCHEDULE=daily
      - GITLAB_BACKUP_TIME=01:00

      - SMTP_ENABLED=false
      - SMTP_DOMAIN=www.example.com
      - SMTP_HOST=smtp.gmail.com
      - SMTP_PORT=587
      - SMTP_USER=mailer@example.com
      - SMTP_PASS=password
      - SMTP_STARTTLS=true
      - SMTP_AUTHENTICATION=login

      - IMAP_ENABLED=false
      - IMAP_HOST=imap.gmail.com
      - IMAP_PORT=993
      - IMAP_USER=mailer@example.com
      - IMAP_PASS=password
      - IMAP_SSL=true
      - IMAP_STARTTLS=false

      - OAUTH_ENABLED=false
      - OAUTH_AUTO_SIGN_IN_WITH_PROVIDER=
      - OAUTH_ALLOW_SSO=
      - OAUTH_BLOCK_AUTO_CREATED_USERS=true
      - OAUTH_AUTO_LINK_LDAP_USER=false
      - OAUTH_AUTO_LINK_SAML_USER=false
      - OAUTH_EXTERNAL_PROVIDERS=

      - OAUTH_CAS3_LABEL=cas3
      - OAUTH_CAS3_SERVER=
      - OAUTH_CAS3_DISABLE_SSL_VERIFICATION=false
      - OAUTH_CAS3_LOGIN_URL=/cas/login
      - OAUTH_CAS3_VALIDATE_URL=/cas/p3/serviceValidate
      - OAUTH_CAS3_LOGOUT_URL=/cas/logout

      - OAUTH_GOOGLE_API_KEY=
      - OAUTH_GOOGLE_APP_SECRET=
      - OAUTH_GOOGLE_RESTRICT_DOMAIN=

      - OAUTH_FACEBOOK_API_KEY=
      - OAUTH_FACEBOOK_APP_SECRET=

      - OAUTH_TWITTER_API_KEY=
      - OAUTH_TWITTER_APP_SECRET=

      - OAUTH_GITHUB_API_KEY=
      - OAUTH_GITHUB_APP_SECRET=
      - OAUTH_GITHUB_URL=
      - OAUTH_GITHUB_VERIFY_SSL=

      - OAUTH_GITLAB_API_KEY=
      - OAUTH_GITLAB_APP_SECRET=

      - OAUTH_BITBUCKET_API_KEY=
      - OAUTH_BITBUCKET_APP_SECRET=

      - OAUTH_SAML_ASSERTION_CONSUMER_SERVICE_URL=
      - OAUTH_SAML_IDP_CERT_FINGERPRINT=
      - OAUTH_SAML_IDP_SSO_TARGET_URL=
      - OAUTH_SAML_ISSUER=
      - OAUTH_SAML_LABEL=&quot;Our SAML Provider&quot;
      - OAUTH_SAML_NAME_IDENTIFIER_FORMAT=urn:oasis:names:tc:SAML:2.0:nameid-format:transient
      - OAUTH_SAML_GROUPS_ATTRIBUTE=
      - OAUTH_SAML_EXTERNAL_GROUPS=
      - OAUTH_SAML_ATTRIBUTE_STATEMENTS_EMAIL=
      - OAUTH_SAML_ATTRIBUTE_STATEMENTS_NAME=
      - OAUTH_SAML_ATTRIBUTE_STATEMENTS_USERNAME=
      - OAUTH_SAML_ATTRIBUTE_STATEMENTS_FIRST_NAME=
      - OAUTH_SAML_ATTRIBUTE_STATEMENTS_LAST_NAME=

      - OAUTH_CROWD_SERVER_URL=
      - OAUTH_CROWD_APP_NAME=
      - OAUTH_CROWD_APP_PASSWORD=

      - OAUTH_AUTH0_CLIENT_ID=
      - OAUTH_AUTH0_CLIENT_SECRET=
      - OAUTH_AUTH0_DOMAIN=

      - OAUTH_AZURE_API_KEY=
      - OAUTH_AZURE_API_SECRET=
      - OAUTH_AZURE_TENANT_ID=
</code></pre>

      <div class="tags">
          <a href="/tags/%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90/" rel="tag"><i class="ic i-tag"></i> 持续集成</a>
          <a href="/tags/%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2/" rel="tag"><i class="ic i-tag"></i> 持续部署</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">更新于</span>
    <time title="修改时间：2024-07-24 15:29:28" itemprop="dateModified" datetime="2024-07-24T15:29:28+08:00">2024-07-24</time>
  </span>
  <span id="2024/02/03/持续集成与持续部署/" class="item leancloud_visitors" data-flag-title="持续集成与持续部署" title="阅读次数">
      <span class="icon">
        <i class="ic i-eye"></i>
      </span>
      <span class="text">阅读次数</span>
      <span class="leancloud-visitors-count"></span>
      <span class="text">次</span>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> 赞赏</button>
  <p>请我喝[茶]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="dmq 微信支付">
        <p>微信支付</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="dmq 支付宝">
        <p>支付宝</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>本文作者： </strong>dmq <i class="ic i-at"><em>@</em></i>杜明清的个人博客
  </li>
  <li class="link">
    <strong>本文链接：</strong>
    <a href="https://dmqweb.cn/2024/02/03/%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E4%B8%8E%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2/" title="持续集成与持续部署">https://dmqweb.cn/2024/02/03/持续集成与持续部署/</a>
  </li>
  <li class="license">
    <strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2024/02/02/%E5%AE%B9%E5%99%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E6%93%8D%E4%BD%9C/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s3.uuu.ovh&#x2F;imgs&#x2F;2024&#x2F;04&#x2F;28&#x2F;02824114036dc293.webp" title="容器化运维操作">
  <span class="type">上一篇</span>
  <span class="category"><i class="ic i-flag"></i> 容器化运维操作</span>
  <h3>容器化运维操作</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2024/03/02/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s3.uuu.ovh&#x2F;imgs&#x2F;2024&#x2F;04&#x2F;12&#x2F;f63f09ff2084b1f3.jpg" title="自动化测试">
  <span class="type">下一篇</span>
  <span class="category"><i class="ic i-flag"></i> 自动化测试</span>
  <h3>自动化测试</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="文章目录">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#5-4-%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E4%B8%8E%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2"><span class="toc-number">1.</span> <span class="toc-text">5-4 持续集成与持续部署</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90"><span class="toc-number">1.1.</span> <span class="toc-text">持续集成</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="toc-number">1.1.1.</span> <span class="toc-text">核心概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90-1"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">持续集成</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%98"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">持续交付</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">持续部署</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E7%BB%84%E6%88%90%E8%A6%81%E7%B4%A0"><span class="toc-number">1.1.2.</span> <span class="toc-text">持续集成组成要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.1.3.</span> <span class="toc-text">应用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E6%B5%81"><span class="toc-number">1.1.4.</span> <span class="toc-text">工作流</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%A0%E7%BB%9F%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">传统的工作流</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81"><span class="toc-number">1.1.4.2.</span> <span class="toc-text">常见的工作流</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.1.4.3.</span> <span class="toc-text">解决的问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="toc-number">1.1.4.4.</span> <span class="toc-text">常见问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.1.4.5.</span> <span class="toc-text">最佳实践</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%88%E7%8E%87%E5%B7%A5%E5%85%B7%E5%AF%B9%E6%AF%94"><span class="toc-number">1.1.5.</span> <span class="toc-text">效率工具对比</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins"><span class="toc-number">1.2.</span> <span class="toc-text">Jenkins</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%AE%80%E4%BB%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text">使用简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.2.</span> <span class="toc-text">安装方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E4%BB%B6%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.2.3.</span> <span class="toc-text">插件介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E8%87%AA%E5%8A%A8%E5%8C%96%E4%BB%BB%E5%8A%A1"><span class="toc-number">1.2.4.</span> <span class="toc-text">配置自动化任务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TravisCI"><span class="toc-number">1.3.</span> <span class="toc-text">TravisCI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%AE%80%E4%BB%8B-1"><span class="toc-number">1.3.1.</span> <span class="toc-text">使用简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-Node-js-%E5%BA%94%E7%94%A8"><span class="toc-number">1.3.2.</span> <span class="toc-text">配置 Node.js 应用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CircleCI"><span class="toc-number">1.4.</span> <span class="toc-text">CircleCI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%AE%80%E4%BB%8B-2"><span class="toc-number">1.4.1.</span> <span class="toc-text">使用简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-Node-js-%E5%BA%94%E7%94%A8-1"><span class="toc-number">1.4.2.</span> <span class="toc-text">配置 Node.js 应用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E7%9F%A5%E8%AF%86"><span class="toc-number">1.5.</span> <span class="toc-text">扩展知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%81%E7%A8%8B%E7%9A%84%E5%8F%91%E5%B1%95%E8%B6%8B%E5%8A%BF"><span class="toc-number">1.5.1.</span> <span class="toc-text">自动化流程的发展趋势</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E6%9D%82%E7%9A%84-DevOps-%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7"><span class="toc-number">1.5.2.</span> <span class="toc-text">复杂的 DevOps 相关工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins-%E7%9A%84%E4%B8%80%E4%BA%9B%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.5.3.</span> <span class="toc-text">Jenkins 的一些应用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins-%E7%9A%84-Docker-compose-yml-%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6"><span class="toc-number">1.5.4.</span> <span class="toc-text">Jenkins 的 Docker-compose.yml 创建文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gitlab-%E7%9A%84-docker-%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.5.5.</span> <span class="toc-text">gitlab 的 docker 启动配置文件</span></a></li></ol></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="系列文章">
        <ul>
          <li class="active"><a href="/2024/02/03/%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E4%B8%8E%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2/" rel="bookmark" title="持续集成与持续部署">持续集成与持续部署</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="站点概览">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="dmq"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">dmq</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">80</span>
        <span class="name">文章</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">64</span>
        <span class="name">分类</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">100</span>
        <span class="name">标签</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RtcTA/dGFiPXJlcG9zaXRvcmllcw==" title="https:&#x2F;&#x2F;github.com&#x2F;dmq0?tab&#x3D;repositories"><i class="ic i-github"></i></span>
      <span class="exturl item npm" data-url="aHR0cHM6Ly93d3cubnBtanMuY29tL35kbXEwMDA=" title="https:&#x2F;&#x2F;www.npmjs.com&#x2F;~dmq000"><i class="ic i-file"></i></span>
      <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9kLTg4LTYxLTgz" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;d-88-61-83"><i class="ic i-zhihu"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTgwMjc4OTk0OTE=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;8027899491"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vdS83NjI1OTAxNzE3" title="https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;7625901717"><i class="ic i-weibo"></i></span>
      <span class="exturl item email" data-url="bWFpbHRvOjMyNjc4MDc1MTRAcXEuY29t" title="mailto:3267807514@qq.com"><i class="ic i-envelope"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>首页</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>介绍</a>
  </li>

    
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a>
  </li>

    
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a>
  </li>

    
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a>
  </li>

    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a>
  </li>

    
  <li class="item">
    <a href="/links/" rel="section"><i class="ic i-magic"></i>工具</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2024/02/02/%E5%AE%B9%E5%99%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E6%93%8D%E4%BD%9C/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2024/03/02/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>随机文章</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/" title="分类于 浏览器">浏览器</a>
</div>

    <span><a href="/2023/10/09/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93%E5%8E%9F%E7%90%86/" title="浏览器渲染原理">浏览器渲染原理</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/TDD/" title="分类于 TDD">TDD</a>
</div>

    <span><a href="/2024/03/30/jest/" title="jest">jest</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Blob/" title="分类于 Blob">Blob</a>
</div>

    <span><a href="/2024/05/17/Blob%E5%92%8CFile/" title="Blob、File和FileReader">Blob、File和FileReader</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8E%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/" title="分类于 设计模式与设计原则">设计模式与设计原则</a>
</div>

    <span><a href="/2024/07/07/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%8E%9F%E5%88%99/" title="设计模式与设计原则">设计模式与设计原则</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/ajax/" title="分类于 ajax">ajax</a>
</div>

    <span><a href="/2023/01/08/ajax/" title="ajax">ajax</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/JS/" title="分类于 JS">JS</a>
</div>

    <span><a href="/2023/12/21/%E6%9C%80%E5%A4%A7%E5%AE%89%E5%85%A8%E6%95%B0/" title="最大安全数与最大安全整数">最大安全数与最大安全整数</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Docker/" title="分类于 Docker">Docker</a>
</div>

    <span><a href="/2024/07/08/docker/" title="Docker">Docker</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/whistle/" title="分类于 whistle">whistle</a>
</div>

    <span><a href="/2024/05/17/whistle%E4%BD%BF%E7%94%A8/" title="whistle抓包">whistle抓包</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/" title="分类于 面试题">面试题</a>
</div>

    <span><a href="/2024/04/30/%E6%B7%B1%E6%8B%B7%E8%B4%9D/" title="深拷贝">深拷贝</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="分类于 正则表达式">正则表达式</a>
</div>

    <span><a href="/2023/02/12/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="正则表达式">正则表达式</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>最新评论</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2022 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">dmq @ Web blog</span>
  </div>
  <div class="count">
    <span class="post-meta-item-icon">
      <i class="ic i-chart-area"></i>
    </span>
    <span title="站点总字数">938k 字</span>

    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="ic i-coffee"></i>
    </span>
    <span title="站点阅读时长">14:12</span>
  </div>
  <div class="powered-by">
    基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2024/02/03/持续集成与持续部署/',
    favicon: {
      show: "科技引领未来",
      hide: "欢迎与我交流"
    },
    search : {
      placeholder: "文章搜索",
      empty: "关于 「 ${query} 」，什么也没搜到",
      stats: "${time} ms 内找到 ${hits} 条结果"
    },
    valine: true,fancybox: true,
    copyright: '复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//gcore.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>


  <script data-pjax>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?9ba187659e850a6910681214f0faa16b";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


</body>
</html>
